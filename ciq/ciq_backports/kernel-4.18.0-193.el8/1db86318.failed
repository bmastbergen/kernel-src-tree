RDMA/mlx5: Check for error return in flow_rule rather than err

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Colin Ian King <colin.king@canonical.com>
commit 1db86318c4d1a0d1c8a19535290f71a03a2f13ad
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/1db86318.failed

Currently when the call to create_flow_rule_vport_sq fails, the error
check is being performed on err rather than on the return pointer
flow_rule.  The return flow_rule maybe NULL (which is not considered an
error) or an error code, so check for the error on flow_rule.

Addresses-Coverity: ("Uninitialized scalar variable")
Fixes: d5ed8ac34cef ("RDMA/mlx5: Move default representors SQ steering to rule to modify QP")
	Signed-off-by: Colin Ian King <colin.king@canonical.com>
	Acked-by: Leon Romanovsky <leonro@mellanox.com>
	Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
(cherry picked from commit 1db86318c4d1a0d1c8a19535290f71a03a2f13ad)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/mlx5/qp.c
diff --cc drivers/infiniband/hw/mlx5/qp.c
index 83a4d3984747,487dccbe1852..000000000000
--- a/drivers/infiniband/hw/mlx5/qp.c
+++ b/drivers/infiniband/hw/mlx5/qp.c
@@@ -3268,8 -3273,25 +3268,30 @@@ static int modify_raw_packet_qp(struct 
  				return err;
  		}
  
++<<<<<<< HEAD
 +		return modify_raw_packet_qp_sq(dev->mdev, sq, sq_state,
 +					       raw_qp_param, qp->ibqp.pd);
++=======
+ 		flow_rule = create_flow_rule_vport_sq(dev, sq,
+ 						      raw_qp_param->port);
+ 		if (IS_ERR(flow_rule))
+ 			return PTR_ERR(flow_rule);
+ 
+ 		err = modify_raw_packet_qp_sq(dev->mdev, sq, sq_state,
+ 					      raw_qp_param, qp->ibqp.pd);
+ 		if (err) {
+ 			if (flow_rule)
+ 				mlx5_del_flow_rules(flow_rule);
+ 			return err;
+ 		}
+ 
+ 		if (flow_rule) {
+ 			destroy_flow_rule_vport_sq(sq);
+ 			sq->flow_rule = flow_rule;
+ 		}
+ 
+ 		return err;
++>>>>>>> 1db86318c4d1 (RDMA/mlx5: Check for error return in flow_rule rather than err)
  	}
  
  	return 0;
* Unmerged path drivers/infiniband/hw/mlx5/qp.c
