mac80211: fix possible NULL pointerderef in obss pd code

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author John Crispin <john@phrozen.org>
commit 5db16ba82f38849a78ae932c0b7eada4cd2eb919
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/5db16ba8.failed

he_spr_ie_elem is dereferenced before the NULL check. fix this by moving
the assignment after the check.

fixes commit 697f6c507c74 ("mac80211: propagate HE operation info into
bss_conf")

This was reported by the static code checker.

	Reported-by: Dan Carpenter <dan.carpenter@oracle.com>
	Signed-off-by: John Crispin <john@phrozen.org>
Link: https://lore.kernel.org/r/20190813070712.25509-1-john@phrozen.org
	Signed-off-by: Johannes Berg <johannes.berg@intel.com>
(cherry picked from commit 5db16ba82f38849a78ae932c0b7eada4cd2eb919)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/mac80211/he.c
diff --cc net/mac80211/he.c
index f910f730ad0d,736da0035135..000000000000
--- a/net/mac80211/he.c
+++ b/net/mac80211/he.c
@@@ -65,3 -65,28 +65,31 @@@ ieee80211_he_op_ie_to_bss_conf(struct i
  
  	vif->bss_conf.he_operation = *he_op_ie_elem;
  }
++<<<<<<< HEAD
++=======
+ 
+ void
+ ieee80211_he_spr_ie_to_bss_conf(struct ieee80211_vif *vif,
+ 				const struct ieee80211_he_spr *he_spr_ie_elem)
+ {
+ 	struct ieee80211_he_obss_pd *he_obss_pd =
+ 					&vif->bss_conf.he_obss_pd;
+ 	const u8 *data;
+ 
+ 	memset(he_obss_pd, 0, sizeof(*he_obss_pd));
+ 
+ 	if (!he_spr_ie_elem)
+ 		return;
+ 	data = he_spr_ie_elem->optional;
+ 
+ 	if (he_spr_ie_elem->he_sr_control &
+ 	    IEEE80211_HE_SPR_NON_SRG_OFFSET_PRESENT)
+ 		data++;
+ 	if (he_spr_ie_elem->he_sr_control &
+ 	    IEEE80211_HE_SPR_SRG_INFORMATION_PRESENT) {
+ 		he_obss_pd->max_offset = *data++;
+ 		he_obss_pd->min_offset = *data++;
+ 		he_obss_pd->enable = true;
+ 	}
+ }
++>>>>>>> 5db16ba82f38 (mac80211: fix possible NULL pointerderef in obss pd code)
* Unmerged path net/mac80211/he.c
