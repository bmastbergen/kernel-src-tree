HID: wacom: Add 2nd gen Intuos Pro Small support

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
Rebuild_CHGLOG: - [hid] wacom: Add 2nd gen Intuos Pro Small support (Benjamin Tissoires) [1740778]
Rebuild_FUZZ: 94.51%
commit-author Aaron Armstrong Skomra <skomra@gmail.com>
commit 912c6aa67ad4252dc92e6569cfcb32ee44575183
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/912c6aa6.failed

The existing INTUOSP2_BT device class supports LEDs and this device
does not. A new device class enum entry, "INTUOSP2S_BT", is created
to avoid the INTUOSP2_BT LED code.

	Signed-off-by: Aaron Armstrong Skomra <aaron.skomra@wacom.com>
	Reviewed-by: Jason Gerecke <jason.gerecke@wacom.com>
	Signed-off-by: Jiri Kosina <jkosina@suse.cz>
(cherry picked from commit 912c6aa67ad4252dc92e6569cfcb32ee44575183)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/hid/wacom_wac.c
diff --cc drivers/hid/wacom_wac.c
index 5342fd80d698,b764e9d72b5b..000000000000
--- a/drivers/hid/wacom_wac.c
+++ b/drivers/hid/wacom_wac.c
@@@ -1290,27 -1277,25 +1292,38 @@@ static void wacom_intuos_pro2_bt_pen(st
  						 get_unaligned_le16(&frame[11]));
  			}
  		}
++<<<<<<< HEAD
 +
 +		if (wacom->tool[0]) {
 +			input_report_abs(pen_input, ABS_PRESSURE, get_unaligned_le16(&frame[5]));
 +			if (wacom->features.type == INTUOSP2_BT) {
 +				input_report_abs(pen_input, ABS_DISTANCE,
 +						 range ? frame[13] : wacom->features.distance_max);
 +			} else {
 +				input_report_abs(pen_input, ABS_DISTANCE,
 +						 range ? frame[7] : wacom->features.distance_max);
 +			}
 +
 +			input_report_key(pen_input, BTN_TOUCH, frame[0] & 0x09);
 +			input_report_key(pen_input, BTN_STYLUS, frame[0] & 0x02);
 +			input_report_key(pen_input, BTN_STYLUS2, frame[0] & 0x04);
 +
 +			input_report_key(pen_input, wacom->tool[0], prox);
 +			input_event(pen_input, EV_MSC, MSC_SERIAL, wacom->serial[0]);
 +			input_report_abs(pen_input, ABS_MISC,
 +					 wacom_intuos_id_mangle(wacom->id[0])); /* report tool id */
++=======
+ 		input_report_abs(pen_input, ABS_PRESSURE, get_unaligned_le16(&frame[5]));
+ 		if (wacom->features.type == INTUOSP2_BT ||
+ 		    wacom->features.type == INTUOSP2S_BT) {
+ 			input_report_abs(pen_input, ABS_DISTANCE,
+ 					 range ? frame[13] : wacom->features.distance_max);
+ 		} else {
+ 			input_report_abs(pen_input, ABS_DISTANCE,
+ 					 range ? frame[7] : wacom->features.distance_max);
++>>>>>>> 912c6aa67ad4 (HID: wacom: Add 2nd gen Intuos Pro Small support)
  		}
  
 -		input_report_key(pen_input, BTN_TOUCH, frame[0] & 0x01);
 -		input_report_key(pen_input, BTN_STYLUS, frame[0] & 0x02);
 -		input_report_key(pen_input, BTN_STYLUS2, frame[0] & 0x04);
 -
 -		input_report_key(pen_input, wacom->tool[0], prox);
 -		input_event(pen_input, EV_MSC, MSC_SERIAL, wacom->serial[0]);
 -		input_report_abs(pen_input, ABS_MISC,
 -				 wacom_intuos_id_mangle(wacom->id[0])); /* report tool id */
 -
  		wacom->shared->stylus_in_proximity = prox;
  
  		input_sync(pen_input);
* Unmerged path drivers/hid/wacom_wac.c
diff --git a/drivers/hid/wacom_wac.h b/drivers/hid/wacom_wac.h
index f67d871841c0..48f08f8a556d 100644
--- a/drivers/hid/wacom_wac.h
+++ b/drivers/hid/wacom_wac.h
@@ -215,6 +215,7 @@ enum {
 	INTUOSPM,
 	INTUOSPL,
 	INTUOSP2_BT,
+	INTUOSP2S_BT,
 	INTUOSHT3_BT,
 	WACOM_21UX2,
 	WACOM_22HD,
