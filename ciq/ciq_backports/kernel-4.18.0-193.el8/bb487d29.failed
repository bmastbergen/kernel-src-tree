net/mlx5: fix a -Wstringop-truncation warning

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
Rebuild_CHGLOG: - [netdrv] mlx5: fix a -Wstringop-truncation warning (Mohammad Heib) [1776921]
Rebuild_FUZZ: 95.35%
commit-author Qian Cai <cai@lca.pw>
commit bb487d29ce005416ed355dea213bbc39c03dabe7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/bb487d29.failed

In file included from ./arch/powerpc/include/asm/paca.h:15,
                 from ./arch/powerpc/include/asm/current.h:13,
                 from ./include/linux/thread_info.h:21,
                 from ./include/asm-generic/preempt.h:5,
                 from ./arch/powerpc/include/generated/asm/preempt.h:1,
                 from ./include/linux/preempt.h:78,
                 from ./include/linux/spinlock.h:51,
                 from ./include/linux/wait.h:9,
                 from ./include/linux/completion.h:12,
                 from ./include/linux/mlx5/driver.h:37,
                 from
drivers/net/ethernet/mellanox/mlx5/core/lib/eq.h:6,
                 from
drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c:33:
In function 'strncpy',
    inlined from 'mlx5_fw_tracer_save_trace' at
drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c:549:2,
    inlined from 'mlx5_tracer_print_trace' at
drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c:574:2:
./include/linux/string.h:305:9: warning: '__builtin_strncpy' output may
be truncated copying 256 bytes from a string of length 511
[-Wstringop-truncation]
  return __builtin_strncpy(p, q, size);
         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Fix it by using the new strscpy_pad() since the commit 458a3bf82df4
("lib/string: Add strscpy_pad() function") which will always
NUL-terminate the string, and avoid possibly leak data through the ring
buffer where non-admin account might enable these events through perf.

Fixes: fd1483fe1f9f ("net/mlx5: Add support for FW reporter dump")
	Signed-off-by: Qian Cai <cai@lca.pw>
	Signed-off-by: Saeed Mahameed <saeedm@mellanox.com>
(cherry picked from commit bb487d29ce005416ed355dea213bbc39c03dabe7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
index 6999f4486e9e,2011eaf15cc5..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
@@@ -522,6 -535,24 +522,27 @@@ static void mlx5_fw_tracer_clean_ready_
  		list_del(&str_frmt->list);
  }
  
++<<<<<<< HEAD
++=======
+ static void mlx5_fw_tracer_save_trace(struct mlx5_fw_tracer *tracer,
+ 				      u64 timestamp, bool lost,
+ 				      u8 event_id, char *msg)
+ {
+ 	struct mlx5_fw_trace_data *trace_data;
+ 
+ 	mutex_lock(&tracer->st_arr.lock);
+ 	trace_data = &tracer->st_arr.straces[tracer->st_arr.saved_traces_index];
+ 	trace_data->timestamp = timestamp;
+ 	trace_data->lost = lost;
+ 	trace_data->event_id = event_id;
+ 	strscpy_pad(trace_data->msg, msg, TRACE_STR_MSG);
+ 
+ 	tracer->st_arr.saved_traces_index =
+ 		(tracer->st_arr.saved_traces_index + 1) & (SAVED_TRACES_NUM - 1);
+ 	mutex_unlock(&tracer->st_arr.lock);
+ }
+ 
++>>>>>>> bb487d29ce00 (net/mlx5: fix a -Wstringop-truncation warning)
  static void mlx5_tracer_print_trace(struct tracer_string_format *str_frmt,
  				    struct mlx5_core_dev *dev,
  				    u64 trace_timestamp)
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
