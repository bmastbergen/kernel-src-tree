bpf/flow_dissector: don't adjust nhoff by ETH_HLEN in BPF_PROG_TEST_RUN

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Stanislav Fomichev <sdf@google.com>
commit 02ee0658362d3713421851bb7487af77a4098bb5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/02ee0658.failed

Now that we use skb-less flow dissector let's return true nhoff and
thoff. We used to adjust them by ETH_HLEN because that's how it was
done in the skb case. For VLAN tests that looks confusing: nhoff is
pointing to vlan parts :-\

Warning, this is an API change for BPF_PROG_TEST_RUN! Feel free to drop
if you think that it's too late at this point to fix it.

	Signed-off-by: Stanislav Fomichev <sdf@google.com>
	Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
(cherry picked from commit 02ee0658362d3713421851bb7487af77a4098bb5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/bpf/test_run.c
#	tools/testing/selftests/bpf/prog_tests/flow_dissector.c
diff --cc net/bpf/test_run.c
index 2221573dacdb,8606e5aef0b6..000000000000
--- a/net/bpf/test_run.c
+++ b/net/bpf/test_run.c
@@@ -433,9 -415,8 +433,14 @@@ int bpf_prog_test_run_flow_dissector(st
  	preempt_disable();
  	time_start = ktime_get_ns();
  	for (i = 0; i < repeat; i++) {
++<<<<<<< HEAD
 +		retval = __skb_flow_bpf_dissect(prog, skb,
 +						&flow_keys_dissector,
 +						&flow_keys);
++=======
+ 		retval = bpf_flow_dissect(prog, &ctx, eth->h_proto, ETH_HLEN,
+ 					  size);
++>>>>>>> 02ee0658362d (bpf/flow_dissector: don't adjust nhoff by ETH_HLEN in BPF_PROG_TEST_RUN)
  
  		if (signal_pending(current)) {
  			preempt_enable();
* Unmerged path tools/testing/selftests/bpf/prog_tests/flow_dissector.c
* Unmerged path net/bpf/test_run.c
* Unmerged path tools/testing/selftests/bpf/prog_tests/flow_dissector.c
