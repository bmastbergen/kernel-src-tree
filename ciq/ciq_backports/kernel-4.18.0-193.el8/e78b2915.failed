net: Introduce parse_protocol header_ops callback

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Maxim Mikityanskiy <maximmi@mellanox.com>
commit e78b2915517e8fcadb1bc130ad6aeac7099e510c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/e78b2915.failed

Introduce a new optional header_ops callback called parse_protocol and a
wrapper function dev_parse_header_protocol, similar to dev_parse_header.

The new callback's purpose is to extract the protocol number from the L2
header, the format of which is known to the driver, but not to the upper
layers of the stack.

	Signed-off-by: Maxim Mikityanskiy <maximmi@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit e78b2915517e8fcadb1bc130ad6aeac7099e510c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/linux/netdevice.h
diff --cc include/linux/netdevice.h
index 4c743add611a,6997f62cb6a0..000000000000
--- a/include/linux/netdevice.h
+++ b/include/linux/netdevice.h
@@@ -276,10 -274,7 +276,14 @@@ struct header_ops 
  				const struct net_device *dev,
  				const unsigned char *haddr);
  	bool	(*validate)(const char *ll_header, unsigned int len);
++<<<<<<< HEAD
 +
 +	RH_KABI_RESERVE(1)
 +	RH_KABI_RESERVE(2)
 +	RH_KABI_RESERVE(3)
++=======
+ 	__be16	(*parse_protocol)(const struct sk_buff *skb);
++>>>>>>> e78b2915517e (net: Introduce parse_protocol header_ops callback)
  };
  
  /* These flag bits are private to the generic network queueing
* Unmerged path include/linux/netdevice.h
