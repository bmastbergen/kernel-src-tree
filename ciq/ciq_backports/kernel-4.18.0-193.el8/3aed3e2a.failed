net: phy: micrel: add Asym Pause workaround

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
Rebuild_CHGLOG: - [netdrv] phy: micrel: add Asym Pause workaround (Petr Oros) [1772010]
Rebuild_FUZZ: 93.83%
commit-author Antoine Tenart <antoine.tenart@bootlin.com>
commit 3aed3e2a143c9619f4c8d0a3b8fe74d7d3d79c93
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/3aed3e2a.failed

The Micrel KSZ9031 PHY may fail to establish a link when the Asymmetric
Pause capability is set. This issue is described in a Silicon Errata
(DS80000691D or DS80000692D), which advises to always disable the
capability. This patch implements the workaround by defining a KSZ9031
specific get_feature callback to force the Asymmetric Pause capability
bit to be cleared.

This fixes issues where the link would not come up at boot time, or when
the Asym Pause bit was set later on.

	Signed-off-by: Antoine Tenart <antoine.tenart@bootlin.com>
	Reviewed-by: Andrew Lunn <andrew@lunn.ch>
	Reviewed-by: Florian Fainelli <f.fainelli@gmail.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 3aed3e2a143c9619f4c8d0a3b8fe74d7d3d79c93)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/phy/micrel.c
diff --cc drivers/net/phy/micrel.c
index 52d52619256a,ddd6b6374d8c..000000000000
--- a/drivers/net/phy/micrel.c
+++ b/drivers/net/phy/micrel.c
@@@ -1051,10 -1077,9 +1076,14 @@@ static struct phy_driver ksphy_driver[
  	.phy_id		= PHY_ID_KSZ9031,
  	.phy_id_mask	= MICREL_PHY_ID_MASK,
  	.name		= "Micrel KSZ9031 Gigabit PHY",
++<<<<<<< HEAD
 +	.features	= PHY_GBIT_FEATURES,
 +	.flags		= PHY_HAS_INTERRUPT,
++=======
++>>>>>>> 3aed3e2a143c (net: phy: micrel: add Asym Pause workaround)
  	.driver_data	= &ksz9021_type,
  	.probe		= kszphy_probe,
+ 	.get_features	= ksz9031_get_features,
  	.config_init	= ksz9031_config_init,
  	.soft_reset	= genphy_soft_reset,
  	.read_status	= ksz9031_read_status,
* Unmerged path drivers/net/phy/micrel.c
