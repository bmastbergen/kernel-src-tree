net/mlx5e: Fix number of vports for ingress ACL configuration

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
Rebuild_CHGLOG: - [netdrv] mlx5e: Fix number of vports for ingress ACL configuration (Alaa Hleihel) [1724335]
Rebuild_FUZZ: 96.61%
commit-author Eli Britstein <elibr@mellanox.com>
commit 955858009708326b26f47b6f99939489bb88a0dc
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/95585800.failed

With the cited commit, ACLs are configured for the VF ports. The loop
for the number of ports had the wrong number. Fix it.

Fixes: 184867373d8c ("net/mlx5e: ACLs for priority tag mode")
	Signed-off-by: Eli Britstein <elibr@mellanox.com>
	Reviewed-by: Roi Dayan <roid@mellanox.com>
	Signed-off-by: Saeed Mahameed <saeedm@mellanox.com>
(cherry picked from commit 955858009708326b26f47b6f99939489bb88a0dc)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/eswitch_offloads.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/eswitch_offloads.c
index 5d30117c7129,47b446d30f71..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/eswitch_offloads.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/eswitch_offloads.c
@@@ -1550,11 -1729,12 +1550,17 @@@ err_ingress
  
  static void esw_prio_tag_acls_cleanup(struct mlx5_eswitch *esw)
  {
 -	struct mlx5_vport *vport;
  	int i;
  
++<<<<<<< HEAD
 +	mlx5_esw_for_each_vf_vport(esw, i, esw->nvports) {
 +		esw_vport_disable_egress_acl(esw, &esw->vports[i]);
 +		esw_vport_disable_ingress_acl(esw, &esw->vports[i]);
++=======
+ 	mlx5_esw_for_each_vf_vport(esw, i, vport, esw->dev->priv.sriov.num_vfs) {
+ 		esw_vport_disable_egress_acl(esw, vport);
+ 		esw_vport_disable_ingress_acl(esw, vport);
++>>>>>>> 955858009708 (net/mlx5e: Fix number of vports for ingress ACL configuration)
  	}
  }
  
@@@ -1607,9 -1840,7 +1614,13 @@@ int esw_offloads_init(struct mlx5_eswit
  {
  	int err;
  
++<<<<<<< HEAD
 +	mutex_init(&esw->fdb_table.offloads.fdb_prio_lock);
 +
 +	err = esw_offloads_steering_init(esw, nvports);
++=======
+ 	err = esw_offloads_steering_init(esw, vf_nvports, total_nvports);
++>>>>>>> 955858009708 (net/mlx5e: Fix number of vports for ingress ACL configuration)
  	if (err)
  		return err;
  
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/eswitch_offloads.c
