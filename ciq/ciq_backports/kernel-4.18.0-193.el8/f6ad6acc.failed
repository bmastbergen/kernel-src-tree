selftests/bpf: expand test_tc_tunnel with SIT encap

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Willem de Bruijn <willemb@google.com>
commit f6ad6accaa99dfa7462d18687961b8421d707c1e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/f6ad6acc.failed

So far, all BPF tc tunnel testcases encapsulate in the same network
protocol. Add an encap testcase that requires updating skb->protocol.

The 6in4 tunnel encapsulates an IPv6 packet inside an IPv4 tunnel.
Verify that bpf_skb_net_grow correctly updates skb->protocol to
select the right protocol handler in __netif_receive_skb_core.

The BPF program should also manually update the link layer header to
encode the right network protocol.

Changes v1->v2
  - improve documentation of non-obvious logic

	Signed-off-by: Willem de Bruijn <willemb@google.com>
	Tested-by: Alan Maguire <alan.maguire@oracle.com>
	Acked-by: Yonghong Song <yhs@fb.com>
	Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
(cherry picked from commit f6ad6accaa99dfa7462d18687961b8421d707c1e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/testing/selftests/bpf/config
#	tools/testing/selftests/bpf/progs/test_tc_tunnel.c
#	tools/testing/selftests/bpf/test_tc_tunnel.sh
diff --cc tools/testing/selftests/bpf/config
index 37f947ec44ed,f7a0744db31e..000000000000
--- a/tools/testing/selftests/bpf/config
+++ b/tools/testing/selftests/bpf/config
@@@ -23,3 -23,14 +23,17 @@@ CONFIG_LWTUNNEL=
  CONFIG_BPF_STREAM_PARSER=y
  CONFIG_XDP_SOCKETS=y
  CONFIG_FTRACE_SYSCALLS=y
++<<<<<<< HEAD
++=======
+ CONFIG_IPV6_TUNNEL=y
+ CONFIG_IPV6_GRE=y
+ CONFIG_NET_FOU=m
+ CONFIG_NET_FOU_IP_TUNNELS=y
+ CONFIG_IPV6_FOU=m
+ CONFIG_IPV6_FOU_TUNNEL=m
+ CONFIG_MPLS=y
+ CONFIG_NET_MPLS_GSO=m
+ CONFIG_MPLS_ROUTING=m
+ CONFIG_MPLS_IPTUNNEL=m
+ CONFIG_IPV6_SIT=m
++>>>>>>> f6ad6accaa99 (selftests/bpf: expand test_tc_tunnel with SIT encap)
* Unmerged path tools/testing/selftests/bpf/progs/test_tc_tunnel.c
* Unmerged path tools/testing/selftests/bpf/test_tc_tunnel.sh
* Unmerged path tools/testing/selftests/bpf/config
* Unmerged path tools/testing/selftests/bpf/progs/test_tc_tunnel.c
* Unmerged path tools/testing/selftests/bpf/test_tc_tunnel.sh
