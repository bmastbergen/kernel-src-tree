fuse: reduce allocation size for splice_write

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Andrey Ryabinin <aryabinin@virtuozzo.com>
commit 9635453572028134b0f997afca8a6ad9ece2c515
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/96354535.failed

The 'bufs' array contains 'pipe->buffers' elements, but the
fuse_dev_splice_write() uses only 'pipe->nrbufs' elements.

So reduce the allocation size to 'pipe->nrbufs' elements.

	Signed-off-by: Andrey Ryabinin <aryabinin@virtuozzo.com>
	Signed-off-by: Miklos Szeredi <mszeredi@redhat.com>
(cherry picked from commit 9635453572028134b0f997afca8a6ad9ece2c515)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/fuse/dev.c
diff --cc fs/fuse/dev.c
index afc6e275adaa,11ea2c4a38ab..000000000000
--- a/fs/fuse/dev.c
+++ b/fs/fuse/dev.c
@@@ -1976,8 -1957,8 +1976,13 @@@ static ssize_t fuse_dev_splice_write(st
  
  	pipe_lock(pipe);
  
++<<<<<<< HEAD
 +	bufs = kmalloc_array(pipe->buffers, sizeof(struct pipe_buffer),
 +			     GFP_KERNEL);
++=======
+ 	bufs = kvmalloc_array(pipe->nrbufs, sizeof(struct pipe_buffer),
+ 			      GFP_KERNEL);
++>>>>>>> 963545357202 (fuse: reduce allocation size for splice_write)
  	if (!bufs) {
  		pipe_unlock(pipe);
  		return -ENOMEM;
* Unmerged path fs/fuse/dev.c
