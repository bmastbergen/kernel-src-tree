livepatch: Proper error handling in the shadow variables selftest

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Petr Mladek <pmladek@suse.com>
commit 49ee4dd2e753cd13d157361d4bd28b548e3d0ee7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/49ee4dd2.failed

Add proper error handling when allocating or getting shadow variables
in the selftest. It prevents an invalid pointer access in some situations.
It shows the good programming practice in the others.

The error codes are just the best guess and specific for this particular
test. In general, klp_shadow_alloc() returns NULL also when the given
shadow variable has already been allocated. In addition, both
klp_shadow_alloc() and klp_shadow_get_or_alloc() might fail from
other reasons when the constructor fails.

Note, that the error code is not really important even in the real life.
The use of shadow variables should be transparent for the original
livepatched code.

	Acked-by: Miroslav Benes <mbenes@suse.cz>
	Acked-by: Joe Lawrence <joe.lawrence@redhat.com>
	Signed-off-by: Petr Mladek <pmladek@suse.com>
(cherry picked from commit 49ee4dd2e753cd13d157361d4bd28b548e3d0ee7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	lib/livepatch/test_klp_shadow_vars.c
* Unmerged path lib/livepatch/test_klp_shadow_vars.c
* Unmerged path lib/livepatch/test_klp_shadow_vars.c
