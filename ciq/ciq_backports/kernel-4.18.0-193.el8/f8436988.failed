cls_api: remove the tcf_block cache

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author wenxu <wenxu@ucloud.cn>
commit f8436988574e50fe69f6f193ee76c3185b17a5c7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/f8436988.failed

Remove the tcf_block in the tc_indr_block_dev for muti-subsystem
support.

	Signed-off-by: wenxu <wenxu@ucloud.cn>
	Acked-by: Jakub Kicinski <jakub.kicinski@netronome.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit f8436988574e50fe69f6f193ee76c3185b17a5c7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sched/cls_api.c
diff --cc net/sched/cls_api.c
index 081ac3d0fb50,12eaa6c90e79..000000000000
--- a/net/sched/cls_api.c
+++ b/net/sched/cls_api.c
@@@ -715,7 -716,9 +714,13 @@@ int __tc_indr_block_cb_register(struct 
  	if (err)
  		goto err_dev_put;
  
++<<<<<<< HEAD
 +	tc_indr_block_ing_cmd(indr_dev, indr_block_cb, TC_BLOCK_BIND);
++=======
+ 	block = tc_dev_ingress_block(dev);
+ 	tc_indr_block_ing_cmd(dev, block, indr_block_cb->cb,
+ 			      indr_block_cb->cb_priv, FLOW_BLOCK_BIND);
++>>>>>>> f8436988574e (cls_api: remove the tcf_block cache)
  	return 0;
  
  err_dev_put:
@@@ -752,7 -756,9 +758,13 @@@ void __tc_indr_block_cb_unregister(stru
  		return;
  
  	/* Send unbind message if required to free any block cbs. */
++<<<<<<< HEAD
 +	tc_indr_block_ing_cmd(indr_dev, indr_block_cb, TC_BLOCK_UNBIND);
++=======
+ 	block = tc_dev_ingress_block(dev);
+ 	tc_indr_block_ing_cmd(dev, block, indr_block_cb->cb,
+ 			      indr_block_cb->cb_priv, FLOW_BLOCK_UNBIND);
++>>>>>>> f8436988574e (cls_api: remove the tcf_block cache)
  	tc_indr_block_cb_del(indr_block_cb);
  	tc_indr_block_dev_put(indr_dev);
  }
@@@ -786,8 -794,6 +798,11 @@@ static void tc_indr_block_call(struct t
  	if (!indr_dev)
  		return;
  
++<<<<<<< HEAD
 +	indr_dev->block = command == TC_BLOCK_BIND ? block : NULL;
 +
++=======
++>>>>>>> f8436988574e (cls_api: remove the tcf_block cache)
  	list_for_each_entry(indr_block_cb, &indr_dev->cb_list, list)
  		indr_block_cb->cb(dev, indr_block_cb->cb_priv, TC_SETUP_BLOCK,
  				  &bo);
* Unmerged path net/sched/cls_api.c
