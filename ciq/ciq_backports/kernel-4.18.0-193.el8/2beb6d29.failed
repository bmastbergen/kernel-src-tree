ipv6/addrconf: only check invalid header values when NETLINK_F_STRICT_CHK is set

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Hangbin Liu <liuhangbin@gmail.com>
commit 2beb6d2901a3f73106485d560c49981144aeacb1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/2beb6d29.failed

In commit 4b1373de73a3 ("net: ipv6: addr: perform strict checks also for
doit handlers") we add strict check for inet6_rtm_getaddr(). But we did
the invalid header values check before checking if NETLINK_F_STRICT_CHK
is set. This may break backwards compatibility if user already set the
ifm->ifa_prefixlen, ifm->ifa_flags, ifm->ifa_scope in their netlink code.

I didn't move the nlmsg_len check because I thought it's a valid check.

	Reported-by: Jianlin Shi <jishi@redhat.com>
Fixes: 4b1373de73a3 ("net: ipv6: addr: perform strict checks also for doit handlers")
	Signed-off-by: Hangbin Liu <liuhangbin@gmail.com>
	Reviewed-by: David Ahern <dsahern@gmail.com>
	Signed-off-by: Jakub Kicinski <jakub.kicinski@netronome.com>
(cherry picked from commit 2beb6d2901a3f73106485d560c49981144aeacb1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv6/addrconf.c
diff --cc net/ipv6/addrconf.c
index 55d37d6eddc0,39d861d00377..000000000000
--- a/net/ipv6/addrconf.c
+++ b/net/ipv6/addrconf.c
@@@ -5234,12 -5241,8 +5238,17 @@@ static int inet6_rtm_valid_getaddr_req(
  		return -EINVAL;
  	}
  
++<<<<<<< HEAD
 +	if (!netlink_strict_get_check(skb))
 +		return nlmsg_parse(nlh, sizeof(*ifm), tb, IFA_MAX,
 +				   ifa_ipv6_policy, extack);
 +
 +	err = nlmsg_parse_strict(nlh, sizeof(*ifm), tb, IFA_MAX,
 +				 ifa_ipv6_policy, extack);
++=======
+ 	err = nlmsg_parse_deprecated_strict(nlh, sizeof(*ifm), tb, IFA_MAX,
+ 					    ifa_ipv6_policy, extack);
++>>>>>>> 2beb6d2901a3 (ipv6/addrconf: only check invalid header values when NETLINK_F_STRICT_CHK is set)
  	if (err)
  		return err;
  
* Unmerged path net/ipv6/addrconf.c
