s390/crypto: xts-aes-s390 fix extra run-time crypto self tests finding

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Harald Freudenberger <freude@linux.ibm.com>
commit 9e323d45ba94262620a073a3f9945ca927c07c71
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/9e323d45.failed

With 'extra run-time crypto self tests' enabled, the selftest
for s390-xts fails with

  alg: skcipher: xts-aes-s390 encryption unexpectedly succeeded on
  test vector "random: len=0 klen=64"; expected_error=-22,
  cfg="random: inplace use_digest nosimd src_divs=[2.61%@+4006,
  84.44%@+21, 1.55%@+13, 4.50%@+344, 4.26%@+21, 2.64%@+27]"

This special case with nbytes=0 is not handled correctly and this
fix now makes sure that -EINVAL is returned when there is en/decrypt
called with 0 bytes to en/decrypt.

	Signed-off-by: Harald Freudenberger <freude@linux.ibm.com>
	Signed-off-by: Vasily Gorbik <gor@linux.ibm.com>
(cherry picked from commit 9e323d45ba94262620a073a3f9945ca927c07c71)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/s390/crypto/aes_s390.c
diff --cc arch/s390/crypto/aes_s390.c
index 78c82c4fef76,6d2dbb5089d5..000000000000
--- a/arch/s390/crypto/aes_s390.c
+++ b/arch/s390/crypto/aes_s390.c
@@@ -585,7 -586,10 +585,14 @@@ static int xts_aes_encrypt(struct blkci
  	struct s390_xts_ctx *xts_ctx = crypto_blkcipher_ctx(desc->tfm);
  	struct blkcipher_walk walk;
  
++<<<<<<< HEAD
 +	if (unlikely(!xts_ctx->fc || (nbytes % XTS_BLOCKSIZE) != 0))
++=======
+ 	if (!nbytes)
+ 		return -EINVAL;
+ 
+ 	if (unlikely(!xts_ctx->fc))
++>>>>>>> 9e323d45ba94 (s390/crypto: xts-aes-s390 fix extra run-time crypto self tests finding)
  		return xts_fallback_encrypt(desc, dst, src, nbytes);
  
  	blkcipher_walk_init(&walk, dst, src, nbytes);
@@@ -599,7 -603,10 +606,14 @@@ static int xts_aes_decrypt(struct blkci
  	struct s390_xts_ctx *xts_ctx = crypto_blkcipher_ctx(desc->tfm);
  	struct blkcipher_walk walk;
  
++<<<<<<< HEAD
 +	if (unlikely(!xts_ctx->fc || (nbytes % XTS_BLOCKSIZE) != 0))
++=======
+ 	if (!nbytes)
+ 		return -EINVAL;
+ 
+ 	if (unlikely(!xts_ctx->fc))
++>>>>>>> 9e323d45ba94 (s390/crypto: xts-aes-s390 fix extra run-time crypto self tests finding)
  		return xts_fallback_decrypt(desc, dst, src, nbytes);
  
  	blkcipher_walk_init(&walk, dst, src, nbytes);
* Unmerged path arch/s390/crypto/aes_s390.c
