net/mlx5e: Move local var definition into ifdef block

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
Rebuild_CHGLOG: - [netdrv] mlx5e: Move local var definition into ifdef block (Ivan Vecera) [1739606]
Rebuild_FUZZ: 96.08%
commit-author Vlad Buslov <vladbu@mellanox.com>
commit daa664a5cdd599583fceb9018c49d783bc5a0d5d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/daa664a5.failed

New local variable "struct flow_block_offload *f" was added to
mlx5e_setup_tc() in recent rtnl lock removal patches. The variable is used
in code that is only compiled when CONFIG_MLX5_ESWITCH is enabled. This
results compilation warning about unused variable when CONFIG_MLX5_ESWITCH
is not set. Move the variable definition into eswitch-specific code block
from the beginning of mlx5e_setup_tc() function.

Fixes: c9f14470d048 ("net: sched: add API for registering unlocked offload block callbacks")
	Reported-by: tanhuazhong <tanhuazhong@huawei.com>
	Signed-off-by: Vlad Buslov <vladbu@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit daa664a5cdd599583fceb9018c49d783bc5a0d5d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/en_main.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/en_main.c
index d67b5ad8b9d4,dadadf221087..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
@@@ -3481,10 -3496,19 +3481,26 @@@ static int mlx5e_setup_tc_block(struct 
  static int mlx5e_setup_tc(struct net_device *dev, enum tc_setup_type type,
  			  void *type_data)
  {
++<<<<<<< HEAD
 +	switch (type) {
 +#ifdef CONFIG_MLX5_ESWITCH
 +	case TC_SETUP_BLOCK:
 +		return mlx5e_setup_tc_block(dev, type_data);
++=======
+ 	struct mlx5e_priv *priv = netdev_priv(dev);
+ 
+ 	switch (type) {
+ #ifdef CONFIG_MLX5_ESWITCH
+ 	case TC_SETUP_BLOCK: {
+ 		struct flow_block_offload *f = type_data;
+ 
+ 		f->unlocked_driver_cb = true;
+ 		return flow_block_cb_setup_simple(type_data,
+ 						  &mlx5e_block_cb_list,
+ 						  mlx5e_setup_tc_block_cb,
+ 						  priv, priv, true);
+ 	}
++>>>>>>> daa664a5cdd5 (net/mlx5e: Move local var definition into ifdef block)
  #endif
  	case TC_SETUP_QDISC_MQPRIO:
  		return mlx5e_setup_tc_mqprio(priv, type_data);
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en_main.c
