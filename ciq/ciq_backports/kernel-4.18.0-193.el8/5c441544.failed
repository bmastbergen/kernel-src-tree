NFSv4.x: Handle bad/dead sessions correctly in nfs41_sequence_process()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Trond Myklebust <trond.myklebust@hammerspace.com>
commit 5c441544f045e679afd6c3c6d9f7aaf5fa5f37b0
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/5c441544.failed

If the server returns a bad or dead session error, the we don't want
to update the session slot number, but just immediately schedule
recovery and allow it to proceed.

We can/should then remove handling in other places

Fixes: 3453d5708b33 ("NFSv4.1: Avoid false retries when RPC calls are interrupted")
	Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
(cherry picked from commit 5c441544f045e679afd6c3c6d9f7aaf5fa5f37b0)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/nfs/nfs4proc.c
diff --cc fs/nfs/nfs4proc.c
index 26606cf82669,d1a7facfa926..000000000000
--- a/fs/nfs/nfs4proc.c
+++ b/fs/nfs/nfs4proc.c
@@@ -2127,8 -2198,6 +2137,11 @@@ static int nfs4_handle_delegation_recal
  		case -NFS4ERR_BAD_HIGH_SLOT:
  		case -NFS4ERR_CONN_NOT_BOUND_TO_SESSION:
  		case -NFS4ERR_DEADSESSION:
++<<<<<<< HEAD
 +			set_bit(NFS_DELEGATED_STATE, &state->flags);
 +			nfs4_schedule_session_recovery(server->nfs_client->cl_session, err);
++=======
++>>>>>>> 5c441544f045 (NFSv4.x: Handle bad/dead sessions correctly in nfs41_sequence_process())
  			return -EAGAIN;
  		case -NFS4ERR_STALE_CLIENTID:
  		case -NFS4ERR_STALE_STATEID:
* Unmerged path fs/nfs/nfs4proc.c
