drm/i915/gen9: Clear residual context state on context switch

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Akeem G Abodunrin <akeem.g.abodunrin@intel.com>
commit bc8a76a152c5f9ef3b48104154a65a68a8b76946
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/bc8a76a1.failed

Intel ID: PSIRT-TA-201910-001
CVEID: CVE-2019-14615

Intel GPU Hardware prior to Gen11 does not clear EU state
during a context switch. This can result in information
leakage between contexts.

For Gen8 and Gen9, hardware provides a mechanism for
fast cleardown of the EU state, by issuing a PIPE_CONTROL
with bit 27 set. We can use this in a context batch buffer
to explicitly cleardown the state on every context switch.

As this workaround is already in place for gen8, we can borrow
the code verbatim for Gen9.

	Signed-off-by: Mika Kuoppala <mika.kuoppala@linux.intel.com>
	Signed-off-by: Akeem G Abodunrin <akeem.g.abodunrin@intel.com>
	Cc: Kumar Valsan Prathap <prathap.kumar.valsan@intel.com>
	Cc: Chris Wilson <chris.p.wilson@intel.com>
	Cc: Balestrieri Francesco <francesco.balestrieri@intel.com>
	Cc: Bloomfield Jon <jon.bloomfield@intel.com>
	Cc: Dutt Sudeep <sudeep.dutt@intel.com>
(cherry picked from commit bc8a76a152c5f9ef3b48104154a65a68a8b76946)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/i915/gt/intel_lrc.c
* Unmerged path drivers/gpu/drm/i915/gt/intel_lrc.c
* Unmerged path drivers/gpu/drm/i915/gt/intel_lrc.c
