KVM: nVMX: Rename and split top-level consistency checks to match SDM

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Sean Christopherson <sean.j.christopherson@intel.com>
commit 5478ba349f3f71f8d306cddaed33fa0527cc7b16
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/5478ba34.failed

Rename the top-level consistency check functions to (loosely) align with
the SDM.  Historically, KVM has used the terms "prereq" and "postreq" to
differentiate between consistency checks that lead to VM-Fail and those
that lead to VM-Exit.  The terms are vague and potentially misleading,
e.g. "postreq" might be interpreted as occurring after VM-Entry.

Note, while the SDM lumps controls and host state into a single section,
"Checks on VMX Controls and Host-State Area", split them into separate
top-level functions as the two categories of checks result in different
VM instruction errors.  This split will allow for additional cleanup.

Note #2, "vmentry" is intentionally dropped from the new function names
to avoid confusion with nested_check_vm_entry_controls(), and to keep
the length of the functions names somewhat manageable.

	Suggested-by: Paolo Bonzini <pbonzini@redhat.com>
	Signed-off-by: Sean Christopherson <sean.j.christopherson@intel.com>
	Reviewed-by: Krish Sadhukhan <krish.sadhukhan@oracle.com>
	Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
(cherry picked from commit 5478ba349f3f71f8d306cddaed33fa0527cc7b16)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kvm/vmx/nested.c
diff --cc arch/x86/kvm/vmx/nested.c
index 399b57dcff98,97cc17effce2..000000000000
--- a/arch/x86/kvm/vmx/nested.c
+++ b/arch/x86/kvm/vmx/nested.c
@@@ -5539,12 -5495,13 +5549,19 @@@ static int vmx_set_nested_state(struct 
  
  		if (shadow_vmcs12->hdr.revision_id != VMCS12_REVISION ||
  		    !shadow_vmcs12->hdr.shadow_vmcs)
 -			return -EINVAL;
 +			goto error_guest_mode;
  	}
  
++<<<<<<< HEAD
 +	if (nested_vmx_check_vmentry_prereqs(vcpu, vmcs12) ||
 +	    nested_vmx_check_vmentry_postreqs(vcpu, vmcs12, &exit_qual))
 +		goto error_guest_mode;
++=======
+ 	if (nested_vmx_check_controls(vcpu, vmcs12) ||
+ 	    nested_vmx_check_host_state(vcpu, vmcs12) ||
+ 	    nested_vmx_check_guest_state(vcpu, vmcs12, &exit_qual))
+ 		return -EINVAL;
++>>>>>>> 5478ba349f3f (KVM: nVMX: Rename and split top-level consistency checks to match SDM)
  
  	vmx->nested.dirty_vmcs12 = true;
  	ret = nested_vmx_enter_non_root_mode(vcpu, false);
* Unmerged path arch/x86/kvm/vmx/nested.c
