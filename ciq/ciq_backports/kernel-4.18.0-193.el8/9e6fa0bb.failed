SUNRPC: Refactor rpc_restart_call/rpc_restart_call_prepare

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Trond Myklebust <trondmy@gmail.com>
commit 9e6fa0bb84beeff4dddb17d7c23e35135fe977c5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/9e6fa0bb.failed

Clean up.

	Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
	Signed-off-by: Anna Schumaker <Anna.Schumaker@Netapp.com>
(cherry picked from commit 9e6fa0bb84beeff4dddb17d7c23e35135fe977c5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sunrpc/clnt.c
diff --cc net/sunrpc/clnt.c
index 2b272ab9272e,af1dfc2a8fb1..000000000000
--- a/net/sunrpc/clnt.c
+++ b/net/sunrpc/clnt.c
@@@ -1453,22 -1464,13 +1453,19 @@@ void rpc_force_rebind(struct rpc_clnt *
  }
  EXPORT_SYMBOL_GPL(rpc_force_rebind);
  
- /*
-  * Restart an (async) RPC call from the call_prepare state.
-  * Usually called from within the exit handler.
-  */
- int
- rpc_restart_call_prepare(struct rpc_task *task)
+ static int
+ __rpc_restart_call(struct rpc_task *task, void (*action)(struct rpc_task *))
  {
++<<<<<<< HEAD
 +	if (RPC_ASSASSINATED(task))
 +		return 0;
 +	task->tk_action = call_start;
++=======
++>>>>>>> 9e6fa0bb84be (SUNRPC: Refactor rpc_restart_call/rpc_restart_call_prepare)
  	task->tk_status = 0;
- 	if (task->tk_ops->rpc_call_prepare != NULL)
- 		task->tk_action = rpc_prepare_task;
+ 	task->tk_action = action;
  	return 1;
  }
- EXPORT_SYMBOL_GPL(rpc_restart_call_prepare);
  
  /*
   * Restart an (async) RPC call. Usually called from within the
@@@ -1477,11 -1479,7 +1474,15 @@@
  int
  rpc_restart_call(struct rpc_task *task)
  {
++<<<<<<< HEAD
 +	if (RPC_ASSASSINATED(task))
 +		return 0;
 +	task->tk_action = call_start;
 +	task->tk_status = 0;
 +	return 1;
++=======
+ 	return __rpc_restart_call(task, call_start);
++>>>>>>> 9e6fa0bb84be (SUNRPC: Refactor rpc_restart_call/rpc_restart_call_prepare)
  }
  EXPORT_SYMBOL_GPL(rpc_restart_call);
  
* Unmerged path net/sunrpc/clnt.c
