ife: error out when nla attributes are empty

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Cong Wang <xiyou.wangcong@gmail.com>
commit c8ec4632c6ac9cda0e8c3d51aa41eeab66585bd5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/c8ec4632.failed

act_ife at least requires TCA_IFE_PARMS, so we have to bail out
when there is no attribute passed in.

	Reported-by: syzbot+fbb5b288c9cb6a2eeac4@syzkaller.appspotmail.com
Fixes: ef6980b6becb ("introduce IFE action")
	Cc: Jamal Hadi Salim <jhs@mojatatu.com>
	Cc: Jiri Pirko <jiri@resnulli.us>
	Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit c8ec4632c6ac9cda0e8c3d51aa41eeab66585bd5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sched/act_ife.c
diff --cc net/sched/act_ife.c
index 575a19b4b575,3578196d1600..000000000000
--- a/net/sched/act_ife.c
+++ b/net/sched/act_ife.c
@@@ -484,10 -479,15 +484,20 @@@ static int tcf_ife_init(struct net *net
  	u8 *saddr = NULL;
  	bool exists = false;
  	int ret = 0;
 +	u32 index;
  	int err;
  
++<<<<<<< HEAD
 +	err = nla_parse_nested(tb, TCA_IFE_MAX, nla, ife_policy, NULL);
++=======
+ 	if (!nla) {
+ 		NL_SET_ERR_MSG_MOD(extack, "IFE requires attributes to be passed");
+ 		return -EINVAL;
+ 	}
+ 
+ 	err = nla_parse_nested_deprecated(tb, TCA_IFE_MAX, nla, ife_policy,
+ 					  NULL);
++>>>>>>> c8ec4632c6ac (ife: error out when nla attributes are empty)
  	if (err < 0)
  		return err;
  
* Unmerged path net/sched/act_ife.c
