perf db-export: Factor out db_export__comm()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Adrian Hunter <adrian.hunter@intel.com>
commit 80859c947a1eb170927d03e713abf7550a3d8766
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/80859c94.failed

In preparation for exporting the current comm for a thread, factor out
db_export__comm().

	Signed-off-by: Adrian Hunter <adrian.hunter@intel.com>
	Cc: Jiri Olsa <jolsa@redhat.com>
Link: http://lkml.kernel.org/r/20190710085810.1650-12-adrian.hunter@intel.com
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 80859c947a1eb170927d03e713abf7550a3d8766)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/util/db-export.c
diff --cc tools/perf/util/db-export.c
index 1ee4544e8b2c,b1e581c13963..000000000000
--- a/tools/perf/util/db-export.c
+++ b/tools/perf/util/db-export.c
@@@ -156,16 -112,9 +176,22 @@@ int db_export__exec_comm(struct db_expo
  	if (comm->db_id)
  		return 0;
  
++<<<<<<< HEAD
 +	comm->db_id = ++dbe->comm_last_db_id;
 +
 +	if (dbe->export_comm) {
 +		if (main_thread->comm_set)
 +			err = dbe->export_comm(dbe, comm);
 +		else
 +			err = db_export__defer_comm(dbe, comm);
 +		if (err)
 +			return err;
 +	}
++=======
+ 	err = __db_export__comm(dbe, comm, main_thread);
+ 	if (err)
+ 		return err;
++>>>>>>> 80859c947a1e (perf db-export: Factor out db_export__comm())
  
  	/*
  	 * Record the main thread for this comm. Note that the main thread can
* Unmerged path tools/perf/util/db-export.c
diff --git a/tools/perf/util/db-export.h b/tools/perf/util/db-export.h
index 129fe766fa11..b3280f4e7df1 100644
--- a/tools/perf/util/db-export.h
+++ b/tools/perf/util/db-export.h
@@ -87,6 +87,8 @@ int db_export__evsel(struct db_export *dbe, struct perf_evsel *evsel);
 int db_export__machine(struct db_export *dbe, struct machine *machine);
 int db_export__thread(struct db_export *dbe, struct thread *thread,
 		      struct machine *machine, struct thread *main_thread);
+int db_export__comm(struct db_export *dbe, struct comm *comm,
+		    struct thread *thread);
 int db_export__exec_comm(struct db_export *dbe, struct comm *comm,
 			 struct thread *main_thread);
 int db_export__comm_thread(struct db_export *dbe, struct comm *comm,
