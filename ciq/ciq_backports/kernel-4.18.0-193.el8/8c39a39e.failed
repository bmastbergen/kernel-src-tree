NFSv4: Fix a credential refcount leak in nfs41_check_delegation_stateid

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Trond Myklebust <trond.myklebust@hammerspace.com>
commit 8c39a39e28b86a4021d9be314ce01019bafa5fdc
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/8c39a39e.failed

It is unsafe to dereference delegation outside the rcu lock, and in
any case, the refcount is guaranteed held if cred is non-zero.

	Signed-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>
(cherry picked from commit 8c39a39e28b86a4021d9be314ce01019bafa5fdc)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/nfs/nfs4proc.c
diff --cc fs/nfs/nfs4proc.c
index f89cebc55504,a6d73609b163..000000000000
--- a/fs/nfs/nfs4proc.c
+++ b/fs/nfs/nfs4proc.c
@@@ -2730,7 -2778,7 +2730,11 @@@ static void nfs41_check_delegation_stat
  	if (status == -NFS4ERR_EXPIRED || status == -NFS4ERR_BAD_STATEID)
  		nfs_finish_clear_delegation_stateid(state, &stateid);
  
++<<<<<<< HEAD
 +	put_rpccred(cred);
++=======
+ 	put_cred(cred);
++>>>>>>> 8c39a39e28b8 (NFSv4: Fix a credential refcount leak in nfs41_check_delegation_stateid)
  }
  
  /**
* Unmerged path fs/nfs/nfs4proc.c
