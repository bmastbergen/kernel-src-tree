ALSA: fireworks: support AMDTP domain

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Takashi Sakamoto <o-takashi@sakamocchi.jp>
commit db40eeb2469fef4efe26789ea2596372ee43ae2f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/db40eeb2.failed

This commit adds AMDTP domain support for ALSA fireworks driver.

	Signed-off-by: Takashi Sakamoto <o-takashi@sakamocchi.jp>
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit db40eeb2469fef4efe26789ea2596372ee43ae2f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/firewire/fireworks/fireworks_stream.c
diff --cc sound/firewire/fireworks/fireworks_stream.c
index 909257d2b138,f2de304d2f26..000000000000
--- a/sound/firewire/fireworks/fireworks_stream.c
+++ b/sound/firewire/fireworks/fireworks_stream.c
@@@ -157,10 -135,17 +140,21 @@@ int snd_efw_stream_init_duplex(struct s
  	err = init_stream(efw, &efw->rx_stream);
  	if (err < 0) {
  		destroy_stream(efw, &efw->tx_stream);
 -		return err;
 +		goto end;
  	}
  
++<<<<<<< HEAD
 +	/* set IEC61883 compliant mode (actually not fully compliant...) */
++=======
+ 	err = amdtp_domain_init(&efw->domain);
+ 	if (err < 0) {
+ 		destroy_stream(efw, &efw->tx_stream);
+ 		destroy_stream(efw, &efw->rx_stream);
+ 		return err;
+ 	}
+ 
+ 	// set IEC61883 compliant mode (actually not fully compliant...).
++>>>>>>> db40eeb2469f (ALSA: fireworks: support AMDTP domain)
  	err = snd_efw_command_set_tx_mode(efw, SND_EFW_TRANSPORT_MODE_IEC61883);
  	if (err < 0) {
  		destroy_stream(efw, &efw->tx_stream);
diff --git a/sound/firewire/fireworks/fireworks.h b/sound/firewire/fireworks/fireworks.h
index 31efd4b53b4f..4cda297f8438 100644
--- a/sound/firewire/fireworks/fireworks.h
+++ b/sound/firewire/fireworks/fireworks.h
@@ -107,6 +107,8 @@ struct snd_efw {
 	u8 *resp_buf;
 	u8 *pull_ptr;
 	u8 *push_ptr;
+
+	struct amdtp_domain domain;
 };
 
 int snd_efw_transaction_cmd(struct fw_unit *unit,
* Unmerged path sound/firewire/fireworks/fireworks_stream.c
