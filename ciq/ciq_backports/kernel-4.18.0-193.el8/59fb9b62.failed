flow_dissector: Fix to use new variables for port ranges in bpf hook

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Yoshiki Komachi <komachi.yoshiki@gmail.com>
commit 59fb9b62fb6c929a756563152a89f39b07cf8893
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/59fb9b62.failed

This patch applies new flag (FLOW_DISSECTOR_KEY_PORTS_RANGE) and
field (tp_range) to BPF flow dissector to generate appropriate flow
keys when classified by specified port ranges.

Fixes: 8ffb055beae5 ("cls_flower: Fix the behavior using port ranges with hw-offload")
	Signed-off-by: Yoshiki Komachi <komachi.yoshiki@gmail.com>
	Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
	Acked-by: Petar Penkov <ppenkov@google.com>
	Acked-by: John Fastabend <john.fastabend@gmail.com>
Link: https://lore.kernel.org/bpf/20200117070533.402240-2-komachi.yoshiki@gmail.com
(cherry picked from commit 59fb9b62fb6c929a756563152a89f39b07cf8893)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/core/flow_dissector.c
diff --cc net/core/flow_dissector.c
index 5b4735500a2d,a1670dff0629..000000000000
--- a/net/core/flow_dissector.c
+++ b/net/core/flow_dissector.c
@@@ -735,7 -838,7 +736,11 @@@ static void __skb_flow_bpf_to_target(co
  	struct flow_dissector_key_control *key_control;
  	struct flow_dissector_key_basic *key_basic;
  	struct flow_dissector_key_addrs *key_addrs;
++<<<<<<< HEAD
 +	struct flow_dissector_key_ports *key_ports;
++=======
+ 	struct flow_dissector_key_tags *key_tags;
++>>>>>>> 59fb9b62fb6c (flow_dissector: Fix to use new variables for port ranges in bpf hook)
  
  	key_control = skb_flow_dissector_target(flow_dissector,
  						FLOW_DISSECTOR_KEY_CONTROL,
* Unmerged path net/core/flow_dissector.c
