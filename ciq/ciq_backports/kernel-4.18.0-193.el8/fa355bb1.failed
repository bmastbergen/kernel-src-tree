net/mlx5: FWTrace, Reduce stack usage

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
Rebuild_CHGLOG: - [netdrv] mlx5: FWTrace, Reduce stack usage (Alaa Hleihel) [1724336]
Rebuild_FUZZ: 94.29%
commit-author Saeed Mahameed <saeedm@mellanox.com>
commit fa355bb1b0373e7fe087cfc830b1b0b9b6130388
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/fa355bb1.failed

Mark mlx5_tracer_print_trace as noinline as the function only uses 512
bytes on the stack to avoid the following build warning:

drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c:660:13: error: stack frame size of 1032 bytes in function 'mlx5_fw_tracer_handle_traces' [-Werror,-Wframe-larger-than=]

Fixes: 70dd6fdb8987 ("net/mlx5: FW tracer, parse traces and kernel tracing support")
	Reported-by: Arnd Bergmann <arnd@arndb.de>
	Signed-off-by: Saeed Mahameed <saeedm@mellanox.com>
(cherry picked from commit fa355bb1b0373e7fe087cfc830b1b0b9b6130388)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
index 6999f4486e9e,94d7b69a95c7..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
@@@ -522,9 -535,28 +522,34 @@@ static void mlx5_fw_tracer_clean_ready_
  		list_del(&str_frmt->list);
  }
  
++<<<<<<< HEAD
 +static void mlx5_tracer_print_trace(struct tracer_string_format *str_frmt,
 +				    struct mlx5_core_dev *dev,
 +				    u64 trace_timestamp)
++=======
+ static void mlx5_fw_tracer_save_trace(struct mlx5_fw_tracer *tracer,
+ 				      u64 timestamp, bool lost,
+ 				      u8 event_id, char *msg)
+ {
+ 	struct mlx5_fw_trace_data *trace_data;
+ 
+ 	mutex_lock(&tracer->st_arr.lock);
+ 	trace_data = &tracer->st_arr.straces[tracer->st_arr.saved_traces_index];
+ 	trace_data->timestamp = timestamp;
+ 	trace_data->lost = lost;
+ 	trace_data->event_id = event_id;
+ 	strscpy_pad(trace_data->msg, msg, TRACE_STR_MSG);
+ 
+ 	tracer->st_arr.saved_traces_index =
+ 		(tracer->st_arr.saved_traces_index + 1) & (SAVED_TRACES_NUM - 1);
+ 	mutex_unlock(&tracer->st_arr.lock);
+ }
+ 
+ static noinline
+ void mlx5_tracer_print_trace(struct tracer_string_format *str_frmt,
+ 			     struct mlx5_core_dev *dev,
+ 			     u64 trace_timestamp)
++>>>>>>> fa355bb1b037 (net/mlx5: FWTrace, Reduce stack usage)
  {
  	char	tmp[512];
  
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
