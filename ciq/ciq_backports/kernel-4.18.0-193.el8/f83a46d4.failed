selftests/bpf: put test_stub.o into $(OUTPUT)

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Ilya Leoshkevich <iii@linux.ibm.com>
commit f83a46d4711e789642033eb00fed8e017e34fe7d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/f83a46d4.failed

Add a rule to put test_stub.o in $(OUTPUT) and change the references to
it accordingly. This prevents test_stub.o from being created in the
source directory.

	Signed-off-by: Ilya Leoshkevich <iii@linux.ibm.com>
	Acked-by: Andrii Nakryiko <andriin@fb.com>
	Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
(cherry picked from commit f83a46d4711e789642033eb00fed8e017e34fe7d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/testing/selftests/bpf/Makefile
diff --cc tools/testing/selftests/bpf/Makefile
index 9bfa8b025d92,1296253b3422..000000000000
--- a/tools/testing/selftests/bpf/Makefile
+++ b/tools/testing/selftests/bpf/Makefile
@@@ -67,11 -76,23 +67,31 @@@ TEST_GEN_PROGS_EXTENDED = test_libbpf_o
  
  include ../lib.mk
  
++<<<<<<< HEAD
 +BPFOBJ := $(OUTPUT)/libbpf.a
 +
 +$(TEST_GEN_PROGS): $(BPFOBJ)
 +
 +$(TEST_GEN_PROGS_EXTENDED): $(OUTPUT)/libbpf.a
++=======
+ # NOTE: $(OUTPUT) won't get default value if used before lib.mk
+ TEST_CUSTOM_PROGS = $(OUTPUT)/urandom_read
+ all: $(TEST_CUSTOM_PROGS)
+ 
+ $(OUTPUT)/urandom_read: $(OUTPUT)/%: %.c
+ 	$(CC) -o $@ $< -Wl,--build-id
+ 
+ $(OUTPUT)/test_stub.o: test_stub.c
+ 	$(CC) $(TEST_PROGS_CFLAGS) $(CFLAGS) -c -o $@ $<
+ 
+ $(OUTPUT)/test_maps: map_tests/*.c
+ 
+ BPFOBJ := $(OUTPUT)/libbpf.a
+ 
+ $(TEST_GEN_PROGS): $(OUTPUT)/test_stub.o $(BPFOBJ)
+ 
+ $(TEST_GEN_PROGS_EXTENDED): $(OUTPUT)/test_stub.o $(OUTPUT)/libbpf.a
++>>>>>>> f83a46d4711e (selftests/bpf: put test_stub.o into $(OUTPUT))
  
  $(OUTPUT)/test_dev_cgroup: cgroup_helpers.c
  $(OUTPUT)/test_skb_cgroup_id_user: cgroup_helpers.c
* Unmerged path tools/testing/selftests/bpf/Makefile
