net: phy: improve struct phy_device member interrupts handling

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
Rebuild_CHGLOG: - [kernel] phy: improve struct phy_device member interrupts handling (Petr Oros) [1772010]
Rebuild_FUZZ: 95.80%
commit-author Heiner Kallweit <hkallweit1@gmail.com>
commit 695bce8fd8e994999f40ee279e2fa9979cbae87a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/695bce8f.failed

As a heritage from the very early days of phylib member interrupts is
defined as u32 even though it's just a flag whether interrupts are
enabled. So we can change it to a bitfield member. In addition change
the code dealing with this member in a way that it's clear we're
dealing with a bool value.

	Signed-off-by: Heiner Kallweit <hkallweit1@gmail.com>
	Reviewed-by: Andrew Lunn <andrew@lunn.ch>
	Reviewed-by: Florian Fainelli <f.fainelli@gmail.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 695bce8fd8e994999f40ee279e2fa9979cbae87a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/linux/phy.h
diff --cc include/linux/phy.h
index 6ef7cee6f877,3299ec6e69f3..000000000000
--- a/include/linux/phy.h
+++ b/include/linux/phy.h
@@@ -434,15 -428,11 +437,23 @@@ struct phy_device 
  	int pause;
  	int asym_pause;
  
++<<<<<<< HEAD
 +	/* Enabled Interrupts */
 +	u32 interrupts;
 +
 +	/* RHEL specific: fileds are deprecated.
 +	 * PHY now using bitmaps declared later by RH_KABI_EXTEND macro
 +	 */
 +	RH_KABI_DEPRECATE(u32, supported)
 +	RH_KABI_DEPRECATE(u32, advertising)
 +	RH_KABI_DEPRECATE(u32, lp_advertising)
++=======
+ 	/* Union of PHY and Attached devices' supported modes */
+ 	/* See mii.h for more info */
+ 	u32 supported;
+ 	u32 advertising;
+ 	u32 lp_advertising;
++>>>>>>> 695bce8fd8e9 (net: phy: improve struct phy_device member interrupts handling)
  
  	/* Energy efficient ethernet modes which should be prohibited */
  	u32 eee_broken_modes;
diff --git a/drivers/net/phy/phy.c b/drivers/net/phy/phy.c
index 2702b83946bb..20db45354e29 100644
--- a/drivers/net/phy/phy.c
+++ b/drivers/net/phy/phy.c
@@ -115,9 +115,9 @@ static int phy_clear_interrupt(struct phy_device *phydev)
  *
  * Returns 0 on success or < 0 on error.
  */
-static int phy_config_interrupt(struct phy_device *phydev, u32 interrupts)
+static int phy_config_interrupt(struct phy_device *phydev, bool interrupts)
 {
-	phydev->interrupts = interrupts;
+	phydev->interrupts = interrupts ? 1 : 0;
 	if (phydev->drv->config_intr)
 		return phydev->drv->config_intr(phydev);
 
* Unmerged path include/linux/phy.h
