ALSA: hda: Drop export of snd_hdac_bus_add/remove_device()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Takashi Iwai <tiwai@suse.de>
commit 53eff75e5f4dd4b9bc489955fdc60fde48d85e93
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/53eff75e.failed

snd_hdac_bus_add_device() and snd_hdac_remove_device() are called only
internally in hda-core.  Let's drop the exports of them and move the
declarations into local.h.

	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit 53eff75e5f4dd4b9bc489955fdc60fde48d85e93)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/hda/hdac_bus.c
diff --cc sound/hda/hdac_bus.c
index fb6cb306d75b,18ed3185df82..000000000000
--- a/sound/hda/hdac_bus.c
+++ b/sound/hda/hdac_bus.c
@@@ -217,4 -215,33 +217,37 @@@ void snd_hdac_bus_remove_device(struct 
  	bus->num_codecs--;
  	flush_work(&bus->unsol_work);
  }
++<<<<<<< HEAD
 +EXPORT_SYMBOL_GPL(snd_hdac_bus_remove_device);
++=======
+ 
+ #ifdef CONFIG_SND_HDA_ALIGNED_MMIO
+ /* Helpers for aligned read/write of mmio space, for Tegra */
+ unsigned int snd_hdac_aligned_read(void __iomem *addr, unsigned int mask)
+ {
+ 	void __iomem *aligned_addr =
+ 		(void __iomem *)((unsigned long)(addr) & ~0x3);
+ 	unsigned int shift = ((unsigned long)(addr) & 0x3) << 3;
+ 	unsigned int v;
+ 
+ 	v = readl(aligned_addr);
+ 	return (v >> shift) & mask;
+ }
+ EXPORT_SYMBOL_GPL(snd_hdac_aligned_read);
+ 
+ void snd_hdac_aligned_write(unsigned int val, void __iomem *addr,
+ 			    unsigned int mask)
+ {
+ 	void __iomem *aligned_addr =
+ 		(void __iomem *)((unsigned long)(addr) & ~0x3);
+ 	unsigned int shift = ((unsigned long)(addr) & 0x3) << 3;
+ 	unsigned int v;
+ 
+ 	v = readl(aligned_addr);
+ 	v &= ~(mask << shift);
+ 	v |= val << shift;
+ 	writel(v, aligned_addr);
+ }
+ EXPORT_SYMBOL_GPL(snd_hdac_aligned_write);
+ #endif /* CONFIG_SND_HDA_ALIGNED_MMIO */
++>>>>>>> 53eff75e5f4d (ALSA: hda: Drop export of snd_hdac_bus_add/remove_device())
diff --git a/include/sound/hdaudio.h b/include/sound/hdaudio.h
index 8aba7302842d..afca9d04e9d4 100644
--- a/include/sound/hdaudio.h
+++ b/include/sound/hdaudio.h
@@ -389,9 +389,6 @@ int snd_hdac_bus_exec_verb_unlocked(struct hdac_bus *bus, unsigned int addr,
 				    unsigned int cmd, unsigned int *res);
 void snd_hdac_bus_queue_event(struct hdac_bus *bus, u32 res, u32 res_ex);
 
-int snd_hdac_bus_add_device(struct hdac_bus *bus, struct hdac_device *codec);
-void snd_hdac_bus_remove_device(struct hdac_bus *bus,
-				struct hdac_device *codec);
 void snd_hdac_bus_process_unsol_events(struct work_struct *work);
 
 static inline void snd_hdac_codec_link_up(struct hdac_device *codec)
* Unmerged path sound/hda/hdac_bus.c
diff --git a/sound/hda/local.h b/sound/hda/local.h
index 877631e39373..3a4e303169a6 100644
--- a/sound/hda/local.h
+++ b/sound/hda/local.h
@@ -33,4 +33,8 @@ int hda_widget_sysfs_reinit(struct hdac_device *codec, hda_nid_t start_nid,
 			    int num_nodes);
 void hda_widget_sysfs_exit(struct hdac_device *codec);
 
+int snd_hdac_bus_add_device(struct hdac_bus *bus, struct hdac_device *codec);
+void snd_hdac_bus_remove_device(struct hdac_bus *bus,
+				struct hdac_device *codec);
+
 #endif /* __HDAC_LOCAL_H */
