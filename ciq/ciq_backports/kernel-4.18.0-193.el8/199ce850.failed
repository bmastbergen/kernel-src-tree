net_sched: add policy validation for action attributes

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
commit-author Cong Wang <xiyou.wangcong@gmail.com>
commit 199ce850ce112315cfc68d42b694bcaa27b097b7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/199ce850.failed

Similar to commit 8b4c3cdd9dd8
("net: sched: Add policy validation for tc attributes"), we need
to add proper policy validation for TC action attributes too.

	Cc: David Ahern <dsahern@gmail.com>
	Cc: Jamal Hadi Salim <jhs@mojatatu.com>
	Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>
	Acked-by: Jiri Pirko <jiri@mellanox.com>
	Signed-off-by: Jakub Kicinski <jakub.kicinski@netronome.com>
(cherry picked from commit 199ce850ce112315cfc68d42b694bcaa27b097b7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sched/act_api.c
diff --cc net/sched/act_api.c
index d35eb0b8379b,2558f00f6b3e..000000000000
--- a/net/sched/act_api.c
+++ b/net/sched/act_api.c
@@@ -852,7 -855,8 +861,12 @@@ struct tc_action *tcf_action_init_1(str
  	int err;
  
  	if (name == NULL) {
++<<<<<<< HEAD
 +		err = nla_parse_nested(tb, TCA_ACT_MAX, nla, NULL, extack);
++=======
+ 		err = nla_parse_nested_deprecated(tb, TCA_ACT_MAX, nla,
+ 						  tcf_action_policy, extack);
++>>>>>>> 199ce850ce11 (net_sched: add policy validation for action attributes)
  		if (err < 0)
  			goto err_out;
  		err = -EINVAL;
@@@ -1102,7 -1098,8 +1107,12 @@@ static struct tc_action *tcf_action_get
  	int index;
  	int err;
  
++<<<<<<< HEAD
 +	err = nla_parse_nested(tb, TCA_ACT_MAX, nla, NULL, extack);
++=======
+ 	err = nla_parse_nested_deprecated(tb, TCA_ACT_MAX, nla,
+ 					  tcf_action_policy, extack);
++>>>>>>> 199ce850ce11 (net_sched: add policy validation for action attributes)
  	if (err < 0)
  		goto err_out;
  
@@@ -1156,7 -1153,8 +1166,12 @@@ static int tca_action_flush(struct net 
  
  	b = skb_tail_pointer(skb);
  
++<<<<<<< HEAD
 +	err = nla_parse_nested(tb, TCA_ACT_MAX, nla, NULL, extack);
++=======
+ 	err = nla_parse_nested_deprecated(tb, TCA_ACT_MAX, nla,
+ 					  tcf_action_policy, extack);
++>>>>>>> 199ce850ce11 (net_sched: add policy validation for action attributes)
  	if (err < 0)
  		goto err_out;
  
@@@ -1447,7 -1442,7 +1462,11 @@@ static struct nlattr *find_dump_kind(st
  
  	if (tb[1] == NULL)
  		return NULL;
++<<<<<<< HEAD
 +	if (nla_parse_nested(tb2, TCA_ACT_MAX, tb[1], NULL, NULL) < 0)
++=======
+ 	if (nla_parse_nested_deprecated(tb2, TCA_ACT_MAX, tb[1], tcf_action_policy, NULL) < 0)
++>>>>>>> 199ce850ce11 (net_sched: add policy validation for action attributes)
  		return NULL;
  	kind = tb2[TCA_ACT_KIND];
  
* Unmerged path net/sched/act_api.c
