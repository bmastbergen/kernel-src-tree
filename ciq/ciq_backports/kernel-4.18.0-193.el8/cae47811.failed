powercap/intel_rapl: add support for CometLake Mobile

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-193.el8
Rebuild_CHGLOG: - [powercap] intel_rapl: add support for CometLake Mobile (David Arcari) [1746265]
Rebuild_FUZZ: 90.72%
commit-author Zhang Rui <rui.zhang@intel.com>
commit cae478114fbe2e6f4cb9194360cf0789a923be13
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-193.el8/cae47811.failed

Add CometLake Mobile support in intel_rapl driver

	Signed-off-by: Zhang Rui <rui.zhang@intel.com>
	Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
(cherry picked from commit cae478114fbe2e6f4cb9194360cf0789a923be13)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/powercap/intel_rapl.c
diff --cc drivers/powercap/intel_rapl.c
index 7bd53e2e9e10,cc1e82d513a9..000000000000
--- a/drivers/powercap/intel_rapl.c
+++ b/drivers/powercap/intel_rapl.c
@@@ -1011,43 -951,49 +1011,58 @@@ static const struct rapl_defaults rapl_
  };
  
  static const struct x86_cpu_id rapl_ids[] __initconst = {
 -	INTEL_CPU_FAM6(SANDYBRIDGE, rapl_defaults_core),
 -	INTEL_CPU_FAM6(SANDYBRIDGE_X, rapl_defaults_core),
 -
 -	INTEL_CPU_FAM6(IVYBRIDGE, rapl_defaults_core),
 -	INTEL_CPU_FAM6(IVYBRIDGE_X, rapl_defaults_core),
 -
 -	INTEL_CPU_FAM6(HASWELL, rapl_defaults_core),
 -	INTEL_CPU_FAM6(HASWELL_L, rapl_defaults_core),
 -	INTEL_CPU_FAM6(HASWELL_G, rapl_defaults_core),
 -	INTEL_CPU_FAM6(HASWELL_X, rapl_defaults_hsw_server),
 -
 -	INTEL_CPU_FAM6(BROADWELL, rapl_defaults_core),
 -	INTEL_CPU_FAM6(BROADWELL_G, rapl_defaults_core),
 -	INTEL_CPU_FAM6(BROADWELL_D, rapl_defaults_core),
 -	INTEL_CPU_FAM6(BROADWELL_X, rapl_defaults_hsw_server),
 -
 +	INTEL_CPU_FAM6(SANDYBRIDGE,		rapl_defaults_core),
 +	INTEL_CPU_FAM6(SANDYBRIDGE_X,		rapl_defaults_core),
 +
 +	INTEL_CPU_FAM6(IVYBRIDGE,		rapl_defaults_core),
 +	INTEL_CPU_FAM6(IVYBRIDGE_X,		rapl_defaults_core),
 +
 +	INTEL_CPU_FAM6(HASWELL_CORE,		rapl_defaults_core),
 +	INTEL_CPU_FAM6(HASWELL_ULT,		rapl_defaults_core),
 +	INTEL_CPU_FAM6(HASWELL_GT3E,		rapl_defaults_core),
 +	INTEL_CPU_FAM6(HASWELL_X,		rapl_defaults_hsw_server),
 +
 +	INTEL_CPU_FAM6(BROADWELL_CORE,		rapl_defaults_core),
 +	INTEL_CPU_FAM6(BROADWELL_GT3E,		rapl_defaults_core),
 +	INTEL_CPU_FAM6(BROADWELL_XEON_D,	rapl_defaults_core),
 +	INTEL_CPU_FAM6(BROADWELL_X,		rapl_defaults_hsw_server),
 +
++<<<<<<< HEAD:drivers/powercap/intel_rapl.c
 +	INTEL_CPU_FAM6(SKYLAKE_DESKTOP,		rapl_defaults_core),
 +	INTEL_CPU_FAM6(SKYLAKE_MOBILE,		rapl_defaults_core),
 +	INTEL_CPU_FAM6(SKYLAKE_X,		rapl_defaults_hsw_server),
 +	INTEL_CPU_FAM6(KABYLAKE_MOBILE,		rapl_defaults_core),
 +	INTEL_CPU_FAM6(KABYLAKE_DESKTOP,	rapl_defaults_core),
 +	INTEL_CPU_FAM6(CANNONLAKE_MOBILE,	rapl_defaults_core),
 +	INTEL_CPU_FAM6(ICELAKE_MOBILE,		rapl_defaults_core),
++=======
+ 	INTEL_CPU_FAM6(SKYLAKE, rapl_defaults_core),
+ 	INTEL_CPU_FAM6(SKYLAKE_L, rapl_defaults_core),
+ 	INTEL_CPU_FAM6(SKYLAKE_X, rapl_defaults_hsw_server),
+ 	INTEL_CPU_FAM6(KABYLAKE_L, rapl_defaults_core),
+ 	INTEL_CPU_FAM6(KABYLAKE, rapl_defaults_core),
+ 	INTEL_CPU_FAM6(CANNONLAKE_L, rapl_defaults_core),
+ 	INTEL_CPU_FAM6(ICELAKE_L, rapl_defaults_core),
+ 	INTEL_CPU_FAM6(ICELAKE, rapl_defaults_core),
+ 	INTEL_CPU_FAM6(ICELAKE_NNPI, rapl_defaults_core),
+ 	INTEL_CPU_FAM6(ICELAKE_X, rapl_defaults_hsw_server),
+ 	INTEL_CPU_FAM6(ICELAKE_D, rapl_defaults_hsw_server),
+ 	INTEL_CPU_FAM6(COMETLAKE_L, rapl_defaults_core),
 -
 -	INTEL_CPU_FAM6(ATOM_SILVERMONT, rapl_defaults_byt),
 -	INTEL_CPU_FAM6(ATOM_AIRMONT, rapl_defaults_cht),
 -	INTEL_CPU_FAM6(ATOM_SILVERMONT_MID, rapl_defaults_tng),
 -	INTEL_CPU_FAM6(ATOM_AIRMONT_MID, rapl_defaults_ann),
 -	INTEL_CPU_FAM6(ATOM_GOLDMONT, rapl_defaults_core),
 -	INTEL_CPU_FAM6(ATOM_GOLDMONT_PLUS, rapl_defaults_core),
 -	INTEL_CPU_FAM6(ATOM_GOLDMONT_D, rapl_defaults_core),
 -	INTEL_CPU_FAM6(ATOM_TREMONT_D, rapl_defaults_core),
 -
 -	INTEL_CPU_FAM6(XEON_PHI_KNL, rapl_defaults_hsw_server),
 -	INTEL_CPU_FAM6(XEON_PHI_KNM, rapl_defaults_hsw_server),
++>>>>>>> cae478114fbe (powercap/intel_rapl: add support for CometLake Mobile):drivers/powercap/intel_rapl_common.c
 +
 +	INTEL_CPU_FAM6(ATOM_SILVERMONT,		rapl_defaults_byt),
 +	INTEL_CPU_FAM6(ATOM_AIRMONT,		rapl_defaults_cht),
 +	INTEL_CPU_FAM6(ATOM_SILVERMONT_MID,	rapl_defaults_tng),
 +	INTEL_CPU_FAM6(ATOM_AIRMONT_MID,	rapl_defaults_ann),
 +	INTEL_CPU_FAM6(ATOM_GOLDMONT,		rapl_defaults_core),
 +	INTEL_CPU_FAM6(ATOM_GOLDMONT_PLUS,	rapl_defaults_core),
 +	INTEL_CPU_FAM6(ATOM_GOLDMONT_X,		rapl_defaults_core),
 +	INTEL_CPU_FAM6(ATOM_TREMONT_X,		rapl_defaults_core),
 +
 +	INTEL_CPU_FAM6(XEON_PHI_KNL,		rapl_defaults_hsw_server),
 +	INTEL_CPU_FAM6(XEON_PHI_KNM,		rapl_defaults_hsw_server),
  	{}
  };
 -
  MODULE_DEVICE_TABLE(x86cpu, rapl_ids);
  
  /* Read once for all raw primitive data for domains */
* Unmerged path drivers/powercap/intel_rapl.c
