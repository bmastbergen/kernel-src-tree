net: openvswitch: refactor flow free function

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
Rebuild_CHGLOG: - [net] openvswitch: refactor flow free function (Eelco Chaudron) [1895862]
Rebuild_FUZZ: 94.12%
commit-author Tonghao Zhang <xiangxia.m.yue@gmail.com>
commit df68d64ee3f54556aca1d50607e57b3129949a42
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/df68d64e.failed

Decrease table->count and ufid_count unconditionally,
because we only don't use count or ufid_count to count
when flushing the flows. To simplify the codes, we
remove the "count" argument of table_instance_flow_free.

To avoid a bug when deleting flows in the future, add
WARN_ON in flush flows function.

	Cc: Pravin B Shelar <pshelar@ovn.org>
	Signed-off-by: Tonghao Zhang <xiangxia.m.yue@gmail.com>
	Acked-by: Pravin B Shelar <pshelar@ovn.org>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit df68d64ee3f54556aca1d50607e57b3129949a42)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/openvswitch/flow_table.c
diff --cc net/openvswitch/flow_table.c
index fbf69cf1e332,80849bdf45d2..000000000000
--- a/net/openvswitch/flow_table.c
+++ b/net/openvswitch/flow_table.c
@@@ -467,14 -459,12 +467,19 @@@ static void flow_tbl_destroy_rcu_cb(str
  }
  
  static void table_instance_flow_free(struct flow_table *table,
++<<<<<<< HEAD
 +				  struct table_instance *ti,
 +				  struct table_instance *ufid_ti,
 +				  struct sw_flow *flow,
 +				  bool count)
++=======
+ 				     struct table_instance *ti,
+ 				     struct table_instance *ufid_ti,
+ 				     struct sw_flow *flow)
++>>>>>>> df68d64ee3f5 (net: openvswitch: refactor flow free function)
  {
  	hlist_del_rcu(&flow->flow_table.node[ti->node_ver]);
- 	if (count)
- 		table->count--;
+ 	table->count--;
  
  	if (ovs_identifier_is_ufid(&flow->id)) {
  		hlist_del_rcu(&flow->ufid_table.node[ufid_ti->node_ver]);
* Unmerged path net/openvswitch/flow_table.c
