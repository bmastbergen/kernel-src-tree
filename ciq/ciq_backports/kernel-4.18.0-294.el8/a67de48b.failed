clocksource/drivers/arm_arch_timer: Fix vDSO clockmode when vDSO disabled

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Vincenzo Frascino <vincenzo.frascino@arm.com>
commit a67de48b3075cbb6ec030205d7b78981def6596d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/a67de48b.failed

The arm_arch_timer requires VDSO_CLOCKMODE_ARCHTIMER to be defined to
compile correctly. On ARM the vDSO can be disabled and when this is the
case the compilation ends prematurely with an error:

 $ make ARCH=arm multi_v7_defconfig
 $ ./scripts/config -d VDSO
 $ make

drivers/clocksource/arm_arch_timer.c:73:44: error:
‘VDSO_CLOCKMODE_ARCHTIMER’ undeclared here (not in a function)
  static enum vdso_clock_mode vdso_default = VDSO_CLOCKMODE_ARCHTIMER;

Make the usage of VDSO_CLOCKMODE_ARCHTIMER depend on the VDSO enablement
and initialize the vdso clockmode variable with VDSO_CLOCKMODE_NONE
otherwise.

[ tglx: Match changelog and patch content. ]

Fixes: 5e3c6a312a09 ("ARM/arm64: vdso: Use common vdso clock mode storage")
	Reported-by: Marek Szyprowski <m.szyprowski@samsung.com>
	Signed-off-by: Vincenzo Frascino <vincenzo.frascino@arm.com>
	Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Link: https://lkml.kernel.org/r/20200224151552.57274-1-vincenzo.frascino@arm.com

(cherry picked from commit a67de48b3075cbb6ec030205d7b78981def6596d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/clocksource/arm_arch_timer.c
diff --cc drivers/clocksource/arm_arch_timer.c
index 1c1c342815ad,d53f4c7ccaae..000000000000
--- a/drivers/clocksource/arm_arch_timer.c
+++ b/drivers/clocksource/arm_arch_timer.c
@@@ -75,7 -69,11 +75,15 @@@ static enum arch_timer_ppi_nr arch_time
  static bool arch_timer_c3stop;
  static bool arch_timer_mem_use_virtual;
  static bool arch_counter_suspend_stop;
++<<<<<<< HEAD
 +static bool vdso_default = true;
++=======
+ #ifdef CONFIG_GENERIC_GETTIMEOFDAY
+ static enum vdso_clock_mode vdso_default = VDSO_CLOCKMODE_ARCHTIMER;
+ #else
+ static enum vdso_clock_mode vdso_default = VDSO_CLOCKMODE_NONE;
+ #endif /* CONFIG_GENERIC_GETTIMEOFDAY */
++>>>>>>> a67de48b3075 (clocksource/drivers/arm_arch_timer: Fix vDSO clockmode when vDSO disabled)
  
  static cpumask_t evtstrm_available = CPU_MASK_NONE;
  static bool evtstrm_enable = IS_ENABLED(CONFIG_ARM_ARCH_TIMER_EVTSTREAM);
* Unmerged path drivers/clocksource/arm_arch_timer.c
