net: phylink: avoid mac_config calls

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Russell King <rmk+kernel@armlinux.org.uk>
commit 7cceb599d15d6639b1298ae400c26d822148e86f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/7cceb599.failed

Avoid calling mac_config() when using split PCS, and the interface
remains the same.

	Reviewed-by: Florian Fainelli <f.fainelli@gmail.com>
	Signed-off-by: Russell King <rmk+kernel@armlinux.org.uk>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 7cceb599d15d6639b1298ae400c26d822148e86f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/phy/phylink.c
diff --cc drivers/net/phy/phylink.c
index 8ae109f323a0,424a927d7889..000000000000
--- a/drivers/net/phy/phylink.c
+++ b/drivers/net/phy/phylink.c
@@@ -590,6 -620,28 +590,31 @@@ static void phylink_resolve(struct work
  		}
  	}
  
++<<<<<<< HEAD
++=======
+ 	if (mac_config) {
+ 		if (link_state.interface != pl->link_config.interface) {
+ 			/* The interface has changed, force the link down and
+ 			 * then reconfigure.
+ 			 */
+ 			if (cur_link_state) {
+ 				phylink_link_down(pl);
+ 				cur_link_state = false;
+ 			}
+ 			phylink_pcs_config(pl, false, &link_state);
+ 			pl->link_config.interface = link_state.interface;
+ 		} else if (!pl->pcs_ops) {
+ 			/* The interface remains unchanged, only the speed,
+ 			 * duplex or pause settings have changed. Call the
+ 			 * old mac_config() method to configure the MAC/PCS
+ 			 * only if we do not have a PCS installed (an
+ 			 * unconverted user.)
+ 			 */
+ 			phylink_mac_config(pl, &link_state);
+ 		}
+ 	}
+ 
++>>>>>>> 7cceb599d15d (net: phylink: avoid mac_config calls)
  	if (link_state.link != cur_link_state) {
  		pl->old_link_state = link_state.link;
  		if (!link_state.link)
* Unmerged path drivers/net/phy/phylink.c
