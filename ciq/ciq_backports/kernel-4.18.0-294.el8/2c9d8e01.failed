netdevsim: fix unbalaced locking in nsim_create()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Taehee Yoo <ap420073@gmail.com>
commit 2c9d8e01f0c6017317eee7638496173d4a64e6bc
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/2c9d8e01.failed

In the nsim_create(), rtnl_lock() is called before nsim_bpf_init().
If nsim_bpf_init() is failed, rtnl_unlock() should be called,
but it isn't called.
So, unbalanced locking would occur.

Fixes: e05b2d141fef ("netdevsim: move netdev creation/destruction to dev probe")
	Signed-off-by: Taehee Yoo <ap420073@gmail.com>
	Reviewed-by: Jakub Kicinski <kuba@kernel.org>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 2c9d8e01f0c6017317eee7638496173d4a64e6bc)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/netdevsim/netdev.c
diff --cc drivers/net/netdevsim/netdev.c
index 9d0d18026434,23950e7a0f81..000000000000
--- a/drivers/net/netdevsim/netdev.c
+++ b/drivers/net/netdevsim/netdev.c
@@@ -309,7 -302,7 +309,11 @@@ nsim_create(struct nsim_dev *nsim_dev, 
  	rtnl_lock();
  	err = nsim_bpf_init(ns);
  	if (err)
++<<<<<<< HEAD
 +		goto err_utn_destroy;
++=======
+ 		goto err_rtnl_unlock;
++>>>>>>> 2c9d8e01f0c6 (netdevsim: fix unbalaced locking in nsim_create())
  
  	nsim_ipsec_init(ns);
  
@@@ -323,10 -316,8 +327,14 @@@
  err_ipsec_teardown:
  	nsim_ipsec_teardown(ns);
  	nsim_bpf_uninit(ns);
+ err_rtnl_unlock:
  	rtnl_unlock();
++<<<<<<< HEAD
 +err_utn_destroy:
 +	nsim_udp_tunnels_info_destroy(dev);
 +err_free_netdev:
++=======
++>>>>>>> 2c9d8e01f0c6 (netdevsim: fix unbalaced locking in nsim_create())
  	free_netdev(dev);
  	return ERR_PTR(err);
  }
* Unmerged path drivers/net/netdevsim/netdev.c
