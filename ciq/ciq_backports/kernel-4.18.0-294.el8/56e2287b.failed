mlx5: fix xdp data_meta setup in mlx5e_fill_xdp_buff

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Jesper Dangaard Brouer <brouer@redhat.com>
commit 56e2287b4110fbb81456a346b1d4c12bee7cf044
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/56e2287b.failed

The helper function xdp_set_data_meta_invalid() must be called after
setting xdp->data as it depends on it.

The bug was introduced in the cited patch below, and cause the kernel
to crash when using BPF helper bpf_xdp_adjust_head() on mlx5 driver.

Fixes: 39d6443c8daf ("mlx5, xsk: Migrate to new MEM_TYPE_XSK_BUFF_POOL")
	Reported-by: David Ahern <dsahern@kernel.org>
	Signed-off-by: Jesper Dangaard Brouer <brouer@redhat.com>
	Tested-by: David Ahern <dsahern@gmail.com>
	Signed-off-by: Saeed Mahameed <saeedm@mellanox.com>
(cherry picked from commit 56e2287b4110fbb81456a346b1d4c12bee7cf044)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/en_rx.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/en_rx.c
index 029bbab7fd1c,dbb1c6323967..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/en_rx.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/en_rx.c
@@@ -1043,6 -1052,17 +1043,20 @@@ struct sk_buff *mlx5e_build_linear_skb(
  	return skb;
  }
  
++<<<<<<< HEAD
++=======
+ static void mlx5e_fill_xdp_buff(struct mlx5e_rq *rq, void *va, u16 headroom,
+ 				u32 len, struct xdp_buff *xdp)
+ {
+ 	xdp->data_hard_start = va;
+ 	xdp->data = va + headroom;
+ 	xdp_set_data_meta_invalid(xdp);
+ 	xdp->data_end = xdp->data + len;
+ 	xdp->rxq = &rq->xdp_rxq;
+ 	xdp->frame_sz = rq->buff.frame0_sz;
+ }
+ 
++>>>>>>> 56e2287b4110 (mlx5: fix xdp data_meta setup in mlx5e_fill_xdp_buff)
  struct sk_buff *
  mlx5e_skb_from_cqe_linear(struct mlx5e_rq *rq, struct mlx5_cqe64 *cqe,
  			  struct mlx5e_wqe_frag_info *wi, u32 cqe_bcnt)
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en_rx.c
