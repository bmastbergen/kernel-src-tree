powerpc/perf: Initialize power10 PMU registers in cpu setup routine

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Athira Rajeev <atrajeev@linux.vnet.ibm.com>
commit 65156f2b1d9d5bf3fd0eac54b0a7fd515c92773c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/65156f2b.failed

Initialize Monitor Mode Control Register 3 (MMCR3)
SPR which is new in power10. For PowerISA v3.1, BHRB disable
is controlled via Monitor Mode Control Register A (MMCRA) bit,
namely "BHRB Recording Disable (BHRBRD)". This patch also initializes
MMCRA BHRBRD to disable BHRB feature at boot for power10.

	Reported-by: kernel test robot <lkp@intel.com>
	Signed-off-by: Athira Rajeev <atrajeev@linux.vnet.ibm.com>
	Reviewed-by: Jordan Niethe <jniethe5@gmail.com>
	Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
Link: https://lore.kernel.org/r/1595489557-2047-1-git-send-email-atrajeev@linux.vnet.ibm.com
(cherry picked from commit 65156f2b1d9d5bf3fd0eac54b0a7fd515c92773c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/powerpc/kernel/cpu_setup_power.S
diff --cc arch/powerpc/kernel/cpu_setup_power.S
index 634e432fd9ae,704e8b9501ee..000000000000
--- a/arch/powerpc/kernel/cpu_setup_power.S
+++ b/arch/powerpc/kernel/cpu_setup_power.S
@@@ -96,11 -91,18 +96,26 @@@ _GLOBAL(__restore_cpu_power8
  	mtlr	r11
  	blr
  
++<<<<<<< HEAD
 +_GLOBAL(__setup_cpu_power9)
 +	mflr	r11
 +	bl	__init_FSCR
 +	bl	__init_PMU
 +	bl	__init_hvmode_206
++=======
+ _GLOBAL(__setup_cpu_power10)
+ 	mflr	r11
+ 	bl	__init_FSCR_power10
+ 	bl	__init_PMU
+ 	bl	__init_PMU_ISA31
+ 	b	1f
+ 
+ _GLOBAL(__setup_cpu_power9)
+ 	mflr	r11
+ 	bl	__init_FSCR_power9
+ 	bl	__init_PMU
+ 1:	bl	__init_hvmode_206
++>>>>>>> 65156f2b1d9d (powerpc/perf: Initialize power10 PMU registers in cpu setup routine)
  	mtlr	r11
  	beqlr
  	li	r0,0
@@@ -121,11 -123,18 +136,26 @@@
  	mtlr	r11
  	blr
  
++<<<<<<< HEAD
 +_GLOBAL(__restore_cpu_power9)
 +	mflr	r11
 +	bl	__init_FSCR
 +	bl	__init_PMU
 +	mfmsr	r3
++=======
+ _GLOBAL(__restore_cpu_power10)
+ 	mflr	r11
+ 	bl	__init_FSCR_power10
+ 	bl	__init_PMU
+ 	bl	__init_PMU_ISA31
+ 	b	1f
+ 
+ _GLOBAL(__restore_cpu_power9)
+ 	mflr	r11
+ 	bl	__init_FSCR_power9
+ 	bl	__init_PMU
+ 1:	mfmsr	r3
++>>>>>>> 65156f2b1d9d (powerpc/perf: Initialize power10 PMU registers in cpu setup routine)
  	rldicl.	r0,r3,4,63
  	mtlr	r11
  	beqlr
* Unmerged path arch/powerpc/kernel/cpu_setup_power.S
