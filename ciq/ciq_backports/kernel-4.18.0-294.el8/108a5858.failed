nvme: do not call del_gendisk() on a disk that was never added

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Niklas Cassel <niklas.cassel@wdc.com>
commit 108a58585b196e31822c597891f2c83cea7aeb4a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/108a5858.failed

device_add_disk() is negated by del_gendisk().
alloc_disk_node() is negated by put_disk().

In nvme_alloc_ns(), device_add_disk() is one of the last things being
called in the success case, and only void functions are being called
after this. Therefore this call should not be negated in the error path.

The superfluous call to del_gendisk() leads to the following prints:
[    7.839975] kobject: '(null)' (000000001ff73734): is not initialized, yet kobject_put() is being called.
[    7.840865] WARNING: CPU: 2 PID: 361 at lib/kobject.c:736 kobject_put+0x70/0x120

Fixes: 33cfdc2aa696 ("nvme: enforce extended LBA format for fabrics metadata")
	Signed-off-by: Niklas Cassel <niklas.cassel@wdc.com>
	Reviewed-by: Sagi Grimberg <sagi@grimberg.me>
	Reviewed-by: Max Gurtovoy <maxg@mellanox.com>
	Signed-off-by: Christoph Hellwig <hch@lst.de>
	Signed-off-by: Jens Axboe <axboe@kernel.dk>
(cherry picked from commit 108a58585b196e31822c597891f2c83cea7aeb4a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/nvme/host/core.c
diff --cc drivers/nvme/host/core.c
index 9f33e0ddcdfb,c2c5bc4fb702..000000000000
--- a/drivers/nvme/host/core.c
+++ b/drivers/nvme/host/core.c
@@@ -3693,7 -3668,8 +3693,12 @@@ static void nvme_alloc_ns(struct nvme_c
  	memcpy(disk->disk_name, disk_name, DISK_NAME_LEN);
  	ns->disk = disk;
  
++<<<<<<< HEAD
 +	__nvme_revalidate_disk(disk, id);
++=======
+ 	if (__nvme_revalidate_disk(disk, id))
+ 		goto out_put_disk;
++>>>>>>> 108a58585b19 (nvme: do not call del_gendisk() on a disk that was never added)
  
  	if ((ctrl->quirks & NVME_QUIRK_LIGHTNVM) && id->vs[0] == 0x1) {
  		ret = nvme_nvm_register(ns, disk_name, node);
* Unmerged path drivers/nvme/host/core.c
