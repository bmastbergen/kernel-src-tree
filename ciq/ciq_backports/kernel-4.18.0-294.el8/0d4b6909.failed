mt76: mt7915: avoid memcpy in rxv operation

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Ryder Lee <ryder.lee@mediatek.com>
commit 0d4b6909987723f11c23b3a996499cb8f7a0e2b7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/0d4b6909.failed

Avoid memcpy in Rx hot path to slightly improve performance.

	Signed-off-by: Ryder Lee <ryder.lee@mediatek.com>
	Signed-off-by: Felix Fietkau <nbd@nbd.name>
(cherry picked from commit 0d4b6909987723f11c23b3a996499cb8f7a0e2b7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/wireless/mediatek/mt76/mt7915/mac.c
diff --cc drivers/net/wireless/mediatek/mt76/mt7915/mac.c
index 411b78fd6fcc,6825afca1efb..000000000000
--- a/drivers/net/wireless/mediatek/mt76/mt7915/mac.c
+++ b/drivers/net/wireless/mediatek/mt76/mt7915/mac.c
@@@ -425,13 -423,18 +423,27 @@@ int mt7915_mac_fill_rx(struct mt7915_de
  
  	/* RXD Group 3 - P-RXV */
  	if (rxd1 & MT_RXD1_NORMAL_GROUP_3) {
++<<<<<<< HEAD
 +		memcpy(rxv.v, rxd, sizeof(rxv.v));
 +
++=======
+ 		u32 v0, v1, v2;
+ 
+ 		rxv = rxd;
++>>>>>>> 0d4b69099877 (mt76: mt7915: avoid memcpy in rxv operation)
  		rxd += 2;
  		if ((u8 *)rxd - skb->data >= skb->len)
  			return -EINVAL;
  
++<<<<<<< HEAD
 +		if (rxv.v[0] & MT_PRXV_HT_AD_CODE)
++=======
+ 		v0 = le32_to_cpu(rxv[0]);
+ 		v1 = le32_to_cpu(rxv[1]);
+ 		v2 = le32_to_cpu(rxv[2]);
+ 
+ 		if (v0 & MT_PRXV_HT_AD_CODE)
++>>>>>>> 0d4b69099877 (mt76: mt7915: avoid memcpy in rxv operation)
  			status->enc_flags |= RX_ENC_FLAG_LDPC;
  
  		status->chains = mphy->antenna_mask;
@@@ -459,10 -462,10 +471,15 @@@
  			if ((u8 *)rxd - skb->data >= skb->len)
  				return -EINVAL;
  
++<<<<<<< HEAD
 +			idx = i = FIELD_GET(MT_PRXV_TX_RATE, rxv.v[0]);
 +			rxv.phy = FIELD_GET(MT_CRXV_TX_MODE, rxv.v[2]);
++=======
+ 			idx = i = FIELD_GET(MT_PRXV_TX_RATE, v0);
+ 			mode = FIELD_GET(MT_CRXV_TX_MODE, v2);
++>>>>>>> 0d4b69099877 (mt76: mt7915: avoid memcpy in rxv operation)
  
- 			switch (rxv.phy) {
+ 			switch (mode) {
  			case MT_PHY_TYPE_CCK:
  				cck = true;
  				/* fall through */
* Unmerged path drivers/net/wireless/mediatek/mt76/mt7915/mac.c
diff --git a/drivers/net/wireless/mediatek/mt76/mt7915/mac.h b/drivers/net/wireless/mediatek/mt76/mt7915/mac.h
index 4b0871ab2414..c8bb5ea96c60 100644
--- a/drivers/net/wireless/mediatek/mt76/mt7915/mac.h
+++ b/drivers/net/wireless/mediatek/mt76/mt7915/mac.h
@@ -128,13 +128,6 @@ enum rx_pkt_type {
 #define MT_CRXV_HE_BEAM_CHNG		BIT(13)
 #define MT_CRXV_HE_DOPPLER		BIT(16)
 
-struct mt7915_rxv {
-	u32 phy;
-
-	/* P-RXV: bit 0~1, C-RXV: bit 2~19 */
-	__le32 v[20];
-};
-
 enum tx_header_format {
 	MT_HDR_FORMAT_802_3,
 	MT_HDR_FORMAT_CMD,
