vfio/pci: Add device denylist

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Giovanni Cabiddu <giovanni.cabiddu@intel.com>
commit 1f97970e6c8e60349b045599f4525608db895009
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/1f97970e.failed

Add denylist of devices that by default are not probed by vfio-pci.
Devices in this list may be susceptible to untrusted application, even
if the IOMMU is enabled. To be accessed via vfio-pci, the user has to
explicitly disable the denylist.

The denylist can be disabled via the module parameter disable_denylist.

	Signed-off-by: Giovanni Cabiddu <giovanni.cabiddu@intel.com>
	Reviewed-by: Cornelia Huck <cohuck@redhat.com>
	Reviewed-by: Fiona Trahe <fiona.trahe@intel.com>
	Reviewed-by: Andy Shevchenko <andy.shevchenko@gmail.com>
	Signed-off-by: Alex Williamson <alex.williamson@redhat.com>
(cherry picked from commit 1f97970e6c8e60349b045599f4525608db895009)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/vfio/pci/vfio_pci.c
diff --cc drivers/vfio/pci/vfio_pci.c
index 00cc893e8bdd,f368a3993ac1..000000000000
--- a/drivers/vfio/pci/vfio_pci.c
+++ b/drivers/vfio/pci/vfio_pci.c
@@@ -57,6 -54,16 +57,19 @@@ module_param(disable_idle_d3, bool, S_I
  MODULE_PARM_DESC(disable_idle_d3,
  		 "Disable using the PCI D3 low power state for idle, unused devices");
  
++<<<<<<< HEAD
++=======
+ static bool enable_sriov;
+ #ifdef CONFIG_PCI_IOV
+ module_param(enable_sriov, bool, 0644);
+ MODULE_PARM_DESC(enable_sriov, "Enable support for SR-IOV configuration.  Enabling SR-IOV on a PF typically requires support of the userspace PF driver, enabling VFs without such support may result in non-functional VFs or PF.");
+ #endif
+ 
+ static bool disable_denylist;
+ module_param(disable_denylist, bool, 0444);
+ MODULE_PARM_DESC(disable_denylist, "Disable use of device denylist. Disabling the denylist allows binding to devices with known errata that may lead to exploitable stability or security issues when accessed by untrusted users.");
+ 
++>>>>>>> 1f97970e6c8e (vfio/pci: Add device denylist)
  static inline bool vfio_vga_disabled(void)
  {
  #ifdef CONFIG_VFIO_PCI_VGA
* Unmerged path drivers/vfio/pci/vfio_pci.c
