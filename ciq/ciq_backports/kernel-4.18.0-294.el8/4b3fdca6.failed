x86/boot/compressed/64: Check return value of kernel_ident_mapping_init()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
Rebuild_CHGLOG: - [x86] boot/compressed/64: Check return value of kernel_ident_mapping_init() (Vitaly Kuznetsov) [1868080]
Rebuild_FUZZ: 97.18%
commit-author Joerg Roedel <jroedel@suse.de>
commit 4b3fdca64a7e8ad90c87cad1fbc6991471f48dc7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/4b3fdca6.failed

The function can fail to create an identity mapping, check for that
and bail out if it happens.

	Signed-off-by: Joerg Roedel <jroedel@suse.de>
	Signed-off-by: Borislav Petkov <bp@suse.de>
Link: https://lkml.kernel.org/r/20200907131613.12703-22-joro@8bytes.org
(cherry picked from commit 4b3fdca64a7e8ad90c87cad1fbc6991471f48dc7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/boot/compressed/kaslr_64.c
diff --cc arch/x86/boot/compressed/kaslr_64.c
index 9557c5a15b91,aa91bebc0fe9..000000000000
--- a/arch/x86/boot/compressed/kaslr_64.c
+++ b/arch/x86/boot/compressed/kaslr_64.c
@@@ -74,6 -86,25 +74,28 @@@ phys_addr_t physical_mask = (1ULL << __
   */
  static struct x86_mapping_info mapping_info;
  
++<<<<<<< HEAD:arch/x86/boot/compressed/kaslr_64.c
++=======
+ /*
+  * Adds the specified range to the identity mappings.
+  */
+ static void add_identity_map(unsigned long start, unsigned long end)
+ {
+ 	int ret;
+ 
+ 	/* Align boundary to 2M. */
+ 	start = round_down(start, PMD_SIZE);
+ 	end = round_up(end, PMD_SIZE);
+ 	if (start >= end)
+ 		return;
+ 
+ 	/* Build the mapping. */
+ 	ret = kernel_ident_mapping_init(&mapping_info, (pgd_t *)top_level_pgt, start, end);
+ 	if (ret)
+ 		error("Error: kernel_ident_mapping_init() failed\n");
+ }
+ 
++>>>>>>> 4b3fdca64a7e (x86/boot/compressed/64: Check return value of kernel_ident_mapping_init()):arch/x86/boot/compressed/ident_map_64.c
  /* Locates and clears a region for a new top level page table. */
  void initialize_identity_maps(void)
  {
* Unmerged path arch/x86/boot/compressed/kaslr_64.c
