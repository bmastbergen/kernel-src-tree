iwlwifi: pcie: clean up some rx code

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Johannes Berg <johannes.berg@intel.com>
commit e4475583b5c49d5a90dcff9ae201018cd98c7d84
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/e4475583.failed

We don't need the sequence/index/cmd_index unless we're doing
reclaim, they're not even valid in the other cases. Move the
variables and their assignments into the right if statement
and combine the two if statements into a single one as well.

	Signed-off-by: Johannes Berg <johannes.berg@intel.com>
	Signed-off-by: Luca Coelho <luciano.coelho@intel.com>
Link: https://lore.kernel.org/r/iwlwifi.20201209231352.6207fdcc91a9.Ia71e766ead7560262f4bc6ad3da6f1117c498cd6@changeid
	Signed-off-by: Luca Coelho <luciano.coelho@intel.com>
(cherry picked from commit e4475583b5c49d5a90dcff9ae201018cd98c7d84)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/wireless/intel/iwlwifi/pcie/rx.c
diff --cc drivers/net/wireless/intel/iwlwifi/pcie/rx.c
index 221a0a1d448c,e82356abd0c4..000000000000
--- a/drivers/net/wireless/intel/iwlwifi/pcie/rx.c
+++ b/drivers/net/wireless/intel/iwlwifi/pcie/rx.c
@@@ -1364,10 -1306,6 +1363,13 @@@ static void iwl_pcie_rx_handle_rb(struc
  			}
  		}
  
++<<<<<<< HEAD
 +		sequence = le16_to_cpu(pkt->hdr.sequence);
 +		index = SEQ_TO_INDEX(sequence);
 +		cmd_index = iwl_pcie_get_cmd_index(txq, index);
 +
++=======
++>>>>>>> e4475583b5c4 (iwlwifi: pcie: clean up some rx code)
  		if (rxq->id == trans_pcie->def_rx_queue)
  			iwl_op_mode_rx(trans->op_mode, &rxq->napi,
  				       &rxcb);
@@@ -1375,11 -1313,6 +1377,14 @@@
  			iwl_op_mode_rx_rss(trans->op_mode, &rxq->napi,
  					   &rxcb, rxq->id);
  
++<<<<<<< HEAD
 +		if (reclaim) {
 +			kzfree(txq->entries[cmd_index].free_buf);
 +			txq->entries[cmd_index].free_buf = NULL;
 +		}
 +
++=======
++>>>>>>> e4475583b5c4 (iwlwifi: pcie: clean up some rx code)
  		/*
  		 * After here, we should always check rxcb._page_stolen,
  		 * if it is true then one of the handlers took the page.
* Unmerged path drivers/net/wireless/intel/iwlwifi/pcie/rx.c
