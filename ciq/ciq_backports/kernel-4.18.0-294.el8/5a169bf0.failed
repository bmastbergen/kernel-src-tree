x86/kvm: Reserve KVM_FEATURE_MSI_EXT_DEST_ID

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author David Woodhouse <dwmw@amazon.co.uk>
commit 5a169bf04cd2bfdbac967d12eb5b70915b29d7ee
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/5a169bf0.failed

No functional change; just reserve the feature bit for now so that VMMs
can start to implement it.

This will allow the host to indicate that MSI emulation supports 15-bit
destination IDs, allowing up to 32768 CPUs without interrupt remapping.

cf. https://patchwork.kernel.org/patch/11816693/ for qemu

	Signed-off-by: David Woodhouse <dwmw@amazon.co.uk>
	Acked-by: Paolo Bonzini <pbonzini@redhat.com>
Message-Id: <4cd59bed05f4b7410d3d1ffd1e997ab53683874d.camel@infradead.org>
	Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
(cherry picked from commit 5a169bf04cd2bfdbac967d12eb5b70915b29d7ee)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	Documentation/virt/kvm/cpuid.rst
#	arch/x86/include/uapi/asm/kvm_para.h
diff --cc Documentation/virt/kvm/cpuid.rst
index f50345d0213a,cf62162d4be2..000000000000
--- a/Documentation/virt/kvm/cpuid.rst
+++ b/Documentation/virt/kvm/cpuid.rst
@@@ -38,58 -38,68 +38,75 @@@ returns:
  
  where ``flag`` is defined as below:
  
 -================================== =========== ================================
 -flag                               value       meaning
 -================================== =========== ================================
 -KVM_FEATURE_CLOCKSOURCE            0           kvmclock available at msrs
 -                                               0x11 and 0x12
 +================================= =========== ================================
 +flag                              value       meaning
 +================================= =========== ================================
 +KVM_FEATURE_CLOCKSOURCE           0           kvmclock available at msrs
 +                                              0x11 and 0x12
  
 -KVM_FEATURE_NOP_IO_DELAY           1           not necessary to perform delays
 -                                               on PIO operations
 +KVM_FEATURE_NOP_IO_DELAY          1           not necessary to perform delays
 +                                              on PIO operations
  
 -KVM_FEATURE_MMU_OP                 2           deprecated
 +KVM_FEATURE_MMU_OP                2           deprecated
  
 -KVM_FEATURE_CLOCKSOURCE2           3           kvmclock available at msrs
 -                                               0x4b564d00 and 0x4b564d01
 +KVM_FEATURE_CLOCKSOURCE2          3           kvmclock available at msrs
 +                                              0x4b564d00 and 0x4b564d01
  
 -KVM_FEATURE_ASYNC_PF               4           async pf can be enabled by
 -                                               writing to msr 0x4b564d02
 +KVM_FEATURE_ASYNC_PF              4           async pf can be enabled by
 +                                              writing to msr 0x4b564d02
  
 -KVM_FEATURE_STEAL_TIME             5           steal time can be enabled by
 -                                               writing to msr 0x4b564d03
 +KVM_FEATURE_STEAL_TIME            5           steal time can be enabled by
 +                                              writing to msr 0x4b564d03
  
 -KVM_FEATURE_PV_EOI                 6           paravirtualized end of interrupt
 -                                               handler can be enabled by
 -                                               writing to msr 0x4b564d04
 +KVM_FEATURE_PV_EOI                6           paravirtualized end of interrupt
 +                                              handler can be enabled by
 +                                              writing to msr 0x4b564d04
  
 -KVM_FEATURE_PV_UNHALT              7           guest checks this feature bit
 -                                               before enabling paravirtualized
 -                                               spinlock support
 +KVM_FEATURE_PV_UNHAULT            7           guest checks this feature bit
 +                                              before enabling paravirtualized
 +                                              spinlock support
  
 -KVM_FEATURE_PV_TLB_FLUSH           9           guest checks this feature bit
 -                                               before enabling paravirtualized
 -                                               tlb flush
 +KVM_FEATURE_PV_TLB_FLUSH          9           guest checks this feature bit
 +                                              before enabling paravirtualized
 +                                              tlb flush
  
 -KVM_FEATURE_ASYNC_PF_VMEXIT        10          paravirtualized async PF VM EXIT
 -                                               can be enabled by setting bit 2
 -                                               when writing to msr 0x4b564d02
 +KVM_FEATURE_ASYNC_PF_VMEXIT       10          paravirtualized async PF VM EXIT
 +                                              can be enabled by setting bit 2
 +                                              when writing to msr 0x4b564d02
  
 -KVM_FEATURE_PV_SEND_IPI            11          guest checks this feature bit
 -                                               before enabling paravirtualized
 -                                               send IPIs
 +KVM_FEATURE_PV_SEND_IPI           11          guest checks this feature bit
 +                                              before enabling paravirtualized
 +                                              sebd IPIs
  
 -KVM_FEATURE_POLL_CONTROL           12          host-side polling on HLT can
 -                                               be disabled by writing
 -                                               to msr 0x4b564d05.
 +KVM_FEATURE_POLL_CONTROL          12          host-side polling on HLT can
 +                                              be disabled by writing
 +                                              to msr 0x4b564d05.
  
 -KVM_FEATURE_PV_SCHED_YIELD         13          guest checks this feature bit
 -                                               before using paravirtualized
 -                                               sched yield.
 +KVM_FEATURE_PV_SCHED_YIELD        13          guest checks this feature bit
 +                                              before using paravirtualized
 +                                              sched yield.
  
++<<<<<<< HEAD
 +KVM_FEATURE_CLOCSOURCE_STABLE_BIT 24          host will warn if no guest-side
 +                                              per-cpu warps are expeced in
 +                                              kvmclock
 +================================= =========== ================================
++=======
+ KVM_FEATURE_ASYNC_PF_INT           14          guest checks this feature bit
+                                                before using the second async
+                                                pf control msr 0x4b564d06 and
+                                                async pf acknowledgment msr
+                                                0x4b564d07.
+ 
+ KVM_FEATURE_MSI_EXT_DEST_ID        15          guest checks this feature bit
+                                                before using extended destination
+                                                ID bits in MSI address bits 11-5.
+ 
+ KVM_FEATURE_CLOCKSOURCE_STABLE_BIT 24          host will warn if no guest-side
+                                                per-cpu warps are expected in
+                                                kvmclock
+ ================================== =========== ================================
++>>>>>>> 5a169bf04cd2 (x86/kvm: Reserve KVM_FEATURE_MSI_EXT_DEST_ID)
  
  ::
  
diff --cc arch/x86/include/uapi/asm/kvm_para.h
index 2a8e0b6b9805,950afebfba88..000000000000
--- a/arch/x86/include/uapi/asm/kvm_para.h
+++ b/arch/x86/include/uapi/asm/kvm_para.h
@@@ -31,6 -31,8 +31,11 @@@
  #define KVM_FEATURE_PV_SEND_IPI	11
  #define KVM_FEATURE_POLL_CONTROL	12
  #define KVM_FEATURE_PV_SCHED_YIELD	13
++<<<<<<< HEAD
++=======
+ #define KVM_FEATURE_ASYNC_PF_INT	14
+ #define KVM_FEATURE_MSI_EXT_DEST_ID	15
++>>>>>>> 5a169bf04cd2 (x86/kvm: Reserve KVM_FEATURE_MSI_EXT_DEST_ID)
  
  #define KVM_HINTS_REALTIME      0
  
* Unmerged path Documentation/virt/kvm/cpuid.rst
* Unmerged path arch/x86/include/uapi/asm/kvm_para.h
