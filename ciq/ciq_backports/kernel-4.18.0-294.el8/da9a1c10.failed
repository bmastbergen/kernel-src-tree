powerpc: Move ptrace into a subdirectory.

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
Rebuild_CHGLOG: - [powerpc] powerpc: Move ptrace into a subdirectory (Desnes Augusto Nunes do Rosario) [1854528]
Rebuild_FUZZ: 98.77%
commit-author Christophe Leroy <christophe.leroy@c-s.fr>
commit da9a1c10e2c7311e923210b6ccd9fbd1ac9132df
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/da9a1c10.failed

In order to allow splitting of ptrace depending on the different
CONFIG_ options, create a subdirectory dedicated to ptrace and move
ptrace.c and ptrace32.c into it.

	Signed-off-by: Christophe Leroy <christophe.leroy@c-s.fr>
	Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
Link: https://lore.kernel.org/r/9ebcbe37834e9d447dd97f4381084795a673260c.1582848567.git.christophe.leroy@c-s.fr
(cherry picked from commit da9a1c10e2c7311e923210b6ccd9fbd1ac9132df)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/powerpc/kernel/Makefile
diff --cc arch/powerpc/kernel/Makefile
index 07b9f49bc695,570660efbb3d..000000000000
--- a/arch/powerpc/kernel/Makefile
+++ b/arch/powerpc/kernel/Makefile
@@@ -3,10 -3,6 +3,13 @@@
  # Makefile for the linux kernel.
  #
  
++<<<<<<< HEAD
 +CFLAGS_ptrace.o		+= -DUTS_MACHINE='"$(UTS_MACHINE)"'
 +
 +subdir-ccflags-$(CONFIG_PPC_WERROR) := -Werror
 +
++=======
++>>>>>>> da9a1c10e2c7 (powerpc: Move ptrace into a subdirectory.)
  ifdef CONFIG_PPC64
  CFLAGS_prom_init.o	+= $(NO_MINIMAL_TOC)
  endif
@@@ -24,23 -20,36 +27,31 @@@ CFLAGS_prom_init.o += $(call cc-option
  
  ifdef CONFIG_FUNCTION_TRACER
  # Do not trace early boot code
 -CFLAGS_REMOVE_cputable.o = $(CC_FLAGS_FTRACE)
 -CFLAGS_REMOVE_prom_init.o = $(CC_FLAGS_FTRACE)
 -CFLAGS_REMOVE_btext.o = $(CC_FLAGS_FTRACE)
 -CFLAGS_REMOVE_prom.o = $(CC_FLAGS_FTRACE)
 -endif
 -
 -KASAN_SANITIZE_early_32.o := n
 -KASAN_SANITIZE_cputable.o := n
 -KASAN_SANITIZE_prom_init.o := n
 -KASAN_SANITIZE_btext.o := n
 -
 -ifdef CONFIG_KASAN
 -CFLAGS_early_32.o += -DDISABLE_BRANCH_PROFILING
 -CFLAGS_cputable.o += -DDISABLE_BRANCH_PROFILING
 -CFLAGS_btext.o += -DDISABLE_BRANCH_PROFILING
 +CFLAGS_REMOVE_cputable.o = -mno-sched-epilog $(CC_FLAGS_FTRACE)
 +CFLAGS_REMOVE_prom_init.o = -mno-sched-epilog $(CC_FLAGS_FTRACE)
 +CFLAGS_REMOVE_btext.o = -mno-sched-epilog $(CC_FLAGS_FTRACE)
 +CFLAGS_REMOVE_prom.o = -mno-sched-epilog $(CC_FLAGS_FTRACE)
  endif
  
- obj-y				:= cputable.o ptrace.o syscalls.o \
+ obj-y				:= cputable.o syscalls.o \
  				   irq.o align.o signal_32.o pmc.o vdso.o \
  				   process.o systbl.o idle.o \
  				   signal.o sysfs.o cacheinfo.o time.o \
  				   prom.o traps.o setup-common.o \
  				   udbg.o misc.o io.o misc_$(BITS).o \
++<<<<<<< HEAD
 +				   of_platform.o prom_parse.o \
 +				   dma-common.o
 +obj-$(CONFIG_PPC64)		+= setup_64.o sys_ppc32.o \
 +				   signal_64.o ptrace32.o \
 +				   paca.o nvram_64.o firmware.o note.o
++=======
+ 				   of_platform.o prom_parse.o
+ obj-y				+= ptrace/
+ obj-$(CONFIG_PPC64)		+= setup_64.o sys_ppc32.o signal_64.o \
+ 				   paca.o nvram_64.o firmware.o note.o \
+ 				   syscall_64.o
++>>>>>>> da9a1c10e2c7 (powerpc: Move ptrace into a subdirectory.)
  obj-$(CONFIG_VDSO32)		+= vdso32/
  obj-$(CONFIG_PPC_WATCHDOG)	+= watchdog.o
  obj-$(CONFIG_HAVE_HW_BREAKPOINT)	+= hw_breakpoint.o
* Unmerged path arch/powerpc/kernel/Makefile
diff --git a/arch/powerpc/kernel/ptrace/Makefile b/arch/powerpc/kernel/ptrace/Makefile
new file mode 100644
index 000000000000..02fb28eb3b55
--- /dev/null
+++ b/arch/powerpc/kernel/ptrace/Makefile
@@ -0,0 +1,9 @@
+# SPDX-License-Identifier: GPL-2.0
+#
+# Makefile for the linux kernel.
+#
+
+CFLAGS_ptrace.o		+= -DUTS_MACHINE='"$(UTS_MACHINE)"'
+
+obj-y				+= ptrace.o
+obj-$(CONFIG_PPC64)		+= ptrace32.o
diff --git a/arch/powerpc/kernel/ptrace.c b/arch/powerpc/kernel/ptrace/ptrace.c
similarity index 100%
rename from arch/powerpc/kernel/ptrace.c
rename to arch/powerpc/kernel/ptrace/ptrace.c
diff --git a/arch/powerpc/kernel/ptrace32.c b/arch/powerpc/kernel/ptrace/ptrace32.c
similarity index 100%
rename from arch/powerpc/kernel/ptrace32.c
rename to arch/powerpc/kernel/ptrace/ptrace32.c
