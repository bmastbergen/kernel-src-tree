selftests: fix poll error in udpgro.sh

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Paolo Abeni <pabeni@redhat.com>
commit 38bf8cd821be292e7d8e6f6283d67c5d9708f887
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/38bf8cd8.failed

The test program udpgso_bench_rx always invokes the poll()
syscall with a timeout of 10ms. If a larger timeout is specified
via the command line, udpgso_bench_rx is supposed to do multiple
poll() calls till the timeout is expired or an event is received.

Currently the poll() loop errors out after the first invocation with
no events, and may causes self-tests failure alike:

failed
 GRO with custom segment size            ./udpgso_bench_rx: poll: 0x0 expected 0x1

This change addresses the issue allowing the poll() loop to consume
all the configured timeout.

Fixes: ada641ff6ed3 ("selftests: fixes for UDP GRO")
	Signed-off-by: Paolo Abeni <pabeni@redhat.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 38bf8cd821be292e7d8e6f6283d67c5d9708f887)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/testing/selftests/net/udpgso_bench_rx.c
diff --cc tools/testing/selftests/net/udpgso_bench_rx.c
index 8f48d7fb32cf,76a24052f4b4..000000000000
--- a/tools/testing/selftests/net/udpgso_bench_rx.c
+++ b/tools/testing/selftests/net/udpgso_bench_rx.c
@@@ -73,8 -104,19 +73,24 @@@ static void do_poll(int fd
  			break;
  		if (ret == -1)
  			error(1, errno, "poll");
++<<<<<<< HEAD
 +		if (ret == 0)
 +			continue;
++=======
+ 		if (ret == 0) {
+ 			if (!timeout_ms)
+ 				continue;
+ 
+ 			timeout_ms -= 10;
+ 			if (timeout_ms <= 0) {
+ 				interrupted = true;
+ 				break;
+ 			}
+ 
+ 			/* no events and more time to wait, do poll again */
+ 			continue;
+ 		}
++>>>>>>> 38bf8cd821be (selftests: fix poll error in udpgro.sh)
  		if (pfd.revents != POLLIN)
  			error(1, errno, "poll: 0x%x expected 0x%x\n",
  					pfd.revents, POLLIN);
* Unmerged path tools/testing/selftests/net/udpgso_bench_rx.c
