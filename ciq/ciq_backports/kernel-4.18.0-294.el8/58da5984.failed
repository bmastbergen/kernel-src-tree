powerpc/watchpoint: Add hw_len wherever missing

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Ravi Bangoria <ravi.bangoria@linux.ibm.com>
commit 58da5984d2ea6d95f3f9d9e8dd9f7e1b0dddfb3c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/58da5984.failed

There are couple of places where we set len but not hw_len. For
ptrace/perf watchpoints, when CONFIG_HAVE_HW_BREAKPOINT=Y, hw_len
will be calculated and set internally while parsing watchpoint.
But when CONFIG_HAVE_HW_BREAKPOINT=N, we need to manually set
'hw_len'. Similarly for xmon as well, hw_len needs to be set
directly.

Fixes: b57aeab811db ("powerpc/watchpoint: Fix length calculation for unaligned target")
	Signed-off-by: Ravi Bangoria <ravi.bangoria@linux.ibm.com>
	Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
Link: https://lore.kernel.org/r/20200902042945.129369-7-ravi.bangoria@linux.ibm.com
(cherry picked from commit 58da5984d2ea6d95f3f9d9e8dd9f7e1b0dddfb3c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/powerpc/kernel/ptrace/ptrace-noadv.c
#	arch/powerpc/xmon/xmon.c
diff --cc arch/powerpc/xmon/xmon.c
index 3ba3f8df7d8d,55c43a6c9111..000000000000
--- a/arch/powerpc/xmon/xmon.c
+++ b/arch/powerpc/xmon/xmon.c
@@@ -867,13 -961,17 +867,24 @@@ static void insert_bpts(void
  
  static void insert_cpu_bpts(void)
  {
 -	int i;
  	struct arch_hw_breakpoint brk;
  
++<<<<<<< HEAD
 +	if (dabr.enabled) {
 +		brk.address = dabr.address;
 +		brk.type = (dabr.enabled & HW_BRK_TYPE_DABR) | HW_BRK_TYPE_PRIV_ALL;
 +		brk.len = 8;
 +		__set_breakpoint(&brk);
++=======
+ 	for (i = 0; i < nr_wp_slots(); i++) {
+ 		if (dabr[i].enabled) {
+ 			brk.address = dabr[i].address;
+ 			brk.type = (dabr[i].enabled & HW_BRK_TYPE_DABR) | HW_BRK_TYPE_PRIV_ALL;
+ 			brk.len = 8;
+ 			brk.hw_len = 8;
+ 			__set_breakpoint(i, &brk);
+ 		}
++>>>>>>> 58da5984d2ea (powerpc/watchpoint: Add hw_len wherever missing)
  	}
  
  	if (iabr)
* Unmerged path arch/powerpc/kernel/ptrace/ptrace-noadv.c
* Unmerged path arch/powerpc/kernel/ptrace/ptrace-noadv.c
* Unmerged path arch/powerpc/xmon/xmon.c
