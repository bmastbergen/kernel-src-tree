scsi: sr: Fix sr_probe() missing deallocate of device minor

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Simon Arlott <simon@octiron.net>
commit 6555781b3fdec5e94e6914511496144241df7dee
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/6555781b.failed

If the cdrom fails to be registered then the device minor should be
deallocated.

Link: https://lore.kernel.org/r/072dac4b-8402-4de8-36bd-47e7588969cd@0882a8b5-c6c3-11e9-b005-00805fc181fe
	Signed-off-by: Simon Arlott <simon@octiron.net>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit 6555781b3fdec5e94e6914511496144241df7dee)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/sr.c
diff --cc drivers/scsi/sr.c
index cce823d47c2f,b9cff27e2c81..000000000000
--- a/drivers/scsi/sr.c
+++ b/drivers/scsi/sr.c
@@@ -742,9 -790,10 +742,14 @@@ static int sr_probe(struct device *dev
  	set_capacity(disk, cd->capacity);
  	disk->private_data = &cd->driver;
  	disk->queue = sdev->request_queue;
 -	cd->cdi.disk = disk;
  
++<<<<<<< HEAD
 +	if (register_cdrom(disk, &cd->cdi))
 +		goto fail_put;
++=======
+ 	if (register_cdrom(&cd->cdi))
+ 		goto fail_minor;
++>>>>>>> 6555781b3fde (scsi: sr: Fix sr_probe() missing deallocate of device minor)
  
  	/*
  	 * Initialize block layer runtime PM stuffs before the
* Unmerged path drivers/scsi/sr.c
