kunit: add log test

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Alan Maguire <alan.maguire@oracle.com>
commit eda8e324f70815e90360bef1032d49ef7c61e877
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/eda8e324.failed

the logging test ensures multiple strings logged appear in the
log string associated with the test when CONFIG_KUNIT_DEBUGFS is
enabled.

	Signed-off-by: Alan Maguire <alan.maguire@oracle.com>
	Reviewed-by: Brendan Higgins <brendanhiggins@google.com>
	Reviewed-by: Frank Rowand <frank.rowand@sony.com>
	Signed-off-by: Shuah Khan <skhan@linuxfoundation.org>
(cherry picked from commit eda8e324f70815e90360bef1032d49ef7c61e877)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	lib/kunit/test-test.c
diff --cc lib/kunit/test-test.c
index 5a6cc0484eda,4f3d36a72f8f..000000000000
--- a/lib/kunit/test-test.c
+++ b/lib/kunit/test-test.c
@@@ -330,4 -329,44 +330,48 @@@ static struct kunit_suite kunit_resourc
  	.exit = kunit_resource_test_exit,
  	.test_cases = kunit_resource_test_cases,
  };
++<<<<<<< HEAD:lib/kunit/test-test.c
 +kunit_test_suite(kunit_resource_test_suite);
++=======
+ 
+ static void kunit_log_test(struct kunit *test);
+ 
+ static struct kunit_case kunit_log_test_cases[] = {
+ 	KUNIT_CASE(kunit_log_test),
+ 	{}
+ };
+ 
+ static struct kunit_suite kunit_log_test_suite = {
+ 	.name = "kunit-log-test",
+ 	.test_cases = kunit_log_test_cases,
+ };
+ 
+ static void kunit_log_test(struct kunit *test)
+ {
+ 	struct kunit_suite *suite = &kunit_log_test_suite;
+ 
+ 	kunit_log(KERN_INFO, test, "put this in log.");
+ 	kunit_log(KERN_INFO, test, "this too.");
+ 	kunit_log(KERN_INFO, suite, "add to suite log.");
+ 	kunit_log(KERN_INFO, suite, "along with this.");
+ 
+ #ifdef CONFIG_KUNIT_DEBUGFS
+ 	KUNIT_EXPECT_NOT_ERR_OR_NULL(test,
+ 				     strstr(test->log, "put this in log."));
+ 	KUNIT_EXPECT_NOT_ERR_OR_NULL(test,
+ 				     strstr(test->log, "this too."));
+ 	KUNIT_EXPECT_NOT_ERR_OR_NULL(test,
+ 				     strstr(suite->log, "add to suite log."));
+ 	KUNIT_EXPECT_NOT_ERR_OR_NULL(test,
+ 				     strstr(suite->log, "along with this."));
+ #else
+ 	KUNIT_EXPECT_PTR_EQ(test, test->log, (char *)NULL);
+ 	KUNIT_EXPECT_PTR_EQ(test, suite->log, (char *)NULL);
+ #endif
+ }
+ 
+ kunit_test_suites(&kunit_try_catch_test_suite, &kunit_resource_test_suite,
+ 		  &kunit_log_test_suite);
+ 
+ MODULE_LICENSE("GPL v2");
++>>>>>>> eda8e324f708 (kunit: add log test):lib/kunit/kunit-test.c
* Unmerged path lib/kunit/test-test.c
