ASoC: SOF: ext_manifest: parse cavs extra config data elem

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
Rebuild_CHGLOG: - [sound] ALSA: ASoC: SOF: ext_manifest: parse cavs extra config data elem (Jaroslav Kysela) [1783462]
Rebuild_FUZZ: 95.08%
commit-author Fred Oh <fred.oh@linux.intel.com>
commit e3a85dbe30cf4c6904640da10e7dbd18c4ee7be7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/e3a85dbe.failed

OUTBOX_SIZE, INBOX_SIZE are defined but not being used yet. Handle
these elements to avoid warning about unknown token type.

	Signed-off-by: Fred Oh <fred.oh@linux.intel.com>
	Reviewed-by: Ranjani Sridharan <ranjani.sridharan@linux.intel.com>
	Reviewed-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
	Signed-off-by: Kai Vehmanen <kai.vehmanen@linux.intel.com>
Link: https://lore.kernel.org/r/20201127164022.2498406-4-kai.vehmanen@linux.intel.com
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit e3a85dbe30cf4c6904640da10e7dbd18c4ee7be7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/soc/sof/intel/ext_manifest.h
#	sound/soc/sof/intel/hda-loader.c
diff --cc sound/soc/sof/intel/hda-loader.c
index c691ae3be39e,52101b1a3dac..000000000000
--- a/sound/soc/sof/intel/hda-loader.c
+++ b/sound/soc/sof/intel/hda-loader.c
@@@ -471,3 -471,41 +471,44 @@@ int hda_dsp_post_fw_run(struct snd_sof_
  	/* re-enable clock gating and power gating */
  	return hda_dsp_ctrl_clock_power_gating(sdev, true);
  }
++<<<<<<< HEAD
++=======
+ 
+ int hda_dsp_ext_man_get_cavs_config_data(struct snd_sof_dev *sdev,
+ 					 const struct sof_ext_man_elem_header *hdr)
+ {
+ 	const struct sof_ext_man_cavs_config_data *config_data =
+ 		container_of(hdr, struct sof_ext_man_cavs_config_data, hdr);
+ 	struct sof_intel_hda_dev *hda = sdev->pdata->hw_pdata;
+ 	int i, elem_num;
+ 
+ 	/* calculate total number of config data elements */
+ 	elem_num = (hdr->size - sizeof(struct sof_ext_man_elem_header))
+ 		   / sizeof(struct sof_config_elem);
+ 	if (elem_num <= 0) {
+ 		dev_err(sdev->dev, "cavs config data is inconsistent: %d\n", elem_num);
+ 		return -EINVAL;
+ 	}
+ 
+ 	for (i = 0; i < elem_num; i++)
+ 		switch (config_data->elems[i].token) {
+ 		case SOF_EXT_MAN_CAVS_CONFIG_EMPTY:
+ 			/* skip empty token */
+ 			break;
+ 		case SOF_EXT_MAN_CAVS_CONFIG_CAVS_LPRO:
+ 			hda->clk_config_lpro = config_data->elems[i].value;
+ 			dev_dbg(sdev->dev, "FW clock config: %s\n",
+ 				hda->clk_config_lpro ? "LPRO" : "HPRO");
+ 			break;
+ 		case SOF_EXT_MAN_CAVS_CONFIG_OUTBOX_SIZE:
+ 		case SOF_EXT_MAN_CAVS_CONFIG_INBOX_SIZE:
+ 			/* These elements are defined but not being used yet. No warn is required */
+ 			break;
+ 		default:
+ 			dev_info(sdev->dev, "unsupported token type: %d\n",
+ 				 config_data->elems[i].token);
+ 		}
+ 
+ 	return 0;
+ }
++>>>>>>> e3a85dbe30cf (ASoC: SOF: ext_manifest: parse cavs extra config data elem)
* Unmerged path sound/soc/sof/intel/ext_manifest.h
* Unmerged path sound/soc/sof/intel/ext_manifest.h
* Unmerged path sound/soc/sof/intel/hda-loader.c
