IB/uverbs: Enable CQ ioctl commands by default

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Yishai Hadas <yishaih@mellanox.com>
commit 263427526f0c00490c20e4940d1fd4277fb5f7b3
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/26342752.failed

Enable CQ ioctl commands by default, this functionality is fully mature
to be used over ioctl, no reason to maintain any more the EXP KCONFIG
entry to enable it.

Link: https://lore.kernel.org/r/20200630093916.332097-2-leon@kernel.org
	Signed-off-by: Yishai Hadas <yishaih@mellanox.com>
	Signed-off-by: Leon Romanovsky <leonro@mellanox.com>
	Signed-off-by: Jason Gunthorpe <jgg@nvidia.com>
(cherry picked from commit 263427526f0c00490c20e4940d1fd4277fb5f7b3)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/Kconfig
diff --cc drivers/infiniband/Kconfig
index 5968b04dd55f,91b023341b77..000000000000
--- a/drivers/infiniband/Kconfig
+++ b/drivers/infiniband/Kconfig
@@@ -38,14 -37,6 +38,17 @@@ config INFINIBAND_USER_ACCES
  	  libibverbs, libibcm and a hardware driver library from
  	  rdma-core <https://github.com/linux-rdma/rdma-core>.
  
++<<<<<<< HEAD
 +config INFINIBAND_EXP_LEGACY_VERBS_NEW_UAPI
 +	bool "Allow experimental legacy verbs in new ioctl uAPI  (EXPERIMENTAL)"
 +	depends on INFINIBAND_USER_ACCESS
 +	---help---
 +	  IOCTL based uAPI support for Infiniband is enabled by default for
 +	  new verbs only. This allows userspace to invoke the IOCTL based uAPI
 +	  for current legacy verbs too.
 +
++=======
++>>>>>>> 263427526f0c (IB/uverbs: Enable CQ ioctl commands by default)
  config INFINIBAND_USER_MEM
  	bool
  	depends on INFINIBAND_USER_ACCESS != n
* Unmerged path drivers/infiniband/Kconfig
diff --git a/drivers/infiniband/core/uverbs_std_types_cq.c b/drivers/infiniband/core/uverbs_std_types_cq.c
index da4110a0eea2..73eb472b2b67 100644
--- a/drivers/infiniband/core/uverbs_std_types_cq.c
+++ b/drivers/infiniband/core/uverbs_std_types_cq.c
@@ -202,11 +202,8 @@ DECLARE_UVERBS_NAMED_METHOD(
 DECLARE_UVERBS_NAMED_OBJECT(
 	UVERBS_OBJECT_CQ,
 	UVERBS_TYPE_ALLOC_IDR_SZ(sizeof(struct ib_ucq_object), uverbs_free_cq),
-
-#if IS_ENABLED(CONFIG_INFINIBAND_EXP_LEGACY_VERBS_NEW_UAPI)
 	&UVERBS_METHOD(UVERBS_METHOD_CQ_CREATE),
 	&UVERBS_METHOD(UVERBS_METHOD_CQ_DESTROY)
-#endif
 );
 
 const struct uapi_definition uverbs_def_obj_cq[] = {
