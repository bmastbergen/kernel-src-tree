net: stmmac: xgmac: Fix RSS writing wrong keys

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Jose Abreu <Jose.Abreu@synopsys.com>
commit 56627336b655494356a23e65200c21718a1c3b2b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/56627336.failed

Commit b6b6cc9acd7b, changed the call to dwxgmac2_rss_write_reg()
passing it the variable cfg->key[i].

As key is an u8 but we write 32 bits at a time we need to cast it into
an u32 so that the correct key values are written. Notice that the for
loop already takes this into account so we don't try to write past the
keys size.

Fixes: b6b6cc9acd7b ("net: stmmac: selftest: avoid large stack usage")
	Signed-off-by: Jose Abreu <Jose.Abreu@synopsys.com>
	Reviewed-by: Arnd Bergmann <arnd@arndb.de>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 56627336b655494356a23e65200c21718a1c3b2b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/stmicro/stmmac/dwxgmac2_core.c
diff --cc drivers/net/ethernet/stmicro/stmmac/dwxgmac2_core.c
index 416a4a204a6f,5031398e612c..000000000000
--- a/drivers/net/ethernet/stmicro/stmmac/dwxgmac2_core.c
+++ b/drivers/net/ethernet/stmicro/stmmac/dwxgmac2_core.c
@@@ -523,19 -523,19 +523,28 @@@ static int dwxgmac2_rss_configure(struc
  				  struct stmmac_rss *cfg, u32 num_rxq)
  {
  	void __iomem *ioaddr = hw->pcsr;
++<<<<<<< HEAD
 +	u32 *key = (u32 *)cfg->key;
++=======
+ 	u32 value, *key;
++>>>>>>> 56627336b655 (net: stmmac: xgmac: Fix RSS writing wrong keys)
  	int i, ret;
- 	u32 value;
  
  	value = readl(ioaddr + XGMAC_RSS_CTRL);
 -	if (!cfg || !cfg->enable) {
 +	if (!cfg->enable) {
  		value &= ~XGMAC_RSSE;
  		writel(value, ioaddr + XGMAC_RSS_CTRL);
  		return 0;
  	}
  
++<<<<<<< HEAD
 +	for (i = 0; i < (sizeof(cfg->key) / sizeof(u32)); i++) {
 +		ret = dwxgmac2_rss_write_reg(ioaddr, true, i, *key++);
++=======
+ 	key = (u32 *)cfg->key;
+ 	for (i = 0; i < (ARRAY_SIZE(cfg->key) / sizeof(u32)); i++) {
+ 		ret = dwxgmac2_rss_write_reg(ioaddr, true, i, key[i]);
++>>>>>>> 56627336b655 (net: stmmac: xgmac: Fix RSS writing wrong keys)
  		if (ret)
  			return ret;
  	}
* Unmerged path drivers/net/ethernet/stmicro/stmmac/dwxgmac2_core.c
