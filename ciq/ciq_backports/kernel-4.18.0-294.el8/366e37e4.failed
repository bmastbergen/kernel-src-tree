arm64: avoid clang warning about self-assignment

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Arnd Bergmann <arnd@arndb.de>
commit 366e37e4da23f9df498cc9577cadcb354f7bd431
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/366e37e4.failed

Building a preprocessed source file for arm64 now always produces
a warning with clang because of the page_to_virt() macro assigning
a variable to itself.

Adding a new temporary variable avoids this issue.

Fixes: 2813b9c02962 ("kasan, mm, arm64: tag non slab memory allocated via pagealloc")
	Reviewed-by: Andrey Konovalov <andreyknvl@google.com>
	Signed-off-by: Arnd Bergmann <arnd@arndb.de>
	Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>
(cherry picked from commit 366e37e4da23f9df498cc9577cadcb354f7bd431)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/arm64/include/asm/memory.h
diff --cc arch/arm64/include/asm/memory.h
index df263607ae15,6340aa8350d9..000000000000
--- a/arch/arm64/include/asm/memory.h
+++ b/arch/arm64/include/asm/memory.h
@@@ -318,7 -313,14 +318,18 @@@ static inline void *phys_to_virt(phys_a
  #define __virt_to_pgoff(kaddr)	(((u64)(kaddr) & ~PAGE_OFFSET) / PAGE_SIZE * sizeof(struct page))
  #define __page_to_voff(kaddr)	(((u64)(kaddr) & ~VMEMMAP_START) * PAGE_SIZE / sizeof(struct page))
  
++<<<<<<< HEAD
 +#define page_to_virt(page)	((void *)((__page_to_voff(page)) | PAGE_OFFSET))
++=======
+ #define page_to_virt(page)	({					\
+ 	unsigned long __addr =						\
+ 		((__page_to_voff(page)) | PAGE_OFFSET);			\
+ 	unsigned long __addr_tag =					\
+ 		 __tag_set(__addr, page_kasan_tag(page));		\
+ 	((void *)__addr_tag);						\
+ })
+ 
++>>>>>>> 366e37e4da23 (arm64: avoid clang warning about self-assignment)
  #define virt_to_page(vaddr)	((struct page *)((__virt_to_pgoff(vaddr)) | VMEMMAP_START))
  
  #define _virt_addr_valid(kaddr)	pfn_valid((((u64)(kaddr) & ~PAGE_OFFSET) \
* Unmerged path arch/arm64/include/asm/memory.h
