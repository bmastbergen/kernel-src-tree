arm64: smccc: use asm EXPORT_SYMBOL()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-294.el8
commit-author Mark Rutland <mark.rutland@arm.com>
commit 23fe04c0c58c0432d26fd9c8d974d2fd9ab8a493
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-294.el8/23fe04c0.failed

For a while now it's been possible to use EXPORT_SYMBOL() in assembly
files, which allows us to place exports immediately after assembly
functions, as we do for C functions.

As a step towards removing arm64ksyms.c, let's move the SMCCC exports to
the assembly file the functions are defined in.

There should be no functional change as a result of this patch.

	Signed-off-by: Mark Rutland <mark.rutland@arm.com>
	Cc: Will Deacon <will.deacon@arm.com>
	Cc: Catalin Marinas <catalin.marinas@arm.com>
	Signed-off-by: Will Deacon <will.deacon@arm.com>
(cherry picked from commit 23fe04c0c58c0432d26fd9c8d974d2fd9ab8a493)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/arm64/kernel/arm64ksyms.c
diff --cc arch/arm64/kernel/arm64ksyms.c
index 56330e691d2f,74e29e69190b..000000000000
--- a/arch/arm64/kernel/arm64ksyms.c
+++ b/arch/arm64/kernel/arm64ksyms.c
@@@ -67,16 -63,3 +66,19 @@@ EXPORT_SYMBOL(_mcount)
  NOKPROBE_SYMBOL(_mcount);
  #endif
  
++<<<<<<< HEAD
 +	/* arm-smccc */
 +EXPORT_SYMBOL(__arm_smccc_smc);
 +EXPORT_SYMBOL(__arm_smccc_hvc);
 +
 +	/* tishift.S */
 +extern long long __ashlti3(long long a, int b);
 +EXPORT_SYMBOL(__ashlti3);
 +extern long long __ashrti3(long long a, int b);
 +EXPORT_SYMBOL(__ashrti3);
 +extern long long __lshrti3(long long a, int b);
 +EXPORT_SYMBOL(__lshrti3);
 +
 +EXPORT_SYMBOL(kimage_vaddr);
++=======
++>>>>>>> 23fe04c0c58c (arm64: smccc: use asm EXPORT_SYMBOL())
* Unmerged path arch/arm64/kernel/arm64ksyms.c
diff --git a/arch/arm64/kernel/smccc-call.S b/arch/arm64/kernel/smccc-call.S
index 62522342e1e4..184332286a81 100644
--- a/arch/arm64/kernel/smccc-call.S
+++ b/arch/arm64/kernel/smccc-call.S
@@ -13,7 +13,9 @@
  */
 #include <linux/linkage.h>
 #include <linux/arm-smccc.h>
+
 #include <asm/asm-offsets.h>
+#include <asm/assembler.h>
 
 	.macro SMCCC instr
 	.cfi_startproc
@@ -40,6 +42,7 @@
 ENTRY(__arm_smccc_smc)
 	SMCCC	smc
 ENDPROC(__arm_smccc_smc)
+EXPORT_SYMBOL(__arm_smccc_smc)
 
 /*
  * void arm_smccc_hvc(unsigned long a0, unsigned long a1, unsigned long a2,
@@ -50,3 +53,4 @@ ENDPROC(__arm_smccc_smc)
 ENTRY(__arm_smccc_hvc)
 	SMCCC	hvc
 ENDPROC(__arm_smccc_hvc)
+EXPORT_SYMBOL(__arm_smccc_hvc)
