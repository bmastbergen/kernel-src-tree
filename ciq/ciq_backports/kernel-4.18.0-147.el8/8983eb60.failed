ALSA: hda/realtek - Move to ACT_INIT state

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Kailang Yang <kailang@realtek.com>
commit 8983eb602af511fc5822f5ff4a82074c68816fd9
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/8983eb60.failed

It will be lose Mic JD state when Chrome OS boot and headset was plugged.
Just Implement of reset combo jack JD verb for ACT_PRE_PROBE state.
Intel test result was also failed.
It test passed until changed the initial state to ACT_INIT.
Mic JD will show every time.
This patch also changed the model name as 'alc-chrome-book' for
application of Chrome OS.

Fixes: 10f5b1b85ed1 ("ALSA: hda/realtek - Fixed Headset Mic JD not stable")
	Signed-off-by: Kailang Yang <kailang@realtek.com>
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit 8983eb602af511fc5822f5ff4a82074c68816fd9)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/pci/hda/patch_realtek.c
diff --cc sound/pci/hda/patch_realtek.c
index 0befe0bf47fe,c235b26add07..000000000000
--- a/sound/pci/hda/patch_realtek.c
+++ b/sound/pci/hda/patch_realtek.c
@@@ -5524,9 -5524,8 +5524,14 @@@ static void alc_fixup_headset_jack(stru
  static void alc295_fixup_chromebook(struct hda_codec *codec,
  				    const struct hda_fixup *fix, int action)
  {
++<<<<<<< HEAD
 +
 +	switch (action) {
 +	case HDA_FIXUP_ACT_PRE_PROBE:
++=======
+ 	switch (action) {
+ 	case HDA_FIXUP_ACT_INIT:
++>>>>>>> 8983eb602af5 (ALSA: hda/realtek - Move to ACT_INIT state)
  		switch (codec->core.vendor_id) {
  		case 0x10ec0295:
  			alc_update_coef_idx(codec, 0x4a, 0x8000, 1 << 15); /* Reset HP JD */
@@@ -5692,6 -5694,13 +5697,16 @@@ enum 
  	ALC285_FIXUP_LENOVO_PC_BEEP_IN_NOISE,
  	ALC255_FIXUP_ACER_HEADSET_MIC,
  	ALC295_FIXUP_CHROME_BOOK,
++<<<<<<< HEAD
++=======
+ 	ALC225_FIXUP_HEADSET_JACK,
+ 	ALC225_FIXUP_DELL_WYSE_AIO_MIC_NO_PRESENCE,
+ 	ALC225_FIXUP_WYSE_AUTO_MUTE,
+ 	ALC225_FIXUP_WYSE_DISABLE_MIC_VREF,
+ 	ALC286_FIXUP_ACER_AIO_HEADSET_MIC,
+ 	ALC256_FIXUP_ASUS_MIC_NO_PRESENCE,
+ 	ALC299_FIXUP_PREDATOR_SPK,
++>>>>>>> 8983eb602af5 (ALSA: hda/realtek - Move to ACT_INIT state)
  };
  
  static const struct hda_fixup alc269_fixups[] = {
@@@ -6604,8 -6623,44 +6619,17 @@@
  		.chained = true,
  		.chain_id = ALC269_FIXUP_HEADSET_MIC
  	},
 -	[ALC294_FIXUP_ASUS_MIC] = {
 -		.type = HDA_FIXUP_PINS,
 -		.v.pins = (const struct hda_pintbl[]) {
 -			{ 0x13, 0x90a60160 }, /* use as internal mic */
 -			{ 0x19, 0x04a11120 }, /* use as headset mic, without its own jack detect */
 -			{ }
 -		},
 -		.chained = true,
 -		.chain_id = ALC269_FIXUP_HEADSET_MODE_NO_HP_MIC
 -	},
 -	[ALC294_FIXUP_ASUS_HEADSET_MIC] = {
 -		.type = HDA_FIXUP_PINS,
 -		.v.pins = (const struct hda_pintbl[]) {
 -			{ 0x19, 0x01a1103c }, /* use as headset mic */
 -			{ }
 -		},
 -		.chained = true,
 -		.chain_id = ALC269_FIXUP_HEADSET_MODE_NO_HP_MIC
 -	},
 -	[ALC294_FIXUP_ASUS_SPK] = {
 -		.type = HDA_FIXUP_VERBS,
 -		.v.verbs = (const struct hda_verb[]) {
 -			/* Set EAPD high */
 -			{ 0x20, AC_VERB_SET_COEF_INDEX, 0x40 },
 -			{ 0x20, AC_VERB_SET_PROC_COEF, 0x8800 },
 -			{ }
 -		},
 -		.chained = true,
 -		.chain_id = ALC294_FIXUP_ASUS_HEADSET_MIC
 -	},
 -	[ALC295_FIXUP_CHROME_BOOK] = {
 +	[ALC225_FIXUP_HEADSET_JACK] = {
  		.type = HDA_FIXUP_FUNC,
++<<<<<<< HEAD
++=======
+ 		.v.func = alc295_fixup_chromebook,
+ 		.chained = true,
+ 		.chain_id = ALC225_FIXUP_HEADSET_JACK
+ 	},
+ 	[ALC225_FIXUP_HEADSET_JACK] = {
+ 		.type = HDA_FIXUP_FUNC,
++>>>>>>> 8983eb602af5 (ALSA: hda/realtek - Move to ACT_INIT state)
  		.v.func = alc_fixup_headset_jack,
  	},
  	[ALC293_FIXUP_SYSTEM76_MIC_NO_PRESENCE] = {
@@@ -7056,7 -7160,9 +7080,13 @@@ static const struct hda_model_fixup alc
  	{.id = ALC255_FIXUP_DUMMY_LINEOUT_VERB, .name = "alc255-dummy-lineout"},
  	{.id = ALC255_FIXUP_DELL_HEADSET_MIC, .name = "alc255-dell-headset"},
  	{.id = ALC295_FIXUP_HP_X360, .name = "alc295-hp-x360"},
++<<<<<<< HEAD
 +	{.id = ALC295_FIXUP_CHROME_BOOK, .name = "alc-sense-combo"},
++=======
+ 	{.id = ALC225_FIXUP_HEADSET_JACK, .name = "alc-headset-jack"},
+ 	{.id = ALC295_FIXUP_CHROME_BOOK, .name = "alc-chrome-book"},
+ 	{.id = ALC299_FIXUP_PREDATOR_SPK, .name = "predator-spk"},
++>>>>>>> 8983eb602af5 (ALSA: hda/realtek - Move to ACT_INIT state)
  	{}
  };
  #define ALC225_STANDARD_PINS \
* Unmerged path sound/pci/hda/patch_realtek.c
