iwlwifi: clear persistence bit according to device family

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Shahar S Matityahu <shahar.s.matityahu@intel.com>
commit 44f61b5c832c4085fcf476484efeaeef96dcfb8b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/44f61b5c.failed

The driver attempts to clear persistence bit on any device familiy even
though only 9000 and 22000 families require it. Clear the bit only on
the relevant device families.

Each HW has different address to the write protection register. Use the
right register for each HW

	Signed-off-by: Shahar S Matityahu <shahar.s.matityahu@intel.com>
Fixes: 8954e1eb2270 ("iwlwifi: trans: Clear persistence bit when starting the FW")
	Signed-off-by: Luca Coelho <luciano.coelho@intel.com>
	Signed-off-by: Kalle Valo <kvalo@codeaurora.org>
(cherry picked from commit 44f61b5c832c4085fcf476484efeaeef96dcfb8b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/wireless/intel/iwlwifi/iwl-prph.h
#	drivers/net/wireless/intel/iwlwifi/pcie/trans.c
diff --cc drivers/net/wireless/intel/iwlwifi/iwl-prph.h
index 421a869633a3,925f308764bf..000000000000
--- a/drivers/net/wireless/intel/iwlwifi/iwl-prph.h
+++ b/drivers/net/wireless/intel/iwlwifi/iwl-prph.h
@@@ -399,6 -408,12 +399,15 @@@ enum aux_misc_master1_en 
  #define AUX_MISC_MASTER1_SMPHR_STATUS	0xA20800
  #define RSA_ENABLE			0xA24B08
  #define PREG_AUX_BUS_WPROT_0		0xA04CC0
++<<<<<<< HEAD
++=======
+ 
+ /* device family 9000 WPROT register */
+ #define PREG_PRPH_WPROT_9000		0xA04CE0
+ /* device family 22000 WPROT register */
+ #define PREG_PRPH_WPROT_22000		0xA04D00
+ 
++>>>>>>> 44f61b5c832c (iwlwifi: clear persistence bit according to device family)
  #define SB_CPU_1_STATUS			0xA01E30
  #define SB_CPU_2_STATUS			0xA01E34
  #define UMAG_SB_CPU_1_STATUS		0xA038C0
diff --cc drivers/net/wireless/intel/iwlwifi/pcie/trans.c
index a2a98087eb41,e9d1075d91db..000000000000
--- a/drivers/net/wireless/intel/iwlwifi/pcie/trans.c
+++ b/drivers/net/wireless/intel/iwlwifi/pcie/trans.c
@@@ -1756,6 -1742,10 +1787,13 @@@ static int _iwl_trans_pcie_start_hw(str
  		return err;
  	}
  
++<<<<<<< HEAD
++=======
+ 	err = iwl_trans_pcie_clear_persistence_bit(trans);
+ 	if (err)
+ 		return err;
+ 
++>>>>>>> 44f61b5c832c (iwlwifi: clear persistence bit according to device family)
  	iwl_trans_pcie_sw_reset(trans);
  
  	err = iwl_pcie_apm_init(trans);
* Unmerged path drivers/net/wireless/intel/iwlwifi/iwl-prph.h
* Unmerged path drivers/net/wireless/intel/iwlwifi/pcie/trans.c
