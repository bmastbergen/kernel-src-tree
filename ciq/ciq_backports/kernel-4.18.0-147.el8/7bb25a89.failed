scsi: hisi_sas: Set protection parameters prior to adding SCSI host

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author John Garry <john.garry@huawei.com>
commit 7bb25a89aad2cc96de188c9ecc89a175360f6fb4
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/7bb25a89.failed

Currently we set the protection parameters after calling scsi_add_host()
for v3 hw.

They should be set beforehand, so make this change.

Appearantly this fixes our DIX issue (not mainline yet) also, but more
testing required.

Fixes: d6a9000b81be ("scsi: hisi_sas: Add support for DIF feature for v2 hw")
	Signed-off-by: John Garry <john.garry@huawei.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit 7bb25a89aad2cc96de188c9ecc89a175360f6fb4)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/hisi_sas/hisi_sas_v3_hw.c
diff --cc drivers/scsi/hisi_sas/hisi_sas_v3_hw.c
index 38d1247d6236,c92b3822c408..000000000000
--- a/drivers/scsi/hisi_sas/hisi_sas_v3_hw.c
+++ b/drivers/scsi/hisi_sas/hisi_sas_v3_hw.c
@@@ -2673,8 -2507,11 +2673,16 @@@ hisi_sas_v3_probe(struct pci_dev *pdev
  		sha->sas_port[i] = &hisi_hba->port[i].sas_port;
  	}
  
++<<<<<<< HEAD
 +	if (hisi_sas_debugfs_enable)
 +		hisi_sas_debugfs_init(hisi_hba);
++=======
+ 	if (hisi_hba->prot_mask) {
+ 		dev_info(dev, "Registering for DIF/DIX prot_mask=0x%x\n",
+ 			 prot_mask);
+ 		scsi_host_set_prot(hisi_hba->shost, prot_mask);
+ 	}
++>>>>>>> 7bb25a89aad2 (scsi: hisi_sas: Set protection parameters prior to adding SCSI host)
  
  	rc = scsi_add_host(shost, dev);
  	if (rc)
* Unmerged path drivers/scsi/hisi_sas/hisi_sas_v3_hw.c
