vxlan: Add a function to init switchdev_notifier_vxlan_fdb_info

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Petr Machata <petrm@mellanox.com>
commit ff23b91ce1ae686e436e9926de1fda3342ef26f8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/ff23b91c.failed

There are currently two places that need to initialize the notifier info
structure, and one more is coming next when vxlan_fdb_replay() is
introduced. These three instances have / will have very similar code
that is easy to abstract away into a named function.

Add such function, vxlan_fdb_switchdev_notifier_info(), and call it from
vxlan_fdb_switchdev_call_notifiers() and vxlan_fdb_find_uc().

	Signed-off-by: Petr Machata <petrm@mellanox.com>
	Signed-off-by: Ido Schimmel <idosch@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit ff23b91ce1ae686e436e9926de1fda3342ef26f8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/vxlan.c
diff --cc drivers/net/vxlan.c
index 6bf62e1be8b8,d3db0313c97e..000000000000
--- a/drivers/net/vxlan.c
+++ b/drivers/net/vxlan.c
@@@ -368,17 -387,7 +384,21 @@@ static void vxlan_fdb_switchdev_call_no
  
  	notifier_type = adding ? SWITCHDEV_VXLAN_FDB_ADD_TO_DEVICE
  			       : SWITCHDEV_VXLAN_FDB_DEL_TO_DEVICE;
++<<<<<<< HEAD
 +
 +	info = (struct switchdev_notifier_vxlan_fdb_info){
 +		.remote_ip = rd->remote_ip,
 +		.remote_port = rd->remote_port,
 +		.remote_vni = rd->remote_vni,
 +		.remote_ifindex = rd->remote_ifindex,
 +		.vni = fdb->vni,
 +		.offloaded = rd->offloaded,
 +	};
 +	memcpy(info.eth_addr, fdb->eth_addr, ETH_ALEN);
 +
++=======
+ 	vxlan_fdb_switchdev_notifier_info(vxlan, fdb, rd, &info);
++>>>>>>> ff23b91ce1ae (vxlan: Add a function to init switchdev_notifier_vxlan_fdb_info)
  	call_switchdev_notifiers(notifier_type, vxlan->dev,
  				 &info.info);
  }
@@@ -531,16 -544,7 +551,20 @@@ int vxlan_fdb_find_uc(struct net_devic
  	}
  
  	rdst = first_remote_rcu(f);
++<<<<<<< HEAD
 +
 +	memset(fdb_info, 0, sizeof(*fdb_info));
 +	fdb_info->info.dev = dev;
 +	fdb_info->remote_ip = rdst->remote_ip;
 +	fdb_info->remote_port = rdst->remote_port;
 +	fdb_info->remote_vni = rdst->remote_vni;
 +	fdb_info->remote_ifindex = rdst->remote_ifindex;
 +	fdb_info->vni = vni;
 +	fdb_info->offloaded = rdst->offloaded;
 +	ether_addr_copy(fdb_info->eth_addr, mac);
++=======
+ 	vxlan_fdb_switchdev_notifier_info(vxlan, f, rdst, fdb_info);
++>>>>>>> ff23b91ce1ae (vxlan: Add a function to init switchdev_notifier_vxlan_fdb_info)
  
  out:
  	rcu_read_unlock();
* Unmerged path drivers/net/vxlan.c
