libbpf: make bpf_object__open default to UNSPEC

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Nikita V. Shirokov <tehnerd@tehnerd.com>
commit 47ae7e3d0be539c6af83b7b349ece31a18001aa6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/47ae7e3d.failed

currently by default libbpf's bpf_object__open requires
bpf's program to specify  version in a code because of two things:
1) default prog type is set to KPROBE
2) KPROBE requires (in kernel/bpf/syscall.c) version to be specified

in this patch i'm changing default prog type to UNSPEC and also changing
requirments for version's section to be present in object file.
now it would reflect what we have today in kernel
(only KPROBE prog type requires for version to be explicitly set).

v1 -> v2:
 - RFC tag has been dropped

	Signed-off-by: Nikita V. Shirokov <tehnerd@tehnerd.com>
	Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
(cherry picked from commit 47ae7e3d0be539c6af83b7b349ece31a18001aa6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/lib/bpf/libbpf.c
diff --cc tools/lib/bpf/libbpf.c
index 9ac238289908,ed4212a4c5f9..000000000000
--- a/tools/lib/bpf/libbpf.c
+++ b/tools/lib/bpf/libbpf.c
@@@ -304,7 -333,8 +304,12 @@@ bpf_program__init(void *data, size_t si
  	prog->idx = idx;
  	prog->instances.fds = NULL;
  	prog->instances.nr = -1;
++<<<<<<< HEAD
 +	prog->type = BPF_PROG_TYPE_KPROBE;
++=======
+ 	prog->type = BPF_PROG_TYPE_UNSPEC;
+ 	prog->btf_fd = -1;
++>>>>>>> 47ae7e3d0be5 (libbpf: make bpf_object__open default to UNSPEC)
  
  	return 0;
  errout:
* Unmerged path tools/lib/bpf/libbpf.c
