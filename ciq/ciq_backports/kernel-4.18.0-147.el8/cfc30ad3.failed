IB/usnic: Remove stub functions

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Gal Pressman <galpress@amazon.com>
commit cfc30ad3d098b63ac08d2d2d61ef9aeff659c57a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/cfc30ad3.failed

Lack of mandatory verbs no longer fail device registration, the device
will be marked as a non-kverbs provider.

	Signed-off-by: Gal Pressman <galpress@amazon.com>
	Tested-by: Parvi Kaustubhi <pkaustub@cisco.com>
	Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
(cherry picked from commit cfc30ad3d098b63ac08d2d2d61ef9aeff659c57a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/usnic/usnic_ib_verbs.c
#	drivers/infiniband/hw/usnic/usnic_ib_verbs.h
diff --cc drivers/infiniband/hw/usnic/usnic_ib_verbs.c
index e5fce7d86d82,9dea18106247..000000000000
--- a/drivers/infiniband/hw/usnic/usnic_ib_verbs.c
+++ b/drivers/infiniband/hw/usnic/usnic_ib_verbs.c
@@@ -760,56 -760,4 +760,59 @@@ int usnic_ib_mmap(struct ib_ucontext *c
  	return -EINVAL;
  }
  
++<<<<<<< HEAD
 +/* In ib callbacks section -  Start of stub funcs */
 +struct ib_ah *usnic_ib_create_ah(struct ib_pd *pd,
 +				 struct rdma_ah_attr *ah_attr,
 +				 struct ib_udata *udata)
 +
 +{
 +	usnic_dbg("\n");
 +	return ERR_PTR(-EPERM);
 +}
 +
 +int usnic_ib_destroy_ah(struct ib_ah *ah)
 +{
 +	usnic_dbg("\n");
 +	return -EINVAL;
 +}
 +
 +int usnic_ib_post_send(struct ib_qp *ibqp, struct ib_send_wr *wr,
 +				struct ib_send_wr **bad_wr)
 +{
 +	usnic_dbg("\n");
 +	return -EINVAL;
 +}
 +
 +int usnic_ib_post_recv(struct ib_qp *ibqp, struct ib_recv_wr *wr,
 +				struct ib_recv_wr **bad_wr)
 +{
 +	usnic_dbg("\n");
 +	return -EINVAL;
 +}
 +
 +int usnic_ib_poll_cq(struct ib_cq *ibcq, int num_entries,
 +				struct ib_wc *wc)
 +{
 +	usnic_dbg("\n");
 +	return -EINVAL;
 +}
 +
 +int usnic_ib_req_notify_cq(struct ib_cq *cq,
 +					enum ib_cq_notify_flags flags)
 +{
 +	usnic_dbg("\n");
 +	return -EINVAL;
 +}
 +
 +struct ib_mr *usnic_ib_get_dma_mr(struct ib_pd *pd, int acc)
 +{
 +	usnic_dbg("\n");
 +	return ERR_PTR(-ENOMEM);
 +}
 +
 +
 +/* In ib callbacks section - End of stub funcs */
++=======
++>>>>>>> cfc30ad3d098 (IB/usnic: Remove stub functions)
  /* End of ib callbacks section */
diff --cc drivers/infiniband/hw/usnic/usnic_ib_verbs.h
index 1fda94425116,99a6d81c2bcd..000000000000
--- a/drivers/infiniband/hw/usnic/usnic_ib_verbs.h
+++ b/drivers/infiniband/hw/usnic/usnic_ib_verbs.h
@@@ -75,18 -75,4 +75,21 @@@ struct ib_ucontext *usnic_ib_alloc_ucon
  int usnic_ib_dealloc_ucontext(struct ib_ucontext *ibcontext);
  int usnic_ib_mmap(struct ib_ucontext *context,
  			struct vm_area_struct *vma);
++<<<<<<< HEAD
 +struct ib_ah *usnic_ib_create_ah(struct ib_pd *pd,
 +				 struct rdma_ah_attr *ah_attr,
 +				 struct ib_udata *udata);
 +
 +int usnic_ib_destroy_ah(struct ib_ah *ah);
 +int usnic_ib_post_send(struct ib_qp *ibqp, struct ib_send_wr *wr,
 +			struct ib_send_wr **bad_wr);
 +int usnic_ib_post_recv(struct ib_qp *ibqp, struct ib_recv_wr *wr,
 +			struct ib_recv_wr **bad_wr);
 +int usnic_ib_poll_cq(struct ib_cq *ibcq, int num_entries,
 +			struct ib_wc *wc);
 +int usnic_ib_req_notify_cq(struct ib_cq *cq,
 +				enum ib_cq_notify_flags flags);
 +struct ib_mr *usnic_ib_get_dma_mr(struct ib_pd *pd, int acc);
++=======
++>>>>>>> cfc30ad3d098 (IB/usnic: Remove stub functions)
  #endif /* !USNIC_IB_VERBS_H */
diff --git a/drivers/infiniband/hw/usnic/usnic_ib_main.c b/drivers/infiniband/hw/usnic/usnic_ib_main.c
index e202a403f980..d5ba07a5e6f4 100644
--- a/drivers/infiniband/hw/usnic/usnic_ib_main.c
+++ b/drivers/infiniband/hw/usnic/usnic_ib_main.c
@@ -333,32 +333,25 @@ static void usnic_get_dev_fw_str(struct ib_device *device, char *str)
 static const struct ib_device_ops usnic_dev_ops = {
 	.alloc_pd = usnic_ib_alloc_pd,
 	.alloc_ucontext = usnic_ib_alloc_ucontext,
-	.create_ah = usnic_ib_create_ah,
 	.create_cq = usnic_ib_create_cq,
 	.create_qp = usnic_ib_create_qp,
 	.dealloc_pd = usnic_ib_dealloc_pd,
 	.dealloc_ucontext = usnic_ib_dealloc_ucontext,
 	.dereg_mr = usnic_ib_dereg_mr,
-	.destroy_ah = usnic_ib_destroy_ah,
 	.destroy_cq = usnic_ib_destroy_cq,
 	.destroy_qp = usnic_ib_destroy_qp,
 	.get_dev_fw_str = usnic_get_dev_fw_str,
-	.get_dma_mr = usnic_ib_get_dma_mr,
 	.get_link_layer = usnic_ib_port_link_layer,
 	.get_netdev = usnic_get_netdev,
 	.get_port_immutable = usnic_port_immutable,
 	.mmap = usnic_ib_mmap,
 	.modify_qp = usnic_ib_modify_qp,
-	.poll_cq = usnic_ib_poll_cq,
-	.post_recv = usnic_ib_post_recv,
-	.post_send = usnic_ib_post_send,
 	.query_device = usnic_ib_query_device,
 	.query_gid = usnic_ib_query_gid,
 	.query_pkey = usnic_ib_query_pkey,
 	.query_port = usnic_ib_query_port,
 	.query_qp = usnic_ib_query_qp,
 	.reg_user_mr = usnic_ib_reg_mr,
-	.req_notify_cq = usnic_ib_req_notify_cq,
 };
 
 /* Start of PF discovery section */
* Unmerged path drivers/infiniband/hw/usnic/usnic_ib_verbs.c
* Unmerged path drivers/infiniband/hw/usnic/usnic_ib_verbs.h
