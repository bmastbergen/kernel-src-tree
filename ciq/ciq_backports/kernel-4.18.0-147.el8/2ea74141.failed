drm/i915/icl: Enable media sampler powergate

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Mika Kuoppala <mika.kuoppala@linux.intel.com>
commit 2ea7414159cdbbab76b55f01b4ff560ff2018a4f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/2ea74141.failed

Enable media sampler powergate as recommended.

v2: use REG_BIT (Chris)

	Cc: Chris Wilson <chris@chris-wilson.co.uk>
	Signed-off-by: Mika Kuoppala <mika.kuoppala@linux.intel.com>
	Acked-by: Chris Wilson <chris@chris-wilson.co.uk>
	Signed-off-by: Chris Wilson <chris@chris-wilson.co.uk>
Link: https://patchwork.freedesktop.org/patch/msgid/20190410105923.18546-3-mika.kuoppala@linux.intel.com
(cherry picked from commit 2ea7414159cdbbab76b55f01b4ff560ff2018a4f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/i915/i915_reg.h
diff --cc drivers/gpu/drm/i915/i915_reg.h
index a78c6ef1f608,3c243025ea3e..000000000000
--- a/drivers/gpu/drm/i915/i915_reg.h
+++ b/drivers/gpu/drm/i915/i915_reg.h
@@@ -8123,8 -8687,9 +8123,14 @@@ enum 
  #define GEN9_MEDIA_PG_IDLE_HYSTERESIS		_MMIO(0xA0C4)
  #define GEN9_RENDER_PG_IDLE_HYSTERESIS		_MMIO(0xA0C8)
  #define GEN9_PG_ENABLE				_MMIO(0xA210)
++<<<<<<< HEAD
 +#define GEN9_RENDER_PG_ENABLE			(1<<0)
 +#define GEN9_MEDIA_PG_ENABLE			(1<<1)
++=======
+ #define GEN9_RENDER_PG_ENABLE			REG_BIT(0)
+ #define GEN9_MEDIA_PG_ENABLE			REG_BIT(1)
+ #define GEN11_MEDIA_SAMPLER_PG_ENABLE		REG_BIT(2)
++>>>>>>> 2ea7414159cd (drm/i915/icl: Enable media sampler powergate)
  #define GEN8_PUSHBUS_CONTROL			_MMIO(0xA248)
  #define GEN8_PUSHBUS_ENABLE			_MMIO(0xA250)
  #define GEN8_PUSHBUS_SHIFT			_MMIO(0xA25C)
* Unmerged path drivers/gpu/drm/i915/i915_reg.h
diff --git a/drivers/gpu/drm/i915/intel_pm.c b/drivers/gpu/drm/i915/intel_pm.c
index 29f65e77f27a..973471c19f66 100644
--- a/drivers/gpu/drm/i915/intel_pm.c
+++ b/drivers/gpu/drm/i915/intel_pm.c
@@ -6881,7 +6881,9 @@ static void gen11_enable_rc6(struct drm_i915_private *dev_priv)
 
 	/* 3b: Enable Coarse Power Gating only when RC6 is enabled. */
 	I915_WRITE(GEN9_PG_ENABLE,
-		   GEN9_RENDER_PG_ENABLE | GEN9_MEDIA_PG_ENABLE);
+		   GEN9_RENDER_PG_ENABLE |
+		   GEN9_MEDIA_PG_ENABLE |
+		   GEN11_MEDIA_SAMPLER_PG_ENABLE);
 
 	intel_uncore_forcewake_put(&dev_priv->uncore, FORCEWAKE_ALL);
 }
