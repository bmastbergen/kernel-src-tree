ALSA: hda/realtek: Enable headset MIC of Acer AIO with ALC286

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Jian-Hong Pan <jian-hong@endlessm.com>
commit 667a8f73753908c4d0171e52b71774f9be5d6713
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/667a8f73.failed

Some Acer AIO desktops like Veriton Z6860G, Z4860G and Z4660G cannot
record sound from headset MIC.  This patch adds the
ALC286_FIXUP_ACER_AIO_HEADSET_MIC quirk to fix this issue.

Fixes: 9f8aefed9623 ("ALSA: hda/realtek: Fix mic issue on Acer AIO Veriton Z4660G")
Fixes: b72f936f6b32 ("ALSA: hda/realtek: Fix mic issue on Acer AIO Veriton Z4860G/Z6860G")
	Signed-off-by: Jian-Hong Pan <jian-hong@endlessm.com>
	Reviewed-by: Kailang Yang <kailang@realtek.com>
	Cc: <stable@vger.kernel.org>
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit 667a8f73753908c4d0171e52b71774f9be5d6713)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/pci/hda/patch_realtek.c
diff --cc sound/pci/hda/patch_realtek.c
index 0befe0bf47fe,191830d4fa40..000000000000
--- a/sound/pci/hda/patch_realtek.c
+++ b/sound/pci/hda/patch_realtek.c
@@@ -5692,6 -5684,10 +5692,13 @@@ enum 
  	ALC285_FIXUP_LENOVO_PC_BEEP_IN_NOISE,
  	ALC255_FIXUP_ACER_HEADSET_MIC,
  	ALC295_FIXUP_CHROME_BOOK,
++<<<<<<< HEAD
++=======
+ 	ALC225_FIXUP_DELL_WYSE_AIO_MIC_NO_PRESENCE,
+ 	ALC225_FIXUP_WYSE_AUTO_MUTE,
+ 	ALC225_FIXUP_WYSE_DISABLE_MIC_VREF,
+ 	ALC286_FIXUP_ACER_AIO_HEADSET_MIC,
++>>>>>>> 667a8f737539 (ALSA: hda/realtek: Enable headset MIC of Acer AIO with ALC286)
  };
  
  static const struct hda_fixup alc269_fixups[] = {
@@@ -6638,12 -6664,38 +6645,22 @@@
  		.chained = true,
  		.chain_id = ALC255_FIXUP_HEADSET_MODE_NO_HP_MIC
  	},
 -	[ALC225_FIXUP_DELL_WYSE_AIO_MIC_NO_PRESENCE] = {
 -		.type = HDA_FIXUP_PINS,
 -		.v.pins = (const struct hda_pintbl[]) {
 -			{ 0x16, 0x01011020 }, /* Rear Line out */
 -			{ 0x19, 0x01a1913c }, /* use as Front headset mic, without its own jack detect */
 -			{ }
 -		},
 -		.chained = true,
 -		.chain_id = ALC225_FIXUP_WYSE_AUTO_MUTE
 -	},
 -	[ALC225_FIXUP_WYSE_AUTO_MUTE] = {
 -		.type = HDA_FIXUP_FUNC,
 -		.v.func = alc_fixup_auto_mute_via_amp,
 -		.chained = true,
 -		.chain_id = ALC225_FIXUP_WYSE_DISABLE_MIC_VREF
 -	},
 -	[ALC225_FIXUP_WYSE_DISABLE_MIC_VREF] = {
 +	[ALC295_FIXUP_CHROME_BOOK] = {
  		.type = HDA_FIXUP_FUNC,
 -		.v.func = alc_fixup_disable_mic_vref,
 +		.v.func = alc295_fixup_chromebook,
  		.chained = true,
 -		.chain_id = ALC269_FIXUP_HEADSET_MODE_NO_HP_MIC
 +		.chain_id = ALC225_FIXUP_HEADSET_JACK
  	},
+ 	[ALC286_FIXUP_ACER_AIO_HEADSET_MIC] = {
+ 		.type = HDA_FIXUP_VERBS,
+ 		.v.verbs = (const struct hda_verb[]) {
+ 			{ 0x20, AC_VERB_SET_COEF_INDEX, 0x4f },
+ 			{ 0x20, AC_VERB_SET_PROC_COEF, 0x5029 },
+ 			{ }
+ 		},
+ 		.chained = true,
+ 		.chain_id = ALC286_FIXUP_ACER_AIO_MIC_NO_PRESENCE
+ 	},
  };
  
  static const struct snd_pci_quirk alc269_fixup_tbl[] = {
* Unmerged path sound/pci/hda/patch_realtek.c
