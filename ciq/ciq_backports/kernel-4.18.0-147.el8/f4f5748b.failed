netfilter: ipset: fix a missing check of nla_parse

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Aditya Pakki <pakki001@umn.edu>
commit f4f5748bfec94cf418e49bf05f0c81a1b9ebc950
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/f4f5748b.failed

When nla_parse fails, we should not use the results (the first
argument). The fix checks if it fails, and if so, returns its error code
upstream.

	Signed-off-by: Aditya Pakki <pakki001@umn.edu>
	Signed-off-by: Jozsef Kadlecsik <kadlec@blackhole.kfki.hu>
(cherry picked from commit f4f5748bfec94cf418e49bf05f0c81a1b9ebc950)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/netfilter/ipset/ip_set_core.c
diff --cc net/netfilter/ipset/ip_set_core.c
index 45a257695bef,d0f4c627ff91..000000000000
--- a/net/netfilter/ipset/ip_set_core.c
+++ b/net/netfilter/ipset/ip_set_core.c
@@@ -1546,9 -1544,14 +1546,19 @@@ call_ad(struct sock *ctnl, struct sk_bu
  		memcpy(&errmsg->msg, nlh, nlh->nlmsg_len);
  		cmdattr = (void *)&errmsg->msg + min_len;
  
++<<<<<<< HEAD
 +		nla_parse(cda, IPSET_ATTR_CMD_MAX, cmdattr,
 +			  nlh->nlmsg_len - min_len, ip_set_adt_policy, NULL);
- 
++=======
+ 		ret = nla_parse_deprecated(cda, IPSET_ATTR_CMD_MAX, cmdattr,
+ 					   nlh->nlmsg_len - min_len,
+ 					   ip_set_adt_policy, NULL);
++>>>>>>> f4f5748bfec9 (netfilter: ipset: fix a missing check of nla_parse)
+ 
+ 		if (ret) {
+ 			nlmsg_free(skb2);
+ 			return ret;
+ 		}
  		errline = nla_data(cda[IPSET_ATTR_LINENO]);
  
  		*errline = lineno;
* Unmerged path net/netfilter/ipset/ip_set_core.c
