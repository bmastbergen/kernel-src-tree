ASoC: audio-graph-card: don't select DPCM via audio-graph-card

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
Rebuild_CHGLOG: - [sound] ALSA: ASoC: audio-graph-card: don't select DPCM via audio-graph-card (Jaroslav Kysela) [1683051]
Rebuild_FUZZ: 95.38%
commit-author Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
commit c2c616021d64d952dc9d37793924ce57833d7754
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/c2c61602.failed

commit ae3cb5790906b ("ASoC: audio-graph-card: merge
audio-graph-scu-card") merged audio-graph-scu-card which can
handle DPCM into audio-graph-card.

By this patch, the judgement to select "normal sound card" or
"DPCM sound card" is based on its OF-graph endpoint connection.
But, because of it, existing "audio-graph-card" user who is
assuming "normal sound card" might select DPCM unintentionally.

To solve this issue, this patch allows "audio-graph-card" user
can select "normal sound card", and "audio-graph-scu-card" user
can select both "normal sound card" and "DPCM sound card".
This keeps compatibility collectry.

Fixes: ae3cb5790906b ("ASoC: audio-graph-card: merge audio-graph-scu-card")
	Reported-by: Arnaud Pouliquen <arnaud.pouliquen@st.com>
	Signed-off-by: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
	Acked-by: Arnaud Pouliquen <arnaud.pouliquen@st.com>
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit c2c616021d64d952dc9d37793924ce57833d7754)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/soc/generic/audio-graph-card.c
diff --cc sound/soc/generic/audio-graph-card.c
index 8114b5ea9319,69bc4848d787..000000000000
--- a/sound/soc/generic/audio-graph-card.c
+++ b/sound/soc/generic/audio-graph-card.c
@@@ -20,6 -20,39 +20,42 @@@
  #include <linux/string.h>
  #include <sound/simple_card_utils.h>
  
++<<<<<<< HEAD
++=======
+ #define DPCM_SELECTABLE 1
+ 
+ struct graph_priv {
+ 	struct snd_soc_card snd_card;
+ 	struct graph_dai_props {
+ 		struct asoc_simple_dai *cpu_dai;
+ 		struct asoc_simple_dai *codec_dai;
+ 		struct snd_soc_dai_link_component codecs; /* single codec */
+ 		struct snd_soc_dai_link_component platforms;
+ 		struct asoc_simple_card_data adata;
+ 		struct snd_soc_codec_conf *codec_conf;
+ 		unsigned int mclk_fs;
+ 	} *dai_props;
+ 	struct asoc_simple_jack hp_jack;
+ 	struct asoc_simple_jack mic_jack;
+ 	struct snd_soc_dai_link *dai_link;
+ 	struct asoc_simple_dai *dais;
+ 	struct snd_soc_codec_conf *codec_conf;
+ 	struct gpio_desc *pa_gpio;
+ };
+ 
+ struct link_info {
+ 	int dais; /* number of dai  */
+ 	int link; /* number of link */
+ 	int conf; /* number of codec_conf */
+ 	int cpu;  /* turn for CPU / Codec */
+ };
+ 
+ #define graph_priv_to_card(priv) (&(priv)->snd_card)
+ #define graph_priv_to_props(priv, i) ((priv)->dai_props + (i))
+ #define graph_priv_to_dev(priv) (graph_priv_to_card(priv)->dev)
+ #define graph_priv_to_link(priv, i) (graph_priv_to_card(priv)->dai_link + (i))
+ 
++>>>>>>> c2c616021d64 (ASoC: audio-graph-card: don't select DPCM via audio-graph-card)
  #define PREFIX	"audio-graph-card,"
  
  static int graph_outdrv_event(struct snd_soc_dapm_widget *w,
@@@ -414,7 -441,8 +450,12 @@@ static int graph_for_each_link(struct a
  	struct device_node *codec_ep;
  	struct device_node *codec_port;
  	struct device_node *codec_port_old = NULL;
++<<<<<<< HEAD
 +	struct asoc_simple_data adata;
++=======
+ 	struct asoc_simple_card_data adata;
+ 	uintptr_t dpcm_selectable = (uintptr_t)of_device_get_match_data(dev);
++>>>>>>> c2c616021d64 (ASoC: audio-graph-card: don't select DPCM via audio-graph-card)
  	int rc, ret;
  
  	/* loop for all listed CPU port */
* Unmerged path sound/soc/generic/audio-graph-card.c
