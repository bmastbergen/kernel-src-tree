nvmet: add error log support in the core

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Chaitanya Kulkarni <chaitanya.kulkarni@wdc.com>
commit e81446afc7f5ee45fd90b1b5a22ffa247dca5b15
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/e81446af.failed

This patch adds the support to maintain error log page for the
nvmet-core.

	Signed-off-by: Chaitanya Kulkarni <chaitanya.kulkarni@wdc.com>
	Reviewed-by: Sagi Grimberg <sagi@grimberg.me>
	Signed-off-by: Christoph Hellwig <hch@lst.de>
(cherry picked from commit e81446afc7f5ee45fd90b1b5a22ffa247dca5b15)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/nvme/target/core.c
diff --cc drivers/nvme/target/core.c
index 628b8f0276bd,0b969977e361..000000000000
--- a/drivers/nvme/target/core.c
+++ b/drivers/nvme/target/core.c
@@@ -660,8 -775,20 +666,23 @@@ static u16 nvmet_parse_io_cmd(struct nv
  		return ret;
  
  	req->ns = nvmet_find_namespace(req->sq->ctrl, cmd->rw.nsid);
- 	if (unlikely(!req->ns))
+ 	if (unlikely(!req->ns)) {
+ 		req->error_loc = offsetof(struct nvme_common_command, nsid);
  		return NVME_SC_INVALID_NS | NVME_SC_DNR;
++<<<<<<< HEAD
++=======
+ 	}
+ 	ret = nvmet_check_ana_state(req->port, req->ns);
+ 	if (unlikely(ret)) {
+ 		req->error_loc = offsetof(struct nvme_common_command, nsid);
+ 		return ret;
+ 	}
+ 	ret = nvmet_io_cmd_check_access(req);
+ 	if (unlikely(ret)) {
+ 		req->error_loc = offsetof(struct nvme_common_command, nsid);
+ 		return ret;
+ 	}
++>>>>>>> e81446afc7f5 (nvmet: add error log support in the core)
  
  	if (req->ns->file)
  		return nvmet_file_parse_io_cmd(req);
* Unmerged path drivers/nvme/target/core.c
