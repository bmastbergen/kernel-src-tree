cgroup: Simplify cgroup_ancestor

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Andrey Ignatov <rdna@fb.com>
commit 808c43b7c7f70360ed7b9e43e2cf980f388e71fa
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/808c43b7.failed

Simplify cgroup_ancestor function. This is follow-up for
commit 7723628101aa ("bpf: Introduce bpf_skb_ancestor_cgroup_id helper")

	Suggested-by: Tejun Heo <tj@kernel.org>
	Signed-off-by: Andrey Ignatov <rdna@fb.com>
	Signed-off-by: Tejun Heo <tj@kernel.org>
(cherry picked from commit 808c43b7c7f70360ed7b9e43e2cf980f388e71fa)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/linux/cgroup.h
diff --cc include/linux/cgroup.h
index 0c4d56acfdca,e03a92430383..000000000000
--- a/include/linux/cgroup.h
+++ b/include/linux/cgroup.h
@@@ -556,6 -554,27 +556,30 @@@ static inline bool cgroup_is_descendant
  }
  
  /**
++<<<<<<< HEAD
++=======
+  * cgroup_ancestor - find ancestor of cgroup
+  * @cgrp: cgroup to find ancestor of
+  * @ancestor_level: level of ancestor to find starting from root
+  *
+  * Find ancestor of cgroup at specified level starting from root if it exists
+  * and return pointer to it. Return NULL if @cgrp doesn't have ancestor at
+  * @ancestor_level.
+  *
+  * This function is safe to call as long as @cgrp is accessible.
+  */
+ static inline struct cgroup *cgroup_ancestor(struct cgroup *cgrp,
+ 					     int ancestor_level)
+ {
+ 	if (cgrp->level < ancestor_level)
+ 		return NULL;
+ 	while (cgrp && cgrp->level > ancestor_level)
+ 		cgrp = cgroup_parent(cgrp);
+ 	return cgrp;
+ }
+ 
+ /**
++>>>>>>> 808c43b7c7f7 (cgroup: Simplify cgroup_ancestor)
   * task_under_cgroup_hierarchy - test task's membership of cgroup ancestry
   * @task: the task to be tested
   * @ancestor: possible ancestor of @task's cgroup
* Unmerged path include/linux/cgroup.h
