drm/amd/display: Disable cursor when offscreen in negative direction

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Nicholas Kazlauskas <nicholas.kazlauskas@amd.com>
commit e371e19c10a264bd72c2ff1d21e2167b994710d1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/e371e19c.failed

[Why]
When x or y is negative we set the x and y values to 0 and compensate
with a positive cursor hotspot in DM since DC expects positive cursor
values.

When x or y is less than or equal to the maximum cursor width or height
the cursor hotspot is clamped so the hotspot doesn't exceed the
cursor size:

if (x < 0) {
        xorigin = min(-x, amdgpu_crtc->max_cursor_width - 1);
        x = 0;
}

if (y < 0) {
        yorigin = min(-y, amdgpu_crtc->max_cursor_height - 1);
        y = 0;
}

This incorrectly forces the cursor to be at least 1 pixel on the screen
in either direction when x or y is sufficiently negative.

[How]
Just disable the cursor when it goes far enough off the screen in one
of these directions.

This fixes kms_cursor_crc@cursor-256x256-offscreen.

	Signed-off-by: Nicholas Kazlauskas <nicholas.kazlauskas@amd.com>
	Reviewed-by: Sun peng Li <Sunpeng.Li@amd.com>
	Acked-by: Bhawanpreet Lakha <Bhawanpreet.Lakha@amd.com>
	Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
(cherry picked from commit e371e19c10a264bd72c2ff1d21e2167b994710d1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c
diff --cc drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c
index d656073f676c,1e8b51d21fea..000000000000
--- a/drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c
+++ b/drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c
@@@ -3805,9 -4963,17 +3805,23 @@@ static int get_cursor_position(struct d
  
  	x = plane->state->crtc_x;
  	y = plane->state->crtc_y;
++<<<<<<< HEAD
 +	/* avivo cursor are offset into the total surface */
 +	x += crtc->primary->state->src_x >> 16;
 +	y += crtc->primary->state->src_y >> 16;
++=======
+ 
+ 	if (x <= -amdgpu_crtc->max_cursor_width ||
+ 	    y <= -amdgpu_crtc->max_cursor_height)
+ 		return 0;
+ 
+ 	if (crtc->primary->state) {
+ 		/* avivo cursor are offset into the total surface */
+ 		x += crtc->primary->state->src_x >> 16;
+ 		y += crtc->primary->state->src_y >> 16;
+ 	}
+ 
++>>>>>>> e371e19c10a2 (drm/amd/display: Disable cursor when offscreen in negative direction)
  	if (x < 0) {
  		xorigin = min(-x, amdgpu_crtc->max_cursor_width - 1);
  		x = 0;
* Unmerged path drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c
