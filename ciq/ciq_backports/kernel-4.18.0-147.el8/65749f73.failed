net: hns3: reuse reinitialization interface in the hns3_set_channels

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Huazhong Tan <tanhuazhong@huawei.com>
commit 65749f7375ae7a3cc14237c9972e5a3c14116c85
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/65749f73.failed

There is already common interface for network device reinitialization,
so hns3_set_channels() should just call them.

	Signed-off-by: Huazhong Tan <tanhuazhong@huawei.com>
	Signed-off-by: Yunsheng Lin <linyunsheng@huawei.com>
	Signed-off-by: Peng Li <lipeng321@huawei.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 65749f7375ae7a3cc14237c9972e5a3c14116c85)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/hisilicon/hns3/hns3_enet.c
diff --cc drivers/net/ethernet/hisilicon/hns3/hns3_enet.c
index 279e875539b1,0cd70d7667be..000000000000
--- a/drivers/net/ethernet/hisilicon/hns3/hns3_enet.c
+++ b/drivers/net/ethernet/hisilicon/hns3/hns3_enet.c
@@@ -3640,50 -4144,6 +3640,53 @@@ static int hns3_reset_notify(struct hna
  	return ret;
  }
  
++<<<<<<< HEAD
 +static int hns3_modify_tqp_num(struct net_device *netdev, u16 new_tqp_num)
 +{
 +	struct hns3_nic_priv *priv = netdev_priv(netdev);
 +	struct hnae3_handle *h = hns3_get_handle(netdev);
 +	int ret;
 +
 +	ret = h->ae_algo->ops->set_channels(h, new_tqp_num);
 +	if (ret)
 +		return ret;
 +
 +	ret = hns3_get_ring_config(priv);
 +	if (ret)
 +		return ret;
 +
 +	ret = hns3_nic_alloc_vector_data(priv);
 +	if (ret)
 +		goto err_alloc_vector;
 +
 +	hns3_restore_coal(priv);
 +
 +	ret = hns3_nic_init_vector_data(priv);
 +	if (ret)
 +		goto err_uninit_vector;
 +
 +	ret = hns3_init_all_ring(priv);
 +	if (ret)
 +		goto err_put_ring;
 +
 +	return 0;
 +
 +err_put_ring:
 +	hns3_put_ring_config(priv);
 +err_uninit_vector:
 +	hns3_nic_uninit_vector_data(priv);
 +err_alloc_vector:
 +	hns3_nic_dealloc_vector_data(priv);
 +	return ret;
 +}
 +
 +static int hns3_adjust_tqps_num(u8 num_tc, u32 new_tqp_num)
 +{
 +	return (new_tqp_num / num_tc) * num_tc;
 +}
 +
++=======
++>>>>>>> 65749f7375ae (net: hns3: reuse reinitialization interface in the hns3_set_channels)
  int hns3_set_channels(struct net_device *netdev,
  		      struct ethtool_channels *ch)
  {
* Unmerged path drivers/net/ethernet/hisilicon/hns3/hns3_enet.c
