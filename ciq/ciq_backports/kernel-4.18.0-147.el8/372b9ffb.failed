drm/i915: Fix skl+ max plane width

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
Rebuild_CHGLOG: - [drm] drm/i915: Fix ONLY icl+ max plane width (Lyude Paul) [1707312 1688524 1685552 1685427 1665631 1665088 1664615 1664609 1664189 1664177 1664175 1664104 1662017 1660302 1643842 1640840 1639990 1639436 1637606 1633845 1633843 1633842 1504286]
Rebuild_FUZZ: 87.67%
commit-author Ville Syrjälä <ville.syrjala@linux.intel.com>
commit 372b9ffb5799a3d5f4a9c51ac35cf65ed8f40101
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/372b9ffb.failed

The spec has changed since skl_max_plane_width() was written.
Now the SKL limits are lower than what they were initially, and
GLK and ICL have different limits. Update the code to match the
spec.

	Signed-off-by: Ville Syrjälä <ville.syrjala@linux.intel.com>
Link: https://patchwork.freedesktop.org/patch/msgid/20190418195907.23912-1-ville.syrjala@linux.intel.com
	Reviewed-by: José Roberto de Souza <jose.souza@intel.com>
(cherry picked from commit 372b9ffb5799a3d5f4a9c51ac35cf65ed8f40101)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/i915/intel_display.c
diff --cc drivers/gpu/drm/i915/intel_display.c
index 98867581a27e,da9285228557..000000000000
--- a/drivers/gpu/drm/i915/intel_display.c
+++ b/drivers/gpu/drm/i915/intel_display.c
@@@ -3017,23 -3053,26 +3031,38 @@@ static bool skl_check_main_ccs_coordina
  	return true;
  }
  
 -static int skl_check_main_surface(struct intel_plane_state *plane_state)
 +static int skl_check_main_surface(const struct intel_crtc_state *crtc_state,
 +				  struct intel_plane_state *plane_state)
  {
++<<<<<<< HEAD
 +	struct drm_i915_private *dev_priv =
 +		to_i915(plane_state->base.plane->dev);
++=======
+ 	struct drm_i915_private *dev_priv = to_i915(plane_state->base.plane->dev);
++>>>>>>> 372b9ffb5799 (drm/i915: Fix skl+ max plane width)
  	const struct drm_framebuffer *fb = plane_state->base.fb;
  	unsigned int rotation = plane_state->base.rotation;
  	int x = plane_state->base.src.x1 >> 16;
  	int y = plane_state->base.src.y1 >> 16;
  	int w = drm_rect_width(&plane_state->base.src) >> 16;
  	int h = drm_rect_height(&plane_state->base.src) >> 16;
++<<<<<<< HEAD
 +	int dst_x = plane_state->base.dst.x1;
 +	int pipe_src_w = crtc_state->pipe_src_w;
 +	int max_width = skl_max_plane_width(fb, 0, rotation);
++=======
+ 	int max_width;
++>>>>>>> 372b9ffb5799 (drm/i915: Fix skl+ max plane width)
  	int max_height = 4096;
 -	u32 alignment, offset, aux_offset = plane_state->color_plane[1].offset;
 +	u32 alignment, offset, aux_offset = plane_state->aux.offset;
  
+ 	if (INTEL_GEN(dev_priv) >= 11)
+ 		max_width = icl_max_plane_width(fb, 0, rotation);
+ 	else if (INTEL_GEN(dev_priv) >= 10 || IS_GEMINILAKE(dev_priv))
+ 		max_width = glk_max_plane_width(fb, 0, rotation);
+ 	else
+ 		max_width = skl_max_plane_width(fb, 0, rotation);
+ 
  	if (w > max_width || h > max_height) {
  		DRM_DEBUG_KMS("requested Y/RGB source size %dx%d too big (limit %dx%d)\n",
  			      w, h, max_width, max_height);
* Unmerged path drivers/gpu/drm/i915/intel_display.c
