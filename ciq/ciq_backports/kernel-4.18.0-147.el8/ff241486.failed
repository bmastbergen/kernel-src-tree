KVM: nVMX: Move "vmcs12 to shadow/evmcs sync" to helper function

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Sean Christopherson <sean.j.christopherson@intel.com>
commit ff241486ac90671ddf7c18e38c474f32b832af3a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/ff241486.failed

...so that the function doesn't need to be created when moving the
nested code out of vmx.c.

	Signed-off-by: Sean Christopherson <sean.j.christopherson@intel.com>
	Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
(cherry picked from commit ff241486ac90671ddf7c18e38c474f32b832af3a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kvm/vmx/vmx.c
diff --cc arch/x86/kvm/vmx/vmx.c
index d9061399dcbb,7b3a539e18ad..000000000000
--- a/arch/x86/kvm/vmx/vmx.c
+++ b/arch/x86/kvm/vmx/vmx.c
@@@ -10927,17 -9157,8 +10951,22 @@@ static void __noclone vmx_vcpu_run(stru
  		vmcs_write32(PLE_WINDOW, vmx->ple_window);
  	}
  
++<<<<<<< HEAD
 +	if (vmx->nested.need_vmcs12_sync) {
 +		if (vmx->nested.hv_evmcs) {
 +			copy_vmcs12_to_enlightened(vmx);
 +			/* All fields are clean */
 +			vmx->nested.hv_evmcs->hv_clean_fields |=
 +				HV_VMX_ENLIGHTENED_CLEAN_FIELD_ALL;
 +		} else {
 +			copy_vmcs12_to_shadow(vmx);
 +		}
 +		vmx->nested.need_vmcs12_sync = false;
 +	}
++=======
+ 	if (vmx->nested.need_vmcs12_sync)
+ 		nested_sync_from_vmcs12(vcpu);
++>>>>>>> ff241486ac90 (KVM: nVMX: Move "vmcs12 to shadow/evmcs sync" to helper function)
  
  	if (test_bit(VCPU_REGS_RSP, (unsigned long *)&vcpu->arch.regs_dirty))
  		vmcs_writel(GUEST_RSP, vcpu->arch.regs[VCPU_REGS_RSP]);
* Unmerged path arch/x86/kvm/vmx/vmx.c
