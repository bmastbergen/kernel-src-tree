drm/i915/icl: Add WaDisableBankHangMode

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Tvrtko Ursulin <tvrtko.ursulin@intel.com>
commit cbe3e1d103793705204b29c6952faed537c41fe1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/cbe3e1d1.failed

Disable GPU hang by default on unrecoverable ECC cache errors.

v2:
 * Rebase.

v3:
 * Use intel_uncore_read. (Chris)

Fixes: cc38cae7c4e9 ("drm/i915/icl: Introduce initial Icelake Workarounds")
	Signed-off-by: Tvrtko Ursulin <tvrtko.ursulin@intel.com>
	Acked-by: Chris Wilson <chris@chris-wilson.co.uk>
Link: https://patchwork.freedesktop.org/patch/msgid/20190520110442.403-2-tvrtko.ursulin@linux.intel.com
(cherry picked from commit cbe3e1d103793705204b29c6952faed537c41fe1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/i915/gt/intel_workarounds.c
#	drivers/gpu/drm/i915/i915_reg.h
diff --cc drivers/gpu/drm/i915/i915_reg.h
index a78c6ef1f608,87e8780711d7..000000000000
--- a/drivers/gpu/drm/i915/i915_reg.h
+++ b/drivers/gpu/drm/i915/i915_reg.h
@@@ -7197,22 -7612,34 +7197,39 @@@ enum 
  
  /* GEN7 chicken */
  #define GEN7_COMMON_SLICE_CHICKEN1		_MMIO(0x7010)
++<<<<<<< HEAD
 +# define GEN7_CSC1_RHWO_OPT_DISABLE_IN_RCC	((1<<10) | (1<<26))
 +# define GEN9_RHWO_OPTIMIZATION_DISABLE		(1<<14)
 +#define COMMON_SLICE_CHICKEN2			_MMIO(0x7014)
 +# define GEN9_PBE_COMPRESSED_HASH_SELECTION	(1<<13)
 +# define GEN9_DISABLE_GATHER_AT_SET_SHADER_COMMON_SLICE (1<<12)
 +# define GEN8_SBE_DISABLE_REPLAY_BUF_OPTIMIZATION (1<<8)
 +# define GEN8_CSC2_SBE_VUE_CACHE_CONSERVATIVE	(1<<0)
++=======
+   #define GEN7_CSC1_RHWO_OPT_DISABLE_IN_RCC	((1 << 10) | (1 << 26))
+   #define GEN9_RHWO_OPTIMIZATION_DISABLE	(1 << 14)
+ 
+ #define COMMON_SLICE_CHICKEN2					_MMIO(0x7014)
+   #define GEN9_PBE_COMPRESSED_HASH_SELECTION			(1 << 13)
+   #define GEN9_DISABLE_GATHER_AT_SET_SHADER_COMMON_SLICE	(1 << 12)
+   #define GEN8_SBE_DISABLE_REPLAY_BUF_OPTIMIZATION		(1 << 8)
+   #define GEN8_CSC2_SBE_VUE_CACHE_CONSERVATIVE			(1 << 0)
+ 
+ #define GEN8_L3CNTLREG	_MMIO(0x7034)
+   #define GEN8_ERRDETBCTRL (1 << 9)
+ 
+ #define GEN11_COMMON_SLICE_CHICKEN3		_MMIO(0x7304)
+   #define GEN11_BLEND_EMB_FIX_DISABLE_IN_RCC	(1 << 11)
++>>>>>>> cbe3e1d10379 (drm/i915/icl: Add WaDisableBankHangMode)
  
  #define HIZ_CHICKEN					_MMIO(0x7018)
 -# define CHV_HZ_8X8_MODE_IN_1X				(1 << 15)
 -# define BDW_HIZ_POWER_COMPILER_CLOCK_GATING_DISABLE	(1 << 3)
 +# define CHV_HZ_8X8_MODE_IN_1X				(1<<15)
 +# define BDW_HIZ_POWER_COMPILER_CLOCK_GATING_DISABLE	(1<<3)
  
  #define GEN9_SLICE_COMMON_ECO_CHICKEN0		_MMIO(0x7308)
 -#define  DISABLE_PIXEL_MASK_CAMMING		(1 << 14)
 +#define  DISABLE_PIXEL_MASK_CAMMING		(1<<14)
  
  #define GEN9_SLICE_COMMON_ECO_CHICKEN1		_MMIO(0x731c)
 -#define   GEN11_STATE_CACHE_REDIRECT_TO_CS	(1 << 11)
 -
 -#define GEN7_SARCHKMD				_MMIO(0xB000)
 -#define GEN7_DISABLE_DEMAND_PREFETCH		(1 << 31)
 -#define GEN7_DISABLE_SAMPLER_PREFETCH           (1 << 30)
  
  #define GEN7_L3SQCREG1				_MMIO(0xB010)
  #define  VLV_B0_WA_L3SQCREG1_VALUE		0x00D30000
* Unmerged path drivers/gpu/drm/i915/gt/intel_workarounds.c
* Unmerged path drivers/gpu/drm/i915/gt/intel_workarounds.c
* Unmerged path drivers/gpu/drm/i915/i915_reg.h
