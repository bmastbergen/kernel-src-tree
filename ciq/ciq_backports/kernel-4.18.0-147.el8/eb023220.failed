scsi: qla2xxx: Remove a set-but-not-used variable

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-147.el8
commit-author Bart Van Assche <bvanassche@acm.org>
commit eb023220f4eac1703e22e48ed62310a6565b3a1f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-147.el8/eb023220.failed

This patch does not change any functionality.

	Cc: Himanshu Madhani <himanshu.madhani@cavium.com>
	Signed-off-by: Bart Van Assche <bvanassche@acm.org>
	Acked-by: Himanshu Madhani <himanshu.madhani@cavium.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit eb023220f4eac1703e22e48ed62310a6565b3a1f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/qla2xxx/qla_os.c
diff --cc drivers/scsi/qla2xxx/qla_os.c
index f96b2070edf0,01607d2f2c34..000000000000
--- a/drivers/scsi/qla2xxx/qla_os.c
+++ b/drivers/scsi/qla2xxx/qla_os.c
@@@ -1745,45 -1786,33 +1745,56 @@@ __qla2x00_abort_all_cmds(struct qla_qpa
  				    !qla2x00_isp_reg_stat(ha) &&
  				    (sp->type == SRB_SCSI_CMD)) {
  					/*
 -					 * Don't abort commands in adapter
 -					 * during EEH recovery as it's not
 +					 * Don't abort commands in
 +					 * adapter during EEH
 +					 * recovery as it's not
  					 * accessible/responding.
  					 *
 -					 * Get a reference to the sp and drop
 -					 * the lock. The reference ensures this
 -					 * sp->done() call and not the call in
 -					 * qla2xxx_eh_abort() ends the SCSI cmd
 -					 * (with result 'res').
 +					 * Get a reference to the sp
 +					 * and drop the lock. The
 +					 * reference ensures this
 +					 * sp->done() call and not the
 +					 * call in qla2xxx_eh_abort()
 +					 * ends the SCSI command (with
 +					 * result 'res').
 +					 */
++<<<<<<< HEAD
 +					sp_get(sp);
 +					spin_unlock_irqrestore(qp->qp_lock_ptr,
 +					    flags);
 +					status = qla2xxx_eh_abort(
 +					    GET_CMD_SP(sp));
 +					spin_lock_irqsave(qp->qp_lock_ptr,
 +					    flags);
 +					/*
 +					 * Get rid of extra reference
 +					 * if immediate exit from
 +					 * ql2xxx_eh_abort
  					 */
 +					if (status == FAILED &&
 +					    (qla2x00_isp_reg_stat(ha)))
 +						atomic_dec(
 +						    &sp->ref_count);
++=======
+ 					if (!sp_get(sp)) {
+ 						spin_unlock_irqrestore
+ 							(qp->qp_lock_ptr, flags);
+ 						qla2xxx_eh_abort(
+ 							GET_CMD_SP(sp));
+ 						spin_lock_irqsave
+ 							(qp->qp_lock_ptr, flags);
+ 					}
++>>>>>>> eb023220f4ea (scsi: qla2xxx: Remove a set-but-not-used variable)
  				}
  				sp->done(sp, res);
 -				break;
 -			case TYPE_TGT_CMD:
 +			} else {
  				if (!vha->hw->tgt.tgt_ops || !tgt ||
  				    qla_ini_mode_enabled(vha)) {
 -					ql_dbg(ql_dbg_tgt_mgt, vha, 0xf003,
 -					    "HOST-ABORT-HNDLR: dpc_flags=%lx. Target mode disabled\n",
 -					    vha->dpc_flags);
 +					if (!trace)
 +						ql_dbg(ql_dbg_tgt_mgt,
 +						    vha, 0xf003,
 +						    "HOST-ABORT-HNDLR: dpc_flags=%lx. Target mode disabled\n",
 +						    vha->dpc_flags);
  					continue;
  				}
  				cmd = (struct qla_tgt_cmd *)sp;
* Unmerged path drivers/scsi/qla2xxx/qla_os.c
