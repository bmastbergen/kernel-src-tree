powerpc/powernv: Fix opal-elog interrupt handler

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1160.11.1.el7
Rebuild_CHGLOG: - [powerpc] powernv: Fix opal-elog interrupt handler (Gustavo Duarte) [1873189]
Rebuild_FUZZ: 90.91%
commit-author Alistair Popple <alistair@popple.id.au>
commit a8956a7b7232da5f4ce4a305c72a54cc5e4a8307
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1160.11.1.el7/a8956a7b.failed

The conversion of opal events to a proper irqchip means that handlers
are called until the relevant opal event has been cleared by
processing it. Events that queue work should therefore use a threaded
handler to mask the event until processing is complete.

	Signed-off-by: Alistair Popple <alistair@popple.id.au>
	Tested-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com>
	Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
(cherry picked from commit a8956a7b7232da5f4ce4a305c72a54cc5e4a8307)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/powerpc/platforms/powernv/opal-elog.c
diff --cc arch/powerpc/platforms/powernv/opal-elog.c
index 3f400347ed59,37f959bf392e..000000000000
--- a/arch/powerpc/platforms/powernv/opal-elog.c
+++ b/arch/powerpc/platforms/powernv/opal-elog.c
@@@ -275,21 -269,11 +275,20 @@@ static irqreturn_t elog_event(int irq, 
  	 * that gracefully and not create two conflicting
  	 * entries.
  	 */
++<<<<<<< HEAD
 +	kobj = kset_find_obj(elog_kset, name);
 +	if (kobj) {
 +		/* Drop reference added by kset_find_obj() */
 +		kobject_put(kobj);
 +		return;
 +	}
++=======
+ 	if (kset_find_obj(elog_kset, name))
+ 		return IRQ_HANDLED;
++>>>>>>> a8956a7b7232 (powerpc/powernv: Fix opal-elog interrupt handler)
  
  	create_elog_obj(log_id, elog_size, elog_type);
- }
  
- static DECLARE_WORK(elog_work, elog_work_fn);
- 
- static irqreturn_t elog_event(int irq, void *data)
- {
- 	schedule_work(&elog_work);
  	return IRQ_HANDLED;
  }
  
* Unmerged path arch/powerpc/platforms/powernv/opal-elog.c
