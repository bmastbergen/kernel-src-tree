s390/dasd: Use struct_size() helper

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1160.11.1.el7
Rebuild_CHGLOG: - [s390] dasd: Use struct_size() helper (Sterling Alexander) [1886477]
Rebuild_FUZZ: 92.31%
commit-author Gustavo A. R. Silva <gustavoars@kernel.org>
commit 10321aa17ae9ad9b1335d61aeabb6f63d38cc28e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1160.11.1.el7/10321aa1.failed

Make use of the struct_size() helper instead of an open-coded version
in order to avoid any potential type mistakes. Also, remove unnecessary
variable _datasize_.

This code was detected with the help of Coccinelle and, audited and
fixed manually.

	Signed-off-by: Gustavo A. R. Silva <gustavoars@kernel.org>
	Signed-off-by: Stefan Haberland <sth@linux.ibm.com>
	Signed-off-by: Jens Axboe <axboe@kernel.dk>
(cherry picked from commit 10321aa17ae9ad9b1335d61aeabb6f63d38cc28e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/s390/block/dasd_diag.c
diff --cc drivers/s390/block/dasd_diag.c
index f3e0fc74cec5,1b9e1442e6a5..000000000000
--- a/drivers/s390/block/dasd_diag.c
+++ b/drivers/s390/block/dasd_diag.c
@@@ -509,9 -513,9 +509,9 @@@ static struct dasd_ccw_req *dasd_diag_b
  	struct dasd_diag_req *dreq;
  	struct dasd_diag_bio *dbio;
  	struct req_iterator iter;
 -	struct bio_vec bv;
 +	struct bio_vec *bv;
  	char *dst;
- 	unsigned int count, datasize;
+ 	unsigned int count;
  	sector_t recid, first_rec, last_rec;
  	unsigned int blksize, off;
  	unsigned char rw_cmd;
@@@ -539,9 -543,8 +539,14 @@@
  	if (count != last_rec - first_rec + 1)
  		return ERR_PTR(-EINVAL);
  	/* Build the request */
++<<<<<<< HEAD
 +	datasize = sizeof(struct dasd_diag_req) +
 +		count*sizeof(struct dasd_diag_bio);
 +	cqr = dasd_smalloc_request(DASD_DIAG_MAGIC, 0, datasize, memdev);
++=======
+ 	cqr = dasd_smalloc_request(DASD_DIAG_MAGIC, 0, struct_size(dreq, bio, count),
+ 				   memdev, blk_mq_rq_to_pdu(req));
++>>>>>>> 10321aa17ae9 (s390/dasd: Use struct_size() helper)
  	if (IS_ERR(cqr))
  		return cqr;
  
* Unmerged path drivers/s390/block/dasd_diag.c
