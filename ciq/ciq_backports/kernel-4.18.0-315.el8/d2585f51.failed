lib: kunit: add bitfield test conversion to KUnit

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-315.el8
commit-author Vitor Massaru Iha <vitor@massaru.org>
commit d2585f5164c298aaaed14c2c8d313cbe7bd5b253
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-315.el8/d2585f51.failed

This adds the conversion of the runtime tests of test_bitfield,
from `lib/test_bitfield.c` to KUnit tests.

Code Style Documentation: [0]

	Signed-off-by: Vitor Massaru Iha <vitor@massaru.org>
Link: [0] https://lore.kernel.org/linux-kselftest/20200620054944.167330-1-davidgow@google.com/T/#u
	Reviewed-by: Brendan Higgins <brendanhiggins@google.com>
	Signed-off-by: Shuah Khan <skhan@linuxfoundation.org>
(cherry picked from commit d2585f5164c298aaaed14c2c8d313cbe7bd5b253)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	lib/Makefile
#	lib/bitfield_kunit.c
diff --cc lib/Makefile
index a38ab674cad9,d862d41fdc3d..000000000000
--- a/lib/Makefile
+++ b/lib/Makefile
@@@ -81,6 -79,7 +81,10 @@@ obj-$(CONFIG_TEST_STATIC_KEYS) += test_
  obj-$(CONFIG_TEST_STATIC_KEYS) += test_static_key_base.o
  obj-$(CONFIG_TEST_PRINTF) += test_printf.o
  obj-$(CONFIG_TEST_BITMAP) += test_bitmap.o
++<<<<<<< HEAD
++=======
+ obj-$(CONFIG_TEST_STRSCPY) += test_strscpy.o
++>>>>>>> d2585f5164c2 (lib: kunit: add bitfield test conversion to KUnit)
  obj-$(CONFIG_TEST_UUID) += test_uuid.o
  obj-$(CONFIG_TEST_XARRAY) += test_xarray.o
  obj-$(CONFIG_TEST_PARMAN) += test_parman.o
@@@ -293,5 -339,7 +297,6 @@@ obj-$(CONFIG_OBJAGG) += objagg.
  obj-$(CONFIG_PLDMFW) += pldmfw/
  
  # KUnit tests
+ obj-$(CONFIG_BITFIELD_KUNIT) += bitfield_kunit.o
  obj-$(CONFIG_LIST_KUNIT_TEST) += list-test.o
  obj-$(CONFIG_LINEAR_RANGES_TEST) += test_linear_ranges.o
 -obj-$(CONFIG_BITS_TEST) += test_bits.o
* Unmerged path lib/bitfield_kunit.c
diff --git a/lib/Kconfig.debug b/lib/Kconfig.debug
index 07d075a7e5cc..66123a243a3a 100644
--- a/lib/Kconfig.debug
+++ b/lib/Kconfig.debug
@@ -2059,6 +2059,22 @@ config TEST_SYSCTL
 
 	  If unsure, say N.
 
+config BITFIELD_KUNIT
+	tristate "KUnit test bitfield functions at runtime"
+	depends on KUNIT
+	help
+	  Enable this option to test the bitfield functions at boot.
+
+	  KUnit tests run during boot and output the results to the debug log
+	  in TAP format (http://testanything.org/). Only useful for kernel devs
+	  running the KUnit test harness, and not intended for inclusion into a
+	  production build.
+
+	  For more information on KUnit and unit tests in general please refer
+	  to the KUnit documentation in Documentation/dev-tools/kunit/.
+
+	  If unsure, say N.
+
 config SYSCTL_KUNIT_TEST
 	tristate "KUnit test for sysctl" if !KUNIT_ALL_TESTS
 	depends on KUNIT
* Unmerged path lib/Makefile
* Unmerged path lib/bitfield_kunit.c
