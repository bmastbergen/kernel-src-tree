mt76: mt7663: fix when beacon filter is being applied

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-315.el8
commit-author Sean Wang <sean.wang@mediatek.com>
commit 4bec61d9fb9629c21e60cd24a97235ea1f6020ec
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-315.el8/4bec61d9.failed

HW beacon filter command is being applied until we're in associated state
because the command would rely on the associated access point's beacon
interval and DTIM information.

Fixes: 7124198ab1a4 ("mt76: mt7615: enable beacon filtering by default for offload fw")
	Signed-off-by: Sean Wang <sean.wang@mediatek.com>
	Signed-off-by: Felix Fietkau <nbd@nbd.name>
(cherry picked from commit 4bec61d9fb9629c21e60cd24a97235ea1f6020ec)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/wireless/mediatek/mt76/mt7615/main.c
diff --cc drivers/net/wireless/mediatek/mt76/mt7615/main.c
index f8409002c8b6,342e2c5d9766..000000000000
--- a/drivers/net/wireless/mediatek/mt76/mt7615/main.c
+++ b/drivers/net/wireless/mediatek/mt76/mt7615/main.c
@@@ -228,11 -235,9 +228,9 @@@ static int mt7615_add_interface(struct 
  		mtxq->wcid = &mvif->sta.wcid;
  	}
  
 -	ret = mt7615_mcu_add_dev_info(phy, vif, true);
 +	ret = mt7615_mcu_add_dev_info(dev, vif, true);
  	if (ret)
  		goto out;
- 
- 	mt7615_mac_set_beacon_filter(phy, vif, true);
  out:
  	mt7615_mutex_release(dev);
  
@@@ -256,10 -261,9 +254,14 @@@ static void mt7615_remove_interface(str
  	if (vif == phy->monitor_vif)
  	    phy->monitor_vif = NULL;
  
 -	mt76_connac_free_pending_tx_skbs(&dev->pm, &msta->wcid);
 +	mt7615_free_pending_tx_skbs(dev, msta);
  
++<<<<<<< HEAD
 +	mt7615_mac_set_beacon_filter(phy, vif, false);
 +	mt7615_mcu_add_dev_info(dev, vif, false);
++=======
+ 	mt7615_mcu_add_dev_info(phy, vif, false);
++>>>>>>> 4bec61d9fb96 (mt76: mt7663: fix when beacon filter is being applied)
  
  	rcu_assign_pointer(dev->mt76.wcid[idx], NULL);
  
* Unmerged path drivers/net/wireless/mediatek/mt76/mt7615/main.c
