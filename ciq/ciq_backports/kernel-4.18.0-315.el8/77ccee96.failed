netfilter: nf_log_bridge: merge with nf_log_syslog

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-315.el8
commit-author Florian Westphal <fw@strlen.de>
commit 77ccee96a67422ac05fc47327cac4e4287fd0d8a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-315.el8/77ccee96.failed

Provide bridge log support from nf_log_syslog.

After the merge there is no need to load the "real packet loggers",
all of them now reside in the same module.

	Signed-off-by: Florian Westphal <fw@strlen.de>
	Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
(cherry picked from commit 77ccee96a67422ac05fc47327cac4e4287fd0d8a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/bridge/netfilter/Makefile
#	net/bridge/netfilter/nf_log_bridge.c
#	net/netfilter/nf_log_syslog.c
diff --cc net/bridge/netfilter/Makefile
index 9b868861f21a,1c9ce49ab651..000000000000
--- a/net/bridge/netfilter/Makefile
+++ b/net/bridge/netfilter/Makefile
@@@ -3,10 -3,11 +3,15 @@@
  # Makefile for the netfilter modules for Link Layer filtering on a bridge.
  #
  
 -obj-$(CONFIG_NFT_BRIDGE_META)  += nft_meta_bridge.o
  obj-$(CONFIG_NFT_BRIDGE_REJECT)  += nft_reject_bridge.o
  
++<<<<<<< HEAD
 +# packet logging
 +obj-$(CONFIG_NF_LOG_BRIDGE) += nf_log_bridge.o
++=======
+ # connection tracking
+ obj-$(CONFIG_NF_CONNTRACK_BRIDGE) += nf_conntrack_bridge.o
++>>>>>>> 77ccee96a674 (netfilter: nf_log_bridge: merge with nf_log_syslog)
  
  obj-$(CONFIG_BRIDGE_NF_EBTABLES) += ebtables.o
  
* Unmerged path net/bridge/netfilter/nf_log_bridge.c
* Unmerged path net/netfilter/nf_log_syslog.c
diff --git a/include/net/netfilter/nf_log.h b/include/net/netfilter/nf_log.h
index 716db4a0fed8..a6b85068c294 100644
--- a/include/net/netfilter/nf_log.h
+++ b/include/net/netfilter/nf_log.h
@@ -68,7 +68,6 @@ void nf_log_unbind_pf(struct net *net, u_int8_t pf);
 
 int nf_logger_find_get(int pf, enum nf_log_type type);
 void nf_logger_put(int pf, enum nf_log_type type);
-void nf_logger_request_module(int pf, enum nf_log_type type);
 
 #define MODULE_ALIAS_NF_LOGGER(family, type) \
 	MODULE_ALIAS("nf-logger-" __stringify(family) "-" __stringify(type))
diff --git a/net/bridge/netfilter/Kconfig b/net/bridge/netfilter/Kconfig
index 9a0159aebe1a..59fa01d19f5e 100644
--- a/net/bridge/netfilter/Kconfig
+++ b/net/bridge/netfilter/Kconfig
@@ -14,10 +14,6 @@ config NFT_BRIDGE_REJECT
 	help
 	  Add support to reject packets.
 
-config NF_LOG_BRIDGE
-	tristate "Bridge packet logging"
-	select NF_LOG_COMMON
-
 endif # NF_TABLES_BRIDGE
 
 menuconfig BRIDGE_NF_EBTABLES
* Unmerged path net/bridge/netfilter/Makefile
* Unmerged path net/bridge/netfilter/nf_log_bridge.c
diff --git a/net/netfilter/nf_log.c b/net/netfilter/nf_log.c
index a61d6df6e5f6..7758424157ef 100644
--- a/net/netfilter/nf_log.c
+++ b/net/netfilter/nf_log.c
@@ -150,13 +150,6 @@ void nf_log_unbind_pf(struct net *net, u_int8_t pf)
 }
 EXPORT_SYMBOL(nf_log_unbind_pf);
 
-void nf_logger_request_module(int pf, enum nf_log_type type)
-{
-	if (loggers[pf][type] == NULL)
-		request_module("nf-logger-%u-%u", pf, type);
-}
-EXPORT_SYMBOL_GPL(nf_logger_request_module);
-
 int nf_logger_find_get(int pf, enum nf_log_type type)
 {
 	struct nf_logger *logger;
* Unmerged path net/netfilter/nf_log_syslog.c
