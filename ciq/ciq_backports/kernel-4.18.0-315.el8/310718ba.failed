mt76: connac: do not run mt76_txq_schedule_all directly

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-315.el8
commit-author Lorenzo Bianconi <lorenzo@kernel.org>
commit 310718ba6a13a5d0d65ea1ea338ea9f9f992dacf
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-315.el8/310718ba.failed

In order to not break runtime-pm, do run mt76_txq_schedule_all in
mt7615_set_channel/mt7921_set_channel but rely on mt76_worker_schedule

	Signed-off-by: Lorenzo Bianconi <lorenzo@kernel.org>
	Signed-off-by: Felix Fietkau <nbd@nbd.name>
(cherry picked from commit 310718ba6a13a5d0d65ea1ea338ea9f9f992dacf)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/wireless/mediatek/mt76/mt7615/main.c
diff --cc drivers/net/wireless/mediatek/mt76/mt7615/main.c
index afc5e9e969e2,39733b351ac4..000000000000
--- a/drivers/net/wireless/mediatek/mt76/mt7615/main.c
+++ b/drivers/net/wireless/mediatek/mt76/mt7615/main.c
@@@ -332,10 -351,10 +332,17 @@@ out
  
  	mt7615_mutex_release(dev);
  
++<<<<<<< HEAD
 +	mt76_txq_schedule_all(phy->mt76);
 +
 +	if (!mt76_testmode_enabled(&dev->mt76))
 +		ieee80211_queue_delayed_work(phy->mt76->hw, &phy->mac_work,
++=======
+ 	mt76_worker_schedule(&dev->mt76.tx_worker);
+ 	if (!mt76_testmode_enabled(phy->mt76))
+ 		ieee80211_queue_delayed_work(phy->mt76->hw,
+ 					     &phy->mt76->mac_work,
++>>>>>>> 310718ba6a13 (mt76: connac: do not run mt76_txq_schedule_all directly)
  					     MT7615_WATCHDOG_TIME);
  
  	return ret;
* Unmerged path drivers/net/wireless/mediatek/mt76/mt7615/main.c
diff --git a/drivers/net/wireless/mediatek/mt76/mt7921/main.c b/drivers/net/wireless/mediatek/mt76/mt7921/main.c
index c3e38909c927..94f485ac1693 100644
--- a/drivers/net/wireless/mediatek/mt76/mt7921/main.c
+++ b/drivers/net/wireless/mediatek/mt76/mt7921/main.c
@@ -366,8 +366,7 @@ int mt7921_set_channel(struct mt7921_phy *phy)
 	clear_bit(MT76_RESET, &phy->mt76->state);
 	mutex_unlock(&dev->mt76.mutex);
 
-	mt76_txq_schedule_all(phy->mt76);
-
+	mt76_worker_schedule(&dev->mt76.tx_worker);
 	ieee80211_queue_delayed_work(phy->mt76->hw, &phy->mt76->mac_work,
 				     MT7921_WATCHDOG_TIME);
 
