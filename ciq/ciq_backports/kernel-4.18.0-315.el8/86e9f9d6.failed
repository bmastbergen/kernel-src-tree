EDAC/mce_amd: Make fam_ops static global

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-315.el8
commit-author Borislav Petkov <bp@suse.de>
commit 86e9f9d60eb5e0c5d99ddf6b79f4d308d6453bd0
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-315.el8/86e9f9d6.failed

... and do not kmalloc a three-pointer struct. Which simplifies
mce_amd_init() a bit.

No functional changes.

	Signed-off-by: Borislav Petkov <bp@suse.de>
Link: https://lkml.kernel.org/r/20200116163403.GF27148@zn.tnic
(cherry picked from commit 86e9f9d60eb5e0c5d99ddf6b79f4d308d6453bd0)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/edac/mce_amd.c
diff --cc drivers/edac/mce_amd.c
index e5718eeadad4,ea980c556f2e..000000000000
--- a/drivers/edac/mce_amd.c
+++ b/drivers/edac/mce_amd.c
@@@ -1184,13 -1182,10 +1185,9 @@@ static int __init mce_amd_init(void
  {
  	struct cpuinfo_x86 *c = &boot_cpu_data;
  
 -	if (c->x86_vendor != X86_VENDOR_AMD &&
 -	    c->x86_vendor != X86_VENDOR_HYGON)
 +	if (c->x86_vendor != X86_VENDOR_AMD)
  		return -ENODEV;
  
- 	fam_ops = kzalloc(sizeof(struct amd_decoder_ops), GFP_KERNEL);
- 	if (!fam_ops)
- 		return -ENOMEM;
- 
  	if (boot_cpu_has(X86_FEATURE_SMCA)) {
  		xec_mask = 0x3f;
  		goto out;
@@@ -1244,9 -1239,8 +1241,14 @@@
  
  	case 0x17:
  	case 0x18:
++<<<<<<< HEAD
 +		pr_warn_once("Decoding supported only on Scalable MCA processors.\n");
 +		goto err_out;
 +		break;
++=======
+ 		pr_warn("Decoding supported only on Scalable MCA processors.\n");
+ 		return -EINVAL;
++>>>>>>> 86e9f9d60eb5 (EDAC/mce_amd: Make fam_ops static global)
  
  	default:
  		printk(KERN_WARNING "Huh? What family is it: 0x%x?!\n", c->x86);
* Unmerged path drivers/edac/mce_amd.c
