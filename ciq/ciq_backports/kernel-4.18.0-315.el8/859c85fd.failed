mt76: mt7921: always wake the device in mt7921_remove_interface

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-315.el8
commit-author Lorenzo Bianconi <lorenzo@kernel.org>
commit 859c85fd19715349ce01539459095fd5fc7e483a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-315.el8/859c85fd.failed

Make sure the mcu is not in sleep mode before sending mcu messages in
mt7921_remove_interface routine.

Fixes: 1d8efc741df80 ("mt76: mt7921: introduce Runtime PM support")
Co-developed-by: Sean Wang <sean.wang@mediatek.com>
	Signed-off-by: Sean Wang <sean.wang@mediatek.com>
Co-developed-by: Leon Yen <leon.yen@mediatek.com>
	Signed-off-by: Leon Yen <leon.yen@mediatek.com>
	Signed-off-by: Lorenzo Bianconi <lorenzo@kernel.org>
	Signed-off-by: Felix Fietkau <nbd@nbd.name>
(cherry picked from commit 859c85fd19715349ce01539459095fd5fc7e483a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/wireless/mediatek/mt76/mt7921/main.c
diff --cc drivers/net/wireless/mediatek/mt76/mt7921/main.c
index f61698791235,06a47cab494e..000000000000
--- a/drivers/net/wireless/mediatek/mt76/mt7921/main.c
+++ b/drivers/net/wireless/mediatek/mt76/mt7921/main.c
@@@ -330,14 -354,15 +330,23 @@@ static void mt7921_remove_interface(str
  	if (vif == phy->monitor_vif)
  		phy->monitor_vif = NULL;
  
++<<<<<<< HEAD
 +	mt7921_mcu_uni_add_dev(dev, vif, false);
 +
 +	rcu_assign_pointer(dev->mt76.wcid[idx], NULL);
 +
 +	mutex_lock(&dev->mt76.mutex);
++=======
+ 	mt7921_mutex_acquire(dev);
+ 	mt76_connac_free_pending_tx_skbs(&dev->pm, &msta->wcid);
+ 	mt76_connac_mcu_uni_add_dev(&dev->mphy, vif, &mvif->sta.wcid, false);
+ 
+ 	rcu_assign_pointer(dev->mt76.wcid[idx], NULL);
+ 
++>>>>>>> 859c85fd1971 (mt76: mt7921: always wake the device in mt7921_remove_interface)
  	dev->mt76.vif_mask &= ~BIT(mvif->mt76.idx);
  	phy->omac_mask &= ~BIT_ULL(mvif->mt76.omac_idx);
 -	mt7921_mutex_release(dev);
 +	mutex_unlock(&dev->mt76.mutex);
  
  	spin_lock_bh(&dev->sta_poll_lock);
  	if (!list_empty(&msta->poll_list))
* Unmerged path drivers/net/wireless/mediatek/mt76/mt7921/main.c
