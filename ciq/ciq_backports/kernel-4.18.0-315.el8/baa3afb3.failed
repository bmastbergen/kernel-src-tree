mt76: connac: always check return value from mt76_connac_mcu_alloc_wtbl_req

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-315.el8
commit-author Lorenzo Bianconi <lorenzo@kernel.org>
commit baa3afb39e94965f4ca5b5d3d274379504b8fa24
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-315.el8/baa3afb3.failed

Even if this is not a real bug since mt76_connac_mcu_alloc_wtbl_req routine
can fails just if nskb is NULL , always check return value from
mt76_connac_mcu_alloc_wtbl_req in order to avoid possible future
mistake.

	Reported-by: Dan Carpenter <dan.carpenter@oracle.com>
	Signed-off-by: Lorenzo Bianconi <lorenzo@kernel.org>
	Signed-off-by: Felix Fietkau <nbd@nbd.name>
(cherry picked from commit baa3afb39e94965f4ca5b5d3d274379504b8fa24)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/wireless/mediatek/mt76/mt7615/mcu.c
#	drivers/net/wireless/mediatek/mt76/mt76_connac_mcu.c
diff --cc drivers/net/wireless/mediatek/mt76/mt7615/mcu.c
index bb481662d3c5,4ecbd5406e2a..000000000000
--- a/drivers/net/wireless/mediatek/mt76/mt7615/mcu.c
+++ b/drivers/net/wireless/mediatek/mt76/mt7615/mcu.c
@@@ -1417,13 -1034,17 +1417,23 @@@ mt7615_mcu_sta_ba(struct mt7615_dev *de
  	if (IS_ERR(skb))
  		return PTR_ERR(skb);
  
 -	mt76_connac_mcu_sta_ba_tlv(skb, params, enable, tx);
 +	mt7615_mcu_sta_ba_tlv(skb, params, enable, tx);
  
 -	sta_wtbl = mt76_connac_mcu_add_tlv(skb, STA_REC_WTBL, sizeof(struct tlv));
 +	sta_wtbl = mt7615_mcu_add_tlv(skb, STA_REC_WTBL, sizeof(struct tlv));
  
++<<<<<<< HEAD
 +	wtbl_hdr = mt7615_mcu_alloc_wtbl_req(dev, msta, WTBL_SET, sta_wtbl,
 +					     &skb);
 +	mt7615_mcu_wtbl_ba_tlv(skb, params, enable, tx, sta_wtbl, wtbl_hdr);
++=======
+ 	wtbl_hdr = mt76_connac_mcu_alloc_wtbl_req(&dev->mt76, &msta->wcid,
+ 						  WTBL_SET, sta_wtbl, &skb);
+ 	if (IS_ERR(wtbl_hdr))
+ 		return PTR_ERR(wtbl_hdr);
+ 
+ 	mt76_connac_mcu_wtbl_ba_tlv(&dev->mt76, skb, params, enable, tx,
+ 				    sta_wtbl, wtbl_hdr);
++>>>>>>> baa3afb39e94 (mt76: connac: always check return value from mt76_connac_mcu_alloc_wtbl_req)
  
  	return mt76_mcu_skb_send_msg(&dev->mt76, skb,
  				     MCU_EXT_CMD_STA_REC_UPDATE, true);
* Unmerged path drivers/net/wireless/mediatek/mt76/mt76_connac_mcu.c
* Unmerged path drivers/net/wireless/mediatek/mt76/mt7615/mcu.c
* Unmerged path drivers/net/wireless/mediatek/mt76/mt76_connac_mcu.c
