netfilter: nf_log_common: merge with nf_log_syslog

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-315.el8
commit-author Florian Westphal <fw@strlen.de>
commit e465cccd0b9de113a81280bd52ee717bf5e3d1a2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-315.el8/e465cccd.failed

Remove nf_log_common.  Now that all per-af modules have been merged
there is no longer a need to provide a helper module.

	Signed-off-by: Florian Westphal <fw@strlen.de>
	Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
(cherry picked from commit e465cccd0b9de113a81280bd52ee717bf5e3d1a2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/netfilter/Kconfig
#	net/netfilter/Makefile
#	net/netfilter/nf_log_common.c
#	net/netfilter/nf_log_syslog.c
diff --cc net/netfilter/Kconfig
index 79b1a23cb51b,fcd8682704c4..000000000000
--- a/net/netfilter/Kconfig
+++ b/net/netfilter/Kconfig
@@@ -62,12 -71,17 +62,26 @@@ config NF_CONNTRAC
  
  	  To compile it as a module, choose M here.  If unsure, say N.
  
++<<<<<<< HEAD
 +config NF_LOG_COMMON
 +	tristate
 +
 +config NF_LOG_NETDEV
 +	tristate "Netdev packet logging"
 +	select NF_LOG_COMMON
++=======
+ config NF_LOG_SYSLOG
+ 	tristate "Syslog packet logging"
+ 	default m if NETFILTER_ADVANCED=n
+ 	help
+ 	  This option enable support for packet logging via syslog.
+ 	  It supports IPv4, IPV6, ARP and common transport protocols such
+ 	  as TCP and UDP.
+ 	  This is a simpler but less flexible logging method compared to
+ 	  CONFIG_NETFILTER_NETLINK_LOG.
+ 	  If both are enabled the backend to use can be configured at run-time
+ 	  by means of per-address-family sysctl tunables.
++>>>>>>> e465cccd0b9d (netfilter: nf_log_common: merge with nf_log_syslog)
  
  if NF_CONNTRACK
  config NETFILTER_CONNCOUNT
@@@ -896,9 -927,8 +910,14 @@@ config NETFILTER_XT_TARGET_LE
  
  config NETFILTER_XT_TARGET_LOG
  	tristate "LOG target support"
++<<<<<<< HEAD
 +	select NF_LOG_COMMON
 +	select NF_LOG_IPV4
 +	select NF_LOG_IPV6 if IPV6
++=======
+ 	select NF_LOG_SYSLOG
+ 	select NF_LOG_IPV6 if IP6_NF_IPTABLES
++>>>>>>> e465cccd0b9d (netfilter: nf_log_common: merge with nf_log_syslog)
  	default m if NETFILTER_ADVANCED=n
  	help
  	  This option adds a `LOG' target, which allows you to create rules in
diff --cc net/netfilter/Makefile
index a45cbb35948c,e80e010354b1..000000000000
--- a/net/netfilter/Makefile
+++ b/net/netfilter/Makefile
@@@ -47,11 -48,7 +47,15 @@@ obj-$(CONFIG_NF_CONNTRACK_TFTP) += nf_c
  
  nf_nat-y	:= nf_nat_core.o nf_nat_proto.o nf_nat_helper.o
  
++<<<<<<< HEAD
 +# generic transport layer logging
 +obj-$(CONFIG_NF_LOG_COMMON) += nf_log_common.o
 +
 +# packet logging for netdev family
 +obj-$(CONFIG_NF_LOG_NETDEV) += nf_log_netdev.o
++=======
+ obj-$(CONFIG_NF_LOG_SYSLOG) += nf_log_syslog.o
++>>>>>>> e465cccd0b9d (netfilter: nf_log_common: merge with nf_log_syslog)
  
  obj-$(CONFIG_NF_NAT) += nf_nat.o
  nf_nat-$(CONFIG_NF_NAT_REDIRECT) += nf_nat_redirect.o
* Unmerged path net/netfilter/nf_log_common.c
* Unmerged path net/netfilter/nf_log_syslog.c
diff --git a/include/net/netfilter/nf_log.h b/include/net/netfilter/nf_log.h
index 716db4a0fed8..add00ebf99f5 100644
--- a/include/net/netfilter/nf_log.h
+++ b/include/net/netfilter/nf_log.h
@@ -99,28 +99,4 @@ struct nf_log_buf;
 struct nf_log_buf *nf_log_buf_open(void);
 __printf(2, 3) int nf_log_buf_add(struct nf_log_buf *m, const char *f, ...);
 void nf_log_buf_close(struct nf_log_buf *m);
-
-/* common logging functions */
-int nf_log_dump_udp_header(struct nf_log_buf *m, const struct sk_buff *skb,
-			   u8 proto, int fragment, unsigned int offset);
-int nf_log_dump_tcp_header(struct nf_log_buf *m, const struct sk_buff *skb,
-			   u8 proto, int fragment, unsigned int offset,
-			   unsigned int logflags);
-void nf_log_dump_sk_uid_gid(struct net *net, struct nf_log_buf *m,
-			    struct sock *sk);
-void nf_log_dump_vlan(struct nf_log_buf *m, const struct sk_buff *skb);
-void nf_log_dump_packet_common(struct nf_log_buf *m, u_int8_t pf,
-			       unsigned int hooknum, const struct sk_buff *skb,
-			       const struct net_device *in,
-			       const struct net_device *out,
-			       const struct nf_loginfo *loginfo,
-			       const char *prefix);
-void nf_log_l2packet(struct net *net, u_int8_t pf,
-		     __be16 protocol,
-		     unsigned int hooknum,
-		     const struct sk_buff *skb,
-		     const struct net_device *in,
-		     const struct net_device *out,
-		     const struct nf_loginfo *loginfo, const char *prefix);
-
 #endif /* _NF_LOG_H */
* Unmerged path net/netfilter/Kconfig
* Unmerged path net/netfilter/Makefile
* Unmerged path net/netfilter/nf_log_common.c
* Unmerged path net/netfilter/nf_log_syslog.c
