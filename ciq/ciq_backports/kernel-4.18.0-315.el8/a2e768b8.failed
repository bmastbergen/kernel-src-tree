net/vlan: introduce skb_vlan_tag_get_cfi() helper

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-315.el8
commit-author Michał Mirosław <mirq-linux@rere.qmqm.pl>
commit a2e768b861108d846b6df21074cff738660b45b7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-315.el8/a2e768b8.failed

Abstract CFI/DEI bit access consistently with other VLAN tag fields.

	Signed-off-by: Michał Mirosław <mirq-linux@rere.qmqm.pl>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit a2e768b861108d846b6df21074cff738660b45b7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/linux/if_vlan.h
diff --cc include/linux/if_vlan.h
index 5b2044768195,4cca4da7a6de..000000000000
--- a/include/linux/if_vlan.h
+++ b/include/linux/if_vlan.h
@@@ -67,8 -65,7 +67,12 @@@ static inline struct vlan_ethhdr *vlan_
  
  #define VLAN_PRIO_MASK		0xe000 /* Priority Code Point */
  #define VLAN_PRIO_SHIFT		13
++<<<<<<< HEAD
 +#define VLAN_CFI_MASK		0x1000 /* Canonical Format Indicator */
 +#define VLAN_TAG_PRESENT	VLAN_CFI_MASK
++=======
+ #define VLAN_CFI_MASK		0x1000 /* Canonical Format Indicator / Drop Eligible Indicator */
++>>>>>>> a2e768b86110 (net/vlan: introduce skb_vlan_tag_get_cfi() helper)
  #define VLAN_VID_MASK		0x0fff /* VLAN Identifier */
  #define VLAN_N_VID		4096
  
@@@ -80,9 -77,10 +84,10 @@@ static inline bool is_vlan_dev(const st
          return dev->priv_flags & IFF_802_1Q_VLAN;
  }
  
 -#define skb_vlan_tag_present(__skb)	((__skb)->vlan_present)
 -#define skb_vlan_tag_get(__skb)		((__skb)->vlan_tci)
 +#define skb_vlan_tag_present(__skb)	((__skb)->vlan_tci & VLAN_TAG_PRESENT)
 +#define skb_vlan_tag_get(__skb)		((__skb)->vlan_tci & ~VLAN_TAG_PRESENT)
  #define skb_vlan_tag_get_id(__skb)	((__skb)->vlan_tci & VLAN_VID_MASK)
+ #define skb_vlan_tag_get_cfi(__skb)	(!!((__skb)->vlan_tci & VLAN_CFI_MASK))
  #define skb_vlan_tag_get_prio(__skb)	(((__skb)->vlan_tci & VLAN_PRIO_MASK) >> VLAN_PRIO_SHIFT)
  
  static inline int vlan_get_rx_ctag_filter_info(struct net_device *dev)
* Unmerged path include/linux/if_vlan.h
