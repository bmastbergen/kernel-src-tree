mt76: mt7915: add rx checksum offload support

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-315.el8
commit-author Felix Fietkau <nbd@nbd.name>
commit 94244d2ea503455cddec5a4de28d59c74e1aaf47
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-315.el8/94244d2e.failed

Set skb->ip_summed to CHECKSUM_UNNECESSARY if the hardware has validated
the IP and TCP/UDP checksum

	Signed-off-by: Felix Fietkau <nbd@nbd.name>
(cherry picked from commit 94244d2ea503455cddec5a4de28d59c74e1aaf47)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/wireless/mediatek/mt76/mt7915/mac.c
diff --cc drivers/net/wireless/mediatek/mt76/mt7915/mac.c
index 75cc60fe135a,83dd504e7bf1..000000000000
--- a/drivers/net/wireless/mediatek/mt76/mt7915/mac.c
+++ b/drivers/net/wireless/mediatek/mt76/mt7915/mac.c
@@@ -320,8 -321,10 +321,13 @@@ int mt7915_mac_fill_rx(struct mt7915_de
  	u32 rxd1 = le32_to_cpu(rxd[1]);
  	u32 rxd2 = le32_to_cpu(rxd[2]);
  	u32 rxd3 = le32_to_cpu(rxd[3]);
++<<<<<<< HEAD
++=======
+ 	u32 rxd4 = le32_to_cpu(rxd[4]);
+ 	u32 csum_mask = MT_RXD0_NORMAL_IP_SUM | MT_RXD0_NORMAL_UDP_TCP_SUM;
++>>>>>>> 94244d2ea503 (mt76: mt7915: add rx checksum offload support)
  	bool unicast, insert_ccmp_hdr = false;
 -	u8 remove_pad, amsdu_info;
 +	u8 remove_pad;
  	int i, idx;
  
  	memset(status, 0, sizeof(*status));
diff --git a/drivers/net/wireless/mediatek/mt76/mt7915/init.c b/drivers/net/wireless/mediatek/mt76/mt7915/init.c
index 49c09d0d8906..c833291db02d 100644
--- a/drivers/net/wireless/mediatek/mt76/mt7915/init.c
+++ b/drivers/net/wireless/mediatek/mt76/mt7915/init.c
@@ -249,6 +249,7 @@ mt7915_init_wiphy(struct ieee80211_hw *hw)
 	hw->queues = 4;
 	hw->max_rx_aggregation_subframes = IEEE80211_MAX_AMPDU_BUF;
 	hw->max_tx_aggregation_subframes = IEEE80211_MAX_AMPDU_BUF;
+	hw->netdev_features = NETIF_F_RXCSUM;
 
 	phy->slottime = 9;
 
* Unmerged path drivers/net/wireless/mediatek/mt76/mt7915/mac.c
