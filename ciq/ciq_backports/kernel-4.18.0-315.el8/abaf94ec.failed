nl80211: fix potential leak of ACL params

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-315.el8
commit-author Johannes Berg <johannes.berg@intel.com>
commit abaf94ecc9c356d0b885a84edef4905cdd89cfdd
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-315.el8/abaf94ec.failed

In case nl80211_parse_unsol_bcast_probe_resp() results in an
error, need to "goto out" instead of just returning to free
possibly allocated data.

Fixes: 7443dcd1f171 ("nl80211: Unsolicited broadcast probe response support")
Link: https://lore.kernel.org/r/20210408142833.d8bc2e2e454a.If290b1ba85789726a671ff0b237726d4851b5b0f@changeid
	Signed-off-by: Johannes Berg <johannes.berg@intel.com>
(cherry picked from commit abaf94ecc9c356d0b885a84edef4905cdd89cfdd)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/wireless/nl80211.c
diff --cc net/wireless/nl80211.c
index 2ac497914f6e,0d34cca38702..000000000000
--- a/net/wireless/nl80211.c
+++ b/net/wireless/nl80211.c
@@@ -5208,6 -5472,22 +5208,25 @@@ static int nl80211_start_ap(struct sk_b
  			goto out;
  	}
  
++<<<<<<< HEAD
++=======
+ 	if (info->attrs[NL80211_ATTR_FILS_DISCOVERY]) {
+ 		err = nl80211_parse_fils_discovery(rdev,
+ 						   info->attrs[NL80211_ATTR_FILS_DISCOVERY],
+ 						   &params);
+ 		if (err)
+ 			goto out;
+ 	}
+ 
+ 	if (info->attrs[NL80211_ATTR_UNSOL_BCAST_PROBE_RESP]) {
+ 		err = nl80211_parse_unsol_bcast_probe_resp(
+ 			rdev, info->attrs[NL80211_ATTR_UNSOL_BCAST_PROBE_RESP],
+ 			&params);
+ 		if (err)
+ 			goto out;
+ 	}
+ 
++>>>>>>> abaf94ecc9c3 (nl80211: fix potential leak of ACL params)
  	nl80211_calculate_ap_params(&params);
  
  	if (info->attrs[NL80211_ATTR_EXTERNAL_AUTH_SUPPORT])
* Unmerged path net/wireless/nl80211.c
