net: fix GRO skb truesize update

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-338.el8
commit-author Paolo Abeni <pabeni@redhat.com>
commit af352460b465d7a8afbeb3be07c0268d1d48a4d7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-338.el8/af352460.failed

commit 5e10da5385d2 ("skbuff: allow 'slow_gro' for skb carring sock
reference") introduces a serious regression at the GRO layer setting
the wrong truesize for stolen-head skbs.

Restore the correct truesize: SKB_DATA_ALIGN(...) instead of
SKB_TRUESIZE(...)

	Reported-by: Mat Martineau <mathew.j.martineau@linux.intel.com>
Fixes: 5e10da5385d2 ("skbuff: allow 'slow_gro' for skb carring sock reference")
	Signed-off-by: Paolo Abeni <pabeni@redhat.com>
	Tested-by: Mat Martineau <mathew.j.martineau@linux.intel.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit af352460b465d7a8afbeb3be07c0268d1d48a4d7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/core/skbuff.c
diff --cc net/core/skbuff.c
index 11454d214ad6,9240af2ea8c9..000000000000
--- a/net/core/skbuff.c
+++ b/net/core/skbuff.c
@@@ -4092,7 -4369,9 +4092,13 @@@ int skb_gro_receive(struct sk_buff *p, 
  		memcpy(frag + 1, skbinfo->frags, sizeof(*frag) * skbinfo->nr_frags);
  		/* We dont need to clear skbinfo->nr_frags here */
  
++<<<<<<< HEAD
 +		delta_truesize = skb->truesize - SKB_DATA_ALIGN(sizeof(struct sk_buff));
++=======
+ 		new_truesize = SKB_DATA_ALIGN(sizeof(struct sk_buff));
+ 		delta_truesize = skb->truesize - new_truesize;
+ 		skb->truesize = new_truesize;
++>>>>>>> af352460b465 (net: fix GRO skb truesize update)
  		NAPI_GRO_CB(skb)->free = NAPI_GRO_FREE_STOLEN_HEAD;
  		goto done;
  	}
* Unmerged path net/core/skbuff.c
