mmc: sdhci-pci: disable preset register for Baytrail and Merrifield

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [mmc] sdhci-pci: disable preset register for Baytrail and Merrifield (Don Zickus) [1127975 1277866 1280133 1286932 1297039]
Rebuild_FUZZ: 96.12%
commit-author Gao, Yunpeng <yunpeng.gao@intel.com>
commit b7574bad80f773dcc4c17950181cde9fb6701501
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/b7574bad.failed

Due to HW issue, SDHCI host controller on Intel
Baytrail/Merrifield platforms can not use preset
register. So, disable preset registers for them by quirks.

	Signed-off-by: Yunpeng Gao <yunpeng.gao@intel.com>
	Signed-off-by: Chuanxiao Dong <chuanxiao.dong@intel.com>
	Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
(cherry picked from commit b7574bad80f773dcc4c17950181cde9fb6701501)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/mmc/host/sdhci-pci.c
diff --cc drivers/mmc/host/sdhci-pci.c
index 7d850f6ecc74,580073bc164c..000000000000
--- a/drivers/mmc/host/sdhci-pci.c
+++ b/drivers/mmc/host/sdhci-pci.c
@@@ -277,6 -300,31 +279,34 @@@ static const struct sdhci_pci_fixes sdh
  	.own_cd_for_runtime_pm = true,
  };
  
++<<<<<<< HEAD
++=======
+ /* Define Host controllers for Intel Merrifield platform */
+ #define INTEL_MRFL_EMMC_0	0
+ #define INTEL_MRFL_EMMC_1	1
+ 
+ static int intel_mrfl_mmc_probe_slot(struct sdhci_pci_slot *slot)
+ {
+ 	if ((PCI_FUNC(slot->chip->pdev->devfn) != INTEL_MRFL_EMMC_0) &&
+ 	    (PCI_FUNC(slot->chip->pdev->devfn) != INTEL_MRFL_EMMC_1))
+ 		/* SD support is not ready yet */
+ 		return -ENODEV;
+ 
+ 	slot->host->mmc->caps |= MMC_CAP_8_BIT_DATA | MMC_CAP_NONREMOVABLE |
+ 				 MMC_CAP_1_8V_DDR;
+ 
+ 	return 0;
+ }
+ 
+ static const struct sdhci_pci_fixes sdhci_intel_mrfl_mmc = {
+ 	.quirks		= SDHCI_QUIRK_NO_ENDATTR_IN_NOPDESC,
+ 	.quirks2	= SDHCI_QUIRK2_BROKEN_HS200 |
+ 			SDHCI_QUIRK2_PRESET_VALUE_BROKEN,
+ 	.allow_runtime_pm = true,
+ 	.probe_slot	= intel_mrfl_mmc_probe_slot,
+ };
+ 
++>>>>>>> b7574bad80f7 (mmc: sdhci-pci: disable preset register for Baytrail and Merrifield)
  /* O2Micro extra registers */
  #define O2_SD_LOCK_WP		0xD3
  #define O2_SD_MULTI_VCC3V	0xEE
* Unmerged path drivers/mmc/host/sdhci-pci.c
