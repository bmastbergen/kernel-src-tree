dm: drop unnecessary assignment of md->queue

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Bob Liu <bob.liu@oracle.com>
commit e233d800a9648f2c0802aa23250d9c8af57bab43
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/e233d800.failed

md->queue and q are the same thing in dm_old_init_request_queue() and
dm_mq_init_request_queue().

Also drop the temporary 'struct request_queue *q' in
dm_old_init_request_queue().

	Signed-off-by: Bob Liu <bob.liu@oracle.com>
	Signed-off-by: Mike Snitzer <snitzer@redhat.com>
(cherry picked from commit e233d800a9648f2c0802aa23250d9c8af57bab43)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/md/dm.c
diff --cc drivers/md/dm.c
index b809eea744af,9c9272bdc364..000000000000
--- a/drivers/md/dm.c
+++ b/drivers/md/dm.c
@@@ -2797,26 -2650,22 +2797,27 @@@ static void init_rq_based_worker_thread
  }
  
  /*
 - * Fully initialize a .request_fn request-based queue.
 + * Fully initialize a request-based queue (->elevator, ->request_fn, etc).
   */
 -static int dm_old_init_request_queue(struct mapped_device *md)
 +static int dm_init_request_based_queue(struct mapped_device *md)
  {
- 	struct request_queue *q = NULL;
- 
  	/* Fully initialize the queue */
- 	q = blk_init_allocated_queue(md->queue, dm_request_fn, NULL);
- 	if (!q)
+ 	if (!blk_init_allocated_queue(md->queue, dm_request_fn, NULL))
  		return -EINVAL;
  
  	/* disable dm_request_fn's merge heuristic by default */
  	md->seq_rq_merge_deadline_usecs = 0;
  
++<<<<<<< HEAD
 +	md->queue = q;
 +	dm_init_old_md_queue(md);
++=======
+ 	dm_init_normal_md_queue(md);
++>>>>>>> e233d800a964 (dm: drop unnecessary assignment of md->queue)
  	blk_queue_softirq_done(md->queue, dm_softirq_done);
 -	blk_queue_prep_rq(md->queue, dm_old_prep_fn);
 +	blk_queue_prep_rq(md->queue, dm_prep_fn);
  
 -	dm_old_init_rq_based_worker_thread(md);
 +	init_rq_based_worker_thread(md);
  
  	elv_register_queue(md->queue);
  
* Unmerged path drivers/md/dm.c
