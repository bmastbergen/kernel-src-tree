staging/rdma/hfi1: Clean up register device

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [infiniband] rdma/hfi1: Clean up register device (Alex Estrin) [1272062 1273170]
Rebuild_FUZZ: 89.74%
commit-author Dennis Dalessandro <dennis.dalessandro@intel.com>
commit 4331629f57c4def899e560a7e3cb87fda577fb4b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/4331629f.failed

Now that rdmavt has solidified in its design we can clean up the driver
specific register device functions. This handles hfi1.

	Reviewed-by: Ira Weiny <ira.weiny@intel.com>
	Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 4331629f57c4def899e560a7e3cb87fda577fb4b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/staging/hfi1/verbs.c
diff --cc drivers/staging/hfi1/verbs.c
index d228eb7fc4f0,67999150921c..000000000000
--- a/drivers/staging/hfi1/verbs.c
+++ b/drivers/staging/hfi1/verbs.c
@@@ -1913,88 -1507,21 +1913,67 @@@ int hfi1_register_ib_device(struct hfi1
  	strlcpy(ibdev->name + lcpysz, "_%d", IB_DEVICE_NAME_MAX - lcpysz);
  	ibdev->owner = THIS_MODULE;
  	ibdev->node_guid = cpu_to_be64(ppd->guid);
- 	ibdev->uverbs_abi_ver = HFI1_UVERBS_ABI_VERSION;
- 	ibdev->uverbs_cmd_mask =
- 		(1ull << IB_USER_VERBS_CMD_GET_CONTEXT)         |
- 		(1ull << IB_USER_VERBS_CMD_QUERY_DEVICE)        |
- 		(1ull << IB_USER_VERBS_CMD_QUERY_PORT)          |
- 		(1ull << IB_USER_VERBS_CMD_ALLOC_PD)            |
- 		(1ull << IB_USER_VERBS_CMD_DEALLOC_PD)          |
- 		(1ull << IB_USER_VERBS_CMD_CREATE_AH)           |
- 		(1ull << IB_USER_VERBS_CMD_MODIFY_AH)           |
- 		(1ull << IB_USER_VERBS_CMD_QUERY_AH)            |
- 		(1ull << IB_USER_VERBS_CMD_DESTROY_AH)          |
- 		(1ull << IB_USER_VERBS_CMD_REG_MR)              |
- 		(1ull << IB_USER_VERBS_CMD_DEREG_MR)            |
- 		(1ull << IB_USER_VERBS_CMD_CREATE_COMP_CHANNEL) |
- 		(1ull << IB_USER_VERBS_CMD_CREATE_CQ)           |
- 		(1ull << IB_USER_VERBS_CMD_RESIZE_CQ)           |
- 		(1ull << IB_USER_VERBS_CMD_DESTROY_CQ)          |
- 		(1ull << IB_USER_VERBS_CMD_POLL_CQ)             |
- 		(1ull << IB_USER_VERBS_CMD_REQ_NOTIFY_CQ)       |
- 		(1ull << IB_USER_VERBS_CMD_CREATE_QP)           |
- 		(1ull << IB_USER_VERBS_CMD_QUERY_QP)            |
- 		(1ull << IB_USER_VERBS_CMD_MODIFY_QP)           |
- 		(1ull << IB_USER_VERBS_CMD_DESTROY_QP)          |
- 		(1ull << IB_USER_VERBS_CMD_POST_SEND)           |
- 		(1ull << IB_USER_VERBS_CMD_POST_RECV)           |
- 		(1ull << IB_USER_VERBS_CMD_ATTACH_MCAST)        |
- 		(1ull << IB_USER_VERBS_CMD_DETACH_MCAST)        |
- 		(1ull << IB_USER_VERBS_CMD_CREATE_SRQ)          |
- 		(1ull << IB_USER_VERBS_CMD_MODIFY_SRQ)          |
- 		(1ull << IB_USER_VERBS_CMD_QUERY_SRQ)           |
- 		(1ull << IB_USER_VERBS_CMD_DESTROY_SRQ)         |
- 		(1ull << IB_USER_VERBS_CMD_POST_SRQ_RECV);
- 	ibdev->node_type = RDMA_NODE_IB_CA;
  	ibdev->phys_port_cnt = dd->num_pports;
- 	ibdev->num_comp_vectors = 1;
  	ibdev->dma_device = &dd->pcidev->dev;
++<<<<<<< HEAD:drivers/staging/hfi1/verbs.c
 +	ibdev->query_device = query_device;
++=======
++>>>>>>> 4331629f57c4 (staging/rdma/hfi1: Clean up register device):drivers/staging/rdma/hfi1/verbs.c
  	ibdev->modify_device = modify_device;
  	ibdev->query_port = query_port;
  	ibdev->modify_port = modify_port;
- 	ibdev->query_pkey = NULL;
  	ibdev->query_gid = query_gid;
++<<<<<<< HEAD:drivers/staging/hfi1/verbs.c
 +	ibdev->alloc_ucontext = alloc_ucontext;
 +	ibdev->dealloc_ucontext = dealloc_ucontext;
 +	ibdev->alloc_pd = NULL;
 +	ibdev->dealloc_pd = NULL;
 +	ibdev->create_ah = create_ah;
 +	ibdev->destroy_ah = destroy_ah;
 +	ibdev->modify_ah = modify_ah;
 +	ibdev->query_ah = query_ah;
++=======
++>>>>>>> 4331629f57c4 (staging/rdma/hfi1: Clean up register device):drivers/staging/rdma/hfi1/verbs.c
  	ibdev->create_srq = hfi1_create_srq;
  	ibdev->modify_srq = hfi1_modify_srq;
  	ibdev->query_srq = hfi1_query_srq;
  	ibdev->destroy_srq = hfi1_destroy_srq;
++<<<<<<< HEAD:drivers/staging/hfi1/verbs.c
 +	ibdev->create_qp = hfi1_create_qp;
 +	ibdev->modify_qp = hfi1_modify_qp;
 +	ibdev->query_qp = hfi1_query_qp;
 +	ibdev->destroy_qp = hfi1_destroy_qp;
 +	ibdev->post_send = post_send;
 +	ibdev->post_recv = post_receive;
 +	ibdev->post_srq_recv = hfi1_post_srq_receive;
 +	ibdev->create_cq = hfi1_create_cq;
 +	ibdev->destroy_cq = hfi1_destroy_cq;
 +	ibdev->resize_cq = hfi1_resize_cq;
 +	ibdev->poll_cq = hfi1_poll_cq;
 +	ibdev->req_notify_cq = hfi1_req_notify_cq;
 +	ibdev->get_dma_mr = hfi1_get_dma_mr;
 +	ibdev->reg_phys_mr = hfi1_reg_phys_mr;
 +	ibdev->reg_user_mr = hfi1_reg_user_mr;
 +	ibdev->dereg_mr = hfi1_dereg_mr;
 +	ibdev->alloc_mr = hfi1_alloc_mr;
 +	ibdev->alloc_fast_reg_page_list = hfi1_alloc_fast_reg_page_list;
 +	ibdev->free_fast_reg_page_list = hfi1_free_fast_reg_page_list;
 +	ibdev->alloc_fmr = hfi1_alloc_fmr;
 +	ibdev->map_phys_fmr = hfi1_map_phys_fmr;
 +	ibdev->unmap_fmr = hfi1_unmap_fmr;
 +	ibdev->dealloc_fmr = hfi1_dealloc_fmr;
 +	ibdev->attach_mcast = hfi1_multicast_attach;
 +	ibdev->detach_mcast = hfi1_multicast_detach;
 +	ibdev->process_mad = hfi1_process_mad;
 +	ibdev->mmap = hfi1_mmap;
 +	ibdev->dma_ops = &hfi1_dma_mapping_ops;
++=======
+ 	ibdev->query_qp = hfi1_query_qp;
+ 	ibdev->post_srq_recv = hfi1_post_srq_receive;
+ 
+ 	/* keep process mad in the driver */
+ 	ibdev->process_mad = hfi1_process_mad;
++>>>>>>> 4331629f57c4 (staging/rdma/hfi1: Clean up register device):drivers/staging/rdma/hfi1/verbs.c
  	ibdev->get_port_immutable = port_immutable;
  
  	strncpy(ibdev->node_desc, init_utsname()->nodename,
* Unmerged path drivers/staging/hfi1/verbs.c
