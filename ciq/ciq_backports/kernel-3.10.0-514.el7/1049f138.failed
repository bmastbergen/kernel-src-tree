IB/mlx4: Take source mac from AH instead from the port

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Moni Shoua <monis@mellanox.com>
commit 1049f138166ad6ca2e1c8edd2317a71f5b21b9fe
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/1049f138.failed

In commit dbf727de7440 ("IB/core: Use GID table in AH creation and dmac
resolution") we copy source mac to mlx4_ah from the attributes of
gid at ib_ah_attr.grh.sgid_index. Now we can use it.

	Signed-off-by: Moni Shoua <monis@mellanox.com>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 1049f138166ad6ca2e1c8edd2317a71f5b21b9fe)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/mlx4/qp.c
diff --cc drivers/infiniband/hw/mlx4/qp.c
index 13bb6bffd98e,89f921f786b3..000000000000
--- a/drivers/infiniband/hw/mlx4/qp.c
+++ b/drivers/infiniband/hw/mlx4/qp.c
@@@ -2225,17 -2254,7 +2226,21 @@@ static int build_sriov_qp0_header(struc
  	return 0;
  }
  
++<<<<<<< HEAD
 +static void mlx4_u64_to_smac(u8 *dst_mac, u64 src_mac)
 +{
 +	int i;
 +
 +	for (i = ETH_ALEN; i; i--) {
 +		dst_mac[i - 1] = src_mac & 0xff;
 +		src_mac >>= 8;
 +	}
 +}
 +
 +static int build_mlx_header(struct mlx4_ib_sqp *sqp, struct ib_send_wr *wr,
++=======
+ static int build_mlx_header(struct mlx4_ib_sqp *sqp, struct ib_ud_wr *wr,
++>>>>>>> 1049f138166a (IB/mlx4: Take source mac from AH instead from the port)
  			    void *wqe, unsigned *mlx_seg_len)
  {
  	struct ib_device *ib_dev = sqp->qp.ibqp.device;
* Unmerged path drivers/infiniband/hw/mlx4/qp.c
