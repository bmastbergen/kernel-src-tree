ceph: avoid updating directory inode's i_size accidentally

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Yan, Zheng <zyan@redhat.com>
commit a3d714c33632ef6bfdfaacc74ae6ba297b4c5820
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/a3d714c3.failed

Directory inode's i_size is used by readdir cache.

	Signed-off-by: Yan, Zheng <zyan@redhat.com>
(cherry picked from commit a3d714c33632ef6bfdfaacc74ae6ba297b4c5820)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/ceph/inode.c
diff --cc fs/ceph/inode.c
index a649a586cda7,66edef12c6f2..000000000000
--- a/fs/ceph/inode.c
+++ b/fs/ceph/inode.c
@@@ -538,7 -549,11 +538,15 @@@ int ceph_fill_file_size(struct inode *i
  	if (ceph_seq_cmp(truncate_seq, ci->i_truncate_seq) > 0 ||
  	    (truncate_seq == ci->i_truncate_seq && size > inode->i_size)) {
  		dout("size %lld -> %llu\n", inode->i_size, size);
++<<<<<<< HEAD
 +		inode->i_size = size;
++=======
+ 		if (size > 0 && S_ISDIR(inode->i_mode)) {
+ 			pr_err("fill_file_size non-zero size for directory\n");
+ 			size = 0;
+ 		}
+ 		i_size_write(inode, size);
++>>>>>>> a3d714c33632 (ceph: avoid updating directory inode's i_size accidentally)
  		inode->i_blocks = (size + (1<<9) - 1) >> 9;
  		ci->i_reported_size = size;
  		if (truncate_seq != ci->i_truncate_seq) {
* Unmerged path fs/ceph/inode.c
