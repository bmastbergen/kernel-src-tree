net: allow setting mac address of loopback device

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [net] allow setting mac address of loopback device (Phil Sutter) [1152231]
Rebuild_FUZZ: 94.62%
commit-author WANG Cong <xiyou.wangcong@gmail.com>
commit 25f929fbff0d1bcebf2e92656d33025cd330cbf8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/25f929fb.failed

We are trying to mirror the local traffic from lo to eth0,
allowing setting mac address of lo to eth0 would make
the ether addresses in these packets correct, so that
we don't have to modify the ether header again.

Since usually no one cares about its mac address (all-zero),
it is safe to allow those who care to set its mac address.

	Cc: Hannes Frederic Sowa <hannes@stressinduktion.org>
	Cc: Neil Horman <nhorman@tuxdriver.com>
	Cc: Stephen Hemminger <stephen@networkplumber.org>
	Cc: Eric Dumazet <edumazet@google.com>
	Cc: David S. Miller <davem@davemloft.net>
	Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>
	Acked-by: Neil Horman <nhorman@tuxdriver.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 25f929fbff0d1bcebf2e92656d33025cd330cbf8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/loopback.c
diff --cc drivers/net/loopback.c
index 940b23d8c507,e7c1d5f8ab51..000000000000
--- a/drivers/net/loopback.c
+++ b/drivers/net/loopback.c
@@@ -168,7 -175,8 +169,12 @@@ static void loopback_setup(struct net_d
  	dev->tx_queue_len	= 0;
  	dev->type		= ARPHRD_LOOPBACK;	/* 0x0001*/
  	dev->flags		= IFF_LOOPBACK;
++<<<<<<< HEAD
 +	netif_keep_dst(dev);
++=======
+ 	dev->priv_flags		|= IFF_LIVE_ADDR_CHANGE;
+ 	dev->priv_flags	       &= ~IFF_XMIT_DST_RELEASE;
++>>>>>>> 25f929fbff0d (net: allow setting mac address of loopback device)
  	dev->hw_features	= NETIF_F_ALL_TSO | NETIF_F_UFO;
  	dev->features 		= NETIF_F_SG | NETIF_F_FRAGLIST
  		| NETIF_F_ALL_TSO
* Unmerged path drivers/net/loopback.c
