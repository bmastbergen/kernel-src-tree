MD: add new bit to indicate raid array with journal

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [md] add new bit to indicate raid array with journal (Jes Sorensen) [1250578 1265947 1273343 1299140 1307091 1312828 1320563 1340839]
Rebuild_FUZZ: 95.92%
commit-author Song Liu <songliubraving@fb.com>
commit a97b7896447a89749d9258fbb9d8c3faf48a7a4e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/a97b7896.failed

If a raid array has journal feature bit set, add a new bit to indicate
this. If the array is started without journal disk existing, we know
there is something wrong.

	Signed-off-by: Song Liu <songliubraving@fb.com>
	Signed-off-by: Shaohua Li <shli@fb.com>
	Signed-off-by: NeilBrown <neilb@suse.com>
(cherry picked from commit a97b7896447a89749d9258fbb9d8c3faf48a7a4e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/md/md.c
#	drivers/md/md.h
diff --cc drivers/md/md.c
index 1e2e9754cace,bca859a6e3fd..000000000000
--- a/drivers/md/md.c
+++ b/drivers/md/md.c
@@@ -1811,6 -1818,8 +1816,11 @@@ retry
  			sb->dev_roles[i] = cpu_to_le16(MD_DISK_ROLE_FAULTY);
  		else if (test_bit(In_sync, &rdev2->flags))
  			sb->dev_roles[i] = cpu_to_le16(rdev2->raid_disk);
++<<<<<<< HEAD
++=======
+ 		else if (test_bit(Journal, &rdev2->flags))
+ 			sb->dev_roles[i] = cpu_to_le16(MD_DISK_ROLE_JOURNAL);
++>>>>>>> a97b7896447a (MD: add new bit to indicate raid array with journal)
  		else if (rdev2->raid_disk >= 0)
  			sb->dev_roles[i] = cpu_to_le16(rdev2->raid_disk);
  		else
diff --cc drivers/md/md.h
index f8d82442ce8b,2bea51edfab7..000000000000
--- a/drivers/md/md.h
+++ b/drivers/md/md.h
@@@ -217,6 -232,8 +217,11 @@@ struct mddev 
  #define MD_STILL_CLOSED	4	/* If set, then array has not been opened since
  				 * md_ioctl checked on it.
  				 */
++<<<<<<< HEAD
++=======
+ #define MD_JOURNAL_CLEAN 5	/* A raid with journal is already clean */
+ #define MD_HAS_JOURNAL	6	/* The raid array has journal feature set */
++>>>>>>> a97b7896447a (MD: add new bit to indicate raid array with journal)
  
  	int				suspended;
  	atomic_t			active_io;
* Unmerged path drivers/md/md.c
* Unmerged path drivers/md/md.h
