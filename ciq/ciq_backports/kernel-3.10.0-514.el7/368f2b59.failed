IB/hfi1: Remove the use of add/remove RB function pointers

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Mitko Haralanov <mitko.haralanov@intel.com>
commit 368f2b59d024fbb58015dfd0e09c54c424cda979
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/368f2b59.failed

The usage of function pointers for RB node insertion
and removal in the expected receive code path was
meant to be a small performance optimization. However,
maintaining it, especially with the new MMU API, would
become more troublesome as the API is extended.

Since the performance optimization is minor, remove the
function pointers and replace with direct calls.

	Reviewed-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
	Reviewed-by: Dean Luick <dean.luick@intel.com>
	Signed-off-by: Mitko Haralanov <mitko.haralanov@intel.com>
	Signed-off-by: Jubin John <jubin.john@intel.com>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 368f2b59d024fbb58015dfd0e09c54c424cda979)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/staging/hfi1/hfi.h
#	drivers/staging/rdma/hfi1/user_exp_rcv.c
diff --cc drivers/staging/hfi1/hfi.h
index 6438dccf5749,2107cdc8ce3f..000000000000
--- a/drivers/staging/hfi1/hfi.h
+++ b/drivers/staging/hfi1/hfi.h
@@@ -1159,11 -1194,11 +1159,16 @@@ struct hfi1_filedata 
  	spinlock_t tid_lock; /* protect tid_[limit,used] counters */
  	u32 tid_limit;
  	u32 tid_used;
 +	spinlock_t rb_lock; /* protect tid_rb_root RB tree */
  	u32 *invalid_tids;
  	u32 invalid_tid_idx;
++<<<<<<< HEAD:drivers/staging/hfi1/hfi.h
 +	spinlock_t invalid_lock; /* protect the invalid_tids array */
 +	int (*mmu_rb_insert)(struct rb_root *, struct mmu_rb_node *);
++=======
+ 	/* protect invalid_tids array and invalid_tid_idx */
+ 	spinlock_t invalid_lock;
++>>>>>>> 368f2b59d024 (IB/hfi1: Remove the use of add/remove RB function pointers):drivers/staging/rdma/hfi1/hfi.h
  };
  
  extern struct list_head hfi1_dev_list;
* Unmerged path drivers/staging/rdma/hfi1/user_exp_rcv.c
* Unmerged path drivers/staging/hfi1/hfi.h
* Unmerged path drivers/staging/rdma/hfi1/user_exp_rcv.c
