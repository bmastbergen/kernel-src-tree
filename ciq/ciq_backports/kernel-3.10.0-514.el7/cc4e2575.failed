iommu/vt-d: Move context-mapping into dmar_insert_dev_info

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [iommu] vt-d: Move context-mapping into dmar_insert_dev_info (Myron Stowe) [1311267]
Rebuild_FUZZ: 94.55%
commit-author Joerg Roedel <jroedel@suse.de>
commit cc4e2575cc96b1aac910f56e1d7ef45d219b40b2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/cc4e2575.failed

Do the context-mapping of devices from a single place in the
call-path and clean up the other call-sites.

	Signed-off-by: Joerg Roedel <jroedel@suse.de>
(cherry picked from commit cc4e2575cc96b1aac910f56e1d7ef45d219b40b2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/iommu/intel-iommu.c
diff --cc drivers/iommu/intel-iommu.c
index bb8ed4832156,a5ac99cc9ffc..000000000000
--- a/drivers/iommu/intel-iommu.c
+++ b/drivers/iommu/intel-iommu.c
@@@ -2970,16 -3265,6 +2963,19 @@@ static struct dmar_domain *__get_valid_
  		return NULL;
  	}
  
++<<<<<<< HEAD
 +	/* make sure context mapping is ok */
 +	if (unlikely(!domain_context_mapped(dev))) {
 +		ret = domain_context_mapping(domain, dev);
 +		if (ret) {
 +			printk(KERN_ERR "Domain context map for %s failed",
 +			       dev_name(dev));
 +			return NULL;
 +		}
 +	}
 +
++=======
++>>>>>>> cc4e2575cc96 (iommu/vt-d: Move context-mapping into dmar_insert_dev_info)
  	return domain;
  }
  
* Unmerged path drivers/iommu/intel-iommu.c
