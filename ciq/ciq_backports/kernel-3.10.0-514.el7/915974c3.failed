ehci-platform: Change compatible string from usb-ehci to generic-ehci

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Hans de Goede <hdegoede@redhat.com>
commit 915974c34ee056be918b7ea287a870766a0db6ba
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/915974c3.failed

The initial versions of the devicetree enablement patches for ehci-platform
used "ehci-platform" as compatible string. However this was disliked by various
reviewers because the platform bus is a Linux invention and devicetree is
supposed to be OS agnostic. After much discussion I gave up, added a:
"depends on !PPC_OF" to Kconfig to avoid a known conflict with PPC-OF platforms
and went with the generic usb-ehci as requested.

In retro-spect I should have chosen something different, the dts files for many
existing boards already claim to be compatible with "usb-ehci", ie they have:

	compatible = "ti,ehci-omap", "usb-ehci";

In theory this should not be a problem since the "ti,ehci-omap" entry takes
presedence, but in practice using a conflicting compatible string is an issue,
because it makes which driver gets used depend on driver registration order.

This patch changes the compatible string claimed by ehci-platform to
"generic-ehci", avoiding the driver registration / module loading ordering
problems, and removes the "depends on !PPC_OF" workaround.

	Signed-off-by: Hans de Goede <hdegoede@redhat.com>
	Acked-by: Alan Stern <stern@rowland.harvard.edu>
	Tested-by: Kevin Hilman <khilman@linaro.org>
	Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
(cherry picked from commit 915974c34ee056be918b7ea287a870766a0db6ba)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	Documentation/devicetree/bindings/usb/usb-ehci.txt
#	drivers/usb/host/ehci-platform.c
diff --cc Documentation/devicetree/bindings/usb/usb-ehci.txt
index fa18612f757b,ff151ec084c4..000000000000
--- a/Documentation/devicetree/bindings/usb/usb-ehci.txt
+++ b/Documentation/devicetree/bindings/usb/usb-ehci.txt
@@@ -23,3 -24,13 +23,16 @@@ Example (Sequoia 440EPx)
  	   reg = <0 e0000300 90 0 e0000390 70>;
  	   big-endian;
     };
++<<<<<<< HEAD
++=======
+ 
+ Example (Allwinner sun4i A10 SoC):
+    ehci0: usb@01c14000 {
+ 	   compatible = "allwinner,sun4i-a10-ehci", "generic-ehci";
+ 	   reg = <0x01c14000 0x100>;
+ 	   interrupts = <39>;
+ 	   clocks = <&ahb_gates 1>;
+ 	   phys = <&usbphy 1>;
+ 	   phy-names = "usb";
+    };
++>>>>>>> 915974c34ee0 (ehci-platform: Change compatible string from usb-ehci to generic-ehci)
diff --cc drivers/usb/host/ehci-platform.c
index 79f7e9051be3,117873033d00..000000000000
--- a/drivers/usb/host/ehci-platform.c
+++ b/drivers/usb/host/ehci-platform.c
@@@ -204,8 -333,10 +204,12 @@@ static int ehci_platform_resume(struct 
  static const struct of_device_id vt8500_ehci_ids[] = {
  	{ .compatible = "via,vt8500-ehci", },
  	{ .compatible = "wm,prizm-ehci", },
++<<<<<<< HEAD
++=======
+ 	{ .compatible = "generic-ehci", },
++>>>>>>> 915974c34ee0 (ehci-platform: Change compatible string from usb-ehci to generic-ehci)
  	{}
  };
 -MODULE_DEVICE_TABLE(of, vt8500_ehci_ids);
  
  static const struct platform_device_id ehci_platform_table[] = {
  	{ "ehci-platform", 0 },
* Unmerged path Documentation/devicetree/bindings/usb/usb-ehci.txt
* Unmerged path drivers/usb/host/ehci-platform.c
