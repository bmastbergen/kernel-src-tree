resource: Change __request_region to inherit from immediate parent

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Toshi Kani <toshi.kani@hpe.com>
commit 4e0d8f7eff3fbfa3e3ac5782669c078f590dc9e2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/4e0d8f7e.failed

__request_region() sets 'flags' of a new resource from @parent
as it inherits the parent's attribute.  When a target resource
has a conflict, this function inserts the new resource entry
under the conflicted entry by updating @parent.  In this case,
the new resource entry needs to inherit attribute from the updated
parent.  This conflict is a typical case since __request_region()
is used to allocate a new resource from a specific resource range.

For instance, request_mem_region() calls __request_region() with
@parent set to &iomem_resource, which is the root entry of the
whole iomem range.  When this request results in inserting a new
entry "DEV-A" under "BUS-1", "DEV-A" needs to inherit from the
immediate parent "BUS-1" as it holds specific attribute for the
range.

root (&iomem_resource)
 :
 + "BUS-1"
    + "DEV-A"

Change __request_region() to set 'flags' and 'desc' of a new entry
from the immediate parent.

	Signed-off-by: Toshi Kani <toshi.kani@hpe.com>
	Cc: Ingo Molnar <mingo@kernel.org>
	Cc: Borislav Petkov <bp@suse.de>
	Cc: Andrew Morton <akpm@linux-foundation.org>
	Cc: Dan Williams <dan.j.williams@intel.com>
	Signed-off-by: Dan Williams <dan.j.williams@intel.com>
(cherry picked from commit 4e0d8f7eff3fbfa3e3ac5782669c078f590dc9e2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	kernel/resource.c
diff --cc kernel/resource.c
index eaf1c7384470,5a56e8f24058..000000000000
--- a/kernel/resource.c
+++ b/kernel/resource.c
@@@ -1073,8 -1085,6 +1073,11 @@@ struct resource * __request_region(stru
  	res->name = name;
  	res->start = start;
  	res->end = start + n - 1;
++<<<<<<< HEAD
 +	res->flags = resource_type(parent);
 +	res->flags |= IORESOURCE_BUSY | flags;
++=======
++>>>>>>> 4e0d8f7eff3f (resource: Change __request_region to inherit from immediate parent)
  
  	write_lock(&resource_lock);
  
* Unmerged path kernel/resource.c
