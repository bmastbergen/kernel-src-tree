raid5: enable log for raid array with cache disk

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Shaohua Li <shli@fb.com>
commit 5c7e81c3de9eb3db01e16190a1da0899efee645b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/5c7e81c3.failed

Now log is safe to enable for raid array with cache disk

	Signed-off-by: Shaohua Li <shli@fb.com>
	Signed-off-by: NeilBrown <neilb@suse.com>
(cherry picked from commit 5c7e81c3de9eb3db01e16190a1da0899efee645b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/md/raid5.c
#	include/uapi/linux/raid/md_p.h
diff --cc drivers/md/raid5.c
index b9b255fe2944,b0bf81d084fd..000000000000
--- a/drivers/md/raid5.c
+++ b/drivers/md/raid5.c
@@@ -6312,6 -6329,11 +6312,14 @@@ static void raid5_free_percpu(struct r5
  
  static void free_conf(struct r5conf *conf)
  {
++<<<<<<< HEAD
++=======
+ 	if (conf->log)
+ 		r5l_exit_log(conf->log);
+ 	if (conf->shrinker.seeks)
+ 		unregister_shrinker(&conf->shrinker);
+ 
++>>>>>>> 5c7e81c3de9e (raid5: enable log for raid array with cache disk)
  	free_thread_groups(conf);
  	shrink_stripes(conf);
  	raid5_free_percpu(conf);
diff --cc include/uapi/linux/raid/md_p.h
index 290ce74e29e4,c3e654c6d518..000000000000
--- a/include/uapi/linux/raid/md_p.h
+++ b/include/uapi/linux/raid/md_p.h
@@@ -306,6 -321,8 +306,11 @@@ struct mdp_superblock_1 
  					|MD_FEATURE_RESHAPE_BACKWARDS	\
  					|MD_FEATURE_NEW_OFFSET		\
  					|MD_FEATURE_RECOVERY_BITMAP	\
++<<<<<<< HEAD
++=======
+ 					|MD_FEATURE_CLUSTERED		\
+ 					|MD_FEATURE_JOURNAL		\
++>>>>>>> 5c7e81c3de9e (raid5: enable log for raid array with cache disk)
  					)
  
  struct r5l_payload_header {
* Unmerged path drivers/md/raid5.c
* Unmerged path include/uapi/linux/raid/md_p.h
