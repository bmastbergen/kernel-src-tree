nfsd: refactor nfs4_preprocess_stateid_op

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Christoph Hellwig <hch@lst.de>
commit a0649b2d3fffb1cde8745568c767f3a55a3462bc
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/a0649b2d.failed

Split out two self contained helpers to make the function more readable.

	Signed-off-by: Christoph Hellwig <hch@lst.de>
	Signed-off-by: J. Bruce Fields <bfields@redhat.com>
(cherry picked from commit a0649b2d3fffb1cde8745568c767f3a55a3462bc)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/nfsd/nfs4state.c
diff --cc fs/nfsd/nfs4state.c
index 0a0ff7c79780,f8d50817fafc..000000000000
--- a/fs/nfsd/nfs4state.c
+++ b/fs/nfsd/nfs4state.c
@@@ -4506,13 -4614,10 +4540,18 @@@ __be3
  nfs4_preprocess_stateid_op(struct net *net, struct nfsd4_compound_state *cstate,
  			   stateid_t *stateid, int flags, struct file **filpp)
  {
++<<<<<<< HEAD
 +	struct nfs4_stid *s;
 +	struct nfs4_ol_stateid *stp = NULL;
 +	struct nfs4_delegation *dp = NULL;
 +	struct svc_fh *current_fh = &cstate->current_fh;
 +	struct inode *ino = current_fh->fh_dentry->d_inode;
++=======
+ 	struct svc_fh *fhp = &cstate->current_fh;
+ 	struct inode *ino = d_inode(fhp->fh_dentry);
++>>>>>>> a0649b2d3fff (nfsd: refactor nfs4_preprocess_stateid_op)
  	struct nfsd_net *nn = net_generic(net, nfsd_net_id);
- 	struct file *file = NULL;
+ 	struct nfs4_stid *s;
  	__be32 status;
  
  	if (filpp)
* Unmerged path fs/nfsd/nfs4state.c
