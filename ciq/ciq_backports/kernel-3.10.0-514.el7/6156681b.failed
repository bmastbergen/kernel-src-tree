perf record: Add --buildid-all option

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Namhyung Kim <namhyung@kernel.org>
commit 6156681b73f2fffe56493e9a50518c0cbfcd8ba3
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/6156681b.failed

The --buildid-all option is to record build-id of all DSOs in the file.
It might be very costly to postprocess samples to find which DSO hits.

	Signed-off-by: Namhyung Kim <namhyung@kernel.org>
	Cc: Adrian Hunter <adrian.hunter@intel.com>
	Cc: Andi Kleen <andi@firstfloor.org>
	Cc: David Ahern <dsahern@gmail.com>
	Cc: Jiri Olsa <jolsa@kernel.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Stephane Eranian <eranian@google.com>
Link: http://lkml.kernel.org/r/1452519429-31779-1-git-send-email-namhyung@kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 6156681b73f2fffe56493e9a50518c0cbfcd8ba3)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/Documentation/perf-record.txt
#	tools/perf/builtin-record.c
diff --cc tools/perf/Documentation/perf-record.txt
index 0752b177a5e3,fbceb631387c..000000000000
--- a/tools/perf/Documentation/perf-record.txt
+++ b/tools/perf/Documentation/perf-record.txt
@@@ -294,6 -303,44 +294,47 @@@ symbolic names, e.g. on x86, ax, si. T
  --running-time::
  Record running and enabled time for read events (:S)
  
++<<<<<<< HEAD
++=======
+ -k::
+ --clockid::
+ Sets the clock id to use for the various time fields in the perf_event_type
+ records. See clock_gettime(). In particular CLOCK_MONOTONIC and
+ CLOCK_MONOTONIC_RAW are supported, some events might also allow
+ CLOCK_BOOTTIME, CLOCK_REALTIME and CLOCK_TAI.
+ 
+ -S::
+ --snapshot::
+ Select AUX area tracing Snapshot Mode. This option is valid only with an
+ AUX area tracing event. Optionally the number of bytes to capture per
+ snapshot can be specified. In Snapshot Mode, trace data is captured only when
+ signal SIGUSR2 is received.
+ 
+ --proc-map-timeout::
+ When processing pre-existing threads /proc/XXX/mmap, it may take a long time,
+ because the file may be huge. A time out is needed in such cases.
+ This option sets the time out limit. The default value is 500 ms.
+ 
+ --switch-events::
+ Record context switch events i.e. events of type PERF_RECORD_SWITCH or
+ PERF_RECORD_SWITCH_CPU_WIDE.
+ 
+ --clang-path=PATH::
+ Path to clang binary to use for compiling BPF scriptlets.
+ (enabled when BPF support is on)
+ 
+ --clang-opt=OPTIONS::
+ Options passed to clang when compiling BPF scriptlets.
+ (enabled when BPF support is on)
+ 
+ --vmlinux=PATH::
+ Specify vmlinux path which has debuginfo.
+ (enabled when BPF prologue is on)
+ 
+ --buildid-all::
+ Record build-id of all DSOs regardless whether it's actually hit or not.
+ 
++>>>>>>> 6156681b73f2 (perf record: Add --buildid-all option)
  SEE ALSO
  --------
  linkperf:perf-stat[1], linkperf:perf-list[1]
diff --cc tools/perf/builtin-record.c
index 9631fc84ef82,319712a4e02b..000000000000
--- a/tools/perf/builtin-record.c
+++ b/tools/perf/builtin-record.c
@@@ -907,6 -1127,23 +911,26 @@@ struct option __record_options[] = 
  		    " use -I ? to list register names", parse_regs),
  	OPT_BOOLEAN(0, "running-time", &record.opts.running_time,
  		    "Record running/enabled time of read (:S) events"),
++<<<<<<< HEAD
++=======
+ 	OPT_CALLBACK('k', "clockid", &record.opts,
+ 	"clockid", "clockid to use for events, see clock_gettime()",
+ 	parse_clockid),
+ 	OPT_STRING_OPTARG('S', "snapshot", &record.opts.auxtrace_snapshot_opts,
+ 			  "opts", "AUX area tracing Snapshot Mode", ""),
+ 	OPT_UINTEGER(0, "proc-map-timeout", &record.opts.proc_map_timeout,
+ 			"per thread proc mmap processing timeout in ms"),
+ 	OPT_BOOLEAN(0, "switch-events", &record.opts.record_switch_events,
+ 		    "Record context switch events"),
+ 	OPT_STRING(0, "clang-path", &llvm_param.clang_path, "clang path",
+ 		   "clang binary to use for compiling BPF scriptlets"),
+ 	OPT_STRING(0, "clang-opt", &llvm_param.clang_opt, "clang options",
+ 		   "options passed to clang when compiling BPF scriptlets"),
+ 	OPT_STRING(0, "vmlinux", &symbol_conf.vmlinux_name,
+ 		   "file", "vmlinux pathname"),
+ 	OPT_BOOLEAN(0, "buildid-all", &record.buildid_all,
+ 		    "Record build-id of all DSOs regardless of hits"),
++>>>>>>> 6156681b73f2 (perf record: Add --buildid-all option)
  	OPT_END()
  };
  
* Unmerged path tools/perf/Documentation/perf-record.txt
* Unmerged path tools/perf/builtin-record.c
