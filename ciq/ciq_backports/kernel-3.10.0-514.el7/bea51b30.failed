nfs42: add NFS_IOC_CLONE ioctl

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Peng Tao <tao.peng@primarydata.com>
commit bea51b30b281039f0f43fb4f42028ddf33fb601f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/bea51b30.failed

It can be called by user space to CLONE two files.
Follow btrfs lead and define NFS_IOC_CLONE same as BTRFS_IOC_CLONE.
Thus we don't mess up userspace with too many ioctls.

	Signed-off-by: Peng Tao <tao.peng@primarydata.com>
	Signed-off-by: Trond Myklebust <trond.myklebust@primarydata.com>
(cherry picked from commit bea51b30b281039f0f43fb4f42028ddf33fb601f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/nfs/nfs4file.c
diff --cc fs/nfs/nfs4file.c
index 75f15320a424,fc68ba5f030c..000000000000
--- a/fs/nfs/nfs4file.c
+++ b/fs/nfs/nfs4file.c
@@@ -4,9 -4,12 +4,10 @@@
   *  Copyright (C) 1992  Rick Sladkey
   */
  #include <linux/fs.h>
+ #include <linux/file.h>
  #include <linux/falloc.h>
  #include <linux/nfs_fs.h>
 -#include "delegation.h"
  #include "internal.h"
 -#include "iostat.h"
  #include "fscache.h"
  #include "pnfs.h"
  
@@@ -190,5 -312,10 +287,14 @@@ const struct file_operations nfs4_file_
  	.fallocate	= nfs42_fallocate,
  #endif /* CONFIG_NFS_V4_2 */
  	.check_flags	= nfs_check_flags,
++<<<<<<< HEAD
 +	.setlease	= nfs_setlease,
++=======
+ 	.setlease	= simple_nosetlease,
+ #ifdef CONFIG_COMPAT
+ 	.unlocked_ioctl = nfs4_ioctl,
+ #else
+ 	.compat_ioctl	= nfs4_ioctl,
+ #endif /* CONFIG_COMPAT */
++>>>>>>> bea51b30b281 (nfs42: add NFS_IOC_CLONE ioctl)
  };
* Unmerged path fs/nfs/nfs4file.c
diff --git a/include/uapi/linux/nfs.h b/include/uapi/linux/nfs.h
index 5199a36dd574..d85748d3564d 100644
--- a/include/uapi/linux/nfs.h
+++ b/include/uapi/linux/nfs.h
@@ -31,6 +31,10 @@
 
 #define NFS_PIPE_DIRNAME "nfs"
 
+/* NFS ioctls */
+/* Let's follow btrfs lead on CLONE to avoid messing userspace */
+#define NFS_IOC_CLONE	_IOW(0x94, 9, int)
+
 /*
  * NFS stats. The good thing with these values is that NFSv3 errors are
  * a superset of NFSv2 errors (with the exception of NFSERR_WFLUSH which
