storvsc: use storage protocol version to determine storage capabilities

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Keith Mange <keith.mange@microsoft.com>
commit e6c4bc66842752110a66746e2d044fafc01e4800
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/e6c4bc66.failed

Use storage protocol version instead of vmbus protocol
version when determining storage capabilities.

	Tested-by: Alex Ng <alexng@microsoft.com>
	Signed-off-by: Keith Mange <keith.mange@microsoft.com>
	Signed-off-by: K. Y. Srinivasan <kys@microsoft.com>
	Signed-off-by: James Bottomley <JBottomley@Odin.com>
(cherry picked from commit e6c4bc66842752110a66746e2d044fafc01e4800)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/storvsc_drv.c
diff --cc drivers/scsi/storvsc_drv.c
index 848fa40e25ba,97219a0bb280..000000000000
--- a/drivers/scsi/storvsc_drv.c
+++ b/drivers/scsi/storvsc_drv.c
@@@ -1014,8 -1041,7 +1014,12 @@@ static int storvsc_channel_init(struct 
  	 * support multi-channel.
  	 */
  	max_chns = vstor_packet->storage_channel_properties.max_channel_cnt;
++<<<<<<< HEAD
 +	if ((vmbus_proto_version != VERSION_WIN7) &&
 +	   (vmbus_proto_version != VERSION_WS2008))  {
++=======
+ 	if (vmstor_proto_version >= VMSTOR_PROTO_VERSION_WIN8) {
++>>>>>>> e6c4bc668427 (storvsc: use storage protocol version to determine storage capabilities)
  		if (vstor_packet->storage_channel_properties.flags &
  		    STORAGE_CHANNEL_SUPPORTS_MULTI_CHANNEL)
  			process_sub_channels = true;
* Unmerged path drivers/scsi/storvsc_drv.c
