net/mlx5e: Placement changed for carrier state updates

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [netdrv] mlx5e: Placement changed for carrier state updates (kamal heib) [1275159 1296272 1296405 1298421 1298422 1298423 1298424 1298425]
Rebuild_FUZZ: 96.15%
commit-author Tariq Toukan <tariqt@mellanox.com>
commit ce89ef36d2544b4180fdb9ce9e2918196b0082f8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/ce89ef36.failed

More proper to declare carrier state UP only after the channels
are ready for traffic.

	Signed-off-by: Tariq Toukan <tariqt@mellanox.com>
	Signed-off-by: Saeed Mahameed <saeedm@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit ce89ef36d2544b4180fdb9ce9e2918196b0082f8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/en_main.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/en_main.c
index 4feec57d9a1a,013be09a21be..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
@@@ -1421,8 -1451,9 +1421,12 @@@ int mlx5e_open_locked(struct net_devic
  		goto err_close_channels;
  	}
  
- 	mlx5e_update_carrier(priv);
  	mlx5e_redirect_rqts(priv);
++<<<<<<< HEAD
++=======
+ 	mlx5e_update_carrier(priv);
+ 	mlx5e_timestamp_init(priv);
++>>>>>>> ce89ef36d254 (net/mlx5e: Placement changed for carrier state updates)
  
  	schedule_delayed_work(&priv->update_stats_work, 0);
  
@@@ -1459,8 -1490,9 +1463,13 @@@ int mlx5e_close_locked(struct net_devic
  
  	clear_bit(MLX5E_STATE_OPENED, &priv->state);
  
++<<<<<<< HEAD
 +	mlx5e_redirect_rqts(priv);
++=======
+ 	mlx5e_timestamp_cleanup(priv);
++>>>>>>> ce89ef36d254 (net/mlx5e: Placement changed for carrier state updates)
  	netif_carrier_off(priv->netdev);
+ 	mlx5e_redirect_rqts(priv);
  	mlx5e_close_channels(priv);
  
  	return 0;
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en_main.c
