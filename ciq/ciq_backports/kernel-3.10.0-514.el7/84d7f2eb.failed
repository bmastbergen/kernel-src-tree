i2c: i801: Add support for Intel DNV

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [i2c] i801: Add support for Intel DNV (Steve Best) [1322042]
Rebuild_FUZZ: 92.54%
commit-author Mika Westerberg <mika.westerberg@linux.intel.com>
commit 84d7f2ebd70d36e9d83e0973d2f4dac56a671f4f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/84d7f2eb.failed

Intel DNV SoC has the same legacy SMBus host controller than Intel
Sunrisepoint PCH. It also has same iTCO watchdog on the bus.

Add DNV PCI ID to the list of supported devices.

	Signed-off-by: Mika Westerberg <mika.westerberg@linux.intel.com>
	Signed-off-by: Wolfram Sang <wsa@the-dreams.de>
(cherry picked from commit 84d7f2ebd70d36e9d83e0973d2f4dac56a671f4f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/i2c/busses/i2c-i801.c
diff --cc drivers/i2c/busses/i2c-i801.c
index f35240566cfa,47c2ddf76264..000000000000
--- a/drivers/i2c/busses/i2c-i801.c
+++ b/drivers/i2c/busses/i2c-i801.c
@@@ -22,58 -18,61 +22,116 @@@
  */
  
  /*
++<<<<<<< HEAD
 +  Supports the following Intel I/O Controller Hubs (ICH):
 +
 +                                  I/O                     Block   I2C
 +                                  region  SMBus   Block   proc.   block
 +  Chip name             PCI ID    size    PEC     buffer  call    read
 +  ----------------------------------------------------------------------
 +  82801AA  (ICH)        0x2413     16      no      no      no      no
 +  82801AB  (ICH0)       0x2423     16      no      no      no      no
 +  82801BA  (ICH2)       0x2443     16      no      no      no      no
 +  82801CA  (ICH3)       0x2483     32     soft     no      no      no
 +  82801DB  (ICH4)       0x24c3     32     hard     yes     no      no
 +  82801E   (ICH5)       0x24d3     32     hard     yes     yes     yes
 +  6300ESB               0x25a4     32     hard     yes     yes     yes
 +  82801F   (ICH6)       0x266a     32     hard     yes     yes     yes
 +  6310ESB/6320ESB       0x269b     32     hard     yes     yes     yes
 +  82801G   (ICH7)       0x27da     32     hard     yes     yes     yes
 +  82801H   (ICH8)       0x283e     32     hard     yes     yes     yes
 +  82801I   (ICH9)       0x2930     32     hard     yes     yes     yes
 +  EP80579 (Tolapai)     0x5032     32     hard     yes     yes     yes
 +  ICH10                 0x3a30     32     hard     yes     yes     yes
 +  ICH10                 0x3a60     32     hard     yes     yes     yes
 +  5/3400 Series (PCH)   0x3b30     32     hard     yes     yes     yes
 +  6 Series (PCH)        0x1c22     32     hard     yes     yes     yes
 +  Patsburg (PCH)        0x1d22     32     hard     yes     yes     yes
 +  Patsburg (PCH) IDF    0x1d70     32     hard     yes     yes     yes
 +  Patsburg (PCH) IDF    0x1d71     32     hard     yes     yes     yes
 +  Patsburg (PCH) IDF    0x1d72     32     hard     yes     yes     yes
 +  DH89xxCC (PCH)        0x2330     32     hard     yes     yes     yes
 +  Panther Point (PCH)   0x1e22     32     hard     yes     yes     yes
 +  Lynx Point (PCH)      0x8c22     32     hard     yes     yes     yes
 +  Lynx Point-LP (PCH)   0x9c22     32     hard     yes     yes     yes
 +  Avoton (SOC)          0x1f3c     32     hard     yes     yes     yes
 +  Wellsburg (PCH)       0x8d22     32     hard     yes     yes     yes
 +  Wellsburg (PCH) MS    0x8d7d     32     hard     yes     yes     yes
 +  Wellsburg (PCH) MS    0x8d7e     32     hard     yes     yes     yes
 +  Wellsburg (PCH) MS    0x8d7f     32     hard     yes     yes     yes
 +  Coleto Creek (PCH)    0x23b0     32     hard     yes     yes     yes
 +  Wildcat Point-LP (PCH)   0x9ca2     32     hard     yes     yes     yes
 +  Sunrise Point-H (PCH) 	0xa123  32	hard	yes	yes	yes
 +  Sunrise Point-LP (PCH)	0x9d23	32	hard	yes	yes	yes
 +
 +  Features supported by this driver:
 +  Software PEC                     no
 +  Hardware PEC                     yes
 +  Block buffer                     yes
 +  Block process call transaction   no
 +  I2C block read transaction       yes  (doesn't use the block buffer)
 +  Slave mode                       no
 +  Interrupt processing             yes
 +
 +  See the file Documentation/i2c/busses/i2c-i801 for details.
 +*/
++=======
+  * Supports the following Intel I/O Controller Hubs (ICH):
+  *
+  *					I/O			Block	I2C
+  *					region	SMBus	Block	proc.	block
+  * Chip name			PCI ID	size	PEC	buffer	call	read
+  * ---------------------------------------------------------------------------
+  * 82801AA (ICH)		0x2413	16	no	no	no	no
+  * 82801AB (ICH0)		0x2423	16	no	no	no	no
+  * 82801BA (ICH2)		0x2443	16	no	no	no	no
+  * 82801CA (ICH3)		0x2483	32	soft	no	no	no
+  * 82801DB (ICH4)		0x24c3	32	hard	yes	no	no
+  * 82801E (ICH5)		0x24d3	32	hard	yes	yes	yes
+  * 6300ESB			0x25a4	32	hard	yes	yes	yes
+  * 82801F (ICH6)		0x266a	32	hard	yes	yes	yes
+  * 6310ESB/6320ESB		0x269b	32	hard	yes	yes	yes
+  * 82801G (ICH7)		0x27da	32	hard	yes	yes	yes
+  * 82801H (ICH8)		0x283e	32	hard	yes	yes	yes
+  * 82801I (ICH9)		0x2930	32	hard	yes	yes	yes
+  * EP80579 (Tolapai)		0x5032	32	hard	yes	yes	yes
+  * ICH10			0x3a30	32	hard	yes	yes	yes
+  * ICH10			0x3a60	32	hard	yes	yes	yes
+  * 5/3400 Series (PCH)		0x3b30	32	hard	yes	yes	yes
+  * 6 Series (PCH)		0x1c22	32	hard	yes	yes	yes
+  * Patsburg (PCH)		0x1d22	32	hard	yes	yes	yes
+  * Patsburg (PCH) IDF		0x1d70	32	hard	yes	yes	yes
+  * Patsburg (PCH) IDF		0x1d71	32	hard	yes	yes	yes
+  * Patsburg (PCH) IDF		0x1d72	32	hard	yes	yes	yes
+  * DH89xxCC (PCH)		0x2330	32	hard	yes	yes	yes
+  * Panther Point (PCH)		0x1e22	32	hard	yes	yes	yes
+  * Lynx Point (PCH)		0x8c22	32	hard	yes	yes	yes
+  * Lynx Point-LP (PCH)		0x9c22	32	hard	yes	yes	yes
+  * Avoton (SOC)			0x1f3c	32	hard	yes	yes	yes
+  * Wellsburg (PCH)		0x8d22	32	hard	yes	yes	yes
+  * Wellsburg (PCH) MS		0x8d7d	32	hard	yes	yes	yes
+  * Wellsburg (PCH) MS		0x8d7e	32	hard	yes	yes	yes
+  * Wellsburg (PCH) MS		0x8d7f	32	hard	yes	yes	yes
+  * Coleto Creek (PCH)		0x23b0	32	hard	yes	yes	yes
+  * Wildcat Point (PCH)		0x8ca2	32	hard	yes	yes	yes
+  * Wildcat Point-LP (PCH)	0x9ca2	32	hard	yes	yes	yes
+  * BayTrail (SOC)		0x0f12	32	hard	yes	yes	yes
+  * Sunrise Point-H (PCH) 	0xa123  32	hard	yes	yes	yes
+  * Sunrise Point-LP (PCH)	0x9d23	32	hard	yes	yes	yes
+  * DNV (SOC)			0x19df	32	hard	yes	yes	yes
+  *
+  * Features supported by this driver:
+  * Software PEC				no
+  * Hardware PEC				yes
+  * Block buffer				yes
+  * Block process call transaction	no
+  * I2C block read transaction		yes (doesn't use the block buffer)
+  * Slave mode				no
+  * Interrupt processing			yes
+  *
+  * See the file Documentation/i2c/busses/i2c-i801 for details.
+  */
++>>>>>>> 84d7f2ebd70d (i2c: i801: Add support for Intel DNV)
  
  #include <linux/interrupt.h>
  #include <linux/module.h>
@@@ -845,9 -859,13 +904,10 @@@ static const struct pci_device_id i801_
  	{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_WELLSBURG_SMBUS_MS1) },
  	{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_WELLSBURG_SMBUS_MS2) },
  	{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_COLETOCREEK_SMBUS) },
 -	{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_WILDCATPOINT_SMBUS) },
  	{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_WILDCATPOINT_LP_SMBUS) },
 -	{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_BAYTRAIL_SMBUS) },
 -	{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_BRASWELL_SMBUS) },
  	{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_SUNRISEPOINT_H_SMBUS) },
  	{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_SUNRISEPOINT_LP_SMBUS) },
+ 	{ PCI_DEVICE(PCI_VENDOR_ID_INTEL, PCI_DEVICE_ID_INTEL_DNV_SMBUS) },
  	{ 0, }
  };
  
@@@ -1150,6 -1257,16 +1210,19 @@@ static int i801_probe(struct pci_dev *d
  
  	priv->pci_dev = dev;
  	switch (dev->device) {
++<<<<<<< HEAD
++=======
+ 	case PCI_DEVICE_ID_INTEL_SUNRISEPOINT_H_SMBUS:
+ 	case PCI_DEVICE_ID_INTEL_SUNRISEPOINT_LP_SMBUS:
+ 	case PCI_DEVICE_ID_INTEL_DNV_SMBUS:
+ 		priv->features |= FEATURE_I2C_BLOCK_READ;
+ 		priv->features |= FEATURE_IRQ;
+ 		priv->features |= FEATURE_SMBUS_PEC;
+ 		priv->features |= FEATURE_BLOCK_BUFFER;
+ 		priv->features |= FEATURE_TCO;
+ 		break;
+ 
++>>>>>>> 84d7f2ebd70d (i2c: i801: Add support for Intel DNV)
  	case PCI_DEVICE_ID_INTEL_PATSBURG_SMBUS_IDF0:
  	case PCI_DEVICE_ID_INTEL_PATSBURG_SMBUS_IDF1:
  	case PCI_DEVICE_ID_INTEL_PATSBURG_SMBUS_IDF2:
* Unmerged path drivers/i2c/busses/i2c-i801.c
