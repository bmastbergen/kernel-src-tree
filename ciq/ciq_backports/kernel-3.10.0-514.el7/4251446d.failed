perf report: Add --hierarchy option

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Namhyung Kim <namhyung@kernel.org>
commit 4251446d778e669db5ac9f86b02d38064bdbbf9a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/4251446d.failed

The --hierarchy option is to show output in hierarchy mode.  It extends
folding/unfolding in the TUI and GTK browsers to support sort items as
well as callchains.  Users can toggle the items to see the performance
result at wanted level.

  $ perf report --hierarchy --tui
   Overhead       Command / Shared Object / Symbol
  --------------------------------------------------
  +  32.96%       gnome-shell
  -  15.11%       swapper
     -  14.97%       [kernel.vmlinux]
           6.82%        [k] intel_idle
           0.66%        [k] menu_select
           0.43%        [k] __hrtimer_start_range_ns
  ...

	Signed-off-by: Namhyung Kim <namhyung@kernel.org>
	Acked-by: Pekka Enberg <penberg@kernel.org>
	Cc: Andi Kleen <andi@firstfloor.org>
	Cc: David Ahern <dsahern@gmail.com>
	Cc: Jiri Olsa <jolsa@kernel.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Stephane Eranian <eranian@google.com>
	Cc: Wang Nan <wangnan0@huawei.com>
Link: http://lkml.kernel.org/r/1456326830-30456-17-git-send-email-namhyung@kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 4251446d778e669db5ac9f86b02d38064bdbbf9a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/Documentation/perf-report.txt
#	tools/perf/Documentation/tips.txt
#	tools/perf/builtin-report.c
diff --cc tools/perf/Documentation/perf-report.txt
index 2cbfa7a6a307,12113992ac9d..000000000000
--- a/tools/perf/Documentation/perf-report.txt
+++ b/tools/perf/Documentation/perf-report.txt
@@@ -383,6 -384,26 +383,29 @@@ include::itrace.txt[
  --full-source-path::
  	Show the full path for source files for srcline output.
  
++<<<<<<< HEAD
++=======
+ --show-ref-call-graph::
+ 	When multiple events are sampled, it may not be needed to collect
+ 	callgraphs for all of them. The sample sites are usually nearby,
+ 	and it's enough to collect the callgraphs on a reference event.
+ 	So user can use "call-graph=no" event modifier to disable callgraph
+ 	for other events to reduce the overhead.
+ 	However, perf report cannot show callgraphs for the event which
+ 	disable the callgraph.
+ 	This option extends the perf report to show reference callgraphs,
+ 	which collected by reference event, in no callgraph event.
+ 
+ --socket-filter::
+ 	Only report the samples on the processor socket that match with this filter
+ 
+ --raw-trace::
+ 	When displaying traceevent output, do not use print fmt or plugins.
+ 
+ --hierarchy::
+ 	Enable hierarchical output.
+ 
++>>>>>>> 4251446d778e (perf report: Add --hierarchy option)
  include::callchain-overhead-calculation.txt[]
  
  SEE ALSO
diff --cc tools/perf/builtin-report.c
index e590d35fd08a,f4d8244449ca..000000000000
--- a/tools/perf/builtin-report.c
+++ b/tools/perf/builtin-report.c
@@@ -776,6 -805,14 +776,17 @@@ int cmd_report(int argc, const char **a
  			    itrace_parse_synth_opts),
  	OPT_BOOLEAN(0, "full-source-path", &srcline_full_filename,
  			"Show full source file name path for source lines"),
++<<<<<<< HEAD
++=======
+ 	OPT_BOOLEAN(0, "show-ref-call-graph", &symbol_conf.show_ref_callgraph,
+ 		    "Show callgraph from reference event"),
+ 	OPT_INTEGER(0, "socket-filter", &report.socket_filter,
+ 		    "only show processor socket that match with this filter"),
+ 	OPT_BOOLEAN(0, "raw-trace", &symbol_conf.raw_trace,
+ 		    "Show raw trace event output (do not use print fmt or plugins)"),
+ 	OPT_BOOLEAN(0, "hierarchy", &symbol_conf.report_hierarchy,
+ 		    "Show entries in a hierarchy"),
++>>>>>>> 4251446d778e (perf report: Add --hierarchy option)
  	OPT_END()
  	};
  	struct perf_data_file file = {
* Unmerged path tools/perf/Documentation/tips.txt
* Unmerged path tools/perf/Documentation/perf-report.txt
* Unmerged path tools/perf/Documentation/tips.txt
* Unmerged path tools/perf/builtin-report.c
