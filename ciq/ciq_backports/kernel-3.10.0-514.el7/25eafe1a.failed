md: simplify get_bitmap_file now that "file" is zeroed.

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [md] simplify get_bitmap_file now that "file" is zeroed (Jes Sorensen) [1250578 1265947 1273343 1299140 1307091 1312828 1320563 1340839]
Rebuild_FUZZ: 95.24%
commit-author Benjamin Randazzo <benjamin@randazzo.fr>
commit 25eafe1a813681849ad3fb9effdfdce3e1b4335a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/25eafe1a.failed

There is no point assigning '\0' to file->pathname[0] as
file is now zeroed out, so remove that branch and
simplify the code.

[Original patch combined this with the change to use
 kzalloc.  I split the two so that the change to kzalloc
 is easier to backport. - neilb]

	Signed-off-by: Benjamin Randazzo <benjamin@randazzo.fr>
	Signed-off-by: NeilBrown <neilb@suse.com>
(cherry picked from commit 25eafe1a813681849ad3fb9effdfdce3e1b4335a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/md/md.c
diff --cc drivers/md/md.c
index 71e0b9948c59,4d47a9ab8228..000000000000
--- a/drivers/md/md.c
+++ b/drivers/md/md.c
@@@ -5720,16 -5765,16 +5720,29 @@@ static int get_bitmap_file(struct mdde
  
  	err = 0;
  	spin_lock(&mddev->lock);
++<<<<<<< HEAD
 +	/* bitmap disabled, zero the first byte and copy out */
 +	if (!mddev->bitmap_info.file)
 +		file->pathname[0] = '\0';
 +	else if ((ptr = d_path(&mddev->bitmap_info.file->f_path,
 +			       file->pathname, sizeof(file->pathname))),
 +		 IS_ERR(ptr))
 +		err = PTR_ERR(ptr);
 +	else
 +		memmove(file->pathname, ptr,
 +			sizeof(file->pathname)-(ptr-file->pathname));
++=======
+ 	/* bitmap enabled */
+ 	if (mddev->bitmap_info.file) {
+ 		ptr = file_path(mddev->bitmap_info.file, file->pathname,
+ 				sizeof(file->pathname));
+ 		if (IS_ERR(ptr))
+ 			err = PTR_ERR(ptr);
+ 		else
+ 			memmove(file->pathname, ptr,
+ 				sizeof(file->pathname)-(ptr-file->pathname));
+ 	}
++>>>>>>> 25eafe1a8136 (md: simplify get_bitmap_file now that "file" is zeroed.)
  	spin_unlock(&mddev->lock);
  
  	if (err == 0 &&
* Unmerged path drivers/md/md.c
