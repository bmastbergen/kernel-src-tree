scsi: storvsc: Size the queue depth based on the ringbuffer size

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [scsi] storvsc: Size the queue depth based on the ringbuffer size (Cathy Avery) [1287040]
Rebuild_FUZZ: 95.08%
commit-author K. Y. Srinivasan <kys@microsoft.com>
commit f458aada75891e6e9aff391f8f12a2cb2aac7d58
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/f458aada.failed

Size the queue depth based on the ringbuffer size. Also accommodate for the
fact that we could have multiple channels (ringbuffers) per adaptor.

	Signed-off-by: K. Y. Srinivasan <kys@microsoft.com>
	Reviewed-by: Long Li <longli@microsoft.com>
	Signed-off-by: James Bottomley <JBottomley@Odin.com>
(cherry picked from commit f458aada75891e6e9aff391f8f12a2cb2aac7d58)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/storvsc_drv.c
diff --cc drivers/scsi/storvsc_drv.c
index d3374b001926,7f569f971164..000000000000
--- a/drivers/scsi/storvsc_drv.c
+++ b/drivers/scsi/storvsc_drv.c
@@@ -359,7 -323,8 +364,12 @@@ MODULE_PARM_DESC(vcpus_per_sub_channel
   */
  static int storvsc_timeout = 180;
  
++<<<<<<< HEAD
 +#define STORVSC_MAX_IO_REQUESTS				200
++=======
+ static int msft_blist_flags = BLIST_TRY_VPD_PAGES;
+ 
++>>>>>>> f458aada7589 (scsi: storvsc: Size the queue depth based on the ringbuffer size)
  
  static void storvsc_on_channel_callback(void *context);
  
@@@ -1426,8 -1380,6 +1436,11 @@@ static int storvsc_do_io(struct hv_devi
  
  static int storvsc_device_configure(struct scsi_device *sdevice)
  {
++<<<<<<< HEAD
 +	scsi_adjust_queue_depth(sdevice, MSG_SIMPLE_TAG,
 +				STORVSC_MAX_IO_REQUESTS);
++=======
++>>>>>>> f458aada7589 (scsi: storvsc: Size the queue depth based on the ringbuffer size)
  
  	blk_queue_max_segment_size(sdevice->request_queue, PAGE_SIZE);
  
* Unmerged path drivers/scsi/storvsc_drv.c
