mmc: sdhci-pci: enable sdhci doesn't support hs200 quirk for AMD sdhci

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [mmc] sdhci-pci: enable sdhci doesn't support hs200 quirk for AMD sdhci (Don Zickus) [1127975 1277866 1280133 1286932 1297039]
Rebuild_FUZZ: 96.30%
commit-author Vincent Wan <vincent.wan@amd.com>
commit e765bfa22a8f06f0964a97e3e81148511d75140a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/e765bfa2.failed

AMD SD controller supports the SDR104 mode, but caps2 can not
be promoted to support hs200 for eMMC.

	Signed-off-by: Vincent Wan <vincent.wan@amd.com>
	Signed-off-by: Wan Zongshun <mcuos.com@gmail.com>
	Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
(cherry picked from commit e765bfa22a8f06f0964a97e3e81148511d75140a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/mmc/host/sdhci-pci.c
diff --cc drivers/mmc/host/sdhci-pci.c
index a627aad5414a,c1ecd204c194..000000000000
--- a/drivers/mmc/host/sdhci-pci.c
+++ b/drivers/mmc/host/sdhci-pci.c
@@@ -581,6 -633,37 +581,40 @@@ static const struct sdhci_pci_fixes sdh
  	.probe		= via_probe,
  };
  
++<<<<<<< HEAD
++=======
+ static int rtsx_probe_slot(struct sdhci_pci_slot *slot)
+ {
+ 	slot->host->mmc->caps2 |= MMC_CAP2_HS200;
+ 	return 0;
+ }
+ 
+ static const struct sdhci_pci_fixes sdhci_rtsx = {
+ 	.quirks2	= SDHCI_QUIRK2_PRESET_VALUE_BROKEN |
+ 			SDHCI_QUIRK2_BROKEN_DDR50,
+ 	.probe_slot	= rtsx_probe_slot,
+ };
+ 
+ static int amd_probe(struct sdhci_pci_chip *chip)
+ {
+ 	struct pci_dev	*smbus_dev;
+ 
+ 	smbus_dev = pci_get_device(PCI_VENDOR_ID_AMD,
+ 			PCI_DEVICE_ID_AMD_HUDSON2_SMBUS, NULL);
+ 
+ 	if (smbus_dev && (smbus_dev->revision < 0x51)) {
+ 		chip->quirks2 |= SDHCI_QUIRK2_CLEAR_TRANSFERMODE_REG_BEFORE_CMD;
+ 		chip->quirks2 |= SDHCI_QUIRK2_BROKEN_HS200;
+ 	}
+ 
+ 	return 0;
+ }
+ 
+ static const struct sdhci_pci_fixes sdhci_amd = {
+ 	.probe		= amd_probe,
+ };
+ 
++>>>>>>> e765bfa22a8f (mmc: sdhci-pci: enable sdhci doesn't support hs200 quirk for AMD sdhci)
  static const struct pci_device_id pci_ids[] = {
  	{
  		.vendor		= PCI_VENDOR_ID_RICOH,
* Unmerged path drivers/mmc/host/sdhci-pci.c
