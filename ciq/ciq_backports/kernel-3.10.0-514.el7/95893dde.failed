IB/ucma: Take the network namespace from the process

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Guy Shapiro <guysh@mellanox.com>
commit 95893dde99d9d14f8a6ac99ea3103792a8da5f25
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/95893dde.failed

Add support for network namespaces from user space. This is done by passing
the network namespace of the process instead of init_net.

	Signed-off-by: Haggai Eran <haggaie@mellanox.com>
	Signed-off-by: Yotam Kenneth <yotamke@mellanox.com>
	Signed-off-by: Shachar Raindel <raindel@mellanox.com>
	Signed-off-by: Guy Shapiro <guysh@mellanox.com>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 95893dde99d9d14f8a6ac99ea3103792a8da5f25)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/core/ucma.c
diff --cc drivers/infiniband/core/ucma.c
index 3a342dfaac15,8b5a934e1133..000000000000
--- a/drivers/infiniband/core/ucma.c
+++ b/drivers/infiniband/core/ucma.c
@@@ -472,7 -473,8 +473,12 @@@ static ssize_t ucma_create_id(struct uc
  		return -ENOMEM;
  
  	ctx->uid = cmd.uid;
++<<<<<<< HEAD
 +	ctx->cm_id = rdma_create_id(ucma_event_handler, ctx, cmd.ps, qp_type);
++=======
+ 	ctx->cm_id = rdma_create_id(current->nsproxy->net_ns,
+ 				    ucma_event_handler, ctx, cmd.ps, qp_type);
++>>>>>>> 95893dde99d9 (IB/ucma: Take the network namespace from the process)
  	if (IS_ERR(ctx->cm_id)) {
  		ret = PTR_ERR(ctx->cm_id);
  		goto err1;
* Unmerged path drivers/infiniband/core/ucma.c
