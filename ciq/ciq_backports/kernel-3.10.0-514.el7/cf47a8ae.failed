perf tools: Remove unused perf_pathdup, xstrdup functions

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Arnaldo Carvalho de Melo <acme@redhat.com>
commit cf47a8aede9febee21cbd21d40a9c47244773a6c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/cf47a8ae.failed

	Cc: Adrian Hunter <adrian.hunter@intel.com>
	Cc: Jiri Olsa <jolsa@kernel.org>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: Wang Nan <wangnan0@huawei.com>
Link: http://lkml.kernel.org/n/tip-s87zi5d03m6rz622y1z6rlsa@git.kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit cf47a8aede9febee21cbd21d40a9c47244773a6c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/util/cache.h
#	tools/perf/util/util.h
diff --cc tools/perf/util/cache.h
index 704592ac6b7e,da322bea56f7..000000000000
--- a/tools/perf/util/cache.h
+++ b/tools/perf/util/cache.h
@@@ -67,10 -67,7 +67,13 @@@ static inline int is_absolute_path(cons
  const char *make_nonrelative_path(const char *path);
  char *strip_path_suffix(const char *path, const char *suffix);
  
 -char *mkpath(const char *fmt, ...) __attribute__((format (printf, 1, 2)));
 -char *perf_path(const char *fmt, ...) __attribute__((format (printf, 1, 2)));
 +extern char *mkpath(const char *fmt, ...) __attribute__((format (printf, 1, 2)));
 +extern char *perf_path(const char *fmt, ...) __attribute__((format (printf, 1, 2)));
  
++<<<<<<< HEAD
 +extern char *perf_pathdup(const char *fmt, ...)
 +	__attribute__((format (printf, 1, 2)));
 +
++=======
++>>>>>>> cf47a8aede9f (perf tools: Remove unused perf_pathdup, xstrdup functions)
  #endif /* __PERF_CACHE_H */
diff --cc tools/perf/util/util.h
index 66e3b5143ec3,8298d607c738..000000000000
--- a/tools/perf/util/util.h
+++ b/tools/perf/util/util.h
@@@ -168,8 -162,7 +168,12 @@@ static inline char *gitstrchrnul(const 
  /*
   * Wrappers:
   */
++<<<<<<< HEAD
 +extern char *xstrdup(const char *str);
 +extern void *xrealloc(void *ptr, size_t size) __attribute__((weak));
++=======
+ void *xrealloc(void *ptr, size_t size) __attribute__((weak));
++>>>>>>> cf47a8aede9f (perf tools: Remove unused perf_pathdup, xstrdup functions)
  
  
  static inline void *zalloc(size_t size)
* Unmerged path tools/perf/util/cache.h
diff --git a/tools/perf/util/path.c b/tools/perf/util/path.c
index 3654d964e49d..3bf6bf82ff2d 100644
--- a/tools/perf/util/path.c
+++ b/tools/perf/util/path.c
@@ -41,36 +41,6 @@ static char *cleanup_path(char *path)
 	return path;
 }
 
-static char *perf_vsnpath(char *buf, size_t n, const char *fmt, va_list args)
-{
-	const char *perf_dir = get_perf_dir();
-	size_t len;
-
-	len = strlen(perf_dir);
-	if (n < len + 1)
-		goto bad;
-	memcpy(buf, perf_dir, len);
-	if (len && !is_dir_sep(perf_dir[len-1]))
-		buf[len++] = '/';
-	len += vsnprintf(buf + len, n - len, fmt, args);
-	if (len >= n)
-		goto bad;
-	return cleanup_path(buf);
-bad:
-	strlcpy(buf, bad_path, n);
-	return buf;
-}
-
-char *perf_pathdup(const char *fmt, ...)
-{
-	char path[PATH_MAX];
-	va_list args;
-	va_start(args, fmt);
-	(void)perf_vsnpath(path, sizeof(path), fmt, args);
-	va_end(args);
-	return xstrdup(path);
-}
-
 char *mkpath(const char *fmt, ...)
 {
 	va_list args;
* Unmerged path tools/perf/util/util.h
diff --git a/tools/perf/util/wrapper.c b/tools/perf/util/wrapper.c
index 19f15b650703..5f1a07c4b87b 100644
--- a/tools/perf/util/wrapper.c
+++ b/tools/perf/util/wrapper.c
@@ -12,18 +12,6 @@ static inline void release_pack_memory(size_t size __maybe_unused,
 {
 }
 
-char *xstrdup(const char *str)
-{
-	char *ret = strdup(str);
-	if (!ret) {
-		release_pack_memory(strlen(str) + 1, -1);
-		ret = strdup(str);
-		if (!ret)
-			die("Out of memory, strdup failed");
-	}
-	return ret;
-}
-
 void *xrealloc(void *ptr, size_t size)
 {
 	void *ret = realloc(ptr, size);
