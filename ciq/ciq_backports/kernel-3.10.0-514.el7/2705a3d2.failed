iommu, x86: Save the mode (posted or remapped) of an IRTE

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [iommu] x86: Save the mode (posted or remapped) of an IRTE (Paolo Bonzini) [1301888]
Rebuild_FUZZ: 93.46%
commit-author Feng Wu <feng.wu@intel.com>
commit 2705a3d2a690c3dd9f58c7d788bc0f432acdeceb
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/2705a3d2.failed

Add a new field to struct irq_2_iommu, which captures whether the
associated IRTE is in posted mode or remapped mode. We update this
field when the IRTE is written into the table.

	Suggested-by: Thomas Gleixner <tglx@linutronix.de>
	Signed-off-by: Feng Wu <feng.wu@intel.com>
	Reviewed-by: Thomas Gleixner <tglx@linutronix.de>
	Acked-by: Joerg Roedel <joro@8bytes.org>
	Cc: jiang.liu@linux.intel.com
	Cc: iommu@lists.linux-foundation.org
	Cc: dwmw2@infradead.org
Link: http://lkml.kernel.org/r/1433827237-3382-6-git-send-email-feng.wu@intel.com
	Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
(cherry picked from commit 2705a3d2a690c3dd9f58c7d788bc0f432acdeceb)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/iommu/intel_irq_remapping.c
diff --cc drivers/iommu/intel_irq_remapping.c
index 085a116a8b0a,68bce0a52b9b..000000000000
--- a/drivers/iommu/intel_irq_remapping.c
+++ b/drivers/iommu/intel_irq_remapping.c
@@@ -31,6 -37,22 +36,25 @@@ struct hpet_scope 
  	unsigned int devfn;
  };
  
++<<<<<<< HEAD
++=======
+ struct irq_2_iommu {
+ 	struct intel_iommu *iommu;
+ 	u16 irte_index;
+ 	u16 sub_handle;
+ 	u8  irte_mask;
+ 	enum irq_mode mode;
+ };
+ 
+ struct intel_ir_data {
+ 	struct irq_2_iommu			irq_2_iommu;
+ 	struct irte				irte_entry;
+ 	union {
+ 		struct msi_msg			msi_entry;
+ 	};
+ };
+ 
++>>>>>>> 2705a3d2a690 (iommu, x86: Save the mode (posted or remapped) of an IRTE)
  #define IR_X2APIC_MODE(mode) (mode ? (1 << 11) : 0)
  #define IRTE_DEST(dest) ((eim_mode) ? dest : dest << 8)
  
* Unmerged path drivers/iommu/intel_irq_remapping.c
