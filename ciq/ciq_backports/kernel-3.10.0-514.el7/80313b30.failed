x86/reboot: Add ASRock Q1900DC-ITX mainboard reboot quirk

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [x86] reboot: Add ASRock Q1900DC-ITX mainboard reboot quirk (Prarit Bhargava) [1339663]
Rebuild_FUZZ: 96.36%
commit-author Stefan Lippers-Hollmann <s.l-h@gmx.de>
commit 80313b3078fcd2ca51970880d90757f05879a193
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/80313b30.failed

The ASRock Q1900DC-ITX mainboard (Baytrail-D) hangs randomly in
both BIOS and UEFI mode while rebooting unless reboot=pci is
used. Add a quirk to reboot via the pci method.

The problem is very intermittent and hard to debug, it might succeed
rebooting just fine 40 times in a row - but fails half a dozen times
the next day. It seems to be slightly less common in BIOS CSM mode
than native UEFI (with the CSM disabled), but it does happen in either
mode. Since I've started testing this patch in late january, rebooting
has been 100% reliable.

Most of the time it already hangs during POST, but occasionally it
might even make it through the bootloader and the kernel might even
start booting, but then hangs before the mode switch. The same symptoms
occur with grub-efi, gummiboot and grub-pc, just as well as (at least)
kernel 3.16-3.19 and 4.0-rc6 (I haven't tried older kernels than 3.16).
Upgrading to the most current mainboard firmware of the ASRock
Q1900DC-ITX, version 1.20, does not improve the situation.

( Searching the web seems to suggest that other Bay Trail-D mainboards
  might be affected as well. )
--
	Signed-off-by: Stefan Lippers-Hollmann <s.l-h@gmx.de>
	Cc: <stable@vger.kernel.org>
	Cc: Matt Fleming <matt.fleming@intel.com>
Link: http://lkml.kernel.org/r/20150330224427.0fb58e42@mir
	Signed-off-by: Ingo Molnar <mingo@kernel.org>
(cherry picked from commit 80313b3078fcd2ca51970880d90757f05879a193)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kernel/reboot.c
diff --cc arch/x86/kernel/reboot.c
index 90fd1195f276,86db4bcd7ce5..000000000000
--- a/arch/x86/kernel/reboot.c
+++ b/arch/x86/kernel/reboot.c
@@@ -225,244 -138,276 +225,270 @@@ static int __init set_kbd_reboot(const 
   * This is a single dmi_table handling all reboot quirks.
   */
  static struct dmi_system_id __initdata reboot_dmi_table[] = {
 -
 -	/* Acer */
 -	{	/* Handle reboot issue on Acer Aspire one */
 -		.callback = set_kbd_reboot,
 -		.ident = "Acer Aspire One A110",
 +	{	/* Handle problems with rebooting on Dell E520's */
 +		.callback = set_bios_reboot,
 +		.ident = "Dell E520",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Acer"),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "AOA110"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "Dell DM061"),
  		},
  	},
 -
 -	/* Apple */
 -	{	/* Handle problems with rebooting on Apple MacBook5 */
 -		.callback = set_pci_reboot,
 -		.ident = "Apple MacBook5",
 +	{	/* Handle problems with rebooting on Dell 1300's */
 +		.callback = set_bios_reboot,
 +		.ident = "Dell PowerEdge 1300",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Apple Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "MacBook5"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Dell Computer Corporation"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "PowerEdge 1300/"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Apple MacBookPro5 */
 -		.callback = set_pci_reboot,
 -		.ident = "Apple MacBookPro5",
 +	{	/* Handle problems with rebooting on Dell 300's */
 +		.callback = set_bios_reboot,
 +		.ident = "Dell PowerEdge 300",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Apple Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "MacBookPro5"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Dell Computer Corporation"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "PowerEdge 300/"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Apple Macmini3,1 */
 -		.callback = set_pci_reboot,
 -		.ident = "Apple Macmini3,1",
 +	{	/* Handle problems with rebooting on Dell Optiplex 745's SFF */
 +		.callback = set_bios_reboot,
 +		.ident = "Dell OptiPlex 745",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Apple Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "Macmini3,1"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 745"),
  		},
  	},
 -	{	/* Handle problems with rebooting on the iMac9,1. */
 -		.callback = set_pci_reboot,
 -		.ident = "Apple iMac9,1",
 +	{	/* Handle problems with rebooting on Dell Optiplex 745's DFF */
 +		.callback = set_bios_reboot,
 +		.ident = "Dell OptiPlex 745",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Apple Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "iMac9,1"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 745"),
 +			DMI_MATCH(DMI_BOARD_NAME, "0MM599"),
  		},
  	},
 -
 -	/* ASRock */
 -	{	/* Handle problems with rebooting on ASRock Q1900DC-ITX */
 -		.callback = set_pci_reboot,
 -		.ident = "ASRock Q1900DC-ITX",
 +	{	/* Handle problems with rebooting on Dell Optiplex 745 with 0KW626 */
 +		.callback = set_bios_reboot,
 +		.ident = "Dell OptiPlex 745",
  		.matches = {
 -			DMI_MATCH(DMI_BOARD_VENDOR, "ASRock"),
 -			DMI_MATCH(DMI_BOARD_NAME, "Q1900DC-ITX"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 745"),
 +			DMI_MATCH(DMI_BOARD_NAME, "0KW626"),
  		},
  	},
 -
 -	/* ASUS */
 -	{	/* Handle problems with rebooting on ASUS P4S800 */
 +	{	/* Handle problems with rebooting on Dell Optiplex 330 with 0KP561 */
  		.callback = set_bios_reboot,
 -		.ident = "ASUS P4S800",
 +		.ident = "Dell OptiPlex 330",
  		.matches = {
 -			DMI_MATCH(DMI_BOARD_VENDOR, "ASUSTeK Computer INC."),
 -			DMI_MATCH(DMI_BOARD_NAME, "P4S800"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 330"),
 +			DMI_MATCH(DMI_BOARD_NAME, "0KP561"),
  		},
  	},
 -
 -	/* Certec */
 -	{       /* Handle problems with rebooting on Certec BPC600 */
 -		.callback = set_pci_reboot,
 -		.ident = "Certec BPC600",
 +	{	/* Handle problems with rebooting on Dell Optiplex 360 with 0T656F */
 +		.callback = set_bios_reboot,
 +		.ident = "Dell OptiPlex 360",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Certec"),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "BPC600"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 360"),
 +			DMI_MATCH(DMI_BOARD_NAME, "0T656F"),
  		},
  	},
 -
 -	/* Dell */
 -	{	/* Handle problems with rebooting on Dell DXP061 */
 +	{	/* Handle problems with rebooting on Dell OptiPlex 760 with 0G919G */
  		.callback = set_bios_reboot,
 -		.ident = "Dell DXP061",
 +		.ident = "Dell OptiPlex 760",
  		.matches = {
  			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "Dell DXP061"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 760"),
 +			DMI_MATCH(DMI_BOARD_NAME, "0G919G"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Dell E520's */
 +	{	/* Handle problems with rebooting on Dell 2400's */
  		.callback = set_bios_reboot,
 -		.ident = "Dell E520",
 +		.ident = "Dell PowerEdge 2400",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "Dell DM061"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Dell Computer Corporation"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "PowerEdge 2400"),
  		},
  	},
 -	{	/* Handle problems with rebooting on the Latitude E5410. */
 -		.callback = set_pci_reboot,
 -		.ident = "Dell Latitude E5410",
 +	{	/* Handle problems with rebooting on Dell T5400's */
 +		.callback = set_bios_reboot,
 +		.ident = "Dell Precision T5400",
  		.matches = {
  			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "Latitude E5410"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "Precision WorkStation T5400"),
  		},
  	},
 -	{	/* Handle problems with rebooting on the Latitude E5420. */
 -		.callback = set_pci_reboot,
 -		.ident = "Dell Latitude E5420",
 +	{	/* Handle problems with rebooting on Dell T7400's */
 +		.callback = set_bios_reboot,
 +		.ident = "Dell Precision T7400",
  		.matches = {
  			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "Latitude E5420"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "Precision WorkStation T7400"),
  		},
  	},
 -	{	/* Handle problems with rebooting on the Latitude E6320. */
 -		.callback = set_pci_reboot,
 -		.ident = "Dell Latitude E6320",
 +	{	/* Handle problems with rebooting on HP laptops */
 +		.callback = set_bios_reboot,
 +		.ident = "HP Compaq Laptop",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "Latitude E6320"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Hewlett-Packard"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "HP Compaq"),
  		},
  	},
 -	{	/* Handle problems with rebooting on the Latitude E6420. */
 -		.callback = set_pci_reboot,
 -		.ident = "Dell Latitude E6420",
 +	{	/* Handle problems with rebooting on Dell XPS710 */
 +		.callback = set_bios_reboot,
 +		.ident = "Dell XPS710",
  		.matches = {
  			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "Latitude E6420"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "Dell XPS710"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Dell Optiplex 330 with 0KP561 */
 +	{	/* Handle problems with rebooting on Dell DXP061 */
  		.callback = set_bios_reboot,
 -		.ident = "Dell OptiPlex 330",
 +		.ident = "Dell DXP061",
  		.matches = {
  			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 330"),
 -			DMI_MATCH(DMI_BOARD_NAME, "0KP561"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "Dell DXP061"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Dell Optiplex 360 with 0T656F */
 +	{	/* Handle problems with rebooting on Sony VGN-Z540N */
  		.callback = set_bios_reboot,
 -		.ident = "Dell OptiPlex 360",
 +		.ident = "Sony VGN-Z540N",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 360"),
 -			DMI_MATCH(DMI_BOARD_NAME, "0T656F"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Sony Corporation"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "VGN-Z540N"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Dell Optiplex 745's SFF */
 +	{	/* Handle problems with rebooting on ASUS P4S800 */
  		.callback = set_bios_reboot,
 -		.ident = "Dell OptiPlex 745",
 +		.ident = "ASUS P4S800",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 745"),
 +			DMI_MATCH(DMI_BOARD_VENDOR, "ASUSTeK Computer INC."),
 +			DMI_MATCH(DMI_BOARD_NAME, "P4S800"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Dell Optiplex 745's DFF */
 -		.callback = set_bios_reboot,
 -		.ident = "Dell OptiPlex 745",
 +
 +	{	/* Handle reboot issue on Acer Aspire one */
 +		.callback = set_kbd_reboot,
 +		.ident = "Acer Aspire One A110",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 745"),
 -			DMI_MATCH(DMI_BOARD_NAME, "0MM599"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Acer"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "AOA110"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Dell Optiplex 745 with 0KW626 */
 -		.callback = set_bios_reboot,
 -		.ident = "Dell OptiPlex 745",
 +	{	/* Handle problems with rebooting on Apple MacBook5 */
 +		.callback = set_pci_reboot,
 +		.ident = "Apple MacBook5",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 745"),
 -			DMI_MATCH(DMI_BOARD_NAME, "0KW626"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Apple Inc."),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "MacBook5"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Dell OptiPlex 760 with 0G919G */
 -		.callback = set_bios_reboot,
 -		.ident = "Dell OptiPlex 760",
 +	{	/* Handle problems with rebooting on Apple MacBookPro5 */
 +		.callback = set_pci_reboot,
 +		.ident = "Apple MacBookPro5",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 760"),
 -			DMI_MATCH(DMI_BOARD_NAME, "0G919G"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Apple Inc."),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "MacBookPro5"),
  		},
  	},
 -	{	/* Handle problems with rebooting on the OptiPlex 990. */
 +	{	/* Handle problems with rebooting on Apple Macmini3,1 */
  		.callback = set_pci_reboot,
 -		.ident = "Dell OptiPlex 990",
 +		.ident = "Apple Macmini3,1",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 990"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Apple Inc."),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "Macmini3,1"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Dell 300's */
 -		.callback = set_bios_reboot,
 -		.ident = "Dell PowerEdge 300",
 +	{	/* Handle problems with rebooting on the iMac9,1. */
 +		.callback = set_pci_reboot,
 +		.ident = "Apple iMac9,1",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Dell Computer Corporation"),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "PowerEdge 300/"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Apple Inc."),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "iMac9,1"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Dell 1300's */
 -		.callback = set_bios_reboot,
 -		.ident = "Dell PowerEdge 1300",
++<<<<<<< HEAD
 +	{	/* Handle problems with rebooting on the Latitude E6320. */
++=======
++
++	/* ASRock */
++	{	/* Handle problems with rebooting on ASRock Q1900DC-ITX */
++		.callback = set_pci_reboot,
++		.ident = "ASRock Q1900DC-ITX",
+ 		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Dell Computer Corporation"),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "PowerEdge 1300/"),
++			DMI_MATCH(DMI_BOARD_VENDOR, "ASRock"),
++			DMI_MATCH(DMI_BOARD_NAME, "Q1900DC-ITX"),
+ 		},
+ 	},
 -	{	/* Handle problems with rebooting on Dell 2400's */
++
++	/* ASUS */
++	{	/* Handle problems with rebooting on ASUS P4S800 */
+ 		.callback = set_bios_reboot,
 -		.ident = "Dell PowerEdge 2400",
++		.ident = "ASUS P4S800",
+ 		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Dell Computer Corporation"),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "PowerEdge 2400"),
++			DMI_MATCH(DMI_BOARD_VENDOR, "ASUSTeK Computer INC."),
++			DMI_MATCH(DMI_BOARD_NAME, "P4S800"),
+ 		},
+ 	},
 -	{	/* Handle problems with rebooting on the Dell PowerEdge C6100. */
++
++	/* Certec */
++	{       /* Handle problems with rebooting on Certec BPC600 */
++>>>>>>> 80313b3078fc (x86/reboot: Add ASRock Q1900DC-ITX mainboard reboot quirk)
  		.callback = set_pci_reboot,
 -		.ident = "Dell PowerEdge C6100",
 +		.ident = "Dell Latitude E6320",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Dell"),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "C6100"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "Latitude E6320"),
  		},
  	},
 -	{	/* Handle problems with rebooting on the Precision M6600. */
 +	{	/* Handle problems with rebooting on the Latitude E5420. */
  		.callback = set_pci_reboot,
 -		.ident = "Dell Precision M6600",
 +		.ident = "Dell Latitude E5420",
  		.matches = {
  			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "Precision M6600"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "Latitude E5420"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Dell T5400's */
 -		.callback = set_bios_reboot,
 -		.ident = "Dell Precision T5400",
 +	{	/* Handle problems with rebooting on the Latitude E6420. */
 +		.callback = set_pci_reboot,
 +		.ident = "Dell Latitude E6420",
  		.matches = {
  			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "Precision WorkStation T5400"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "Latitude E6420"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Dell T7400's */
 -		.callback = set_bios_reboot,
 -		.ident = "Dell Precision T7400",
 +	{	/* Handle problems with rebooting on the OptiPlex 990. */
 +		.callback = set_pci_reboot,
 +		.ident = "Dell OptiPlex 990",
  		.matches = {
  			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "Precision WorkStation T7400"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "OptiPlex 990"),
  		},
  	},
 -	{	/* Handle problems with rebooting on Dell XPS710 */
 -		.callback = set_bios_reboot,
 -		.ident = "Dell XPS710",
 +	{	/* Handle problems with rebooting on the Precision M6600. */
 +		.callback = set_pci_reboot,
 +		.ident = "Dell OptiPlex 990",
  		.matches = {
  			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "Dell XPS710"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "Precision M6600"),
  		},
  	},
 -
 -	/* Hewlett-Packard */
 -	{	/* Handle problems with rebooting on HP laptops */
 -		.callback = set_bios_reboot,
 -		.ident = "HP Compaq Laptop",
 +	{	/* Handle problems with rebooting on the Dell PowerEdge C6100. */
 +		.callback = set_pci_reboot,
 +		.ident = "Dell PowerEdge C6100",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Hewlett-Packard"),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "HP Compaq"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Dell Inc."),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "C6100"),
  		},
  	},
 -
 -	/* Sony */
 -	{	/* Handle problems with rebooting on Sony VGN-Z540N */
 -		.callback = set_bios_reboot,
 -		.ident = "Sony VGN-Z540N",
 +	{	/* Some C6100 machines were shipped with vendor being 'Dell'. */
 +		.callback = set_pci_reboot,
 +		.ident = "Dell PowerEdge C6100",
  		.matches = {
 -			DMI_MATCH(DMI_SYS_VENDOR, "Sony Corporation"),
 -			DMI_MATCH(DMI_PRODUCT_NAME, "VGN-Z540N"),
 +			DMI_MATCH(DMI_SYS_VENDOR, "Dell"),
 +			DMI_MATCH(DMI_PRODUCT_NAME, "C6100"),
  		},
  	},
 -
  	{ }
  };
  
* Unmerged path arch/x86/kernel/reboot.c
