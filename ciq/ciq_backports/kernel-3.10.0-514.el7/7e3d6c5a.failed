powerpc/cell: Move MSI-related ops to pci_controller_ops

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [powerpc] cell: Move MSI-related ops to pci_controller_ops (Gustavo Duarte) [1275657]
Rebuild_FUZZ: 92.31%
commit-author Daniel Axtens <dja@axtens.net>
commit 7e3d6c5a4be45769a9d439a4b62ad85cfe9e6754
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/7e3d6c5a.failed

Move the Cell platform to use the pci_controller_ops structure rather
than ppc_md for MSI related PCI controller operations.

We can be confident that the functions will be added to the platform's
ops struct before any PCI controller's ops struct is populated
because:

1) These ops are added to the struct in a subsys initcall.

We populate the ops in axon_msi_probe, which is the probe call for the
axon-msi driver. However the driver is registered in axon_msi_init,
which is a subsys initcall, so this will happen at the subsys level.

2) The controller recieves the struct later, in a device initcall.

Cell populates the controller in cell_setup_phb, which is hooked up to
ppc_md.pci_setup_phb. ppc_md.pci_setup_phb is only ever called in
of_platform.c, as part of the OpenFirmware PCI driver's probe
routine. That driver is registered in a device initcall, so it will
occur *after* the struct is properly populated.

	Signed-off-by: Daniel Axtens <dja@axtens.net>
	Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
(cherry picked from commit 7e3d6c5a4be45769a9d439a4b62ad85cfe9e6754)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/powerpc/platforms/cell/axon_msi.c
diff --cc arch/powerpc/platforms/cell/axon_msi.c
index 85825b5401e5,d9b8a443458f..000000000000
--- a/arch/powerpc/platforms/cell/axon_msi.c
+++ b/arch/powerpc/platforms/cell/axon_msi.c
@@@ -414,9 -407,8 +415,14 @@@ static int axon_msi_probe(struct platfo
  
  	dev_set_drvdata(&device->dev, msic);
  
++<<<<<<< HEAD
 +	ppc_md.setup_msi_irqs = axon_msi_setup_msi_irqs;
 +	ppc_md.teardown_msi_irqs = axon_msi_teardown_msi_irqs;
 +	ppc_md.msi_check_device = axon_msi_check_device;
++=======
+ 	cell_pci_controller_ops.setup_msi_irqs = axon_msi_setup_msi_irqs;
+ 	cell_pci_controller_ops.teardown_msi_irqs = axon_msi_teardown_msi_irqs;
++>>>>>>> 7e3d6c5a4be4 (powerpc/cell: Move MSI-related ops to pci_controller_ops)
  
  	axon_msi_debug_setup(dn, msic);
  
* Unmerged path arch/powerpc/platforms/cell/axon_msi.c
