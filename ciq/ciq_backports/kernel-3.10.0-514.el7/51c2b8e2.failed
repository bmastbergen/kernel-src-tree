IB/srp: Remove srp_finish_mapping

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Sagi Grimberg <sagig@mellanox.com>
commit 51c2b8e2ac872cd90a12c5e606eeb0daf1a91e25
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/51c2b8e2.failed

No callers left, remove it.

	Signed-off-by: Sagi Grimberg <sagig@mellanox.com>
	Tested-by: Bart Van Assche <bart.vanassche@sandisk.com>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 51c2b8e2ac872cd90a12c5e606eeb0daf1a91e25)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/ulp/srp/ib_srp.c
diff --cc drivers/infiniband/ulp/srp/ib_srp.c
index feb0c8ea0788,cf54e239f842..000000000000
--- a/drivers/infiniband/ulp/srp/ib_srp.c
+++ b/drivers/infiniband/ulp/srp/ib_srp.c
@@@ -1338,39 -1358,16 +1338,42 @@@ static int srp_map_finish_fr(struct srp
  	*state->fr.next++ = desc;
  	state->nmdesc++;
  
 -	srp_map_desc(state, desc->mr->iova,
 -		     desc->mr->length, desc->mr->rkey);
 +	srp_map_desc(state, state->base_dma_addr, state->dma_len,
 +		     desc->mr->rkey);
 +
 +	return ib_post_send(ch->qp, &wr, &bad_wr);
 +}
 +
++<<<<<<< HEAD
 +static int srp_finish_mapping(struct srp_map_state *state,
 +			      struct srp_rdma_ch *ch)
 +{
 +	struct srp_target_port *target = ch->target;
 +	struct srp_device *dev = target->srp_host->srp_dev;
 +	int ret = 0;
  
 -	err = ib_post_send(ch->qp, &wr.wr, &bad_wr);
 -	if (unlikely(err))
 -		return err;
 +	WARN_ON_ONCE(!dev->use_fast_reg && !dev->use_fmr);
  
 -	return n;
 +	if (state->npages == 0)
 +		return 0;
 +
 +	if (state->npages == 1 && target->global_mr)
 +		srp_map_desc(state, state->base_dma_addr, state->dma_len,
 +			     target->global_mr->rkey);
 +	else
 +		ret = dev->use_fast_reg ? srp_map_finish_fr(state, ch) :
 +			srp_map_finish_fmr(state, ch);
 +
 +	if (ret == 0) {
 +		state->npages = 0;
 +		state->dma_len = 0;
 +	}
 +
 +	return ret;
  }
  
++=======
++>>>>>>> 51c2b8e2ac87 (IB/srp: Remove srp_finish_mapping)
  static int srp_map_sg_entry(struct srp_map_state *state,
  			    struct srp_rdma_ch *ch,
  			    struct scatterlist *sg, int sg_index)
* Unmerged path drivers/infiniband/ulp/srp/ib_srp.c
