drm/dp/mst: Always clear proposed vcpi table for port.

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [drm] dp/mst: Always clear proposed vcpi table for port (Rob Clark) [1348329 1349064]
Rebuild_FUZZ: 95.15%
commit-author Andrey Grodzovsky <Andrey.Grodzovsky@amd.com>
commit fd2d2bac6e79b0be91ab86a6075a0c46ffda658a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/fd2d2bac.failed

Not clearing mst manager's proposed vcpis table for destroyed connectors when the manager is stopped leaves it pointing to unrefernced memory, this causes pagefault when the manager is restarted when plugging back a branch.

Fixes: 91a25e463130 ("drm/dp/mst: deallocate payload on port destruction")
	Signed-off-by: Andrey Grodzovsky <Andrey.Grodzovsky@amd.com>
	Reviewed-by: Lyude <cpaul@redhat.com>
	Cc: stable@vger.kernel.org
	Cc: Mykola Lysenko <Mykola.Lysenko@amd.com>
	Cc: Alex Deucher <alexander.deucher@amd.com>
(cherry picked from commit fd2d2bac6e79b0be91ab86a6075a0c46ffda658a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/drm_dp_mst_topology.c
diff --cc drivers/gpu/drm/drm_dp_mst_topology.c
index 54676b5f3cd9,6537908050d7..000000000000
--- a/drivers/gpu/drm/drm_dp_mst_topology.c
+++ b/drivers/gpu/drm/drm_dp_mst_topology.c
@@@ -2717,9 -2926,13 +2717,19 @@@ static void drm_dp_destroy_connector_wo
  
  		drm_dp_port_teardown_pdt(port, port->pdt);
  
++<<<<<<< HEAD
 +		if (!port->input && port->vcpi.vcpi > 0)
 +			drm_dp_mst_put_payload_id(mgr, port->vcpi.vcpi);
 +		kfree(port);
++=======
+ 		if (!port->input && port->vcpi.vcpi > 0) {
+ 			drm_dp_mst_reset_vcpi_slots(mgr, port);
+ 			drm_dp_update_payload_part1(mgr);
+ 			drm_dp_mst_put_payload_id(mgr, port->vcpi.vcpi);
+ 		}
+ 
+ 		kref_put(&port->kref, drm_dp_free_mst_port);
++>>>>>>> fd2d2bac6e79 (drm/dp/mst: Always clear proposed vcpi table for port.)
  		send_hotplug = true;
  	}
  	if (send_hotplug)
* Unmerged path drivers/gpu/drm/drm_dp_mst_topology.c
