usb: phy: msm: reset controller is mandatory now

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [usb] phy: msm: reset controller is mandatory now (Don Zickus) [1303209]
Rebuild_FUZZ: 94.51%
commit-author Arnd Bergmann <arnd@arndb.de>
commit c5ab571f81905568a59dce306df0181f33e00932
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/c5ab571f.failed

Commit a27345434134 "usb: phy: msm: Use reset framework for LINK
and PHY resets" introduced a mandatory call to reset_control_get
into the msm usb phy driver, which means we have to add a Kconfig
dependency on the API to avoid this build error:

phy/phy-msm-usb.c: In function 'msm_otg_read_dt':
phy/phy-msm-usb.c:1461:2: error: implicit declaration of function 'devm_reset_control_get' [-Werror=implicit-function-declaration]
  motg->link_rst = devm_reset_control_get(&pdev->dev, "link");
  ^

Since the usb-ehci-msm driver currently selects the OTG driver,
we could still get a broken dependency here. To solve that,
this patch also removes the 'select', which turns out to be
unnecessary.

	Reviewed-by: Ivan T. Ivanov <iivanov@mm-sol.com>
	Signed-off-by: Arnd Bergmann <arnd@arndb.de>
	Signed-off-by: Felipe Balbi <balbi@ti.com>
(cherry picked from commit c5ab571f81905568a59dce306df0181f33e00932)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/usb/phy/Kconfig
diff --cc drivers/usb/phy/Kconfig
index d79d8a378d8c,ec531a48d240..000000000000
--- a/drivers/usb/phy/Kconfig
+++ b/drivers/usb/phy/Kconfig
@@@ -151,14 -168,15 +151,20 @@@ config USB_ISP130
  	  and OTG drivers (to be selected separately).
  
  	  To compile this driver as a module, choose M here: the
 -	  module will be called phy-isp1301.
 +	  module will be called isp1301.
  
  config USB_MSM_OTG
++<<<<<<< HEAD
 +	tristate "OTG support for Qualcomm on-chip USB controller"
 +	depends on (USB || USB_GADGET) && ARCH_MSM
++=======
+ 	tristate "Qualcomm on-chip USB OTG controller support"
+ 	depends on (USB || USB_GADGET) && (ARCH_MSM || ARCH_QCOM || COMPILE_TEST)
+ 	depends on RESET_CONTROLLER
++>>>>>>> c5ab571f8190 (usb: phy: msm: reset controller is mandatory now)
  	select USB_PHY
  	help
 -	  Enable this to support the USB OTG transceiver on Qualcomm chips. It
 +	  Enable this to support the USB OTG transceiver on MSM chips. It
  	  handles PHY initialization, clock management, and workarounds
  	  required after resetting the hardware and power management.
  	  This driver is required even for peripheral only or host only
diff --git a/drivers/usb/host/Kconfig b/drivers/usb/host/Kconfig
index 14e3c49416bf..bce7ecf99333 100644
--- a/drivers/usb/host/Kconfig
+++ b/drivers/usb/host/Kconfig
@@ -175,7 +175,6 @@ config USB_EHCI_MSM
 	tristate "Support for Qualcomm QSD/MSM on-chip EHCI USB controller"
 	depends on ARCH_MSM
 	select USB_EHCI_ROOT_HUB_TT
-	select USB_MSM_OTG
 	---help---
 	  Enables support for the USB Host controller present on the
 	  Qualcomm chipsets. Root Hub has inbuilt TT.
* Unmerged path drivers/usb/phy/Kconfig
