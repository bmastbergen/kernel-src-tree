mmc: sdhci-pci: fix 64 BIT DMA quirks for rtsx

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [mmc] sdhci-pci: fix 64 BIT DMA quirks for rtsx (Don Zickus) [1127975 1277866 1280133 1286932 1297039]
Rebuild_FUZZ: 94.25%
commit-author Micky Ching <micky_ching@realsil.com.cn>
commit e30b978f17446d10dcb92c6979b4da9991a18005
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/e30b978f.failed

rts5250 chip failed handle 64 bit ADMA for address below 4G.
Add 64 BIT quirks to disable this feature.

	Signed-off-by: Micky Ching <micky_ching@realsil.com.cn>
	Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
(cherry picked from commit e30b978f17446d10dcb92c6979b4da9991a18005)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/mmc/host/sdhci-pci.c
diff --cc drivers/mmc/host/sdhci-pci.c
index a627aad5414a,7a3fc16d0a6c..000000000000
--- a/drivers/mmc/host/sdhci-pci.c
+++ b/drivers/mmc/host/sdhci-pci.c
@@@ -581,6 -642,38 +581,41 @@@ static const struct sdhci_pci_fixes sdh
  	.probe		= via_probe,
  };
  
++<<<<<<< HEAD
++=======
+ static int rtsx_probe_slot(struct sdhci_pci_slot *slot)
+ {
+ 	slot->host->mmc->caps2 |= MMC_CAP2_HS200;
+ 	return 0;
+ }
+ 
+ static const struct sdhci_pci_fixes sdhci_rtsx = {
+ 	.quirks2	= SDHCI_QUIRK2_PRESET_VALUE_BROKEN |
+ 			SDHCI_QUIRK2_BROKEN_64_BIT_DMA |
+ 			SDHCI_QUIRK2_BROKEN_DDR50,
+ 	.probe_slot	= rtsx_probe_slot,
+ };
+ 
+ static int amd_probe(struct sdhci_pci_chip *chip)
+ {
+ 	struct pci_dev	*smbus_dev;
+ 
+ 	smbus_dev = pci_get_device(PCI_VENDOR_ID_AMD,
+ 			PCI_DEVICE_ID_AMD_HUDSON2_SMBUS, NULL);
+ 
+ 	if (smbus_dev && (smbus_dev->revision < 0x51)) {
+ 		chip->quirks2 |= SDHCI_QUIRK2_CLEAR_TRANSFERMODE_REG_BEFORE_CMD;
+ 		chip->quirks2 |= SDHCI_QUIRK2_BROKEN_HS200;
+ 	}
+ 
+ 	return 0;
+ }
+ 
+ static const struct sdhci_pci_fixes sdhci_amd = {
+ 	.probe		= amd_probe,
+ };
+ 
++>>>>>>> e30b978f1744 (mmc: sdhci-pci: fix 64 BIT DMA quirks for rtsx)
  static const struct pci_device_id pci_ids[] = {
  	{
  		.vendor		= PCI_VENDOR_ID_RICOH,
* Unmerged path drivers/mmc/host/sdhci-pci.c
