xfs: fix error gotos in xfs_setattr_nonsize

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Eric Sandeen <sandeen@redhat.com>
commit 1a7ccad88d1bcebabc011b54a2f8615175e523fc
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/1a7ccad8.failed

As the code stands today, if xfs_trans_reserve() fails, we
goto out_dqrele, which does not free the allocated transaction.

Fix up the goto targets to undo everything properly.

Addresses-Coverity-Id: 145571
	Signed-off-by: Eric Sandeen <sandeen@redhat.com>
	Reviewed-by: Dave Chinner <dchinner@redhat.com>
	Signed-off-by: Dave Chinner <david@fromorbit.com>

(cherry picked from commit 1a7ccad88d1bcebabc011b54a2f8615175e523fc)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/xfs/xfs_iops.c
diff --cc fs/xfs/xfs_iops.c
index 5e33f3364b73,8294132e6a3c..000000000000
--- a/fs/xfs/xfs_iops.c
+++ b/fs/xfs/xfs_iops.c
@@@ -729,10 -729,10 +729,16 @@@ xfs_setattr_nonsize
  
  	return 0;
  
+ out_unlock:
+ 	xfs_iunlock(ip, XFS_ILOCK_EXCL);
  out_trans_cancel:
++<<<<<<< HEAD
 +	xfs_trans_cancel(tp, 0);
 +	xfs_iunlock(ip, XFS_ILOCK_EXCL);
 +out_dqrele:
++=======
+ 	xfs_trans_cancel(tp);
++>>>>>>> 1a7ccad88d1b (xfs: fix error gotos in xfs_setattr_nonsize)
  	xfs_qm_dqrele(udqp);
  	xfs_qm_dqrele(gdqp);
  	return error;
* Unmerged path fs/xfs/xfs_iops.c
