IB/core: Fix bit curruption in ib_device_cap_flags structure

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Max Gurtovoy <maxg@mellanox.com>
commit 47355b3cd7d3c9c5226bff7c449b9d269fb17fa6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/47355b3c.failed

ib_device_cap_flags 64-bit expansion caused caps overlapping
and made consumers read wrong device capabilities. For example
IB_DEVICE_SG_GAPS_REG was falsely read by the iser driver causing
it to use a non-existing capability. This happened because signed
int becomes sign extended when converted it to u64. Fix this by
casting IB_DEVICE_ON_DEMAND_PAGING enumeration to ULL.

Fixes: f5aa9159a418 ('IB/core: Add arbitrary sg_list support')
	Reported-by: Robert LeBlanc <robert@leblancnet.us>
	Cc: Stable <stable@vger.kernel.org> #[v4.6+]
	Acked-by: Sagi Grimberg <sagi@grimberg.me>
	Signed-off-by: Max Gurtovoy <maxg@mellanox.com>
	Signed-off-by: Matan Barak <matanb@mellanox.com>
	Reviewed-by: Christoph Hellwig <hch@lst.de>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 47355b3cd7d3c9c5226bff7c449b9d269fb17fa6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/rdma/ib_verbs.h
diff --cc include/rdma/ib_verbs.h
index 76a9d34c9fb5,c97357b6c276..000000000000
--- a/include/rdma/ib_verbs.h
+++ b/include/rdma/ib_verbs.h
@@@ -173,7 -217,10 +173,14 @@@ enum ib_device_cap_flags 
  	IB_DEVICE_CROSS_CHANNEL		= (1 << 27),
  	IB_DEVICE_MANAGED_FLOW_STEERING		= (1 << 29),
  	IB_DEVICE_SIGNATURE_HANDOVER		= (1 << 30),
++<<<<<<< HEAD
 +	IB_DEVICE_ON_DEMAND_PAGING		= (1 << 31),
++=======
+ 	IB_DEVICE_ON_DEMAND_PAGING		= (1ULL << 31),
+ 	IB_DEVICE_SG_GAPS_REG			= (1ULL << 32),
+ 	IB_DEVICE_VIRTUAL_FUNCTION		= ((u64)1 << 33),
+ 	IB_DEVICE_RAW_SCATTER_FCS		= ((u64)1 << 34),
++>>>>>>> 47355b3cd7d3 (IB/core: Fix bit curruption in ib_device_cap_flags structure)
  };
  
  enum ib_signature_prot_cap {
* Unmerged path include/rdma/ib_verbs.h
