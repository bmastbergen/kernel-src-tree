IB/qib: Fix qib_mr structure

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Ira Weiny <ira.weiny@intel.com>
commit 785f742223c03ec70f9dcf36b87f59e9df2067e0
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/785f7422.failed

struct qib_mr requires the mr member be the last because struct
qib_mregion contains a dynamic array at the end.  The additions
of members should have been placed before this structure as the
comment noted.

Failure to do so was causing random memory corruption.  Reproducing
this bug was easy to do by running the client and server of
ib_write_bw -s 8 -n 5 on the same node.

This BUG() was tripped in a slab debug kernel:

kernel BUG at mm/slab.c:2572!

Fixes: 38071a461f0a ("IB/qib: Support the new memory registration API")
	Reviewed-by: Mike Marciniszyn <mike.marciniszyn@intel.com>
	Signed-off-by: Ira Weiny <ira.weiny@intel.com>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 785f742223c03ec70f9dcf36b87f59e9df2067e0)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/qib/qib_verbs.h
diff --cc drivers/infiniband/hw/qib/qib_verbs.h
index a08df70e8503,bc803f33d5f6..000000000000
--- a/drivers/infiniband/hw/qib/qib_verbs.h
+++ b/drivers/infiniband/hw/qib/qib_verbs.h
@@@ -329,6 -329,8 +329,11 @@@ struct qib_sge 
  struct qib_mr {
  	struct ib_mr ibmr;
  	struct ib_umem *umem;
++<<<<<<< HEAD
++=======
+ 	u64 *pages;
+ 	u32 npages;
++>>>>>>> 785f742223c0 (IB/qib: Fix qib_mr structure)
  	struct qib_mregion mr;  /* must be last */
  };
  
* Unmerged path drivers/infiniband/hw/qib/qib_verbs.h
