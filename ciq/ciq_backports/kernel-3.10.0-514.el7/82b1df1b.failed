iw_cxgb4: Fixes static checker warning in c4iw_rdev_open()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Hariprasad S <hariprasad@chelsio.com>
commit 82b1df1b083ff1b1c45fcdf5a844351cdca03ed8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/82b1df1b.failed

Commit c5dfb000b904 ("iw_cxgb4: Pass qid range to user space driver")
from Dec 11, 2015, leads to the following static checker warning:

	drivers/infiniband/hw/cxgb4/device.c:857 c4iw_rdev_open()
        warn: variable dereferenced before check 'rdev->status_page'

Also we weren't deallocating ocqp pool in error path when failed to
allocate status page. Fixing it too.

Fixes: c5dfb000b904 ("iw_cxgb4: Pass qid range to user space driver")
	Reported-by: Dan Carpenter <dan.carpenter@oracle.com>
	Signed-off-by: Hariprasad Shenai <hariprasad@chelsio.com>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 82b1df1b083ff1b1c45fcdf5a844351cdca03ed8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/cxgb4/device.c
diff --cc drivers/infiniband/hw/cxgb4/device.c
index 5456dc8dc5df,2a3490fab914..000000000000
--- a/drivers/infiniband/hw/cxgb4/device.c
+++ b/drivers/infiniband/hw/cxgb4/device.c
@@@ -866,10 -856,7 +868,14 @@@ static int c4iw_rdev_open(struct c4iw_r
  	rdev->status_page->qp_size = rdev->lldi.vr->qp.size;
  	rdev->status_page->cq_start = rdev->lldi.vr->cq.start;
  	rdev->status_page->cq_size = rdev->lldi.vr->cq.size;
++<<<<<<< HEAD
 +	if (!rdev->status_page) {
 +		pr_err(MOD "error allocating status page\n");
 +		goto err4;
 +	}
++=======
+ 
++>>>>>>> 82b1df1b083f (iw_cxgb4: Fixes static checker warning in c4iw_rdev_open())
  	if (c4iw_wr_log) {
  		rdev->wr_log = kzalloc((1 << c4iw_wr_log_size_order) *
  				       sizeof(*rdev->wr_log), GFP_KERNEL);
@@@ -880,8 -867,12 +886,10 @@@
  			pr_err(MOD "error allocating wr_log. Logging disabled\n");
  		}
  	}
 -
  	rdev->status_page->db_off = 0;
 -
  	return 0;
+ destroy_ocqp_pool:
+ 	c4iw_ocqp_pool_destroy(rdev);
  err4:
  	c4iw_rqtpool_destroy(rdev);
  err3:
* Unmerged path drivers/infiniband/hw/cxgb4/device.c
