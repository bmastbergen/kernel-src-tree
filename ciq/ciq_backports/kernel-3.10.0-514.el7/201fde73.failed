perf hists browser: Cleanup hist_browser__update_percent_limit()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Namhyung Kim <namhyung@kernel.org>
commit 201fde73b111e7c31fdc0e9fa6bc4b73dfef699d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/201fde73.failed

The previous patch introduced __rb_hierarchy_next() function with
various move direction like HMD_FORCE_CHILD but missed to change using
it some place.

	Signed-off-by: Namhyung Kim <namhyung@kernel.org>
	Cc: Andi Kleen <andi@firstfloor.org>
	Cc: David Ahern <dsahern@gmail.com>
	Cc: Jiri Olsa <jolsa@kernel.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Stephane Eranian <eranian@google.com>
	Cc: Wang Nan <wangnan0@huawei.com>
Link: http://lkml.kernel.org/r/1456488800-28124-3-git-send-email-namhyung@kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 201fde73b111e7c31fdc0e9fa6bc4b73dfef699d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/ui/browsers/hists.c
diff --cc tools/perf/ui/browsers/hists.c
index d1445dd5bb7f,904eaa719eb3..000000000000
--- a/tools/perf/ui/browsers/hists.c
+++ b/tools/perf/ui/browsers/hists.c
@@@ -2116,6 -2448,43 +2116,46 @@@ static void hist_browser__update_nr_ent
  	hb->nr_hierarchy_entries = nr_entries;
  }
  
++<<<<<<< HEAD
++=======
+ static void hist_browser__update_percent_limit(struct hist_browser *hb,
+ 					       double percent)
+ {
+ 	struct hist_entry *he;
+ 	struct rb_node *nd = rb_first(&hb->hists->entries);
+ 	u64 total = hists__total_period(hb->hists);
+ 	u64 min_callchain_hits = total * (percent / 100);
+ 
+ 	hb->min_pcnt = callchain_param.min_percent = percent;
+ 
+ 	while ((nd = hists__filter_entries(nd, hb->min_pcnt)) != NULL) {
+ 		he = rb_entry(nd, struct hist_entry, rb_node);
+ 
+ 		if (!he->leaf || !symbol_conf.use_callchain)
+ 			goto next;
+ 
+ 		if (callchain_param.mode == CHAIN_GRAPH_REL) {
+ 			total = he->stat.period;
+ 
+ 			if (symbol_conf.cumulate_callchain)
+ 				total = he->stat_acc->period;
+ 
+ 			min_callchain_hits = total * (percent / 100);
+ 		}
+ 
+ 		callchain_param.sort(&he->sorted_chain, he->callchain,
+ 				     min_callchain_hits, &callchain_param);
+ 
+ next:
+ 		nd = __rb_hierarchy_next(nd, HMD_FORCE_CHILD);
+ 
+ 		/* force to re-evaluate folding state of callchains */
+ 		he->init_have_children = false;
+ 		hist_entry__set_folding(he, hb, false);
+ 	}
+ }
+ 
++>>>>>>> 201fde73b111 (perf hists browser: Cleanup hist_browser__update_percent_limit())
  static int perf_evsel__hists_browse(struct perf_evsel *evsel, int nr_events,
  				    const char *helpline,
  				    bool left_exits,
* Unmerged path tools/perf/ui/browsers/hists.c
