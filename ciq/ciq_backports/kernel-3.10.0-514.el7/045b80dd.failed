perf hists browser: Use the map to determine if a DSO is being used as a kernel

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Arnaldo Carvalho de Melo <acme@redhat.com>
commit 045b80dd03403b8e61a29460987c231317ebfbd4
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/045b80dd.failed

The map is what should say if an ELF (or some other format) image is
being used for some particular purpose, as a kernel, host or guest.

	Cc: Adrian Hunter <adrian.hunter@intel.com>
	Cc: Borislav Petkov <bp@suse.de>
	Cc: David Ahern <dsahern@gmail.com>
	Cc: Frederic Weisbecker <fweisbec@gmail.com>
	Cc: Jiri Olsa <jolsa@redhat.com>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: Stephane Eranian <eranian@google.com>
	Cc: Wang Nan <wangnan0@huawei.com>
Link: http://lkml.kernel.org/n/tip-zufousvfar0710p4qj71c32d@git.kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 045b80dd03403b8e61a29460987c231317ebfbd4)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/ui/browsers/hists.c
diff --cc tools/perf/ui/browsers/hists.c
index 4d15f0925a18,a4e9b370c037..000000000000
--- a/tools/perf/ui/browsers/hists.c
+++ b/tools/perf/ui/browsers/hists.c
@@@ -1768,7 -1815,9 +1769,8 @@@ static int perf_evsel__hists_browse(str
  	while (1) {
  		struct thread *thread = NULL;
  		struct dso *dso = NULL;
+ 		struct map *map = NULL;
  		int choice = 0;
 -		int socked_id = -1;
  
  		nr_options = 0;
  
@@@ -1776,7 -1825,10 +1778,14 @@@
  
  		if (browser->he_selection != NULL) {
  			thread = hist_browser__selected_thread(browser);
++<<<<<<< HEAD
 +			dso = browser->selection->map ? browser->selection->map->dso : NULL;
++=======
+ 			map = browser->selection->map;
+ 			if (map)
+ 				dso = map->dso;
+ 			socked_id = browser->he_selection->socket;
++>>>>>>> 045b80dd0340 (perf hists browser: Use the map to determine if a DSO is being used as a kernel)
  		}
  		switch (key) {
  		case K_TAB:
* Unmerged path tools/perf/ui/browsers/hists.c
