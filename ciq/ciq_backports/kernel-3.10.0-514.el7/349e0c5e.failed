lan78xx: add ethtool set & get pause functions

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Woojung.Huh@microchip.com <Woojung.Huh@microchip.com>
commit 349e0c5e2237744d2acc1bdb52526a69c5fdcd52
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/349e0c5e.failed

Add ethtool operations of set_pauseram and get_pauseparm.

	Signed-off-by: Woojung Huh <woojung.huh@microchip.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 349e0c5e2237744d2acc1bdb52526a69c5fdcd52)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/usb/lan78xx.c
diff --cc drivers/net/usb/lan78xx.c
index 1aed9b7a065d,705c180163c5..000000000000
--- a/drivers/net/usb/lan78xx.c
+++ b/drivers/net/usb/lan78xx.c
@@@ -36,7 -36,7 +36,11 @@@
  #define DRIVER_AUTHOR	"WOOJUNG HUH <woojung.huh@microchip.com>"
  #define DRIVER_DESC	"LAN78XX USB 3.0 Gigabit Ethernet Devices"
  #define DRIVER_NAME	"lan78xx"
++<<<<<<< HEAD
 +#define DRIVER_VERSION	"1.0.1"
++=======
+ #define DRIVER_VERSION	"1.0.3"
++>>>>>>> 349e0c5e2237 (lan78xx: add ethtool set & get pause functions)
  
  #define TX_TIMEOUT_JIFFIES		(5 * HZ)
  #define THROTTLE_JIFFIES		(HZ / 8)
@@@ -279,8 -278,12 +283,11 @@@ struct lan78xx_net 
  	int			link_on;
  	u8			mdix_ctrl;
  
 -	u32			chipid;
 -	u32			chiprev;
 +	u32			devid;
  	struct mii_bus		*mdiobus;
+ 
+ 	int			fc_autoneg;
+ 	u8			fc_request_control;
  };
  
  /* use ethtool to change the level for any given device */
@@@ -1654,16 -1690,16 +1724,27 @@@ static int lan78xx_phy_init(struct lan7
  	/* MAC doesn't support 1000T Half */
  	phydev->supported &= ~SUPPORTED_1000baseT_Half;
  
+ 	/* support both flow controls */
+ 	dev->fc_request_control = (FLOW_CTRL_RX | FLOW_CTRL_TX);
+ 	phydev->advertising &= ~(ADVERTISED_Pause | ADVERTISED_Asym_Pause);
+ 	mii_adv = (u32)mii_advertise_flowctrl(dev->fc_request_control);
+ 	phydev->advertising |= mii_adv_to_ethtool_adv_t(mii_adv);
+ 
  	genphy_config_aneg(phydev);
  
++<<<<<<< HEAD
 +	/* Workaround to enable PHY interrupt.
 +	 * phy_start_interrupts() is API for requesting and enabling
 +	 * PHY interrupt. However, USB-to-Ethernet device can't use
 +	 * request_irq() called in phy_start_interrupts().
 +	 * Set PHY to PHY_HALTED and call phy_start()
 +	 * to make a call to phy_enable_interrupts()
 +	 */
 +	phy_stop(phydev);
++=======
+ 	dev->fc_autoneg = phydev->autoneg;
+ 
++>>>>>>> 349e0c5e2237 (lan78xx: add ethtool set & get pause functions)
  	phy_start(phydev);
  
  	netif_dbg(dev, ifup, dev->net, "phy initialised successfully");
* Unmerged path drivers/net/usb/lan78xx.c
