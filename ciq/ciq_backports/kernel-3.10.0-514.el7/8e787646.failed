IB/core: Fix removal of default GID cache entry

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Aviv Heller <avivh@mellanox.com>
commit 8e787646fbce895c20c4433973e90af90e1c6a28
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/8e787646.failed

When deleting a default GID from the cache, its gid_type field is set
to 0.

This could set the gid_type to RoCE v1 for a RoCE v2 default GID,
essentially making it inaccessible to future modifications, since it
is no longer found by find_gid().

This fix preserves the gid_type value for default gids during cache
operations.

Fixes: b39ffa1df505 ('IB/core: Add gid_type to gid attribute')
	Signed-off-by: Aviv Heller <avivh@mellanox.com>
	Signed-off-by: Leon Romanovsky <leon@kernel.org>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 8e787646fbce895c20c4433973e90af90e1c6a28)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/core/cache.c
diff --cc drivers/infiniband/core/cache.c
index 6fa1f5fbfcef,040966775f40..000000000000
--- a/drivers/infiniband/core/cache.c
+++ b/drivers/infiniband/core/cache.c
@@@ -135,7 -178,7 +135,11 @@@ static int write_gid(struct ib_device *
  {
  	int ret = 0;
  	struct net_device *old_net_dev;
++<<<<<<< HEAD
 +	unsigned long flags;
++=======
+ 	enum ib_gid_type old_gid_type;
++>>>>>>> 8e787646fbce (IB/core: Fix removal of default GID cache entry)
  
  	/* in rdma_cap_roce_gid_table, this funciton should be protected by a
  	 * sleep-able lock.
* Unmerged path drivers/infiniband/core/cache.c
