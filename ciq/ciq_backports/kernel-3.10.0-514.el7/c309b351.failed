scsi: Remove CONFIG_SCSI_MULTI_LUN

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Hannes Reinecke <hare@suse.de>
commit c309b35171ddb5384cc3f2f9dc82a96dccc6b7f6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/c309b351.failed

Obsolete; either use 'max_lun' if the host supports only a
limited number of LUNs or BLIST_NOLUN if the target has
problems addressing more than one LUN.

	Signed-off-by: Hannes Reinecke <hare@suse.de>
	Reviewed-by: Ewan Milne <emilne@redhat.com>
	Signed-off-by: Christoph Hellwig <hch@lst.de>
(cherry picked from commit c309b35171ddb5384cc3f2f9dc82a96dccc6b7f6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/Kconfig
diff --cc drivers/scsi/Kconfig
index f53599ffde7d,cfc6f39ce978..000000000000
--- a/drivers/scsi/Kconfig
+++ b/drivers/scsi/Kconfig
@@@ -197,22 -197,8 +197,25 @@@ config SCSI_ENCLOSUR
  	  it has an enclosure device.  Selecting this option will just allow
  	  certain enclosure conditions to be reported and is not required.
  
++<<<<<<< HEAD
 +config SCSI_MULTI_LUN
 +	bool "Probe all LUNs on each SCSI device"
 +	depends on SCSI
 +	help
 +	  Some devices support more than one LUN (Logical Unit Number) in order
 +	  to allow access to several media, e.g. CD jukebox, USB card reader,
 +	  mobile phone in mass storage mode. This option forces the kernel to
 +	  probe for all LUNs by default. This setting can be overriden by
 +	  max_luns boot/module parameter. Note that this option does not affect
 +	  devices conforming to SCSI-3 or higher as they can explicitely report
 +	  their number of LUNs. It is safe to say Y here unless you have one of
 +	  those rare devices which reacts in an unexpected way when probed for
 +	  multiple LUNs.
 +
++=======
++>>>>>>> c309b35171dd (scsi: Remove CONFIG_SCSI_MULTI_LUN)
  config SCSI_CONSTANTS
 -	bool "Verbose SCSI error reporting (kernel size +=12K)"
 +	bool "Verbose SCSI error reporting (kernel size +=75K)"
  	depends on SCSI
  	help
  	  The error messages regarding your SCSI hardware will be easier to
diff --git a/Documentation/scsi/tmscsim.txt b/Documentation/scsi/tmscsim.txt
index 3303d218b32e..0810132772a8 100644
--- a/Documentation/scsi/tmscsim.txt
+++ b/Documentation/scsi/tmscsim.txt
@@ -317,8 +317,6 @@ Each of the parameters is a number, containing the described information:
     4	 0x10	   16	  Immediate return on BIOS seek command. (Not used)
  (*)5	 0x20	   32	  Check for LUNs >= 1.
   
-  The default for LUN Check depends on CONFIG_SCSI_MULTI_LUN.
-
 * TaggedCmnds is a number indicating the maximum number of Tagged Commands.
   It is the binary logarithm - 1 of the actual number. Max is 4 (32).
    Value  Number of Tagged Commands
* Unmerged path drivers/scsi/Kconfig
diff --git a/drivers/scsi/dc395x.c b/drivers/scsi/dc395x.c
index 42e8624a9b9a..98cccf0f3940 100644
--- a/drivers/scsi/dc395x.c
+++ b/drivers/scsi/dc395x.c
@@ -519,9 +519,7 @@ static struct ParameterData cfg_data[] = {
 		CFG_PARAM_UNSET,
 		0,
 		0x2f,
-#ifdef CONFIG_SCSI_MULTI_LUN
-			NAC_SCANLUN |
-#endif
+		NAC_SCANLUN |
 		NAC_GT2DRIVES | NAC_GREATER_1G | NAC_POWERON_SCSI_RESET
 			/*| NAC_ACTIVE_NEG*/,
 		NAC_GT2DRIVES | NAC_GREATER_1G | NAC_POWERON_SCSI_RESET | 0x08
@@ -4434,15 +4432,10 @@ static void adapter_init_scsi_host(struct Scsi_Host *host)
 	if (host->max_id - 1 == eeprom->scsi_id)
 		host->max_id--;
 
-#ifdef CONFIG_SCSI_MULTI_LUN
 	if (eeprom->channel_cfg & NAC_SCANLUN)
 		host->max_lun = 8;
 	else
 		host->max_lun = 1;
-#else
-	host->max_lun = 1;
-#endif
-
 }
 
 
diff --git a/drivers/scsi/ncr53c8xx.h b/drivers/scsi/ncr53c8xx.h
index 0e008dacf679..02901c54b08b 100644
--- a/drivers/scsi/ncr53c8xx.h
+++ b/drivers/scsi/ncr53c8xx.h
@@ -264,11 +264,7 @@
 #define SCSI_NCR_SG_TABLESIZE	(SCSI_NCR_MAX_SCATTER)
 #define SCSI_NCR_TIMER_INTERVAL	(HZ)
 
-#if 1 /* defined CONFIG_SCSI_MULTI_LUN */
 #define SCSI_NCR_MAX_LUN	(16)
-#else
-#define SCSI_NCR_MAX_LUN	(1)
-#endif
 
 /*
  *  IO functions definition for big/little endian CPU support.
diff --git a/drivers/scsi/scsi_scan.c b/drivers/scsi/scsi_scan.c
index 4ca174a5f3b7..848e434f23c0 100644
--- a/drivers/scsi/scsi_scan.c
+++ b/drivers/scsi/scsi_scan.c
@@ -82,11 +82,7 @@ static const char *scsi_null_device_strs = "nullnullnullnull";
 
 #define MAX_SCSI_LUNS	512
 
-#ifdef CONFIG_SCSI_MULTI_LUN
 static unsigned int max_scsi_luns = MAX_SCSI_LUNS;
-#else
-static unsigned int max_scsi_luns = 1;
-#endif
 
 module_param_named(max_luns, max_scsi_luns, uint, S_IRUGO|S_IWUSR);
 MODULE_PARM_DESC(max_luns,
diff --git a/drivers/usb/storage/Kconfig b/drivers/usb/storage/Kconfig
index 13b5bfbaf951..83e7d77c6317 100644
--- a/drivers/usb/storage/Kconfig
+++ b/drivers/usb/storage/Kconfig
@@ -18,9 +18,7 @@ config USB_STORAGE
 
 	  This option depends on 'SCSI' support being enabled, but you
 	  probably also need 'SCSI device support: SCSI disk support'
-	  (BLK_DEV_SD) for most USB storage devices.  Some devices also
-	  will require 'Probe all LUNs on each SCSI device'
-	  (SCSI_MULTI_LUN).
+	  (BLK_DEV_SD) for most USB storage devices.
 
 	  To compile this driver as a module, choose M here: the
 	  module will be called usb-storage.
