kernel: res_counter: remove the unused API

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
Rebuild_CHGLOG: - [kernel] res_counter: remove the unused API (Jerome Marchand) [1217771]
Rebuild_FUZZ: 89.47%
commit-author Johannes Weiner <hannes@cmpxchg.org>
commit 5b1efc027c0b51ca3e76f4e00c83358f8349f543
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/5b1efc02.failed

All memory accounting and limiting has been switched over to the
lockless page counters.  Bye, res_counter!

[akpm@linux-foundation.org: update Documentation/cgroups/memory.txt]
[mhocko@suse.cz: ditch the last remainings of res_counter]
	Signed-off-by: Johannes Weiner <hannes@cmpxchg.org>
	Acked-by: Vladimir Davydov <vdavydov@parallels.com>
	Acked-by: Michal Hocko <mhocko@suse.cz>
	Cc: Tejun Heo <tj@kernel.org>
	Cc: David Rientjes <rientjes@google.com>
	Cc: Paul Bolle <pebolle@tiscali.nl>
	Signed-off-by: Michal Hocko <mhocko@suse.cz>
	Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
	Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
(cherry picked from commit 5b1efc027c0b51ca3e76f4e00c83358f8349f543)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	Documentation/cgroups/resource_counter.txt
#	include/linux/res_counter.h
#	init/Kconfig
#	kernel/res_counter.c
diff --cc init/Kconfig
index 9c03541a6bec,1761c72bc1a0..000000000000
--- a/init/Kconfig
+++ b/init/Kconfig
@@@ -874,11 -972,8 +874,16 @@@ config CGROUP_CPUACC
  	  Provides a simple Resource Controller for monitoring the
  	  total CPU consumed by the tasks in a cgroup.
  
++<<<<<<< HEAD
 +config RESOURCE_COUNTERS
 +	bool "Resource counters"
 +	help
 +	  This option enables controller independent resource accounting
 +	  infrastructure that works with cgroups.
++=======
+ config PAGE_COUNTER
+        bool
++>>>>>>> 5b1efc027c0b (kernel: res_counter: remove the unused API)
  
  config MEMCG
  	bool "Memory Resource Controller for Control Groups"
* Unmerged path Documentation/cgroups/resource_counter.txt
* Unmerged path include/linux/res_counter.h
* Unmerged path kernel/res_counter.c
diff --git a/Documentation/cgroups/memory.txt b/Documentation/cgroups/memory.txt
index 9059928028bc..69374f215bac 100644
--- a/Documentation/cgroups/memory.txt
+++ b/Documentation/cgroups/memory.txt
@@ -116,16 +116,16 @@ The memory controller is the first controller developed.
 
 2.1. Design
 
-The core of the design is a counter called the res_counter. The res_counter
-tracks the current memory usage and limit of the group of processes associated
-with the controller. Each cgroup has a memory controller specific data
-structure (mem_cgroup) associated with it.
+The core of the design is a counter called the page_counter. The
+page_counter tracks the current memory usage and limit of the group of
+processes associated with the controller. Each cgroup has a memory controller
+specific data structure (mem_cgroup) associated with it.
 
 2.2. Accounting
 
 		+--------------------+
-		|  mem_cgroup     |
-		|  (res_counter)     |
+		|  mem_cgroup        |
+		|  (page_counter)    |
 		+--------------------+
 		 /            ^      \
 		/             |       \
@@ -347,9 +347,8 @@ set:
 0. Configuration
 
 a. Enable CONFIG_CGROUPS
-b. Enable CONFIG_RESOURCE_COUNTERS
-c. Enable CONFIG_MEMCG
-d. Enable CONFIG_MEMCG_SWAP (to use swap extension)
+b. Enable CONFIG_MEMCG
+c. Enable CONFIG_MEMCG_SWAP (to use swap extension)
 d. Enable CONFIG_MEMCG_KMEM (to use kmem extension)
 
 1. Prepare the cgroups (see cgroups.txt, Why are cgroups needed?)
* Unmerged path Documentation/cgroups/resource_counter.txt
* Unmerged path include/linux/res_counter.h
* Unmerged path init/Kconfig
diff --git a/kernel/Makefile b/kernel/Makefile
index d03a3df77380..24b6f1c865f7 100644
--- a/kernel/Makefile
+++ b/kernel/Makefile
@@ -69,7 +69,6 @@ obj-$(CONFIG_UTS_NS) += utsname.o
 obj-$(CONFIG_USER_NS) += user_namespace.o
 obj-$(CONFIG_PID_NS) += pid_namespace.o
 obj-$(CONFIG_IKCONFIG) += configs.o
-obj-$(CONFIG_RESOURCE_COUNTERS) += res_counter.o
 obj-$(CONFIG_SMP) += stop_machine.o
 obj-$(CONFIG_KPROBES_SANITY_TEST) += test_kprobes.o
 obj-$(CONFIG_AUDIT) += audit.o auditfilter.o
* Unmerged path kernel/res_counter.c
