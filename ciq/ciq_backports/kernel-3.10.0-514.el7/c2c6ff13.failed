IB/cm: cm_init_av_by_path should find a GID by its netdevice

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Matan Barak <matanb@mellanox.com>
commit c2c6ff134596e2691de7506667b712bef93cb1f0
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/c2c6ff13.failed

Previously, the CM has searched the cache for any sgid_index whose
GID matches the path's GID. Since the path record stores the net
device, the CM should now search only for GIDs which originated from
this net device.

	Signed-off-by: Matan Barak <matanb@mellanox.com>
Reviewed-By: Devesh Sharma <devesh.sharma@avagotech.com>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit c2c6ff134596e2691de7506667b712bef93cb1f0)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/core/cm.c
diff --cc drivers/infiniband/core/cm.c
index 4f918b929eca,db242bb00299..000000000000
--- a/drivers/infiniband/core/cm.c
+++ b/drivers/infiniband/core/cm.c
@@@ -365,7 -366,7 +366,11 @@@ static int cm_init_av_by_path(struct ib
  	read_lock_irqsave(&cm.device_lock, flags);
  	list_for_each_entry(cm_dev, &cm.device_list, list) {
  		if (!ib_find_cached_gid(cm_dev->ib_device, &path->sgid,
++<<<<<<< HEAD
 +					&p, NULL)) {
++=======
+ 					ndev, &p, NULL)) {
++>>>>>>> c2c6ff134596 (IB/cm: cm_init_av_by_path should find a GID by its netdevice)
  			port = cm_dev->port[p-1];
  			break;
  		}
* Unmerged path drivers/infiniband/core/cm.c
