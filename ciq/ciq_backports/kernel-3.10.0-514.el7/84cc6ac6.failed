iw_cxgb4: Add support for clip

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-514.el7
commit-author Hariprasad S <hariprasad@chelsio.com>
commit 84cc6ac62d4386f5b6d9ccf2900686b5648e230f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-514.el7/84cc6ac6.failed

Add support for ipv6 address handling clip api provided by lld

	Signed-off-by: Hariprasad Shenai <hariprasad@chelsio.com>
	Acked-by: Steve Wise <swise@opengridcomputing.com>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 84cc6ac62d4386f5b6d9ccf2900686b5648e230f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/cxgb4/cm.c
diff --cc drivers/infiniband/hw/cxgb4/cm.c
index f20f2103c7cc,f0c1512c45cd..000000000000
--- a/drivers/infiniband/hw/cxgb4/cm.c
+++ b/drivers/infiniband/hw/cxgb4/cm.c
@@@ -674,9 -708,14 +692,14 @@@ static int send_connect(struct c4iw_ep 
  		opt2 |= WND_SCALE_EN_F;
  	if (is_t5(ep->com.dev->rdev.lldi.adapter_type)) {
  		opt2 |= T5_OPT_2_VALID_F;
 -		opt2 |= CONG_CNTRL_V(CONG_ALG_TAHOE);
 +		opt2 |= V_CONG_CNTRL(CONG_ALG_TAHOE);
  		opt2 |= T5_ISS_F;
  	}
+ 
+ 	if (ep->com.remote_addr.ss_family == AF_INET6)
+ 		cxgb4_clip_get(ep->com.dev->rdev.lldi.ports[0],
+ 			       (const u32 *)&la6->sin6_addr.s6_addr, 1);
+ 
  	t4_set_arp_err_handler(skb, ep, act_open_req_arp_failure);
  
  	if (is_t4(ep->com.dev->rdev.lldi.adapter_type)) {
@@@ -2364,8 -2443,7 +2407,12 @@@ static int pass_accept_req(struct c4iw_
  		sin->sin_port = peer_port;
  		sin->sin_addr.s_addr = *(__be32 *)peer_ip;
  	} else {
++<<<<<<< HEAD
 +		struct sockaddr_in6 *sin6 = (struct sockaddr_in6 *)
 +			&child_ep->com.local_addr;
++=======
+ 		sin6 = (struct sockaddr_in6 *)&child_ep->com.mapped_local_addr;
++>>>>>>> 84cc6ac62d43 (iw_cxgb4: Add support for clip)
  		sin6->sin6_family = PF_INET6;
  		sin6->sin6_port = local_port;
  		memcpy(sin6->sin6_addr.s6_addr, local_ip, 16);
* Unmerged path drivers/infiniband/hw/cxgb4/cm.c
