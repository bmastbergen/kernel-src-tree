scsi: sg: add sg_remove_request in sg_write

jira LE-1907
cve CVE-2020-12770
Rebuild_History Non-Buildable kernel-3.10.0-1160.el7
commit-author Wu Bo <wubo40@huawei.com>
commit 83c6f2390040f188cc25b270b4befeb5628c1aee
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1160.el7/83c6f239.failed

If the __copy_from_user function failed we need to call sg_remove_request
in sg_write.

Link: https://lore.kernel.org/r/610618d9-e983-fd56-ed0f-639428343af7@huawei.com
	Acked-by: Douglas Gilbert <dgilbert@interlog.com>
	Signed-off-by: Wu Bo <wubo40@huawei.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit 83c6f2390040f188cc25b270b4befeb5628c1aee)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/sg.c
diff --cc drivers/scsi/sg.c
index f6a74f1cc124,20472aaaf630..000000000000
--- a/drivers/scsi/sg.c
+++ b/drivers/scsi/sg.c
@@@ -668,8 -685,10 +668,14 @@@ sg_write(struct file *filp, const char 
  	hp->flags = input_size;	/* structure abuse ... */
  	hp->pack_id = old_hdr.pack_id;
  	hp->usr_ptr = NULL;
++<<<<<<< HEAD
 +	if (__copy_from_user(cmnd, buf, cmd_size))
++=======
+ 	if (copy_from_user(cmnd, buf, cmd_size)) {
+ 		sg_remove_request(sfp, srp);
++>>>>>>> 83c6f2390040 (scsi: sg: add sg_remove_request in sg_write)
  		return -EFAULT;
+ 	}
  	/*
  	 * SG_DXFER_TO_FROM_DEV is functionally equivalent to SG_DXFER_FROM_DEV,
  	 * but is is possible that the app intended SG_DXFER_TO_DEV, because there
* Unmerged path drivers/scsi/sg.c
