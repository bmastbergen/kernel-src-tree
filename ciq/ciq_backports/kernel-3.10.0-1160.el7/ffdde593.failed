crypto: user - fix memory leak in crypto_report

jira LE-1907
cve CVE-2019-19062
cve CVE-2019-18808
Rebuild_History Non-Buildable kernel-3.10.0-1160.el7
commit-author Navid Emamdoost <navid.emamdoost@gmail.com>
commit ffdde5932042600c6807d46c1550b28b0db6a3bc
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1160.el7/ffdde593.failed

In crypto_report, a new skb is created via nlmsg_new(). This skb should
be released if crypto_report_alg() fails.

Fixes: a38f7907b926 ("crypto: Add userspace configuration API")
	Cc: <stable@vger.kernel.org>
	Signed-off-by: Navid Emamdoost <navid.emamdoost@gmail.com>
	Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
(cherry picked from commit ffdde5932042600c6807d46c1550b28b0db6a3bc)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	crypto/crypto_user.c
diff --cc crypto/crypto_user.c
index eb42572bc3a3,b785c476de67..000000000000
--- a/crypto/crypto_user.c
+++ b/crypto/crypto_user.c
@@@ -282,10 -209,16 +282,20 @@@ static int crypto_report(struct sk_buf
  	info.nlmsg_flags = 0;
  
  	err = crypto_report_alg(alg, &info);
++<<<<<<< HEAD:crypto/crypto_user.c
 +	if (err)
++=======
+ 
+ drop_alg:
+ 	crypto_mod_put(alg);
+ 
+ 	if (err) {
+ 		kfree_skb(skb);
++>>>>>>> ffdde5932042 (crypto: user - fix memory leak in crypto_report):crypto/crypto_user_base.c
  		return err;
+ 	}
  
 -	return nlmsg_unicast(net->crypto_nlsk, skb, NETLINK_CB(in_skb).portid);
 +	return nlmsg_unicast(crypto_nlsk, skb, NETLINK_CB(in_skb).portid);
  }
  
  static int crypto_dump_report(struct sk_buff *skb, struct netlink_callback *cb)
* Unmerged path crypto/crypto_user.c
