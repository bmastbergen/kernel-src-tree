KVM: nVMX: Advertise support for interrupt acknowledgement

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
Rebuild_CHGLOG: - [virt] kvm/nvmx: Advertise support for interrupt acknowledgement (Paolo Bonzini) [1116936]
Rebuild_FUZZ: 97.39%
commit-author Bandan Das <bsd@redhat.com>
commit e0ba1a6ffcfe8dc95586943bbe56badb1459bf25
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/e0ba1a6f.failed

Some Type 1 hypervisors such as XEN won't enable VMX without it present

	Signed-off-by: Bandan Das <bsd@redhat.com>
	Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
(cherry picked from commit e0ba1a6ffcfe8dc95586943bbe56badb1459bf25)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kvm/vmx.c
diff --cc arch/x86/kvm/vmx.c
index 69c4b6c8ff32,72b8012991b9..000000000000
--- a/arch/x86/kvm/vmx.c
+++ b/arch/x86/kvm/vmx.c
@@@ -2202,15 -2288,13 +2202,25 @@@ static __init void nested_vmx_setup_ctl
  #ifdef CONFIG_X86_64
  		VM_EXIT_HOST_ADDR_SPACE_SIZE |
  #endif
++<<<<<<< HEAD
 +		VM_EXIT_LOAD_IA32_PAT | VM_EXIT_SAVE_IA32_PAT |
 +		VM_EXIT_SAVE_VMX_PREEMPTION_TIMER;
 +	if (!(nested_vmx_pinbased_ctls_high & PIN_BASED_VMX_PREEMPTION_TIMER) ||
 +	    !(nested_vmx_exit_ctls_high & VM_EXIT_SAVE_VMX_PREEMPTION_TIMER)) {
 +		nested_vmx_exit_ctls_high &= ~VM_EXIT_SAVE_VMX_PREEMPTION_TIMER;
 +		nested_vmx_pinbased_ctls_high &= ~PIN_BASED_VMX_PREEMPTION_TIMER;
 +	}
 +	nested_vmx_exit_ctls_high |= (VM_EXIT_ALWAYSON_WITHOUT_TRUE_MSR |
 +		VM_EXIT_LOAD_IA32_EFER | VM_EXIT_SAVE_IA32_EFER);
++=======
+ 		VM_EXIT_LOAD_IA32_PAT | VM_EXIT_SAVE_IA32_PAT;
+ 	nested_vmx_exit_ctls_high |= VM_EXIT_ALWAYSON_WITHOUT_TRUE_MSR |
+ 		VM_EXIT_LOAD_IA32_EFER | VM_EXIT_SAVE_IA32_EFER |
+ 		VM_EXIT_SAVE_VMX_PREEMPTION_TIMER | VM_EXIT_ACK_INTR_ON_EXIT;
+ 
+ 	if (vmx_mpx_supported())
+ 		nested_vmx_exit_ctls_high |= VM_EXIT_CLEAR_BNDCFGS;
++>>>>>>> e0ba1a6ffcfe (KVM: nVMX: Advertise support for interrupt acknowledgement)
  
  	/* entry controls */
  	rdmsr(MSR_IA32_VMX_ENTRY_CTLS,
* Unmerged path arch/x86/kvm/vmx.c
