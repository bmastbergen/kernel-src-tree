ipv6: Need to sock_put on csum error

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
commit-author Tom Herbert <therbert@google.com>
commit 79e0f1c9f2c7096e93879d4158f2d34142b693dd
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/79e0f1c9.failed

Commit 4068579e1e098fa81d48db9ba4432ab664c58561 ("net: Implmement
RFC 6936 (zero RX csums for UDP/IPv6)") introduced zero checksums
being allowed for IPv6, but in the case that a socket disallows a
zero checksum on RX we need to sock_put.

	Signed-off-by: Tom Herbert <therbert@google.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 79e0f1c9f2c7096e93879d4158f2d34142b693dd)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv6/udp.c
diff --cc net/ipv6/udp.c
index 83b0a9963a30,fc2be63e32d5..000000000000
--- a/net/ipv6/udp.c
+++ b/net/ipv6/udp.c
@@@ -835,7 -883,12 +835,16 @@@ int __udp6_lib_rcv(struct sk_buff *skb
  	if (sk != NULL) {
  		int ret;
  
++<<<<<<< HEAD
 +		sk_mark_napi_id(sk, skb);
++=======
+ 		if (!uh->check && !sk->sk_no_check) {
+ 			sock_put(sk);
+ 			udp6_csum_zero_error(skb);
+ 			goto csum_error;
+ 		}
+ 
++>>>>>>> 79e0f1c9f2c7 (ipv6: Need to sock_put on csum error)
  		ret = udpv6_queue_rcv_skb(sk, skb);
  		sock_put(sk);
  
* Unmerged path net/ipv6/udp.c
