perf symbols: Check compatible symtab type before loading dso

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
Rebuild_CHGLOG: - [tools] perf/symbols: Check compatible symtab type before loading dso (Jiri Olsa) [1134356]
Rebuild_FUZZ: 98.36%
commit-author Namhyung Kim <namhyung@kernel.org>
commit 1029f9fedf87fa6f52096991588fa54ffd159584
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/1029f9fe.failed

When loading a dso it'll look for symbol tables of all possible types.
However it's just wasted of time to check incompatible types - like
trying kernel module when loading user library.

	Signed-off-by: Namhyung Kim <namhyung@kernel.org>
	Cc: Adrian Hunter <adrian.hunter@intel.com>
	Cc: Cody P Schafer <cody@linux.vnet.ibm.com>
	Cc: Ingo Molnar <mingo@kernel.org>
	Cc: Namhyung Kim <namhyung.kim@lge.com>
	Cc: Paul Mackerras <paulus@samba.org>
	Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
	Cc: Stephane Eranian <eranian@google.com>
Link: http://lkml.kernel.org/r/1392859976-32760-4-git-send-email-namhyung@kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 1029f9fedf87fa6f52096991588fa54ffd159584)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/util/symbol.c
diff --cc tools/perf/util/symbol.c
index 88a679cce213,0ada68b3b096..000000000000
--- a/tools/perf/util/symbol.c
+++ b/tools/perf/util/symbol.c
@@@ -1311,8 -1356,11 +1356,16 @@@ int dso__load(struct dso *dso, struct m
  
  		enum dso_binary_type symtab_type = binary_type_symtab[i];
  
++<<<<<<< HEAD
 +		if (dso__binary_type_file(dso, symtab_type,
 +					  root_dir, name, PATH_MAX))
++=======
+ 		if (!dso__is_compatible_symtab_type(dso, kmod, symtab_type))
+ 			continue;
+ 
+ 		if (dso__read_binary_type_filename(dso, symtab_type,
+ 						   root_dir, name, PATH_MAX))
++>>>>>>> 1029f9fedf87 (perf symbols: Check compatible symtab type before loading dso)
  			continue;
  
  		/* Name is now the name of the next image to try */
* Unmerged path tools/perf/util/symbol.c
