xfrm4: Properly handle unsupported protocols

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
commit-author Steffen Klassert <steffen.klassert@secunet.com>
commit 61622cc6f29034d0479f7ac16f3d48f1eeabf3a1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/61622cc6.failed

We don't catch the case if an unsupported protocol is submitted
to the xfrm4 protocol handlers, this can lead to NULL pointer
dereferences. Fix this by adding the appropriate checks.

Fixes: 3328715e ("xfrm4: Add IPsec protocol multiplexer")
	Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>
(cherry picked from commit 61622cc6f29034d0479f7ac16f3d48f1eeabf3a1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv4/xfrm4_protocol.c
* Unmerged path net/ipv4/xfrm4_protocol.c
* Unmerged path net/ipv4/xfrm4_protocol.c
