ALSA: hda - Fix and neaten print_nid_path/debug_badness

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
Rebuild_CHGLOG: - [alsa] hda: Fix and neaten print_nid_path/debug_badness (Jaroslav Kysela) [1112200]
Rebuild_FUZZ: 91.26%
commit-author Joe Perches <joe@perches.com>
commit d82353e534847732c4665a21e2ea699713a0e5b0
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/d82353e5.failed

print_nid_path has a possible buffer overflow if
struct nid_path.path values are > 256.

Avoid this and neaten the output to remove the leading ':'

Neaten debug_badness to always verify arguments.

	Signed-off-by: Joe Perches <joe@perches.com>
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit d82353e534847732c4665a21e2ea699713a0e5b0)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/pci/hda/hda_generic.c
diff --cc sound/pci/hda/hda_generic.c
index 5820a74b5781,b956449ddada..000000000000
--- a/sound/pci/hda/hda_generic.c
+++ b/sound/pci/hda/hda_generic.c
@@@ -347,19 -346,20 +347,29 @@@ static bool is_ctl_associated(struct hd
  	return is_ctl_used(codec, val, type);
  }
  
 -static void print_nid_path(struct hda_codec *codec,
 -			   const char *pfx, struct nid_path *path)
 +static void print_nid_path(const char *pfx, struct nid_path *path)
  {
  	char buf[40];
+ 	char *pos = buf;
  	int i;
  
+ 	*pos = 0;
+ 	for (i = 0; i < path->depth; i++)
+ 		pos += scnprintf(pos, sizeof(buf) - (pos - buf), "%s%02x",
+ 				 pos != buf ? ":" : "",
+ 				 path->path[i]);
  
++<<<<<<< HEAD
 +	buf[0] = 0;
 +	for (i = 0; i < path->depth; i++) {
 +		char tmp[4];
 +		sprintf(tmp, ":%02x", path->path[i]);
 +		strlcat(buf, tmp, sizeof(buf));
 +	}
 +	snd_printdd("%s path: depth=%d %s\n", pfx, path->depth, buf);
++=======
+ 	codec_dbg(codec, "%s path: depth=%d '%s'\n", pfx, path->depth, buf);
++>>>>>>> d82353e53484 (ALSA: hda - Fix and neaten print_nid_path/debug_badness)
  }
  
  /* called recursively */
@@@ -1700,9 -1700,11 +1710,15 @@@ static int fill_and_eval_dacs(struct hd
  #define DEBUG_BADNESS
  
  #ifdef DEBUG_BADNESS
++<<<<<<< HEAD
 +#define debug_badness	snd_printdd
++=======
+ #define debug_badness(fmt, ...)						\
+ 	codec_dbg(codec, fmt, ##__VA_ARGS__)
++>>>>>>> d82353e53484 (ALSA: hda - Fix and neaten print_nid_path/debug_badness)
  #else
- #define debug_badness(...)
+ #define debug_badness(fmt, ...)						\
+ 	do { if (0) codec_dbg(codec, fmt, ##__VA_ARGS__); } while (0)
  #endif
  
  #ifdef DEBUG_BADNESS
* Unmerged path sound/pci/hda/hda_generic.c
