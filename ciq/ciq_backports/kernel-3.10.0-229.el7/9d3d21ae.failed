blk-mq: bitmap tag: select random tag betweet 0 and (depth - 1)

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
Rebuild_CHGLOG: - [block] blk-mq: select random tag betweet 0 and (depth - 1) (Mike Snitzer) [1105204]
Rebuild_FUZZ: 89.47%
commit-author Ming Lei <tom.leiming@gmail.com>
commit 9d3d21aeb4f194cd7ac205abe68b14b47ae736a8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/9d3d21ae.failed

The selected tag should be selected at random between 0 and
(depth - 1) with probability 1/depth, instead between 0 and
(depth - 2) with probability 1/(depth - 1).

	Signed-off-by: Ming Lei <tom.leiming@gmail.com>
	Signed-off-by: Jens Axboe <axboe@fb.com>
(cherry picked from commit 9d3d21aeb4f194cd7ac205abe68b14b47ae736a8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	block/blk-mq-tag.c
diff --cc block/blk-mq-tag.c
index 83ae96c51a27,f196e60178f4..000000000000
--- a/block/blk-mq-tag.c
+++ b/block/blk-mq-tag.c
@@@ -181,6 -445,13 +181,16 @@@ void blk_mq_free_tags(struct blk_mq_tag
  	kfree(tags);
  }
  
++<<<<<<< HEAD
++=======
+ void blk_mq_tag_init_last_tag(struct blk_mq_tags *tags, unsigned int *tag)
+ {
+ 	unsigned int depth = tags->nr_tags - tags->nr_reserved_tags;
+ 
+ 	*tag = prandom_u32() % depth;
+ }
+ 
++>>>>>>> 9d3d21aeb4f1 (blk-mq: bitmap tag: select random tag betweet 0 and (depth - 1))
  ssize_t blk_mq_tag_sysfs_show(struct blk_mq_tags *tags, char *page)
  {
  	char *orig_page = page;
* Unmerged path block/blk-mq-tag.c
