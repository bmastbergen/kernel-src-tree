Revert "ath9k_hw: reduce ANI firstep range for older chips"

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
Rebuild_CHGLOG: - [wireless] Revert: ath9k: reduce ANI firstep range for older chips (Stanislaw Gruszka) [1155538]
Rebuild_FUZZ: 94.74%
commit-author Felix Fietkau <nbd@openwrt.org>
commit 171cdab8c78bb169d9693d587e1d02d2dd5a0274
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/171cdab8.failed

This reverts commit 09efc56345be4146ab9fc87a55c837ed5d6ea1ab

I've received reports that this change is decreasing throughput in some
rare conditions on an AR9280 based device

	Cc: stable@vger.kernel.org
	Signed-off-by: Felix Fietkau <nbd@openwrt.org>
	Signed-off-by: John W. Linville <linville@tuxdriver.com>
(cherry picked from commit 171cdab8c78bb169d9693d587e1d02d2dd5a0274)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/wireless/ath/ath9k/ar5008_phy.c
diff --cc drivers/net/wireless/ath/ath9k/ar5008_phy.c
index 391da5ad6a99,3b3e91057a4c..000000000000
--- a/drivers/net/wireless/ath/ath9k/ar5008_phy.c
+++ b/drivers/net/wireless/ath/ath9k/ar5008_phy.c
@@@ -1019,42 -1004,11 +1019,50 @@@ static bool ar5008_hw_ani_control_new(s
  	case ATH9K_ANI_FIRSTEP_LEVEL:{
  		u32 level = param;
  
++<<<<<<< HEAD
 +		if (level >= ARRAY_SIZE(firstep_table)) {
 +			ath_dbg(common, ANI,
 +				"ATH9K_ANI_FIRSTEP_LEVEL: level out of range (%u > %zu)\n",
 +				level, ARRAY_SIZE(firstep_table));
 +			return false;
 +		}
 +
 +		/*
 +		 * make register setting relative to default
 +		 * from INI file & cap value
 +		 */
 +		value = firstep_table[level] -
 +			firstep_table[ATH9K_ANI_FIRSTEP_LVL] +
 +			aniState->iniDef.firstep;
 +		if (value < ATH9K_SIG_FIRSTEP_SETTING_MIN)
 +			value = ATH9K_SIG_FIRSTEP_SETTING_MIN;
 +		if (value > ATH9K_SIG_FIRSTEP_SETTING_MAX)
 +			value = ATH9K_SIG_FIRSTEP_SETTING_MAX;
 +		REG_RMW_FIELD(ah, AR_PHY_FIND_SIG,
 +			      AR_PHY_FIND_SIG_FIRSTEP,
 +			      value);
 +		/*
 +		 * we need to set first step low register too
 +		 * make register setting relative to default
 +		 * from INI file & cap value
 +		 */
 +		value2 = firstep_table[level] -
 +			 firstep_table[ATH9K_ANI_FIRSTEP_LVL] +
 +			 aniState->iniDef.firstepLow;
 +		if (value2 < ATH9K_SIG_FIRSTEP_SETTING_MIN)
 +			value2 = ATH9K_SIG_FIRSTEP_SETTING_MIN;
 +		if (value2 > ATH9K_SIG_FIRSTEP_SETTING_MAX)
 +			value2 = ATH9K_SIG_FIRSTEP_SETTING_MAX;
 +
 +		REG_RMW_FIELD(ah, AR_PHY_FIND_SIG_LOW,
 +			      AR_PHY_FIND_SIG_FIRSTEP_LOW, value2);
++=======
+ 		value = level * 2;
+ 		REG_RMW_FIELD(ah, AR_PHY_FIND_SIG,
+ 			      AR_PHY_FIND_SIG_FIRSTEP, value);
+ 		REG_RMW_FIELD(ah, AR_PHY_FIND_SIG_LOW,
+ 			      AR_PHY_FIND_SIG_FIRSTEP_LOW, value);
++>>>>>>> 171cdab8c78b (Revert "ath9k_hw: reduce ANI firstep range for older chips")
  
  		if (level != aniState->firstepLevel) {
  			ath_dbg(common, ANI,
* Unmerged path drivers/net/wireless/ath/ath9k/ar5008_phy.c
