RDMA/cxgb4: Fix ntuple calculation for ipv6 and remove duplicate line

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
Rebuild_CHGLOG: - [infinband] cxgb4: Fix ntuple calculation for ipv6 and remove duplicate line (Sai Vemuri) [1163467]
Rebuild_FUZZ: 96.24%
commit-author Hariprasad S <hariprasad@chelsio.com>
commit da22b896b119001b0cd9eb9ecb5b3fd85e948e43
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/da22b896.failed

This fixes ntuple calculation for IPv6 active open request for T5
adapter.  And also removes an duplicate line which got added in commit
92e7ae71726c ("iw_cxgb4: Choose appropriate hw mtu index and ISS for
iWARP connections")

	Signed-off-by: Hariprasad Shenai <hariprasad@chelsio.com>
	Signed-off-by: Roland Dreier <roland@purestorage.com>
(cherry picked from commit da22b896b119001b0cd9eb9ecb5b3fd85e948e43)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/cxgb4/cm.c
diff --cc drivers/infiniband/hw/cxgb4/cm.c
index cc33ba686419,fb61f6685809..000000000000
--- a/drivers/infiniband/hw/cxgb4/cm.c
+++ b/drivers/infiniband/hw/cxgb4/cm.c
@@@ -685,6 -719,11 +686,14 @@@ static int send_connect(struct c4iw_ep 
  			req6->opt2 = cpu_to_be32(opt2);
  		}
  	} else {
++<<<<<<< HEAD
++=======
+ 		u32 isn = (prandom_u32() & ~7UL) - 1;
+ 
+ 		if (peer2peer)
+ 			isn += 4;
+ 
++>>>>>>> da22b896b119 (RDMA/cxgb4: Fix ntuple calculation for ipv6 and remove duplicate line)
  		if (ep->com.remote_addr.ss_family == AF_INET) {
  			t5_req = (struct cpl_t5_act_open_req *)
  				 skb_put(skb, wrlen);
@@@ -720,10 -762,13 +729,17 @@@
  			t5_req6->peer_ip_lo = *((__be64 *)
  						(ra6->sin6_addr.s6_addr + 8));
  			t5_req6->opt0 = cpu_to_be64(opt0);
- 			t5_req6->params = (__force __be64)cpu_to_be32(
+ 			t5_req6->params = cpu_to_be64(V_FILTER_TUPLE(
  							cxgb4_select_ntuple(
  						ep->com.dev->rdev.lldi.ports[0],
++<<<<<<< HEAD
 +						ep->l2t));
++=======
+ 						ep->l2t)));
+ 			t5_req6->rsvd = cpu_to_be32(isn);
+ 			PDBG("%s snd_isn %u\n", __func__,
+ 			     be32_to_cpu(t5_req6->rsvd));
++>>>>>>> da22b896b119 (RDMA/cxgb4: Fix ntuple calculation for ipv6 and remove duplicate line)
  			t5_req6->opt2 = cpu_to_be32(opt2);
  		}
  	}
* Unmerged path drivers/infiniband/hw/cxgb4/cm.c
