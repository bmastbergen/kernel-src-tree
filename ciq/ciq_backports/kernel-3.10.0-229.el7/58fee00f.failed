bnx2x: Make BP_VF more robust

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
commit-author Yuval Mintz <Yuval.Mintz@qlogic.com>
commit 58fee00ffae3b13b86f801146631012b3db4cea4
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/58fee00f.failed

Prevent dereference of pointer in case it's NULL.

	Signed-off-by: Yuval Mintz <Yuval.Mintz@qlogic.com>
	Signed-off-by: Ariel Elior <Ariel.Elior@qlogic.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 58fee00ffae3b13b86f801146631012b3db4cea4)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/broadcom/bnx2x/bnx2x_sriov.h
diff --cc drivers/net/ethernet/broadcom/bnx2x/bnx2x_sriov.h
index cd4d624d8485,01bafa4ac045..000000000000
--- a/drivers/net/ethernet/broadcom/bnx2x/bnx2x_sriov.h
+++ b/drivers/net/ethernet/broadcom/bnx2x/bnx2x_sriov.h
@@@ -295,8 -299,9 +295,14 @@@ struct bnx2x_vfdb 
  #define BP_VFDB(bp)		((bp)->vfdb)
  	/* vf array */
  	struct bnx2x_virtf	*vfs;
++<<<<<<< HEAD
 +#define BP_VF(bp, idx)		(&((bp)->vfdb->vfs[(idx)]))
 +#define bnx2x_vf(bp, idx, var)	((bp)->vfdb->vfs[(idx)].var)
++=======
+ #define BP_VF(bp, idx)		((BP_VFDB(bp) && (bp)->vfdb->vfs) ? \
+ 					&((bp)->vfdb->vfs[idx]) : NULL)
+ #define bnx2x_vf(bp, idx, var)	((bp)->vfdb->vfs[idx].var)
++>>>>>>> 58fee00ffae3 (bnx2x: Make BP_VF more robust)
  
  	/* queue array - for all vfs */
  	struct bnx2x_vf_queue *vfqs;
* Unmerged path drivers/net/ethernet/broadcom/bnx2x/bnx2x_sriov.h
