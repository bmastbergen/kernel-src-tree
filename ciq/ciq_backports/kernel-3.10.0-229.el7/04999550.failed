x86, boot: Move memset() definition in compressed/string.c

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
Rebuild_CHGLOG: - [x86] boot: Move memset() definition in compressed/string.c (Vivek Goyal) [852066]
Rebuild_FUZZ: 95.50%
commit-author Vivek Goyal <vgoyal@redhat.com>
commit 04999550f93234bf05597a9b7d26e2bfe27ba883
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/04999550.failed

Currently compressed/misc.c needs to link against memset(). I think one of
the reasons of this need is inclusion of various header files which define
static inline functions and use memset() inside these. For example,
include/linux/bitmap.h

I think trying to include "../string.h" and using builtin version of memset
does not work because by the time "#define memset" shows up, it is too
late. Some other header file has already used memset() and expects to
find a definition during link phase.

Currently we have a C definitoin of memset() in misc.c. Move it to
compressed/string.c so that others can use it if need be.

	Signed-off-by: Vivek Goyal <vgoyal@redhat.com>
Link: http://lkml.kernel.org/r/1395170800-11059-6-git-send-email-vgoyal@redhat.com
	Signed-off-by: H. Peter Anvin <hpa@linux.intel.com>
(cherry picked from commit 04999550f93234bf05597a9b7d26e2bfe27ba883)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/boot/compressed/misc.c
diff --cc arch/x86/boot/compressed/misc.c
index 8d5cca6c28ec,17684615374b..000000000000
--- a/arch/x86/boot/compressed/misc.c
+++ b/arch/x86/boot/compressed/misc.c
@@@ -110,16 -116,8 +116,21 @@@ static void error(char *m)
   */
  struct boot_params *real_mode;		/* Pointer to real-mode data */
  
++<<<<<<< HEAD
 +void *memset(void *s, int c, size_t n);
 +
 +#ifdef CONFIG_X86_64
 +#define memptr long
 +#else
 +#define memptr unsigned
 +#endif
 +
 +static memptr free_mem_ptr;
 +static memptr free_mem_end_ptr;
++=======
+ memptr free_mem_ptr;
+ memptr free_mem_end_ptr;
++>>>>>>> 04999550f932 (x86, boot: Move memset() definition in compressed/string.c)
  
  static char *vidmem;
  static int vidport;
* Unmerged path arch/x86/boot/compressed/misc.c
diff --git a/arch/x86/boot/compressed/string.c b/arch/x86/boot/compressed/string.c
index 920b55e3e241..f3c57e341402 100644
--- a/arch/x86/boot/compressed/string.c
+++ b/arch/x86/boot/compressed/string.c
@@ -33,3 +33,13 @@ void *memcpy(void *dest, const void *src, size_t n)
 	return dest;
 }
 #endif
+
+void *memset(void *s, int c, size_t n)
+{
+	int i;
+	char *ss = s;
+
+	for (i = 0; i < n; i++)
+		ss[i] = c;
+	return s;
+}
