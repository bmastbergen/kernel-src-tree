xprtrdma: mount reports "Invalid mount option" if memreg mode not supported

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
Rebuild_CHGLOG: - [net] sunrpc/xprtrdma: mount reports "Invalid mount option" if memreg mode not supported (Steve Dickson) [1113248]
Rebuild_FUZZ: 95.54%
commit-author Chuck Lever <chuck.lever@oracle.com>
commit cdd9ade711599e7672a635add0406080856f8b92
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/cdd9ade7.failed

If the selected memory registration mode is not supported by the
underlying provider/HCA, the NFS mount command reports that there was
an invalid mount option, and fails. This is misleading.

Reporting a problem allocating memory is a lot closer to the truth.

	Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
	Signed-off-by: Anna Schumaker <Anna.Schumaker@Netapp.com>
(cherry picked from commit cdd9ade711599e7672a635add0406080856f8b92)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sunrpc/xprtrdma/verbs.c
diff --cc net/sunrpc/xprtrdma/verbs.c
index 0ce6cc091efd,7c7e9b41f43f..000000000000
--- a/net/sunrpc/xprtrdma/verbs.c
+++ b/net/sunrpc/xprtrdma/verbs.c
@@@ -545,7 -505,18 +545,22 @@@ rpcrdma_ia_open(struct rpcrdma_xprt *xp
  				RPCRDMA_MAX_DATA_SEGS,
  				devattr.max_fast_reg_page_list_len);
  		}
++<<<<<<< HEAD
 +		break;
++=======
+ 	}
+ 	if (memreg == RPCRDMA_MTHCAFMR) {
+ 		if (!ia->ri_id->device->alloc_fmr) {
+ 			dprintk("RPC:       %s: MTHCAFMR registration "
+ 				"not supported by HCA\n", __func__);
+ #if RPCRDMA_PERSISTENT_REGISTRATION
+ 			memreg = RPCRDMA_ALLPHYSICAL;
+ #else
+ 			rc = -ENOMEM;
+ 			goto out2;
+ #endif
+ 		}
++>>>>>>> cdd9ade71159 (xprtrdma: mount reports "Invalid mount option" if memreg mode not supported)
  	}
  
  	/*
* Unmerged path net/sunrpc/xprtrdma/verbs.c
