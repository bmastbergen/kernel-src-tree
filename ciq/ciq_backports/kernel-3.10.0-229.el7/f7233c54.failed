i40e: Some FD message fixes

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
commit-author Anjali Singhai Jain <anjali.singhai@intel.com>
commit f7233c5491156bc530ed965d4fabc55db35f2e37
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/f7233c54.failed

Change the message that gets printed when adding/deleting a filter to
the SB, so that user can tell if a filter was added or deleted.
Print filter add failures only in case of SB filters. For ATR the
information is not useful to the user and hence suppress it unless in
higher debug mode.

Change-ID: I78d7a7a6ecfa82a38a582b0d7b4da038355e3735
	Signed-off-by: Anjali Singhai Jain <anjali.singhai@intel.com>
	Tested-by: Jim Young <jamesx.m.young@intel.com>
	Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
(cherry picked from commit f7233c5491156bc530ed965d4fabc55db35f2e37)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/i40e/i40e_txrx.c
diff --cc drivers/net/ethernet/intel/i40e/i40e_txrx.c
index 9c6fc77462e7,267c0e609a02..000000000000
--- a/drivers/net/ethernet/intel/i40e/i40e_txrx.c
+++ b/drivers/net/ethernet/intel/i40e/i40e_txrx.c
@@@ -199,23 -220,23 +199,42 @@@ static int i40e_add_del_fdir_udpv4(stru
  	ip->saddr = fd_data->src_ip[0];
  	udp->source = fd_data->src_port;
  
++<<<<<<< HEAD
 +	for (i = I40E_FILTER_PCTYPE_NONF_UNICAST_IPV4_UDP;
 +	     i <= I40E_FILTER_PCTYPE_NONF_IPV4_UDP; i++) {
 +		fd_data->pctype = i;
 +		ret = i40e_program_fdir_filter(fd_data, raw_packet, pf, add);
 +
 +		if (ret) {
 +			dev_info(&pf->pdev->dev,
 +				 "Filter command send failed for PCTYPE %d (ret = %d)\n",
 +				 fd_data->pctype, ret);
 +			err = true;
 +		} else {
 +			dev_info(&pf->pdev->dev,
 +				 "Filter OK for PCTYPE %d (ret = %d)\n",
 +				 fd_data->pctype, ret);
 +		}
++=======
+ 	fd_data->pctype = I40E_FILTER_PCTYPE_NONF_IPV4_UDP;
+ 	ret = i40e_program_fdir_filter(fd_data, raw_packet, pf, add);
+ 	if (ret) {
+ 		dev_info(&pf->pdev->dev,
+ 			 "PCTYPE:%d, Filter command send failed for fd_id:%d (ret = %d)\n",
+ 			 fd_data->pctype, fd_data->fd_id, ret);
+ 		err = true;
+ 	} else {
+ 		if (add)
+ 			dev_info(&pf->pdev->dev,
+ 				 "Filter OK for PCTYPE %d loc = %d\n",
+ 				 fd_data->pctype, fd_data->fd_id);
+ 		else
+ 			dev_info(&pf->pdev->dev,
+ 				 "Filter deleted for PCTYPE %d loc = %d\n",
+ 				 fd_data->pctype, fd_data->fd_id);
++>>>>>>> f7233c549115 (i40e: Some FD message fixes)
  	}
 +
  	return err ? -EOPNOTSUPP : 0;
  }
  
@@@ -267,12 -291,17 +286,22 @@@ static int i40e_add_del_fdir_tcpv4(stru
  
  	if (ret) {
  		dev_info(&pf->pdev->dev,
 -			 "PCTYPE:%d, Filter command send failed for fd_id:%d (ret = %d)\n",
 -			 fd_data->pctype, fd_data->fd_id, ret);
 +			 "Filter command send failed for PCTYPE %d (ret = %d)\n",
 +			 fd_data->pctype, ret);
  		err = true;
  	} else {
++<<<<<<< HEAD
 +		dev_info(&pf->pdev->dev, "Filter OK for PCTYPE %d (ret = %d)\n",
 +			 fd_data->pctype, ret);
++=======
+ 		if (add)
+ 			dev_info(&pf->pdev->dev, "Filter OK for PCTYPE %d loc = %d)\n",
+ 				 fd_data->pctype, fd_data->fd_id);
+ 		else
+ 			dev_info(&pf->pdev->dev,
+ 				 "Filter deleted for PCTYPE %d loc = %d\n",
+ 				 fd_data->pctype, fd_data->fd_id);
++>>>>>>> f7233c549115 (i40e: Some FD message fixes)
  	}
  
  	return err ? -EOPNOTSUPP : 0;
@@@ -333,13 -364,18 +362,24 @@@ static int i40e_add_del_fdir_ipv4(struc
  
  		if (ret) {
  			dev_info(&pf->pdev->dev,
 -				 "PCTYPE:%d, Filter command send failed for fd_id:%d (ret = %d)\n",
 -				 fd_data->pctype, fd_data->fd_id, ret);
 +				 "Filter command send failed for PCTYPE %d (ret = %d)\n",
 +				 fd_data->pctype, ret);
  			err = true;
  		} else {
++<<<<<<< HEAD
 +			dev_info(&pf->pdev->dev,
 +				 "Filter OK for PCTYPE %d (ret = %d)\n",
 +				 fd_data->pctype, ret);
++=======
+ 			if (add)
+ 				dev_info(&pf->pdev->dev,
+ 					 "Filter OK for PCTYPE %d loc = %d\n",
+ 					 fd_data->pctype, fd_data->fd_id);
+ 			else
+ 				dev_info(&pf->pdev->dev,
+ 					 "Filter deleted for PCTYPE %d loc = %d\n",
+ 					 fd_data->pctype, fd_data->fd_id);
++>>>>>>> f7233c549115 (i40e: Some FD message fixes)
  		}
  	}
  
@@@ -437,8 -457,10 +477,15 @@@ static void i40e_fd_handle_status(struc
  		I40E_RX_PROG_STATUS_DESC_QW1_ERROR_SHIFT;
  
  	if (error == (0x1 << I40E_RX_PROG_STATUS_DESC_FD_TBL_FULL_SHIFT)) {
++<<<<<<< HEAD
 +		dev_warn(&pdev->dev, "ntuple filter loc = %d, could not be added\n",
 +			 rx_desc->wb.qword0.hi_dword.fd_id);
++=======
+ 		if ((rx_desc->wb.qword0.hi_dword.fd_id != 0) ||
+ 		    (I40E_DEBUG_FD & pf->hw.debug_mask))
+ 			dev_warn(&pdev->dev, "ntuple filter loc = %d, could not be added\n",
+ 				 rx_desc->wb.qword0.hi_dword.fd_id);
++>>>>>>> f7233c549115 (i40e: Some FD message fixes)
  
  		/* filter programming failed most likely due to table full */
  		fcnt_prog = i40e_get_cur_guaranteed_fd_count(pf);
@@@ -465,7 -487,8 +512,12 @@@
  				pf->flags |= I40E_FLAG_FDIR_REQUIRES_REINIT;
  			}
  		} else {
++<<<<<<< HEAD
 +			dev_info(&pdev->dev, "FD filter programming error");
++=======
+ 			dev_info(&pdev->dev,
+ 				"FD filter programming failed due to incorrect filter parameters\n");
++>>>>>>> f7233c549115 (i40e: Some FD message fixes)
  		}
  	} else if (error ==
  			  (0x1 << I40E_RX_PROG_STATUS_DESC_NO_FD_ENTRY_SHIFT)) {
* Unmerged path drivers/net/ethernet/intel/i40e/i40e_txrx.c
