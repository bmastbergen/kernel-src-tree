qlcnic: Fix update of ethtool stats.

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
Rebuild_CHGLOG: - [ethernet] qlcnic: Fix update of ethtool stats (Chad Dupuis) [1089352]
Rebuild_FUZZ: 98.59%
commit-author Rajesh Borundia <rajesh.borundia@qlogic.com>
commit a0eaf75c03712b491b7a840b5836c8f1e2a09277
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/a0eaf75c.failed

o Aggregating tx stats in adapter variable was resulting in
  an increase in stats even after no traffic was run and
  user runs ifconfig/ethtool command.
o qlcnic_update_stats used to accumulate stats in adapter
  struct at each function call, instead accumulate tx stats
  in local variable and then assign it to adapter structure.

	Reported-by: Holger Kiehl <holger.kiehl@dwd.de>
	Signed-off-by: Rajesh Borundia <rajesh.borundia@qlogic.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit a0eaf75c03712b491b7a840b5836c8f1e2a09277)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/qlogic/qlcnic/qlcnic_ethtool.c
diff --cc drivers/net/ethernet/qlogic/qlcnic/qlcnic_ethtool.c
index f7b72258d28d,141f116eb868..000000000000
--- a/drivers/net/ethernet/qlogic/qlcnic/qlcnic_ethtool.c
+++ b/drivers/net/ethernet/qlogic/qlcnic/qlcnic_ethtool.c
@@@ -1245,14 -1294,21 +1246,25 @@@ void qlcnic_update_stats(struct qlcnic_
  	struct qlcnic_host_tx_ring *tx_ring;
  	int ring;
  
++<<<<<<< HEAD
 +	for (ring = 0; ring < adapter->max_drv_tx_rings; ring++) {
++=======
+ 	memset(&tx_stats, 0, sizeof(tx_stats));
+ 	for (ring = 0; ring < adapter->drv_tx_rings; ring++) {
++>>>>>>> a0eaf75c0371 (qlcnic: Fix update of ethtool stats.)
  		tx_ring = &adapter->tx_ring[ring];
- 		adapter->stats.xmit_on += tx_ring->tx_stats.xmit_on;
- 		adapter->stats.xmit_off += tx_ring->tx_stats.xmit_off;
- 		adapter->stats.xmitcalled += tx_ring->tx_stats.xmit_called;
- 		adapter->stats.xmitfinished += tx_ring->tx_stats.xmit_finished;
- 		adapter->stats.txbytes += tx_ring->tx_stats.tx_bytes;
+ 		tx_stats.xmit_on += tx_ring->tx_stats.xmit_on;
+ 		tx_stats.xmit_off += tx_ring->tx_stats.xmit_off;
+ 		tx_stats.xmit_called += tx_ring->tx_stats.xmit_called;
+ 		tx_stats.xmit_finished += tx_ring->tx_stats.xmit_finished;
+ 		tx_stats.tx_bytes += tx_ring->tx_stats.tx_bytes;
  	}
+ 
+ 	adapter->stats.xmit_on = tx_stats.xmit_on;
+ 	adapter->stats.xmit_off = tx_stats.xmit_off;
+ 	adapter->stats.xmitcalled = tx_stats.xmit_called;
+ 	adapter->stats.xmitfinished = tx_stats.xmit_finished;
+ 	adapter->stats.txbytes = tx_stats.tx_bytes;
  }
  
  static u64 *qlcnic_fill_tx_queue_stats(u64 *data, void *stats)
* Unmerged path drivers/net/ethernet/qlogic/qlcnic/qlcnic_ethtool.c
