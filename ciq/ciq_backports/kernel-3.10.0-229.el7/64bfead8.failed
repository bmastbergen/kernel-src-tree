cxgb4/cxgb4i: set the max. pdu length in firmware

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
Rebuild_CHGLOG: - [scsi] cxgb4i: set the max. pdu length in firmware (Sai Vemuri) [1174982]
Rebuild_FUZZ: 93.48%
commit-author Karen Xie <kxie@chelsio.com>
commit 64bfead85dc3caff74964fae1d03a8ee060770a6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/64bfead8.failed

Programs the firmware of the maximum outgoing iscsi pdu length per connection.

	Signed-off-by: Karen Xie <kxie@chelsio.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 64bfead85dc3caff74964fae1d03a8ee060770a6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/cxgbi/cxgb4i/cxgb4i.c
diff --cc drivers/scsi/cxgbi/cxgb4i/cxgb4i.c
index 6ce80d6bbcf1,93ae720e8264..000000000000
--- a/drivers/scsi/cxgbi/cxgb4i/cxgb4i.c
+++ b/drivers/scsi/cxgbi/cxgb4i/cxgb4i.c
@@@ -546,10 -533,9 +574,16 @@@ static inline int send_tx_flowc_wr(stru
  	skb = alloc_wr(flowclen, 0, GFP_ATOMIC);
  	flowc = (struct fw_flowc_wr *)skb->head;
  	flowc->op_to_nparams =
++<<<<<<< HEAD
 +		htonl(FW_WR_OP(FW_FLOWC_WR) | FW_FLOWC_WR_NPARAMS(8));
 +	flowc->flowid_len16 =
 +		htonl(FW_WR_LEN16(DIV_ROUND_UP(72, 16)) |
 +				FW_WR_FLOWID(csk->tid));
++=======
+ 		htonl(FW_WR_OP_V(FW_FLOWC_WR) | FW_FLOWC_WR_NPARAMS_V(nparams));
+ 	flowc->flowid_len16 =
+ 		htonl(FW_WR_LEN16_V(flowclen16) | FW_WR_FLOWID_V(csk->tid));
++>>>>>>> 64bfead85dc3 (cxgb4/cxgb4i: set the max. pdu length in firmware)
  	flowc->mnemval[0].mnemonic = FW_FLOWC_MNEM_PFNVFN;
  	flowc->mnemval[0].val = htonl(csk->cdev->pfvf);
  	flowc->mnemval[1].mnemonic = FW_FLOWC_MNEM_CH;
diff --git a/drivers/net/ethernet/chelsio/cxgb4/t4fw_api.h b/drivers/net/ethernet/chelsio/cxgb4/t4fw_api.h
index ee69e5fbfbb1..6bd8e5dc71aa 100644
--- a/drivers/net/ethernet/chelsio/cxgb4/t4fw_api.h
+++ b/drivers/net/ethernet/chelsio/cxgb4/t4fw_api.h
@@ -527,6 +527,7 @@ enum fw_flowc_mnem {
 	FW_FLOWC_MNEM_RCVNXT,
 	FW_FLOWC_MNEM_SNDBUF,
 	FW_FLOWC_MNEM_MSS,
+	FW_FLOWC_MNEM_TXDATAPLEN_MAX,
 };
 
 struct fw_flowc_mnemval {
* Unmerged path drivers/scsi/cxgbi/cxgb4i/cxgb4i.c
