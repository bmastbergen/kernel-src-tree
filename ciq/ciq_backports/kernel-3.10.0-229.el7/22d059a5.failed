iwlwifi: increase DEFAULT_MAX_TX_POWER

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
commit-author Eliad Peller <eliad@wizery.com>
commit 22d059a5c7c5de61e53c88e30b65e55fbfd91e91
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/22d059a5.failed

The chip is able to transmit up to 22dBm, so set
the constant appropriately.

CC: <stable@vger.kernel.org> [3.13+]
	Signed-off-by: Eliad Peller <eliadx.peller@intel.com>
	Signed-off-by: Emmanuel Grumbach <emmanuel.grumbach@intel.com>
(cherry picked from commit 22d059a5c7c5de61e53c88e30b65e55fbfd91e91)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/wireless/iwlwifi/iwl-nvm-parse.c
diff --cc drivers/net/wireless/iwlwifi/iwl-nvm-parse.c
index 6199a0a597a6,354255f08754..000000000000
--- a/drivers/net/wireless/iwlwifi/iwl-nvm-parse.c
+++ b/drivers/net/wireless/iwlwifi/iwl-nvm-parse.c
@@@ -111,12 -129,22 +111,22 @@@ static const u8 iwl_nvm_channels[] = 
  	149, 153, 157, 161, 165
  };
  
 -static const u8 iwl_nvm_channels_family_8000[] = {
 -	/* 2.4 GHz */
 -	1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,
 -	/* 5 GHz */
 -	36, 40, 44, 48, 52, 56, 60, 64, 68, 72, 76, 80, 84, 88, 92,
 -	96, 100, 104, 108, 112, 116, 120, 124, 128, 132, 136, 140, 144,
 -	149, 153, 157, 161, 165, 169, 173, 177, 181
 -};
 +#define IWL_NUM_CHANNELS	ARRAY_SIZE(iwl_nvm_channels)
 +#define NUM_2GHZ_CHANNELS	14
 +#define FIRST_2GHZ_HT_MINUS	5
 +#define LAST_2GHZ_HT_PLUS	9
 +#define LAST_5GHZ_HT		161
  
++<<<<<<< HEAD
++=======
+ #define IWL_NUM_CHANNELS		ARRAY_SIZE(iwl_nvm_channels)
+ #define IWL_NUM_CHANNELS_FAMILY_8000	ARRAY_SIZE(iwl_nvm_channels_family_8000)
+ #define NUM_2GHZ_CHANNELS		14
+ #define NUM_2GHZ_CHANNELS_FAMILY_8000	14
+ #define FIRST_2GHZ_HT_MINUS		5
+ #define LAST_2GHZ_HT_PLUS		9
+ #define LAST_5GHZ_HT			161
++>>>>>>> 22d059a5c7c5 (iwlwifi: increase DEFAULT_MAX_TX_POWER)
  
  /* rate data (static) */
  static struct ieee80211_rate iwl_cfg80211_rates[] = {
@@@ -229,13 -277,26 +239,21 @@@ static int iwl_init_channel_map(struct 
  		if (ch_flags & NVM_CHANNEL_RADAR)
  			channel->flags |= IEEE80211_CHAN_RADAR;
  
 -		if (ch_flags & NVM_CHANNEL_INDOOR_ONLY)
 -			channel->flags |= IEEE80211_CHAN_INDOOR_ONLY;
 -
 -		/* Set the GO concurrent flag only in case that NO_IR is set.
 -		 * Otherwise it is meaningless
 -		 */
 -		if ((ch_flags & NVM_CHANNEL_GO_CONCURRENT) &&
 -		    (channel->flags & IEEE80211_CHAN_NO_IR))
 -			channel->flags |= IEEE80211_CHAN_GO_CONCURRENT;
 -
  		/* Initialize regulatory-based run-time data */
  
++<<<<<<< HEAD
 +		/* TODO: read the real value from the NVM */
 +		channel->max_power = 0;
++=======
+ 		/*
+ 		 * Default value - highest tx power value.  max_power
+ 		 * is not used in mvm, and is used for backwards compatibility
+ 		 */
+ 		channel->max_power = IWL_DEFAULT_MAX_TX_POWER;
++>>>>>>> 22d059a5c7c5 (iwlwifi: increase DEFAULT_MAX_TX_POWER)
  		is_5ghz = channel->band == IEEE80211_BAND_5GHZ;
  		IWL_DEBUG_EEPROM(dev,
 -				 "Ch. %d [%sGHz] %s%s%s%s%s%s%s(0x%02x %ddBm): Ad-Hoc %ssupported\n",
 +				 "Ch. %d [%sGHz] %s%s%s%s%s%s(0x%02x %ddBm): Ad-Hoc %ssupported\n",
  				 channel->hw_value,
  				 is_5ghz ? "5.2" : "2.4",
  				 CHECK_AND_PRINT_I(VALID),
diff --git a/drivers/net/wireless/iwlwifi/iwl-config.h b/drivers/net/wireless/iwlwifi/iwl-config.h
index 44e3370ce343..030c253c9448 100644
--- a/drivers/net/wireless/iwlwifi/iwl-config.h
+++ b/drivers/net/wireless/iwlwifi/iwl-config.h
@@ -119,6 +119,8 @@ enum iwl_led_mode {
 #define IWL_LONG_WD_TIMEOUT	10000
 #define IWL_MAX_WD_TIMEOUT	120000
 
+#define IWL_DEFAULT_MAX_TX_POWER 22
+
 /* Antenna presence definitions */
 #define	ANT_NONE	0x0
 #define	ANT_A		BIT(0)
* Unmerged path drivers/net/wireless/iwlwifi/iwl-nvm-parse.c
