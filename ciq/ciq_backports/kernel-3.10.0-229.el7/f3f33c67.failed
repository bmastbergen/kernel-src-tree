Input: alps - Rushmore and v7 resolution support

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
Rebuild_CHGLOG: - [input] alps: Rushmore and v7 resolution support (Benjamin Tissoires) [1107819]
Rebuild_FUZZ: 88.64%
commit-author Hans de Goede <hdegoede@redhat.com>
commit f3f33c6776997db9d377ff3f1b759869f988d25e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/f3f33c67.failed

Add support for querying the physical size from the touchpad for Rushmore
and v7 touchpads, and use that to tell userspace the device resolution.

	Signed-off-by: Hans de Goede <hdegoede@redhat.com>
	Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
(cherry picked from commit f3f33c6776997db9d377ff3f1b759869f988d25e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/input/mouse/alps.c
diff --cc drivers/input/mouse/alps.c
index 566ef5285082,a59a1a64b674..000000000000
--- a/drivers/input/mouse/alps.c
+++ b/drivers/input/mouse/alps.c
@@@ -1782,6 -2030,35 +1824,38 @@@ static int alps_hw_init_dolphin_v1(stru
  	return 0;
  }
  
++<<<<<<< HEAD
++=======
+ static int alps_hw_init_v7(struct psmouse *psmouse)
+ {
+ 	struct ps2dev *ps2dev = &psmouse->ps2dev;
+ 	int reg_val, ret = -1;
+ 
+ 	if (alps_enter_command_mode(psmouse) ||
+ 	    alps_command_mode_read_reg(psmouse, 0xc2d9) == -1)
+ 		goto error;
+ 
+ 	if (alps_get_v3_v7_resolution(psmouse, 0xc397))
+ 		goto error;
+ 
+ 	if (alps_command_mode_write_reg(psmouse, 0xc2c9, 0x64))
+ 		goto error;
+ 
+ 	reg_val = alps_command_mode_read_reg(psmouse, 0xc2c4);
+ 	if (reg_val == -1)
+ 		goto error;
+ 	if (__alps_command_mode_write_reg(psmouse, reg_val | 0x02))
+ 		goto error;
+ 
+ 	alps_exit_command_mode(psmouse);
+ 	return ps2_command(ps2dev, NULL, PSMOUSE_CMD_ENABLE);
+ 
+ error:
+ 	alps_exit_command_mode(psmouse);
+ 	return ret;
+ }
+ 
++>>>>>>> f3f33c677699 (Input: alps - Rushmore and v7 resolution support)
  static void alps_set_defaults(struct alps_data *priv)
  {
  	priv->byte0 = 0x8f;
* Unmerged path drivers/input/mouse/alps.c
diff --git a/drivers/input/mouse/alps.h b/drivers/input/mouse/alps.h
index 17e3ae39bcb7..50972231cdd9 100644
--- a/drivers/input/mouse/alps.h
+++ b/drivers/input/mouse/alps.h
@@ -154,6 +154,8 @@ struct alps_data {
 	int y_max;
 	int x_bits;
 	int y_bits;
+	unsigned int x_res;
+	unsigned int y_res;
 
 	int (*hw_init)(struct psmouse *psmouse);
 	void (*process_packet)(struct psmouse *psmouse);
