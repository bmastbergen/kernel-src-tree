powerpc/perf: Drop MMCRA from thread_struct

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
Rebuild_CHGLOG: - [powerpc] perf: Drop MMCRA from thread_struct (Don Zickus) [1127366]
Rebuild_FUZZ: 89.74%
commit-author Michael Ellerman <michael@ellerman.id.au>
commit 2ac138ca21ad26c988ce7c91d27327f85beb7519
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/2ac138ca.failed

In commit 59affcd "Context switch more PMU related SPRs" I added more
PMU SPRs to thread_struct, later modified in commit b11ae95. To add
insult to injury it turns out we don't need to switch MMCRA as it's
only user readable, and the value is recomputed by the PMU code.

	Signed-off-by: Michael Ellerman <michael@ellerman.id.au>
	Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
(cherry picked from commit 2ac138ca21ad26c988ce7c91d27327f85beb7519)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/powerpc/include/asm/processor.h
diff --cc arch/powerpc/include/asm/processor.h
index d1c7667742b1,3f19df3cc7a3..000000000000
--- a/arch/powerpc/include/asm/processor.h
+++ b/arch/powerpc/include/asm/processor.h
@@@ -298,10 -287,8 +298,13 @@@ struct thread_struct 
  	unsigned long	siar;
  	unsigned long	sdar;
  	unsigned long	sier;
 -	unsigned long	mmcr0;
  	unsigned long	mmcr2;
++<<<<<<< HEAD
 +	unsigned 	mmcr0;
 +	unsigned 	used_ebb;
 +	unsigned long	mmcra;
++=======
++>>>>>>> 2ac138ca21ad (powerpc/perf: Drop MMCRA from thread_struct)
  #endif
  };
  
* Unmerged path arch/powerpc/include/asm/processor.h
diff --git a/arch/powerpc/kernel/asm-offsets.c b/arch/powerpc/kernel/asm-offsets.c
index 9c3d04ad1a03..30836e054d5f 100644
--- a/arch/powerpc/kernel/asm-offsets.c
+++ b/arch/powerpc/kernel/asm-offsets.c
@@ -134,7 +134,6 @@ int main(void)
 	DEFINE(THREAD_SIER, offsetof(struct thread_struct, sier));
 	DEFINE(THREAD_MMCR0, offsetof(struct thread_struct, mmcr0));
 	DEFINE(THREAD_MMCR2, offsetof(struct thread_struct, mmcr2));
-	DEFINE(THREAD_MMCRA, offsetof(struct thread_struct, mmcra));
 #endif
 #ifdef CONFIG_PPC_TRANSACTIONAL_MEM
 	DEFINE(PACATMSCRATCH, offsetof(struct paca_struct, tm_scratch));
