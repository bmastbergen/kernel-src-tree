cputime: Bring cputime -> nsecs conversion

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
commit-author Frederic Weisbecker <fweisbec@gmail.com>
commit d8a9ce3f8ad2b546b9ebaf65de809da0793f11c5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/d8a9ce3f.failed

We already have nsecs_to_cputime(). Now we need to be able to convert
the other way around in order to fix a bug on steal time accounting.

	Cc: Ingo Molnar <mingo@kernel.org>
	Cc: Marcelo Tosatti <mtosatti@redhat.com>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Thomas Gleixner <tglx@linutronix.de>
	Acked-by: Rik van Riel <riel@redhat.com>
	Signed-off-by: Frederic Weisbecker <fweisbec@gmail.com>
(cherry picked from commit d8a9ce3f8ad2b546b9ebaf65de809da0793f11c5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/asm-generic/cputime_nsecs.h
#	include/linux/cputime.h
diff --cc include/asm-generic/cputime_nsecs.h
index 2c9e62c2bfd0,4e817606c549..000000000000
--- a/include/asm-generic/cputime_nsecs.h
+++ b/include/asm-generic/cputime_nsecs.h
@@@ -44,7 -44,10 +44,14 @@@ typedef u64 __nocast cputime64_t
  /*
   * Convert cputime <-> nanoseconds
   */
++<<<<<<< HEAD
 +#define nsecs_to_cputime(__nsecs)	((__force u64)(__nsecs))
++=======
+ #define cputime_to_nsecs(__ct)		\
+ 	(__force u64)(__ct)
+ #define nsecs_to_cputime(__nsecs)	\
+ 	(__force cputime_t)(__nsecs)
++>>>>>>> d8a9ce3f8ad2 (cputime: Bring cputime -> nsecs conversion)
  
  
  /*
* Unmerged path include/linux/cputime.h
diff --git a/include/asm-generic/cputime_jiffies.h b/include/asm-generic/cputime_jiffies.h
index 272ecba9f588..d5cb78f53986 100644
--- a/include/asm-generic/cputime_jiffies.h
+++ b/include/asm-generic/cputime_jiffies.h
@@ -15,8 +15,10 @@ typedef u64 __nocast cputime64_t;
 
 
 /*
- * Convert nanoseconds to cputime
+ * Convert nanoseconds <-> cputime
  */
+#define cputime_to_nsecs(__ct)		\
+	jiffies_to_nsecs(cputime_to_jiffies(__ct))
 #define nsecs_to_cputime64(__nsec)	\
 	jiffies64_to_cputime64(nsecs_to_jiffies64(__nsec))
 #define nsecs_to_cputime(__nsec)	\
* Unmerged path include/asm-generic/cputime_nsecs.h
* Unmerged path include/linux/cputime.h
