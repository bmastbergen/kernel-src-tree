qlcnic: Fix usage of use_msi and use_msi_x module parameters

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
commit-author Shahed Shaikh <shahed.shaikh@qlogic.com>
commit b7520d2b59b09eb284e5fc9080d13145f0a8d9fd
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/b7520d2b.failed

Once interrupts are enabled, instead of using module parameters,
use flags (QLCNIC_MSI_ENABLED and QLCNIC_MSIX_ENABLED) set by driver
to check interrupt mode.

	Signed-off-by: Shahed Shaikh <shahed.shaikh@qlogic.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit b7520d2b59b09eb284e5fc9080d13145f0a8d9fd)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/qlogic/qlcnic/qlcnic_main.c
diff --cc drivers/net/ethernet/qlogic/qlcnic/qlcnic_main.c
index 17b1eb36caa2,e10fc8e7fe22..000000000000
--- a/drivers/net/ethernet/qlogic/qlcnic/qlcnic_main.c
+++ b/drivers/net/ethernet/qlogic/qlcnic/qlcnic_main.c
@@@ -3663,14 -3845,26 +3663,19 @@@ qlcnicvf_start_firmware(struct qlcnic_a
  	return err;
  }
  
 -int qlcnic_validate_rings(struct qlcnic_adapter *adapter, __u32 ring_cnt,
 -			  int queue_type)
 +int qlcnic_validate_max_tx_rings(struct qlcnic_adapter *adapter, u32 txq)
  {
  	struct net_device *netdev = adapter->netdev;
 -	u8 max_hw_rings = 0;
 -	char buf[8];
 -	int cur_rings;
 -
 -	if (queue_type == QLCNIC_RX_QUEUE) {
 -		max_hw_rings = adapter->max_sds_rings;
 -		cur_rings = adapter->drv_sds_rings;
 -		strcpy(buf, "SDS");
 -	} else if (queue_type == QLCNIC_TX_QUEUE) {
 -		max_hw_rings = adapter->max_tx_rings;
 -		cur_rings = adapter->drv_tx_rings;
 -		strcpy(buf, "Tx");
 -	}
 +	u8 max_hw = QLCNIC_MAX_TX_RINGS;
 +	u32 max_allowed;
  
++<<<<<<< HEAD
 +	if (!qlcnic_use_msi_x && !qlcnic_use_msi) {
 +		netdev_err(netdev, "No Multi TX-Q support in INT-x mode\n");
++=======
+ 	if (!QLCNIC_IS_MSI_FAMILY(adapter)) {
+ 		netdev_err(netdev, "No RSS/TSS support in INT-x mode\n");
++>>>>>>> b7520d2b59b0 (qlcnic: Fix usage of use_msi and use_msi_x module parameters)
  		return -EINVAL;
  	}
  
* Unmerged path drivers/net/ethernet/qlogic/qlcnic/qlcnic_main.c
