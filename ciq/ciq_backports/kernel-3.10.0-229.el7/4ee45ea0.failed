openvswitch: fix a memory leak

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
commit-author Li RongQing <roy.qing.li@gmail.com>
commit 4ee45ea05c8710c7ab8a5eb1a72700b874712746
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/4ee45ea0.failed

The user_skb maybe be leaked if the operation on it failed and codes
skipped into the label "out:" without calling genlmsg_unicast.

	Cc: Pravin Shelar <pshelar@nicira.com>
	Signed-off-by: Li RongQing <roy.qing.li@gmail.com>
	Acked-by: Pravin B Shelar <pshelar@nicira.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 4ee45ea05c8710c7ab8a5eb1a72700b874712746)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/openvswitch/datapath.c
diff --cc net/openvswitch/datapath.c
index d0df53822f74,35d866f036e7..000000000000
--- a/net/openvswitch/datapath.c
+++ b/net/openvswitch/datapath.c
@@@ -479,7 -494,11 +479,14 @@@ static int queue_userspace_packet(struc
  	((struct nlmsghdr *) user_skb->data)->nlmsg_len = user_skb->len;
  
  	err = genlmsg_unicast(ovs_dp_get_net(dp), user_skb, upcall_info->portid);
+ 	user_skb = NULL;
  out:
++<<<<<<< HEAD
++=======
+ 	if (err)
+ 		skb_tx_error(skb);
+ 	kfree_skb(user_skb);
++>>>>>>> 4ee45ea05c87 (openvswitch: fix a memory leak)
  	kfree_skb(nskb);
  	return err;
  }
* Unmerged path net/openvswitch/datapath.c
