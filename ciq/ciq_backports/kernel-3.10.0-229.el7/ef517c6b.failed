perf tools: Add per-feature check flags

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-229.el7
Rebuild_CHGLOG: - [tools] perf: Add per-feature check flags (Jiri Olsa) [1133083]
Rebuild_FUZZ: 91.67%
commit-author Jean Pihet <jean.pihet@linaro.org>
commit ef517c6bee5d16404b06bee1d07f00ffb74fc21a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-229.el7/ef517c6b.failed

Add CFLAGS and LDFLAGS for each feature to be checked. This allows to
pass flags and parameters to the feature checks compilation.  Also
simplifies the feature check makefile, to come in a subsequent patch.

	Signed-off-by: Jean Pihet <jean.pihet@linaro.org>
	Acked-by: Ingo Molnar <mingo@kernel.org>
	Acked-by: Jiri Olsa <jolsa@redhat.com>
	Cc: Ingo Molnar <mingo@kernel.org>
	Cc: Jiri Olsa <jolsa@redhat.com>
	Cc: Will Deacon <will.deacon@arm.com>
	Cc: linaro-kernel@lists.linaro.org
	Cc: patches@linaro.org
Link: http://lkml.kernel.org/r/1386678244-13535-2-git-send-email-jean.pihet@linaro.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit ef517c6bee5d16404b06bee1d07f00ffb74fc21a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/config/Makefile
diff --cc tools/perf/config/Makefile
index 374f88fe17c5,2afb132db51a..000000000000
--- a/tools/perf/config/Makefile
+++ b/tools/perf/config/Makefile
@@@ -89,9 -95,14 +89,13 @@@ CFLAGS += -std=gnu9
  
  EXTLIBS = -lelf -lpthread -lrt -lm -ldl
  
 -ifneq ($(OUTPUT),)
 -  OUTPUT_FEATURES = $(OUTPUT)config/feature-checks/
 -  $(shell mkdir -p $(OUTPUT_FEATURES))
 -endif
 -
  feature_check = $(eval $(feature_check_code))
  define feature_check_code
++<<<<<<< HEAD
 +  feature-$(1) := $(shell $(MAKE) -C config/feature-checks test-$1 >/dev/null 2>/dev/null && echo 1 || echo 0)
++=======
+   feature-$(1) := $(shell $(MAKE) OUTPUT=$(OUTPUT_FEATURES) CFLAGS="$(EXTRA_CFLAGS) $(FEATURE_CHECK_CFLAGS-$(1))" LDFLAGS="$(LDFLAGS) $(FEATURE_CHECK_LDFLAGS-$(1))" LIBUNWIND_LIBS="$(LIBUNWIND_LIBS)" -C config/feature-checks test-$1 >/dev/null 2>/dev/null && echo 1 || echo 0)
++>>>>>>> ef517c6bee5d (perf tools: Add per-feature check flags)
  endef
  
  feature_set = $(eval $(feature_set_code))
* Unmerged path tools/perf/config/Makefile
