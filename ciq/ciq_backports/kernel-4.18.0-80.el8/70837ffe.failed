ipv4: frags: precedence bug in ip_expire()

jira LE-1907
cve CVE-2018-5391
Rebuild_History Non-Buildable kernel-4.18.0-80.el8
commit-author Dan Carpenter <dan.carpenter@oracle.com>
commit 70837ffe3085c9a91488b52ca13ac84424da1042
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-80.el8/70837ffe.failed

We accidentally removed the parentheses here, but they are required
because '!' has higher precedence than '&'.

Fixes: fa0f527358bd ("ip: use rb trees for IP frag queue.")
	Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 70837ffe3085c9a91488b52ca13ac84424da1042)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv4/ip_fragment.c
diff --cc net/ipv4/ip_fragment.c
index 960bf5eab59f,7cb7ed761d8c..000000000000
--- a/net/ipv4/ip_fragment.c
+++ b/net/ipv4/ip_fragment.c
@@@ -152,14 -152,31 +152,18 @@@ static void ip_expire(struct timer_lis
  
  	ipq_kill(qp);
  	__IP_INC_STATS(net, IPSTATS_MIB_REASMFAILS);
 +
 +	head = qp->q.fragments;
 +
  	__IP_INC_STATS(net, IPSTATS_MIB_REASMTIMEOUT);
  
++<<<<<<< HEAD
 +	if (!(qp->q.flags & INET_FRAG_FIRST_IN) || !head)
++=======
+ 	if (!(qp->q.flags & INET_FRAG_FIRST_IN))
++>>>>>>> 70837ffe3085 (ipv4: frags: precedence bug in ip_expire())
  		goto out;
  
 -	/* sk_buff::dev and sk_buff::rbnode are unionized. So we
 -	 * pull the head out of the tree in order to be able to
 -	 * deal with head->dev.
 -	 */
 -	if (qp->q.fragments) {
 -		head = qp->q.fragments;
 -		qp->q.fragments = head->next;
 -	} else {
 -		head = skb_rb_first(&qp->q.rb_fragments);
 -		if (!head)
 -			goto out;
 -		rb_erase(&head->rbnode, &qp->q.rb_fragments);
 -		memset(&head->rbnode, 0, sizeof(head->rbnode));
 -		barrier();
 -	}
 -	if (head == qp->q.fragments_tail)
 -		qp->q.fragments_tail = NULL;
 -
 -	sub_frag_mem_limit(qp->q.net, head->truesize);
 -
  	head->dev = dev_get_by_index_rcu(net, qp->iif);
  	if (!head->dev)
  		goto out;
* Unmerged path net/ipv4/ip_fragment.c
