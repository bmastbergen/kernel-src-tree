rcu: Inline increment_cpu_stall_ticks() into its sole caller

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-80.el8
commit-author Paul E. McKenney <paulmck@linux.vnet.ibm.com>
commit 4e95020cdd34bbfc86f9c705f4d46ed63fa2e231
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-80.el8/4e95020c.failed

Consolidation of the RCU flavors into one makes increment_cpu_stall_ticks()
a trivial one-line function with only one caller.  This commit therefore
inlines it.

	Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
(cherry picked from commit 4e95020cdd34bbfc86f9c705f4d46ed63fa2e231)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	kernel/rcu/tree_plugin.h
diff --cc kernel/rcu/tree_plugin.h
index 1a3e7482ab1d,cd276c46bc14..000000000000
--- a/kernel/rcu/tree_plugin.h
+++ b/kernel/rcu/tree_plugin.h
@@@ -1822,15 -1815,6 +1822,18 @@@ static void zero_cpu_stall_ticks(struc
  	rdp->softirq_snap = kstat_softirqs_cpu(RCU_SOFTIRQ, smp_processor_id());
  }
  
++<<<<<<< HEAD
 +/* Increment ->ticks_this_gp for all flavors of RCU. */
 +static void increment_cpu_stall_ticks(void)
 +{
 +	struct rcu_state *rsp;
 +
 +	for_each_rcu_flavor(rsp)
 +		raw_cpu_inc(rcu_data.ticks_this_gp);
 +}
 +
++=======
++>>>>>>> 4e95020cdd34 (rcu: Inline increment_cpu_stall_ticks() into its sole caller)
  #ifdef CONFIG_RCU_NOCB_CPU
  
  /*
diff --git a/kernel/rcu/tree.c b/kernel/rcu/tree.c
index 768e92ffb380..85d6529463e0 100644
--- a/kernel/rcu/tree.c
+++ b/kernel/rcu/tree.c
@@ -2571,7 +2571,7 @@ static void rcu_do_batch(struct rcu_data *rdp)
 void rcu_check_callbacks(int user)
 {
 	trace_rcu_utilization(TPS("Start scheduler-tick"));
-	increment_cpu_stall_ticks();
+	raw_cpu_inc(rcu_data.ticks_this_gp);
 	rcu_flavor_check_callbacks(user);
 	if (rcu_pending())
 		invoke_rcu_core();
diff --git a/kernel/rcu/tree.h b/kernel/rcu/tree.h
index 7c6033d71e9d..d5b58e41f14d 100644
--- a/kernel/rcu/tree.h
+++ b/kernel/rcu/tree.h
@@ -475,7 +475,6 @@ static void print_cpu_stall_info_begin(void);
 static void print_cpu_stall_info(int cpu);
 static void print_cpu_stall_info_end(void);
 static void zero_cpu_stall_ticks(struct rcu_data *rdp);
-static void increment_cpu_stall_ticks(void);
 static bool rcu_nocb_cpu_needs_barrier(int cpu);
 static struct swait_queue_head *rcu_nocb_gp_get(struct rcu_node *rnp);
 static void rcu_nocb_gp_cleanup(struct swait_queue_head *sq);
* Unmerged path kernel/rcu/tree_plugin.h
