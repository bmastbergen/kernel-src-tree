scsi: megaraid_sas: Introduce new Aero adapter type

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-80.el8
commit-author Shivasharan S <shivasharan.srikanteshwara@broadcom.com>
commit 154a7cde9a895d87ecc9807b34651021d3e6e8a7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-80.el8/154a7cde.failed

Identify all Aero controller PCI IDs with new adapter type.

	Signed-off-by: Shivasharan S <shivasharan.srikanteshwara@broadcom.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit 154a7cde9a895d87ecc9807b34651021d3e6e8a7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/megaraid/megaraid_sas_base.c
diff --cc drivers/scsi/megaraid/megaraid_sas_base.c
index ff5c2d50b7b6,3492ae990b64..000000000000
--- a/drivers/scsi/megaraid/megaraid_sas_base.c
+++ b/drivers/scsi/megaraid/megaraid_sas_base.c
@@@ -5322,18 -5418,36 +5322,41 @@@ static int megasas_init_fw(struct megas
  		if (fusion) {
  			if (instance->adapter_type == THUNDERBOLT_SERIES) {
  				/* Thunderbolt Series*/
 -				instance->msix_vectors = (scratch_pad_1
 +				instance->msix_vectors = (scratch_pad_2
  					& MR_MAX_REPLY_QUEUES_OFFSET) + 1;
  				fw_msix_count = instance->msix_vectors;
 -			} else {
 -				instance->msix_vectors = ((scratch_pad_1
 +			} else { /* Invader series supports more than 8 MSI-x vectors*/
 +				instance->msix_vectors = ((scratch_pad_2
  					& MR_MAX_REPLY_QUEUES_EXT_OFFSET)
  					>> MR_MAX_REPLY_QUEUES_EXT_OFFSET_SHIFT) + 1;
++<<<<<<< HEAD
 +				if (instance->msix_vectors > 16)
 +					instance->msix_combined = true;
++=======
+ 
+ 				/*
+ 				 * For Invader series, > 8 MSI-x vectors
+ 				 * supported by FW/HW implies combined
+ 				 * reply queue mode is enabled.
+ 				 * For Ventura series, > 16 MSI-x vectors
+ 				 * supported by FW/HW implies combined
+ 				 * reply queue mode is enabled.
+ 				 */
+ 				switch (instance->adapter_type) {
+ 				case INVADER_SERIES:
+ 					if (instance->msix_vectors > 8)
+ 						instance->msix_combined = true;
+ 					break;
+ 				case AERO_SERIES:
+ 				case VENTURA_SERIES:
+ 					if (instance->msix_vectors > 16)
+ 						instance->msix_combined = true;
+ 					break;
+ 				}
++>>>>>>> 154a7cde9a89 (scsi: megaraid_sas: Introduce new Aero adapter type)
  
  				if (rdpq_enable)
 -					instance->is_rdpq = (scratch_pad_1 & MR_RDPQ_MODE_OFFSET) ?
 +					instance->is_rdpq = (scratch_pad_2 & MR_RDPQ_MODE_OFFSET) ?
  								1 : 0;
  				fw_msix_count = instance->msix_vectors;
  				/* Save 1-15 reply post index address to local memory
diff --git a/drivers/scsi/megaraid/megaraid_sas.h b/drivers/scsi/megaraid/megaraid_sas.h
index 2398e60c4c5f..d559b6c3aa45 100644
--- a/drivers/scsi/megaraid/megaraid_sas.h
+++ b/drivers/scsi/megaraid/megaraid_sas.h
@@ -1553,6 +1553,7 @@ enum MR_ADAPTER_TYPE {
 	THUNDERBOLT_SERIES = 2,
 	INVADER_SERIES = 3,
 	VENTURA_SERIES = 4,
+	AERO_SERIES = 5,
 };
 
 /*
* Unmerged path drivers/scsi/megaraid/megaraid_sas_base.c
