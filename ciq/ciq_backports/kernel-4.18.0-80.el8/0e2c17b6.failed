net/sched: cls_flower: Support matching on ip tos and ttl for tunnels

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-80.el8
commit-author Or Gerlitz <ogerlitz@mellanox.com>
commit 0e2c17b64d5c7f57bcd7054ef87797376dcdee26
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-80.el8/0e2c17b6.failed

Allow users to set rules matching on ipv4 tos and ttl or
ipv6 traffic-class and hoplimit of tunnel headers.

	Signed-off-by: Or Gerlitz <ogerlitz@mellanox.com>
	Reviewed-by: Roi Dayan <roid@mellanox.com>
	Acked-by: Jiri Pirko <jiri@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 0e2c17b64d5c7f57bcd7054ef87797376dcdee26)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/uapi/linux/pkt_cls.h
#	net/sched/cls_flower.c
diff --cc include/uapi/linux/pkt_cls.h
index 84e4c1d0f874,b4512254036b..000000000000
--- a/include/uapi/linux/pkt_cls.h
+++ b/include/uapi/linux/pkt_cls.h
@@@ -469,6 -469,15 +469,18 @@@ enum 
  	TCA_FLOWER_KEY_IP_TTL,		/* u8 */
  	TCA_FLOWER_KEY_IP_TTL_MASK,	/* u8 */
  
++<<<<<<< HEAD
++=======
+ 	TCA_FLOWER_KEY_CVLAN_ID,	/* be16 */
+ 	TCA_FLOWER_KEY_CVLAN_PRIO,	/* u8   */
+ 	TCA_FLOWER_KEY_CVLAN_ETH_TYPE,	/* be16 */
+ 
+ 	TCA_FLOWER_KEY_ENC_IP_TOS,	/* u8 */
+ 	TCA_FLOWER_KEY_ENC_IP_TOS_MASK,	/* u8 */
+ 	TCA_FLOWER_KEY_ENC_IP_TTL,	/* u8 */
+ 	TCA_FLOWER_KEY_ENC_IP_TTL_MASK,	/* u8 */
+ 
++>>>>>>> 0e2c17b64d5c (net/sched: cls_flower: Support matching on ip tos and ttl for tunnels)
  	__TCA_FLOWER_MAX,
  };
  
diff --cc net/sched/cls_flower.c
index 9e8b26a80fb3,38d74803e2df..000000000000
--- a/net/sched/cls_flower.c
+++ b/net/sched/cls_flower.c
@@@ -447,6 -451,13 +448,16 @@@ static const struct nla_policy fl_polic
  	[TCA_FLOWER_KEY_IP_TOS_MASK]	= { .type = NLA_U8 },
  	[TCA_FLOWER_KEY_IP_TTL]		= { .type = NLA_U8 },
  	[TCA_FLOWER_KEY_IP_TTL_MASK]	= { .type = NLA_U8 },
++<<<<<<< HEAD
++=======
+ 	[TCA_FLOWER_KEY_CVLAN_ID]	= { .type = NLA_U16 },
+ 	[TCA_FLOWER_KEY_CVLAN_PRIO]	= { .type = NLA_U8 },
+ 	[TCA_FLOWER_KEY_CVLAN_ETH_TYPE]	= { .type = NLA_U16 },
+ 	[TCA_FLOWER_KEY_ENC_IP_TOS]	= { .type = NLA_U8 },
+ 	[TCA_FLOWER_KEY_ENC_IP_TOS_MASK] = { .type = NLA_U8 },
+ 	[TCA_FLOWER_KEY_ENC_IP_TTL]	 = { .type = NLA_U8 },
+ 	[TCA_FLOWER_KEY_ENC_IP_TTL_MASK] = { .type = NLA_U8 },
++>>>>>>> 0e2c17b64d5c (net/sched: cls_flower: Support matching on ip tos and ttl for tunnels)
  };
  
  static void fl_set_key_val(struct nlattr **tb,
* Unmerged path include/uapi/linux/pkt_cls.h
* Unmerged path net/sched/cls_flower.c
