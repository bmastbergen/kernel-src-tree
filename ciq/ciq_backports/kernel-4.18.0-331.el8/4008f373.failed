net: phy: mscc: implement generic .handle_interrupt() callback

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-331.el8
commit-author Ioana Ciornei <ioana.ciornei@nxp.com>
commit 4008f373eb711630aae79be0b126dc877c4f3a5d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-331.el8/4008f373.failed

In an attempt to actually support shared IRQs in phylib, we now move the
responsibility of triggering the phylib state machine or just returning
IRQ_NONE, based on the IRQ status register, to the PHY driver. Having
3 different IRQ handling callbacks (.handle_interrupt(),
.did_interrupt() and .ack_interrupt() ) is confusing so let the PHY
driver implement directly an IRQ handler like any other device driver.
Make this driver follow the new convention.

Also, remove the .did_interrupt() callback since it's not anymore used.

	Signed-off-by: Ioana Ciornei <ioana.ciornei@nxp.com>
	Tested-by: Vladimir Oltean <olteanv@gmail.com> # VSC8514
	Signed-off-by: Jakub Kicinski <kuba@kernel.org>
(cherry picked from commit 4008f373eb711630aae79be0b126dc877c4f3a5d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/phy/mscc.c
diff --cc drivers/net/phy/mscc.c
index 4a148895b64d,48883730bf6f..000000000000
--- a/drivers/net/phy/mscc.c
+++ b/drivers/net/phy/mscc.c
@@@ -2353,6 -2114,30 +2361,33 @@@ static int vsc85xx_probe(struct phy_dev
  /* Microsemi VSC85xx PHYs */
  static struct phy_driver vsc85xx_driver[] = {
  {
++<<<<<<< HEAD:drivers/net/phy/mscc.c
++=======
+ 	.phy_id		= PHY_ID_VSC8502,
+ 	.name		= "Microsemi GE VSC8502 SyncE",
+ 	.phy_id_mask	= 0xfffffff0,
+ 	/* PHY_BASIC_FEATURES */
+ 	.soft_reset	= &genphy_soft_reset,
+ 	.config_init	= &vsc85xx_config_init,
+ 	.config_aneg    = &vsc85xx_config_aneg,
+ 	.read_status	= &vsc85xx_read_status,
+ 	.handle_interrupt = vsc85xx_handle_interrupt,
+ 	.config_intr	= &vsc85xx_config_intr,
+ 	.suspend	= &genphy_suspend,
+ 	.resume		= &genphy_resume,
+ 	.probe		= &vsc85xx_probe,
+ 	.set_wol	= &vsc85xx_wol_set,
+ 	.get_wol	= &vsc85xx_wol_get,
+ 	.get_tunable	= &vsc85xx_get_tunable,
+ 	.set_tunable	= &vsc85xx_set_tunable,
+ 	.read_page	= &vsc85xx_phy_read_page,
+ 	.write_page	= &vsc85xx_phy_write_page,
+ 	.get_sset_count = &vsc85xx_get_sset_count,
+ 	.get_strings    = &vsc85xx_get_strings,
+ 	.get_stats      = &vsc85xx_get_stats,
+ },
+ {
++>>>>>>> 4008f373eb71 (net: phy: mscc: implement generic .handle_interrupt() callback):drivers/net/phy/mscc/mscc_main.c
  	.phy_id		= PHY_ID_VSC8504,
  	.name		= "Microsemi GE VSC8504 SyncE",
  	.phy_id_mask	= 0xfffffff0,
@@@ -2555,9 -2337,9 +2587,8 @@@
  	.config_aneg    = &vsc85xx_config_aneg,
  	.aneg_done	= &genphy_aneg_done,
  	.read_status	= &vsc85xx_read_status,
 -	.handle_interrupt = &vsc8584_handle_interrupt,
  	.ack_interrupt  = &vsc85xx_ack_interrupt,
  	.config_intr    = &vsc85xx_config_intr,
- 	.did_interrupt  = &vsc8584_did_interrupt,
  	.suspend	= &genphy_suspend,
  	.resume		= &genphy_resume,
  	.probe		= &vsc8574_probe,
@@@ -2607,9 -2388,9 +2637,8 @@@
  	.config_aneg    = &vsc85xx_config_aneg,
  	.aneg_done	= &genphy_aneg_done,
  	.read_status	= &vsc85xx_read_status,
 -	.handle_interrupt = &vsc8584_handle_interrupt,
  	.ack_interrupt  = &vsc85xx_ack_interrupt,
  	.config_intr    = &vsc85xx_config_intr,
- 	.did_interrupt  = &vsc8584_did_interrupt,
  	.suspend	= &genphy_suspend,
  	.resume		= &genphy_resume,
  	.probe		= &vsc8584_probe,
@@@ -2631,9 -2412,9 +2660,8 @@@
  	.config_aneg    = &vsc85xx_config_aneg,
  	.aneg_done	= &genphy_aneg_done,
  	.read_status	= &vsc85xx_read_status,
 -	.handle_interrupt = &vsc8584_handle_interrupt,
  	.ack_interrupt  = &vsc85xx_ack_interrupt,
  	.config_intr    = &vsc85xx_config_intr,
- 	.did_interrupt  = &vsc8584_did_interrupt,
  	.suspend	= &genphy_suspend,
  	.resume		= &genphy_resume,
  	.probe		= &vsc8584_probe,
@@@ -2655,9 -2436,9 +2683,8 @@@
  	.config_aneg    = &vsc85xx_config_aneg,
  	.aneg_done	= &genphy_aneg_done,
  	.read_status	= &vsc85xx_read_status,
 -	.handle_interrupt = &vsc8584_handle_interrupt,
  	.ack_interrupt  = &vsc85xx_ack_interrupt,
  	.config_intr    = &vsc85xx_config_intr,
- 	.did_interrupt  = &vsc8584_did_interrupt,
  	.suspend	= &genphy_suspend,
  	.resume		= &genphy_resume,
  	.probe		= &vsc8584_probe,
* Unmerged path drivers/net/phy/mscc.c
