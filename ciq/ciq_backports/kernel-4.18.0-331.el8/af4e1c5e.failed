x86/amd_nb: Add PCI device IDs for family 17h, model 70h

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-331.el8
commit-author Marcel Bocu <marcel.p.bocu@gmail.com>
commit af4e1c5eca95bed1192d8dc45c8ed63aea2209e8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-331.el8/af4e1c5e.failed

The AMD Ryzen gen 3 processors came with a different PCI IDs for the
function 3 & 4 which are used to access the SMN interface. The root
PCI address however remained at the same address as the model 30h.

Adding the F3/F4 PCI IDs respectively to the misc and link ids appear
to be sufficient for k10temp, so let's add them and follow up on the
patch if other functions need more tweaking.

Vicki Pfau sent an identical patch after I checked that no-one had
written this patch. I would have been happy about dropping my patch but
unlike for his patch series, I had already Cc:ed the x86 people and
they already reviewed the changes. Since Vicki has not answered to
any email after his initial series, let's assume she is on vacation
and let's avoid duplication of reviews from the maintainers and merge
my series. To acknowledge Vicki's anteriority, I added her S-o-b to
the patch.

v2, suggested by Guenter Roeck and Brian Woods:
 - rename from 71h to 70h

	Signed-off-by: Vicki Pfau <vi@endrift.com>
	Signed-off-by: Marcel Bocu <marcel.p.bocu@gmail.com>
	Tested-by: Marcel Bocu <marcel.p.bocu@gmail.com>
	Acked-by: Thomas Gleixner <tglx@linutronix.de>
	Acked-by: Brian Woods <brian.woods@amd.com>
	Acked-by: Bjorn Helgaas <bhelgaas@google.com>	# pci_ids.h

	Cc: Thomas Gleixner <tglx@linutronix.de>
	Cc: Ingo Molnar <mingo@redhat.com>
	Cc: Borislav Petkov <bp@alien8.de>
	Cc: "H. Peter Anvin" <hpa@zytor.com>
	Cc: x86@kernel.org
	Cc: "Woods, Brian" <Brian.Woods@amd.com>
	Cc: Clemens Ladisch <clemens@ladisch.de>
	Cc: Jean Delvare <jdelvare@suse.com>
	Cc: Guenter Roeck <linux@roeck-us.net>
	Cc: linux-hwmon@vger.kernel.org
Link: https://lore.kernel.org/r/20190722174510.2179-1-marcel.p.bocu@gmail.com
	Signed-off-by: Guenter Roeck <linux@roeck-us.net>
(cherry picked from commit af4e1c5eca95bed1192d8dc45c8ed63aea2209e8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kernel/amd_nb.c
#	include/linux/pci_ids.h
diff --cc arch/x86/kernel/amd_nb.c
index ff5870caba13,251c795b4eb3..000000000000
--- a/arch/x86/kernel/amd_nb.c
+++ b/arch/x86/kernel/amd_nb.c
@@@ -20,7 -21,7 +20,11 @@@
  #define PCI_DEVICE_ID_AMD_17H_DF_F4	0x1464
  #define PCI_DEVICE_ID_AMD_17H_M10H_DF_F4 0x15ec
  #define PCI_DEVICE_ID_AMD_17H_M30H_DF_F4 0x1494
++<<<<<<< HEAD
 +#define PCI_DEVICE_ID_AMD_19H_DF_F4	0x1654
++=======
+ #define PCI_DEVICE_ID_AMD_17H_M70H_DF_F4 0x1444
++>>>>>>> af4e1c5eca95 (x86/amd_nb: Add PCI device IDs for family 17h, model 70h)
  
  /* Protect the PCI config register pairs used for SMN and DF indirect access. */
  static DEFINE_MUTEX(smn_mutex);
@@@ -50,7 -51,7 +54,11 @@@ const struct pci_device_id amd_nb_misc_
  	{ PCI_DEVICE(PCI_VENDOR_ID_AMD, PCI_DEVICE_ID_AMD_17H_M10H_DF_F3) },
  	{ PCI_DEVICE(PCI_VENDOR_ID_AMD, PCI_DEVICE_ID_AMD_17H_M30H_DF_F3) },
  	{ PCI_DEVICE(PCI_VENDOR_ID_AMD, PCI_DEVICE_ID_AMD_CNB17H_F3) },
++<<<<<<< HEAD
 +	{ PCI_DEVICE(PCI_VENDOR_ID_AMD, PCI_DEVICE_ID_AMD_19H_DF_F3) },
++=======
+ 	{ PCI_DEVICE(PCI_VENDOR_ID_AMD, PCI_DEVICE_ID_AMD_17H_M70H_DF_F3) },
++>>>>>>> af4e1c5eca95 (x86/amd_nb: Add PCI device IDs for family 17h, model 70h)
  	{}
  };
  EXPORT_SYMBOL_GPL(amd_nb_misc_ids);
@@@ -64,7 -65,7 +72,11 @@@ static const struct pci_device_id amd_n
  	{ PCI_DEVICE(PCI_VENDOR_ID_AMD, PCI_DEVICE_ID_AMD_17H_DF_F4) },
  	{ PCI_DEVICE(PCI_VENDOR_ID_AMD, PCI_DEVICE_ID_AMD_17H_M10H_DF_F4) },
  	{ PCI_DEVICE(PCI_VENDOR_ID_AMD, PCI_DEVICE_ID_AMD_17H_M30H_DF_F4) },
++<<<<<<< HEAD
 +	{ PCI_DEVICE(PCI_VENDOR_ID_AMD, PCI_DEVICE_ID_AMD_19H_DF_F4) },
++=======
+ 	{ PCI_DEVICE(PCI_VENDOR_ID_AMD, PCI_DEVICE_ID_AMD_17H_M70H_DF_F4) },
++>>>>>>> af4e1c5eca95 (x86/amd_nb: Add PCI device IDs for family 17h, model 70h)
  	{ PCI_DEVICE(PCI_VENDOR_ID_AMD, PCI_DEVICE_ID_AMD_CNB17H_F4) },
  	{}
  };
diff --cc include/linux/pci_ids.h
index a06ffaac6453,4b97f427cc92..000000000000
--- a/include/linux/pci_ids.h
+++ b/include/linux/pci_ids.h
@@@ -549,7 -548,7 +549,11 @@@
  #define PCI_DEVICE_ID_AMD_17H_DF_F3	0x1463
  #define PCI_DEVICE_ID_AMD_17H_M10H_DF_F3 0x15eb
  #define PCI_DEVICE_ID_AMD_17H_M30H_DF_F3 0x1493
++<<<<<<< HEAD
 +#define PCI_DEVICE_ID_AMD_19H_DF_F3	0x1653
++=======
+ #define PCI_DEVICE_ID_AMD_17H_M70H_DF_F3 0x1443
++>>>>>>> af4e1c5eca95 (x86/amd_nb: Add PCI device IDs for family 17h, model 70h)
  #define PCI_DEVICE_ID_AMD_CNB17H_F3	0x1703
  #define PCI_DEVICE_ID_AMD_LANCE		0x2000
  #define PCI_DEVICE_ID_AMD_LANCE_HOME	0x2001
* Unmerged path arch/x86/kernel/amd_nb.c
* Unmerged path include/linux/pci_ids.h
