e1000e: Leverage direct_complete to speed up s2ram

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-331.el8
commit-author Chen Yu <yu.c.chen@intel.com>
commit ccf8b940e5fdd331231a7442cd80f0e83336cfd3
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-331.el8/ccf8b940.failed

The NIC is put in runtime suspend status when there is no cable connected.
As a result, it is safe to keep non-wakeup NIC in runtime suspended during
s2ram because the system does not rely on the NIC plug event nor WoL to wake
up the system. Besides that, unlike the s2idle, s2ram does not need to
manipulate S0ix settings during suspend.

This patch introduces the .prepare() for e1000e so that if the NIC is runtime
suspended the subsequent suspend/resume hooks will be skipped so as to speed
up the s2ram. The pm core will check whether the NIC is a wake up device so
there's no need to check it again in .prepare(). DPM_FLAG_SMART_PREPARE flag
should be set during probe to ask the pci subsystem to honor the driver's
prepare() result. Besides, the NIC remains runtime suspended after resumed
from s2ram as there is no need to resume it.

Tested on i7-2600K with 82579V NIC
Before the patch:
e1000e 0000:00:19.0: pci_pm_suspend+0x0/0x160 returned 0 after 225146 usecs
e1000e 0000:00:19.0: pci_pm_resume+0x0/0x90 returned 0 after 140588 usecs

After the patch:
echo disabled > //sys/devices/pci0000\:00/0000\:00\:19.0/power/wakeup
becomes 0 usecs because the hooks will be skipped.

	Suggested-by: Kai-Heng Feng <kai.heng.feng@canonical.com>
	Signed-off-by: Chen Yu <yu.c.chen@intel.com>
	Tested-by: Dvora Fuxbrumer <dvorax.fuxbrumer@linux.intel.com>
	Signed-off-by: Tony Nguyen <anthony.l.nguyen@intel.com>
(cherry picked from commit ccf8b940e5fdd331231a7442cd80f0e83336cfd3)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/e1000e/netdev.c
diff --cc drivers/net/ethernet/intel/e1000e/netdev.c
index 553ec7a1ff4d,3eaae9a5a44e..000000000000
--- a/drivers/net/ethernet/intel/e1000e/netdev.c
+++ b/drivers/net/ethernet/intel/e1000e/netdev.c
@@@ -25,7 -25,7 +25,11 @@@
  #include <linux/pm_runtime.h>
  #include <linux/aer.h>
  #include <linux/prefetch.h>
++<<<<<<< HEAD
 +#include <generated/utsrelease.h>
++=======
+ #include <linux/suspend.h>
++>>>>>>> ccf8b940e5fd (e1000e: Leverage direct_complete to speed up s2ram)
  
  #include "e1000.h"
  
* Unmerged path drivers/net/ethernet/intel/e1000e/netdev.c
