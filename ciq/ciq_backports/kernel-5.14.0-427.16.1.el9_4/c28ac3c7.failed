mm/mglru: skip special VMAs in lru_gen_look_around()

jira LE-1907
Rebuild_History Non-Buildable kernel-5.14.0-427.16.1.el9_4
commit-author Yu Zhao <yuzhao@google.com>
commit c28ac3c7eb945fee6e20f47d576af68fdff1392a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-5.14.0-427.16.1.el9_4/c28ac3c7.failed

Special VMAs like VM_PFNMAP can contain anon pages from COW.  There isn't
much profit in doing lookaround on them.  Besides, they can trigger the
pte_special() warning in get_pte_pfn().

Skip them in lru_gen_look_around().

Link: https://lkml.kernel.org/r/20231223045647.1566043-1-yuzhao@google.com
Fixes: 018ee47f1489 ("mm: multi-gen LRU: exploit locality in rmap")
	Signed-off-by: Yu Zhao <yuzhao@google.com>
	Reported-by: syzbot+03fd9b3f71641f0ebf2d@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/000000000000f9ff00060d14c256@google.com/
	Cc: <stable@vger.kernel.org>
	Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
(cherry picked from commit c28ac3c7eb945fee6e20f47d576af68fdff1392a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	mm/vmscan.c
diff --cc mm/vmscan.c
index 78a303c2022b,bba207f41b14..000000000000
--- a/mm/vmscan.c
+++ b/mm/vmscan.c
@@@ -4622,8 -4001,9 +4627,12 @@@ void lru_gen_look_around(struct page_vm
  
  	for (i = 0, addr = start; addr != end; i++, addr += PAGE_SIZE) {
  		unsigned long pfn;
 -		pte_t ptent = ptep_get(pte + i);
  
++<<<<<<< HEAD
 +		pfn = get_pte_pfn(pte[i], pvmw->vma, addr);
++=======
+ 		pfn = get_pte_pfn(ptent, vma, addr);
++>>>>>>> c28ac3c7eb94 (mm/mglru: skip special VMAs in lru_gen_look_around())
  		if (pfn == -1)
  			continue;
  
* Unmerged path mm/vmscan.c
