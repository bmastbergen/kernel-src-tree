drm/nouveau/device: recognise GK208

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
Rebuild_CHGLOG: - [drm] nouveau/device: recognise GK208 (Rob Clark) [1018414]
Rebuild_FUZZ: 93.94%
commit-author Ben Skeggs <bskeggs@redhat.com>
commit aabf19c27fc72c9c218844c8385744ff5620a229
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/aabf19c2.failed

	Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
(cherry picked from commit aabf19c27fc72c9c218844c8385744ff5620a229)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/nouveau/core/engine/device/base.c
diff --cc drivers/gpu/drm/nouveau/core/engine/device/base.c
index 4c72571655ad,85ed9fbf2f44..000000000000
--- a/drivers/gpu/drm/nouveau/core/engine/device/base.c
+++ b/drivers/gpu/drm/nouveau/core/engine/device/base.c
@@@ -158,22 -158,29 +158,48 @@@ nouveau_devobj_ctor(struct nouveau_obje
  		iounmap(map);
  
  		/* determine chipset and derive architecture from it */
++<<<<<<< HEAD
 +		if ((boot0 & 0x0f000000) > 0) {
 +			device->chipset = (boot0 & 0xff00000) >> 20;
 +			switch (device->chipset & 0xf0) {
 +			case 0x10: device->card_type = NV_10; break;
 +			case 0x20: device->card_type = NV_20; break;
 +			case 0x30: device->card_type = NV_30; break;
 +			case 0x40:
 +			case 0x60: device->card_type = NV_40; break;
 +			case 0x50:
 +			case 0x80:
 +			case 0x90:
 +			case 0xa0: device->card_type = NV_50; break;
 +			case 0xc0: device->card_type = NV_C0; break;
 +			case 0xd0: device->card_type = NV_D0; break;
 +			case 0xe0:
 +			case 0xf0: device->card_type = NV_E0; break;
++=======
+ 		if ((boot0 & 0x1f000000) > 0) {
+ 			device->chipset = (boot0 & 0x1ff00000) >> 20;
+ 			switch (device->chipset & 0x1f0) {
+ 			case 0x010: {
+ 				if (0x461 & (1 << (device->chipset & 0xf)))
+ 					device->card_type = NV_10;
+ 				else
+ 					device->card_type = NV_11;
+ 				break;
+ 			}
+ 			case 0x020: device->card_type = NV_20; break;
+ 			case 0x030: device->card_type = NV_30; break;
+ 			case 0x040:
+ 			case 0x060: device->card_type = NV_40; break;
+ 			case 0x050:
+ 			case 0x080:
+ 			case 0x090:
+ 			case 0x0a0: device->card_type = NV_50; break;
+ 			case 0x0c0: device->card_type = NV_C0; break;
+ 			case 0x0d0: device->card_type = NV_D0; break;
+ 			case 0x0e0:
+ 			case 0x0f0:
+ 			case 0x100: device->card_type = NV_E0; break;
++>>>>>>> aabf19c27fc7 (drm/nouveau/device: recognise GK208)
  			default:
  				break;
  			}
* Unmerged path drivers/gpu/drm/nouveau/core/engine/device/base.c
diff --git a/drivers/gpu/drm/nouveau/core/engine/device/nve0.c b/drivers/gpu/drm/nouveau/core/engine/device/nve0.c
index a354e409cdff..e3e4307f53ba 100644
--- a/drivers/gpu/drm/nouveau/core/engine/device/nve0.c
+++ b/drivers/gpu/drm/nouveau/core/engine/device/nve0.c
@@ -173,6 +173,40 @@ nve0_identify(struct nouveau_device *device)
 		device->oclass[NVDEV_ENGINE_BSP    ] = &nve0_bsp_oclass;
 		device->oclass[NVDEV_ENGINE_VP     ] = &nve0_vp_oclass;
 		device->oclass[NVDEV_ENGINE_PPP    ] = &nvc0_ppp_oclass;
+#endif
+		break;
+	case 0x108:
+		device->cname = "GK208";
+		device->oclass[NVDEV_SUBDEV_VBIOS  ] = &nouveau_bios_oclass;
+		device->oclass[NVDEV_SUBDEV_GPIO   ] = &nve0_gpio_oclass;
+		device->oclass[NVDEV_SUBDEV_I2C    ] = &nvd0_i2c_oclass;
+		device->oclass[NVDEV_SUBDEV_CLOCK  ] = &nvc0_clock_oclass;
+		device->oclass[NVDEV_SUBDEV_THERM  ] = &nvd0_therm_oclass;
+		device->oclass[NVDEV_SUBDEV_MXM    ] = &nv50_mxm_oclass;
+		device->oclass[NVDEV_SUBDEV_DEVINIT] = &nvc0_devinit_oclass;
+		device->oclass[NVDEV_SUBDEV_MC     ] =  nvc3_mc_oclass;
+		device->oclass[NVDEV_SUBDEV_BUS    ] = &nvc0_bus_oclass;
+		device->oclass[NVDEV_SUBDEV_TIMER  ] = &nv04_timer_oclass;
+		device->oclass[NVDEV_SUBDEV_FB     ] =  nvc0_fb_oclass;
+		device->oclass[NVDEV_SUBDEV_LTCG   ] = &nvc0_ltcg_oclass;
+		device->oclass[NVDEV_SUBDEV_IBUS   ] = &nve0_ibus_oclass;
+		device->oclass[NVDEV_SUBDEV_INSTMEM] = &nv50_instmem_oclass;
+		device->oclass[NVDEV_SUBDEV_VM     ] = &nvc0_vmmgr_oclass;
+		device->oclass[NVDEV_SUBDEV_BAR    ] = &nvc0_bar_oclass;
+		device->oclass[NVDEV_ENGINE_DMAOBJ ] = &nvd0_dmaeng_oclass;
+#if 0
+		device->oclass[NVDEV_ENGINE_FIFO   ] = &nve0_fifo_oclass;
+		device->oclass[NVDEV_ENGINE_SW     ] =  nvc0_software_oclass;
+		device->oclass[NVDEV_ENGINE_GR     ] =  nvf0_graph_oclass;
+#endif
+		device->oclass[NVDEV_ENGINE_DISP   ] = &nvf0_disp_oclass;
+#if 0
+		device->oclass[NVDEV_ENGINE_COPY0  ] = &nve0_copy0_oclass;
+		device->oclass[NVDEV_ENGINE_COPY1  ] = &nve0_copy1_oclass;
+		device->oclass[NVDEV_ENGINE_COPY2  ] = &nve0_copy2_oclass;
+		device->oclass[NVDEV_ENGINE_BSP    ] = &nve0_bsp_oclass;
+		device->oclass[NVDEV_ENGINE_VP     ] = &nve0_vp_oclass;
+		device->oclass[NVDEV_ENGINE_PPP    ] = &nvc0_ppp_oclass;
 #endif
 		break;
 	default:
