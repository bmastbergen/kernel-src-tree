drm/qxl: fix memory leak in release list handling

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
Rebuild_CHGLOG: - [drm] qxl: fix memory leak in release list handling (Dave Airlie) [1035564]
Rebuild_FUZZ: 95.74%
commit-author Dave Airlie <airlied@redhat.com>
commit 1b28c3e628315ac0d9ef2d3fac0403f05ae692db
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/1b28c3e6.failed

wow no idea how I got this far without seeing this,
leaking the entries in the list makes kmalloc-64 slab grow.

References: https://bugzilla.kernel.org/show_bug.cgi?id=65121
	Cc: stable@vger.kernel.org
	Reported-by: Matthew Stapleton <matthew4196@gmail.com>
	Signed-off-by: Dave Airlie <airlied@redhat.com>
(cherry picked from commit 1b28c3e628315ac0d9ef2d3fac0403f05ae692db)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/qxl/qxl_release.c
diff --cc drivers/gpu/drm/qxl/qxl_release.c
index b443d6751d5f,821ab7b9409b..000000000000
--- a/drivers/gpu/drm/qxl/qxl_release.c
+++ b/drivers/gpu/drm/qxl/qxl_release.c
@@@ -85,12 -85,14 +85,18 @@@ qxl_release_free(struct qxl_device *qde
  	if (release->surface_release_id)
  		qxl_surface_id_dealloc(qdev, release->surface_release_id);
  
 -	list_for_each_entry_safe(entry, tmp, &release->bos, tv.head) {
 -		struct qxl_bo *bo = to_qxl_bo(entry->tv.bo);
 +	for (i = 0 ; i < release->bo_count; ++i) {
  		QXL_INFO(qdev, "release %llx\n",
 -			drm_vma_node_offset_addr(&entry->tv.bo->vma_node)
 +			release->bos[i]->tbo.addr_space_offset
  						- DRM_FILE_OFFSET);
++<<<<<<< HEAD
 +		qxl_fence_remove_release(&release->bos[i]->fence, release->id);
 +		qxl_bo_unref(&release->bos[i]);
++=======
+ 		qxl_fence_remove_release(&bo->fence, release->id);
+ 		qxl_bo_unref(&bo);
+ 		kfree(entry);
++>>>>>>> 1b28c3e62831 (drm/qxl: fix memory leak in release list handling)
  	}
  	spin_lock(&qdev->release_idr_lock);
  	idr_remove(&qdev->release_idr, release->id);
* Unmerged path drivers/gpu/drm/qxl/qxl_release.c
