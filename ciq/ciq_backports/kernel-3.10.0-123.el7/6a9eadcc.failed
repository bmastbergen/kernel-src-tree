ipv6: release dst properly in ipip6_tunnel_xmit

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
commit-author Li RongQing <roy.qing.li@gmail.com>
commit 6a9eadccff2926e392173a989042f14c867cffbf
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/6a9eadcc.failed

if a dst is not attached to anywhere, it should be released before
exit ipip6_tunnel_xmit, otherwise cause dst memory leakage.

Fixes: 61c1db7fae21 ("ipv6: sit: add GSO/TSO support")
	Signed-off-by: Li RongQing <roy.qing.li@gmail.com>
	Acked-by: Eric Dumazet <edumazet@google.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 6a9eadccff2926e392173a989042f14c867cffbf)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv6/sit.c
diff --cc net/ipv6/sit.c
index 67ced7f6ed94,c87482252577..000000000000
--- a/net/ipv6/sit.c
+++ b/net/ipv6/sit.c
@@@ -888,13 -965,14 +888,20 @@@ static netdev_tx_t ipip6_tunnel_xmit(st
  		ttl = iph6->hop_limit;
  	tos = INET_ECN_encapsulate(tos, ipv6_get_dsfield(iph6));
  
++<<<<<<< HEAD
 +	if (likely(!skb->encapsulation)) {
 +		skb_reset_inner_headers(skb);
 +		skb->encapsulation = 1;
++=======
+ 	skb = iptunnel_handle_offloads(skb, false, SKB_GSO_SIT);
+ 	if (IS_ERR(skb)) {
+ 		ip_rt_put(rt);
+ 		goto out;
++>>>>>>> 6a9eadccff29 (ipv6: release dst properly in ipip6_tunnel_xmit)
  	}
  
 -	err = iptunnel_xmit(rt, skb, fl4.saddr, fl4.daddr, IPPROTO_IPV6, tos,
 -			    ttl, df, !net_eq(tunnel->net, dev_net(dev)));
 +	err = iptunnel_xmit(dev_net(dev), rt, skb, fl4.saddr, fl4.daddr,
 +			    IPPROTO_IPV6, tos, ttl, df);
  	iptunnel_xmit_stats(err, &dev->stats, dev->tstats);
  	return NETDEV_TX_OK;
  
* Unmerged path net/ipv6/sit.c
