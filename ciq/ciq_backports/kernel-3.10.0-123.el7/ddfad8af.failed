audit: include subject in login records

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
commit-author Eric Paris <eparis@redhat.com>
commit ddfad8affdb73cc8df5890fef16d98d63ff3a6f0
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/ddfad8af.failed

The login uid change record does not include the selinux context of the
task logging in.  Add that information.

(Updated from 2011-01: RHBZ:670328 -- RGB)

	Reported-by: Steve Grubb <sgrubb@redhat.com>
	Acked-by: James Morris <jmorris@redhat.com>
	Signed-off-by: Eric Paris <eparis@redhat.com>
	Signed-off-by: Aristeu Rozanski <arozansk@redhat.com>
	Signed-off-by: Richard Guy Briggs <rgb@redhat.com>
(cherry picked from commit ddfad8affdb73cc8df5890fef16d98d63ff3a6f0)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	kernel/auditsc.c
diff --cc kernel/auditsc.c
index de233fb287a8,bd3de52600ff..000000000000
--- a/kernel/auditsc.c
+++ b/kernel/auditsc.c
@@@ -1981,12 -2050,10 +1981,19 @@@ static void audit_log_set_loginuid(kuid
  	ab = audit_log_start(NULL, GFP_KERNEL, AUDIT_LOGIN);
  	if (!ab)
  		return;
++<<<<<<< HEAD
 +	audit_log_format(ab, "pid=%d uid=%u"
 +			 " old-auid=%u auid=%u old-ses=%u ses=%u"
 +			 " res=%d",
 +			 current->pid, uid,
 +			 oldloginuid, loginuid, oldsessionid, sessionid,
 +			 !rc);
++=======
+ 	audit_log_format(ab, "pid=%d uid=%u", task_pid_nr(current), uid);
+ 	audit_log_task_context(ab);
+ 	audit_log_format(ab, " old-auid=%u auid=%u old-ses=%u ses=%u res=%d",
+ 			 oldloginuid, loginuid, oldsessionid, sessionid, !rc);
++>>>>>>> ddfad8affdb7 (audit: include subject in login records)
  	audit_log_end(ab);
  }
  
* Unmerged path kernel/auditsc.c
