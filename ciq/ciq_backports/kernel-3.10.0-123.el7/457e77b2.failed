drm/nouveau/bios: add more checks to PRAMIN image fetching

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
Rebuild_CHGLOG: - [drm] nouveau/bios: add more checks to PRAMIN image fetching (Ben Skeggs) [1033345]
Rebuild_FUZZ: 96.43%
commit-author Ben Skeggs <bskeggs@redhat.com>
commit 457e77b26428ab4a24998eecfb99f27fa4195397
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/457e77b2.failed

Prevents an attempt to access VRAM on an un-posted board, which, on a
particular system with a GRID K1 installed, causes a MCE and chokes
the entire system.

	Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
(cherry picked from commit 457e77b26428ab4a24998eecfb99f27fa4195397)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/nouveau/core/subdev/bios/base.c
diff --cc drivers/gpu/drm/nouveau/core/subdev/bios/base.c
index 0e2c1a4f1659,56085304a847..000000000000
--- a/drivers/gpu/drm/nouveau/core/subdev/bios/base.c
+++ b/drivers/gpu/drm/nouveau/core/subdev/bios/base.c
@@@ -89,7 -90,26 +89,30 @@@ nouveau_bios_shadow_pramin(struct nouve
  	int i;
  
  	if (device->card_type >= NV_50) {
++<<<<<<< HEAD
 +		u64 addr = (u64)(nv_rd32(bios, 0x619f04) & 0xffffff00) << 8;
++=======
+ 		if (device->card_type >= NV_C0 && device->card_type < GM100) {
+ 			if (nv_rd32(bios, 0x022500) & 0x00000001)
+ 				return;
+ 		} else
+ 		if (device->card_type >= GM100) {
+ 			if (nv_rd32(bios, 0x021c04) & 0x00000001)
+ 				return;
+ 		}
+ 
+ 		addr = nv_rd32(bios, 0x619f04);
+ 		if (!(addr & 0x00000008)) {
+ 			nv_debug(bios, "... not enabled\n");
+ 			return;
+ 		}
+ 		if ( (addr & 0x00000003) != 1) {
+ 			nv_debug(bios, "... not in vram\n");
+ 			return;
+ 		}
+ 
+ 		addr = (u64)(addr >> 8) << 8;
++>>>>>>> 457e77b26428 (drm/nouveau/bios: add more checks to PRAMIN image fetching)
  		if (!addr) {
  			addr  = (u64)nv_rd32(bios, 0x001700) << 16;
  			addr += 0xf0000;
* Unmerged path drivers/gpu/drm/nouveau/core/subdev/bios/base.c
