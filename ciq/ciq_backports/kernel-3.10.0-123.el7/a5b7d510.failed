ALSA: hda - hdmi: Fix channel maps with less common speakers

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
Rebuild_CHGLOG: - [alsa] hda/hdmi: Fix channel maps with less common speakers (Jaroslav Kysela) [1044022]
Rebuild_FUZZ: 91.07%
commit-author Anssi Hannula <anssi.hannula@iki.fi>
commit a5b7d510b2220cccbcaeb1b87a6d8c47efeb154c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/a5b7d510.failed

For some speakers and slots the CEA slot <-> speaker assignment depends
on the used CEA Channel Allocation value.

Therefore the from_cea_slot() and to_cea_slot() helpers currently only
work correctly for the regular 7.1 speakers.

Fix them to work with all speakers, taking the re-ordered CA index as
input and adapting use sites accordingly.

This change allows manual channel mapping to actually work for all CEA
allocated speakers. Additionally, this fixes incorrect channel map
reporting in automatic channel mapping mode when an affected speaker
position is used (e.g. 6.1 map which contains an RC speaker).

	Signed-off-by: Anssi Hannula <anssi.hannula@iki.fi>
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit a5b7d510b2220cccbcaeb1b87a6d8c47efeb154c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/pci/hda/patch_hdmi.c
diff --cc sound/pci/hda/patch_hdmi.c
index 18a67dc0cb28,dab2af762d94..000000000000
--- a/sound/pci/hda/patch_hdmi.c
+++ b/sound/pci/hda/patch_hdmi.c
@@@ -744,9 -772,10 +756,14 @@@ static int hdmi_manual_setup_channel_ma
  static void hdmi_setup_fake_chmap(unsigned char *map, int ca)
  {
  	int i;
 -	int ordered_ca = get_channel_allocation_order(ca);
  	for (i = 0; i < 8; i++) {
++<<<<<<< HEAD
 +		if (i < channel_allocations[ca].channels)
 +			map[i] = from_cea_slot((hdmi_channel_mapping[ca][i] >> 4) & 0x0f);
++=======
+ 		if (i < channel_allocations[ordered_ca].channels)
+ 			map[i] = from_cea_slot(ordered_ca, hdmi_channel_mapping[ca][i] & 0x0f);
++>>>>>>> a5b7d510b222 (ALSA: hda - hdmi: Fix channel maps with less common speakers)
  		else
  			map[i] = 0;
  	}
* Unmerged path sound/pci/hda/patch_hdmi.c
