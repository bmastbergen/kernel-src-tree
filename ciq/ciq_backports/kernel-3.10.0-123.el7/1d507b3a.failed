udl: fix issue with imported prime buffers

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
commit-author Rob Clark <robdclark@gmail.com>
commit 1d507b3af40a60e03a3bbc4c897fc2709c075d24
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/1d507b3a.failed

5dc9e1e8 was a bit over-ambitious, and accidentially removed handling
for imported prime buffers.

	Signed-off-by: Rob Clark <robdclark@gmail.com>
	Cc: stable@vger.kernel.org
	Signed-off-by: Dave Airlie <airlied@redhat.com>
(cherry picked from commit 1d507b3af40a60e03a3bbc4c897fc2709c075d24)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/udl/udl_gem.c
diff --cc drivers/gpu/drm/udl/udl_gem.c
index ef034fa3e6f5,8d67b943ac05..000000000000
--- a/drivers/gpu/drm/udl/udl_gem.c
+++ b/drivers/gpu/drm/udl/udl_gem.c
@@@ -159,19 -125,13 +159,26 @@@ err_pages
  
  static void udl_gem_put_pages(struct udl_gem_object *obj)
  {
++<<<<<<< HEAD
 +	int page_count = obj->base.size / PAGE_SIZE;
 +	int i;
 +
++=======
++>>>>>>> 1d507b3af40a (udl: fix issue with imported prime buffers)
  	if (obj->base.import_attach) {
  		drm_free_large(obj->pages);
  		obj->pages = NULL;
  		return;
  	}
  
++<<<<<<< HEAD
 +	for (i = 0; i < page_count; i++)
 +		page_cache_release(obj->pages[i]);
 +
 +	drm_free_large(obj->pages);
++=======
+ 	drm_gem_put_pages(&obj->base, obj->pages, false, false);
++>>>>>>> 1d507b3af40a (udl: fix issue with imported prime buffers)
  	obj->pages = NULL;
  }
  
* Unmerged path drivers/gpu/drm/udl/udl_gem.c
