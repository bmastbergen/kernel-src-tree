xfs: add xfs sb v4 support for dirent filetype field

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
commit-author Mark Tinguely <tinguely@sgi.com>
commit 3e3c51cee9a07d67e3910cc514867b56ac60ec94
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/3e3c51ce.failed

Add XFS superblock v4 support for the file type field in the
directory entry feature.

This support adds a feature bit for version 4 superblocks and
leaves the original superblock 5 incompatibility bit.

	Signed-off-by: Mark Tinguely <tinguely@sgi.com>
	Reviewed-by: Geoffrey Wehrman <gwehrman@sgi.com>
	Signed-off-by: Ben Myers <bpm@sgi.com>

(cherry picked from commit 3e3c51cee9a07d67e3910cc514867b56ac60ec94)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/xfs/xfs_sb.h
diff --cc fs/xfs/xfs_sb.h
index db7593f4bc7e,6835b44f850e..000000000000
--- a/fs/xfs/xfs_sb.h
+++ b/fs/xfs/xfs_sb.h
@@@ -624,6 -631,14 +626,17 @@@ static inline int xfs_sb_version_has_pq
  	return XFS_SB_VERSION_NUM(sbp) == XFS_SB_VERSION_5;
  }
  
++<<<<<<< HEAD
++=======
+ static inline int xfs_sb_version_hasftype(struct xfs_sb *sbp)
+ {
+ 	return (XFS_SB_VERSION_NUM(sbp) == XFS_SB_VERSION_5 &&
+ 		xfs_sb_has_incompat_feature(sbp, XFS_SB_FEAT_INCOMPAT_FTYPE)) ||
+ 	       (xfs_sb_version_hasmorebits(sbp) &&
+ 		 (sbp->sb_features2 & XFS_SB_VERSION2_FTYPE));
+ }
+ 
++>>>>>>> 3e3c51cee9a0 (xfs: add xfs sb v4 support for dirent filetype field)
  /*
   * end of superblock version macros
   */
* Unmerged path fs/xfs/xfs_sb.h
