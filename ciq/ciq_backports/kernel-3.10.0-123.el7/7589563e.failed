drm/nv50-/sw: share engine/channel constructor between implementations

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
Rebuild_CHGLOG: - [drm] nouveau: share engine/channel constructor between implementations (Rob Clark) [1018414]
Rebuild_FUZZ: 88.89%
commit-author Ben Skeggs <bskeggs@redhat.com>
commit 7589563eb34527fd1f357a1ef0dbb7ee6b02af1c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/7589563e.failed

	Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
(cherry picked from commit 7589563eb34527fd1f357a1ef0dbb7ee6b02af1c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/nouveau/core/engine/software/nv50.c
#	drivers/gpu/drm/nouveau/core/engine/software/nv50.h
#	drivers/gpu/drm/nouveau/core/engine/software/nvc0.c
diff --cc drivers/gpu/drm/nouveau/core/engine/software/nv50.c
index b79e6c54e372,5236a1430ef6..000000000000
--- a/drivers/gpu/drm/nouveau/core/engine/software/nv50.c
+++ b/drivers/gpu/drm/nouveau/core/engine/software/nv50.c
@@@ -209,4 -212,6 +212,10 @@@ nv50_software_oclass = 
  		.init = _nouveau_software_init,
  		.fini = _nouveau_software_fini,
  	},
++<<<<<<< HEAD
 +};
++=======
+ 	.cclass = &nv50_software_cclass.base,
+ 	.sclass =  nv50_software_sclass,
+ }.base;
++>>>>>>> 7589563eb345 (drm/nv50-/sw: share engine/channel constructor between implementations)
diff --cc drivers/gpu/drm/nouveau/core/engine/software/nv50.h
index cbdcab3f4f63,2c0b1b42b861..000000000000
--- a/drivers/gpu/drm/nouveau/core/engine/software/nv50.h
+++ b/drivers/gpu/drm/nouveau/core/engine/software/nv50.h
@@@ -3,6 -3,12 +3,15 @@@
  
  #include <engine/software.h>
  
++<<<<<<< HEAD
++=======
+ struct nv50_software_oclass {
+ 	struct nouveau_oclass base;
+ 	struct nouveau_oclass *cclass;
+ 	struct nouveau_oclass *sclass;
+ };
+ 
++>>>>>>> 7589563eb345 (drm/nv50-/sw: share engine/channel constructor between implementations)
  struct nv50_software_priv {
  	struct nouveau_software base;
  };
diff --cc drivers/gpu/drm/nouveau/core/engine/software/nvc0.c
index 6eaf08e68a09,27e47230e3e3..000000000000
--- a/drivers/gpu/drm/nouveau/core/engine/software/nvc0.c
+++ b/drivers/gpu/drm/nouveau/core/engine/software/nvc0.c
@@@ -188,32 -170,15 +170,46 @@@ nvc0_software_cclass = 
   * software engine/subdev functions
   ******************************************************************************/
  
++<<<<<<< HEAD
 +static int
 +nvc0_software_ctor(struct nouveau_object *parent, struct nouveau_object *engine,
 +		   struct nouveau_oclass *oclass, void *data, u32 size,
 +		   struct nouveau_object **pobject)
 +{
 +	struct nv50_software_priv *priv;
 +	int ret;
 +
 +	ret = nouveau_software_create(parent, engine, oclass, &priv);
 +	*pobject = nv_object(priv);
 +	if (ret)
 +		return ret;
 +
 +	nv_engine(priv)->cclass = &nvc0_software_cclass;
 +	nv_engine(priv)->sclass = nvc0_software_sclass;
 +	nv_subdev(priv)->intr = nv04_software_intr;
 +	return 0;
 +}
 +
 +struct nouveau_oclass
 +nvc0_software_oclass = {
 +	.handle = NV_ENGINE(SW, 0xc0),
 +	.ofuncs = &(struct nouveau_ofuncs) {
 +		.ctor = nvc0_software_ctor,
++=======
+ struct nouveau_oclass *
+ nvc0_software_oclass = &(struct nv50_software_oclass) {
+ 	.base.handle = NV_ENGINE(SW, 0xc0),
+ 	.base.ofuncs = &(struct nouveau_ofuncs) {
+ 		.ctor = nv50_software_ctor,
++>>>>>>> 7589563eb345 (drm/nv50-/sw: share engine/channel constructor between implementations)
  		.dtor = _nouveau_software_dtor,
  		.init = _nouveau_software_init,
  		.fini = _nouveau_software_fini,
  	},
++<<<<<<< HEAD
 +};
++=======
+ 	.cclass = &nvc0_software_cclass.base,
+ 	.sclass =  nvc0_software_sclass,
+ }.base;
++>>>>>>> 7589563eb345 (drm/nv50-/sw: share engine/channel constructor between implementations)
* Unmerged path drivers/gpu/drm/nouveau/core/engine/software/nv50.c
* Unmerged path drivers/gpu/drm/nouveau/core/engine/software/nv50.h
* Unmerged path drivers/gpu/drm/nouveau/core/engine/software/nvc0.c
