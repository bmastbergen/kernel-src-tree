IB/core: Don't resolve passive side RoCE L2 address in CMA REQ handler

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
Rebuild_CHGLOG: - [infiniband] core: Don't resolve passive side RoCE L2 address in cma req handler (Amir Vadai) [1075852]
Rebuild_FUZZ: 97.81%
commit-author Moni Shoua <monis@mellanox.com>
commit b2853fd6c2d0f383dbdf7427e263eb576a633867
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/b2853fd6.failed

The code that resolves the passive side source MAC within the rdma_cm
connection request handler was both redundant and buggy, so remove it.

It was redundant since later, when an RC QP is modified to RTR state,
the resolution will take place in the ib_core module.  It was buggy
because this callback also deals with UD SIDR exchange, for which we
incorrectly looked at the REQ member of the CM event and dereferenced
a random value.

Fixes: dd5f03beb4f7 ("IB/core: Ethernet L2 attributes in verbs/cm structures")
	Signed-off-by: Moni Shoua <monis@mellanox.com>
	Signed-off-by: Or Gerlitz <ogerlitz@mellanox.com>
	Signed-off-by: Roland Dreier <roland@purestorage.com>
(cherry picked from commit b2853fd6c2d0f383dbdf7427e263eb576a633867)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/core/cma.c
diff --cc drivers/infiniband/core/cma.c
index 7fff706b114d,42c3058e6e9c..000000000000
--- a/drivers/infiniband/core/cma.c
+++ b/drivers/infiniband/core/cma.c
@@@ -1309,13 -1327,13 +1309,21 @@@ static int cma_req_handler(struct ib_cm
  	ret = conn_id->id.event_handler(&conn_id->id, &event);
  	if (ret)
  		goto err3;
++<<<<<<< HEAD
 +
++=======
++>>>>>>> b2853fd6c2d0 (IB/core: Don't resolve passive side RoCE L2 address in CMA REQ handler)
  	/*
  	 * Acquire mutex to prevent user executing rdma_destroy_id()
  	 * while we're accessing the cm_id.
  	 */
  	mutex_lock(&lock);
++<<<<<<< HEAD
 +	if (cma_comp(conn_id, RDMA_CM_CONNECT) && (conn_id->id.qp_type != IB_QPT_UD))
++=======
+ 	if (cma_comp(conn_id, RDMA_CM_CONNECT) &&
+ 	    (conn_id->id.qp_type != IB_QPT_UD))
++>>>>>>> b2853fd6c2d0 (IB/core: Don't resolve passive side RoCE L2 address in CMA REQ handler)
  		ib_send_cm_mra(cm_id, CMA_CM_MRA_SETTING, NULL, 0);
  	mutex_unlock(&lock);
  	mutex_unlock(&conn_id->handler_mutex);
* Unmerged path drivers/infiniband/core/cma.c
