drm/nouveau/sw: fix oops if gpu has its display block disabled

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
Rebuild_CHGLOG: - [drm] nouveau/sw: fix oops if gpu has its display block disabled (Rob Clark) [1054409]
Rebuild_FUZZ: 96.67%
commit-author Ben Skeggs <bskeggs@redhat.com>
commit 13cd1a5511eb44a54187d91d4929a6592787a48b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/13cd1a55.failed

	Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
(cherry picked from commit 13cd1a5511eb44a54187d91d4929a6592787a48b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/nouveau/core/engine/software/nv50.c
diff --cc drivers/gpu/drm/nouveau/core/engine/software/nv50.c
index b79e6c54e372,5ce686ee729e..000000000000
--- a/drivers/gpu/drm/nouveau/core/engine/software/nv50.c
+++ b/drivers/gpu/drm/nouveau/core/engine/software/nv50.c
@@@ -161,8 -176,20 +161,24 @@@ nv50_software_context_ctor(struct nouve
  	if (ret)
  		return ret;
  
++<<<<<<< HEAD
++=======
+ 	chan->vblank.nr_event = pdisp ? pdisp->vblank->index_nr : 0;
+ 	chan->vblank.event = kzalloc(chan->vblank.nr_event *
+ 				     sizeof(*chan->vblank.event), GFP_KERNEL);
+ 	if (!chan->vblank.event)
+ 		return -ENOMEM;
+ 
+ 	for (i = 0; i < chan->vblank.nr_event; i++) {
+ 		ret = nouveau_event_new(pdisp->vblank, i, pclass->vblank,
+ 					chan, &chan->vblank.event[i]);
+ 		if (ret)
+ 			return ret;
+ 	}
+ 
++>>>>>>> 13cd1a5511eb (drm/nouveau/sw: fix oops if gpu has its display block disabled)
  	chan->vblank.channel = nv_gpuobj(parent->parent)->addr >> 12;
 +	chan->vblank.event.func = nv50_software_vblsem_release;
  	return 0;
  }
  
* Unmerged path drivers/gpu/drm/nouveau/core/engine/software/nv50.c
