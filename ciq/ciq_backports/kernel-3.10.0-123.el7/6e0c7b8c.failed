xfs: use xfs_icluster_size_fsb in xfs_ialloc_inode_init

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
commit-author Jie Liu <jeff.liu@oracle.com>
commit 6e0c7b8c3ea62d684af267d34fc015253e7cd6e5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/6e0c7b8c.failed

Use xfs_icluster_size_fsb() in xfs_ialloc_inode_init(), rename variable
ninodes to inodes_per_cluster, the latter is more meaningful.

	Signed-off-by: Jie Liu <jeff.liu@oracle.com>
	Reviewed-by: Dave Chinner <dchinner@redhat.com>
	Signed-off-by: Dave Chinner <david@fromorbit.com>
(cherry picked from commit 6e0c7b8c3ea62d684af267d34fc015253e7cd6e5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/xfs/xfs_ialloc.c
diff --cc fs/xfs/xfs_ialloc.c
index d1401a0cf9be,6ee592cfc0db..000000000000
--- a/fs/xfs/xfs_ialloc.c
+++ b/fs/xfs/xfs_ialloc.c
@@@ -177,20 -177,13 +177,26 @@@ xfs_ialloc_inode_init
  	xfs_ino_t		ino = 0;
  
  	/*
- 	 * Loop over the new block(s), filling in the inodes.
- 	 * For small block sizes, manipulate the inodes in buffers
- 	 * which are multiples of the blocks size.
+ 	 * Loop over the new block(s), filling in the inodes.  For small block
+ 	 * sizes, manipulate the inodes in buffers  which are multiples of the
+ 	 * blocks size.
  	 */
++<<<<<<< HEAD
 +	if (mp->m_sb.sb_blocksize >= XFS_INODE_CLUSTER_SIZE(mp)) {
 +		blks_per_cluster = 1;
 +		nbufs = length;
 +		ninodes = mp->m_sb.sb_inopblock;
 +	} else {
 +		blks_per_cluster = XFS_INODE_CLUSTER_SIZE(mp) /
 +				   mp->m_sb.sb_blocksize;
 +		nbufs = length / blks_per_cluster;
 +		ninodes = blks_per_cluster * mp->m_sb.sb_inopblock;
 +	}
++=======
+ 	blks_per_cluster = xfs_icluster_size_fsb(mp);
+ 	inodes_per_cluster = blks_per_cluster << mp->m_sb.sb_inopblog;
+ 	nbufs = length / blks_per_cluster;
++>>>>>>> 6e0c7b8c3ea6 (xfs: use xfs_icluster_size_fsb in xfs_ialloc_inode_init)
  
  	/*
  	 * Figure out what version number to use in the inodes we create.  If
* Unmerged path fs/xfs/xfs_ialloc.c
