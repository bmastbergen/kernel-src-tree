be2net: call napi_disable() for all event queues

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
commit-author Ivan Vecera <ivecera@redhat.com>
commit 55485e7b417b640870b14eceec4cfbcb2b3e7a92
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/55485e7b.failed

The recent be2net commit 6384a4d (adds a support for busy polling)
introduces a regression that results in kernel crash. It incorrectly
modified be_close() so napi_disable() is called only for the first queue.
This breaks a correct pairing of napi_enable/_disable for the rest
of event queues and causes a crash in subsequent be_open() call.

	Cc: Sathya Perla <sathya.perla@emulex.com>
	Cc: Subbu Seetharaman <subbu.seetharaman@emulex.com>
	Cc: Ajit Khaparde <ajit.khaparde@emulex.com>
	Signed-off-by: Ivan Vecera <ivecera@redhat.com>
	Acked-by: Ajit Khaparde <ajit.khaparde@emulex.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 55485e7b417b640870b14eceec4cfbcb2b3e7a92)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/emulex/benet/be_main.c
diff --cc drivers/net/ethernet/emulex/benet/be_main.c
index 385ca3ea2b56,0aec4d23eb58..000000000000
--- a/drivers/net/ethernet/emulex/benet/be_main.c
+++ b/drivers/net/ethernet/emulex/benet/be_main.c
@@@ -2586,11 -2658,13 +2586,17 @@@ static int be_close(struct net_device *
  
  	be_roce_dev_close(adapter);
  
 -	for_all_evt_queues(adapter, eqo, i) {
 -		if (adapter->flags & BE_FLAGS_NAPI_ENABLED) {
 +	if (adapter->flags & BE_FLAGS_NAPI_ENABLED) {
 +		for_all_evt_queues(adapter, eqo, i)
  			napi_disable(&eqo->napi);
++<<<<<<< HEAD
 +		adapter->flags &= ~BE_FLAGS_NAPI_ENABLED;
++=======
+ 			be_disable_busy_poll(eqo);
+ 		}
++>>>>>>> 55485e7b417b (be2net: call napi_disable() for all event queues)
  	}
+ 	adapter->flags &= ~BE_FLAGS_NAPI_ENABLED;
  
  	be_async_mcc_disable(adapter);
  
* Unmerged path drivers/net/ethernet/emulex/benet/be_main.c
