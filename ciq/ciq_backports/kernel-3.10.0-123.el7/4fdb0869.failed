drm/qxl: notify that the monitor config changed

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
Rebuild_CHGLOG: - [drm] qxl: notify that the monitor config changed (Dave Airlie) [1026182]
Rebuild_FUZZ: 95.56%
commit-author Marc-André Lureau <marcandre.lureau@gmail.com>
commit 4fdb086924db46489b1af679e2a06683f73c9cbc
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/4fdb0869.failed

drm_helper_hpd_irq_event() only notifies when the connector status
changed. However, Spice monitor config can change while the connector is
connected, to support arbitrary resolution. Do an hotplug event if it
wasn't done by drm_helper_hpd_irq_event().

	Signed-off-by: Marc-André Lureau <marcandre.lureau@redhat.com>
	Signed-off-by: Dave Airlie <airlied@redhat.com>
(cherry picked from commit 4fdb086924db46489b1af679e2a06683f73c9cbc)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/qxl/qxl_display.c
diff --cc drivers/gpu/drm/qxl/qxl_display.c
index 823d29e926ec,c2cc9b52d330..000000000000
--- a/drivers/gpu/drm/qxl/qxl_display.c
+++ b/drivers/gpu/drm/qxl/qxl_display.c
@@@ -155,10 -107,12 +155,19 @@@ void qxl_display_read_client_monitors_c
  		qxl_io_log(qdev, "failed crc check for client_monitors_config,"
  				 " retrying\n");
  	}
++<<<<<<< HEAD
 +	qxl_crtc_set_from_monitors_config(qdev);
 +	/* fire off a uevent and let userspace tell us what to do */
 +	qxl_io_log(qdev, "calling drm_sysfs_hotplug_event\n");
 +	drm_sysfs_hotplug_event(qdev->ddev);
++=======
+ 
+ 	if (!drm_helper_hpd_irq_event(qdev->ddev)) {
+ 		/* notify that the monitor configuration changed, to
+ 		   adjust at the arbitrary resolution */
+ 		drm_kms_helper_hotplug_event(qdev->ddev);
+ 	}
++>>>>>>> 4fdb086924db (drm/qxl: notify that the monitor config changed)
  }
  
  static int qxl_add_monitors_config_modes(struct drm_connector *connector)
* Unmerged path drivers/gpu/drm/qxl/qxl_display.c
