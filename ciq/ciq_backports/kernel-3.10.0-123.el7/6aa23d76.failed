nfs: check if gssd is running before attempting to use krb5i auth in SETCLIENTID call

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
commit-author Jeff Layton <jlayton@redhat.com>
commit 6aa23d76a7b549521a03b63b6d5b7880ea87eab7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/6aa23d76.failed

Currently, the client will attempt to use krb5i in the SETCLIENTID call
even if rpc.gssd isn't running. When that fails, it'll then fall back to
RPC_AUTH_UNIX. This introduced a delay when mounting if rpc.gssd isn't
running, and causes warning messages to pop up in the ring buffer.

Check to see if rpc.gssd is running before even attempting to use krb5i
auth, and just silently skip trying to do so if it isn't. In the event
that the admin is actually trying to mount with krb5*, it will still
fail at a later stage of the mount attempt.

	Signed-off-by: Jeff Layton <jlayton@redhat.com>
	Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
(cherry picked from commit 6aa23d76a7b549521a03b63b6d5b7880ea87eab7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/nfs/nfs4client.c
diff --cc fs/nfs/nfs4client.c
index a860ab566d6e,c1b7a80b6704..000000000000
--- a/fs/nfs/nfs4client.c
+++ b/fs/nfs/nfs4client.c
@@@ -368,7 -370,12 +369,16 @@@ struct nfs_client *nfs4_init_client(str
  	if (clp->cl_minorversion != 0)
  		__set_bit(NFS_CS_INFINITE_SLOTS, &clp->cl_flags);
  	__set_bit(NFS_CS_DISCRTRY, &clp->cl_flags);
++<<<<<<< HEAD
 +	error = nfs_create_rpc_client(clp, timeparms, RPC_AUTH_GSS_KRB5I);
++=======
+ 	__set_bit(NFS_CS_NO_RETRANS_TIMEOUT, &clp->cl_flags);
+ 
+ 	error = -EINVAL;
+ 	if (gssd_running(clp->cl_net))
+ 		error = nfs_create_rpc_client(clp, timeparms,
+ 					      RPC_AUTH_GSS_KRB5I);
++>>>>>>> 6aa23d76a7b5 (nfs: check if gssd is running before attempting to use krb5i auth in SETCLIENTID call)
  	if (error == -EINVAL)
  		error = nfs_create_rpc_client(clp, timeparms, RPC_AUTH_UNIX);
  	if (error < 0)
* Unmerged path fs/nfs/nfs4client.c
