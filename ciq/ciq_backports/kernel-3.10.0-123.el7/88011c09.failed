ALSA: hda/realtek - Raise the delay for alc283_shutup

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-123.el7
Rebuild_CHGLOG: - [alsa] hda/realtek: Raise the delay for alc283_shutup (Jaroslav Kysela) [1044022]
Rebuild_FUZZ: 90.91%
commit-author Kailang Yang <kailang@realtek.com>
commit 88011c0911ee7a1b001393662b9884fb7f32eec6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-123.el7/88011c09.failed

Some machine with 85ms delay might be happen pop noise when codec
enter to D3.  Raise up to 100ms delay will be match for more machine.

	Signed-off-by: Kailang Yang <kailang@realtek.com>
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit 88011c0911ee7a1b001393662b9884fb7f32eec6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/pci/hda/patch_realtek.c
diff --cc sound/pci/hda/patch_realtek.c
index 3ee5f1a3fdd4,dde858be3be5..000000000000
--- a/sound/pci/hda/patch_realtek.c
+++ b/sound/pci/hda/patch_realtek.c
@@@ -2587,6 -2602,74 +2587,77 @@@ static void alc269_shutup(struct hda_co
  	snd_hda_shutup_pins(codec);
  }
  
++<<<<<<< HEAD
++=======
+ static void alc283_init(struct hda_codec *codec)
+ {
+ 	struct alc_spec *spec = codec->spec;
+ 	hda_nid_t hp_pin = spec->gen.autocfg.hp_pins[0];
+ 	bool hp_pin_sense;
+ 	int val;
+ 
+ 	if (!hp_pin)
+ 		return;
+ 	hp_pin_sense = snd_hda_jack_detect(codec, hp_pin);
+ 
+ 	/* Index 0x43 Direct Drive HP AMP LPM Control 1 */
+ 	/* Headphone capless set to high power mode */
+ 	alc_write_coef_idx(codec, 0x43, 0x9004);
+ 
+ 	snd_hda_codec_write(codec, hp_pin, 0,
+ 			    AC_VERB_SET_AMP_GAIN_MUTE, AMP_OUT_MUTE);
+ 
+ 	if (hp_pin_sense)
+ 		msleep(85);
+ 
+ 	snd_hda_codec_write(codec, hp_pin, 0,
+ 			    AC_VERB_SET_PIN_WIDGET_CONTROL, PIN_OUT);
+ 
+ 	if (hp_pin_sense)
+ 		msleep(85);
+ 	/* Index 0x46 Combo jack auto switch control 2 */
+ 	/* 3k pull low control for Headset jack. */
+ 	val = alc_read_coef_idx(codec, 0x46);
+ 	alc_write_coef_idx(codec, 0x46, val & ~(3 << 12));
+ 	/* Headphone capless set to normal mode */
+ 	alc_write_coef_idx(codec, 0x43, 0x9614);
+ }
+ 
+ static void alc283_shutup(struct hda_codec *codec)
+ {
+ 	struct alc_spec *spec = codec->spec;
+ 	hda_nid_t hp_pin = spec->gen.autocfg.hp_pins[0];
+ 	bool hp_pin_sense;
+ 	int val;
+ 
+ 	if (!hp_pin) {
+ 		alc269_shutup(codec);
+ 		return;
+ 	}
+ 
+ 	hp_pin_sense = snd_hda_jack_detect(codec, hp_pin);
+ 
+ 	alc_write_coef_idx(codec, 0x43, 0x9004);
+ 
+ 	snd_hda_codec_write(codec, hp_pin, 0,
+ 			    AC_VERB_SET_AMP_GAIN_MUTE, AMP_OUT_MUTE);
+ 
+ 	if (hp_pin_sense)
+ 		msleep(100);
+ 
+ 	snd_hda_codec_write(codec, hp_pin, 0,
+ 			    AC_VERB_SET_PIN_WIDGET_CONTROL, 0x0);
+ 
+ 	val = alc_read_coef_idx(codec, 0x46);
+ 	alc_write_coef_idx(codec, 0x46, val | (3 << 12));
+ 
+ 	if (hp_pin_sense)
+ 		msleep(100);
+ 	snd_hda_shutup_pins(codec);
+ 	alc_write_coef_idx(codec, 0x43, 0x9614);
+ }
+ 
++>>>>>>> 88011c0911ee (ALSA: hda/realtek - Raise the delay for alc283_shutup)
  static void alc5505_coef_set(struct hda_codec *codec, unsigned int index_reg,
  			     unsigned int val)
  {
* Unmerged path sound/pci/hda/patch_realtek.c
