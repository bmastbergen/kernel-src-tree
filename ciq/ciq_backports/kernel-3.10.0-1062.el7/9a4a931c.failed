perf pmu: Fix pmu events parsing rule

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Jiri Olsa <jolsa@kernel.org>
commit 9a4a931ce847f4aaa12edf11b2e050e18bf45910
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/9a4a931c.failed

Currently all the event parsing fails end up in the event_pmu rule, and
display misleading help like:

  $ perf stat -e inst kill
  event syntax error: 'inst'
                       \___ Cannot find PMU `inst'. Missing kernel support?
  ...

The reason is that the event_pmu is too strong and match also single
string. Changing it to force the '/' separators to be part of the rule,
and getting the proper error now:

  $ perf stat -e inst kill
  event syntax error: 'inst'
                       \___ parser error
  Run 'perf list' for a list of valid events
  ...

	Signed-off-by: Jiri Olsa <jolsa@kernel.org>
	Reported-by: Ingo Molnar <mingo@kernel.org>
	Tested-by: Arnaldo Carvalho de Melo <acme@redhat.com>
	Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
	Cc: David Ahern <dsahern@gmail.com>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
Link: http://lkml.kernel.org/r/20180423090823.32309-5-jolsa@kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 9a4a931ce847f4aaa12edf11b2e050e18bf45910)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/util/parse-events.y
diff --cc tools/perf/util/parse-events.y
index b7975dc972b1,d14464c42714..000000000000
--- a/tools/perf/util/parse-events.y
+++ b/tools/perf/util/parse-events.y
@@@ -210,10 -220,11 +210,10 @@@ event_def: event_pmu 
  	   event_legacy_mem |
  	   event_legacy_tracepoint sep_dc |
  	   event_legacy_numeric sep_dc |
 -	   event_legacy_raw sep_dc |
 -	   event_bpf_file
 +	   event_legacy_raw sep_dc
  
  event_pmu:
- PE_NAME opt_event_config
+ PE_NAME '/' event_config '/'
  {
  	struct list_head *list, *orig_terms, *terms;
  
@@@ -221,9 -232,13 +221,13 @@@
  		YYABORT;
  
  	ALLOC_LIST(list);
++<<<<<<< HEAD
 +	if (parse_events_add_pmu(_parse_state, list, $1, $2)) {
++=======
+ 	if (parse_events_add_pmu(_parse_state, list, $1, $3, false)) {
++>>>>>>> 9a4a931ce847 (perf pmu: Fix pmu events parsing rule)
  		struct perf_pmu *pmu = NULL;
  		int ok = 0;
 -		char *pattern;
 -
 -		if (asprintf(&pattern, "%s*", $1) < 0)
 -			YYABORT;
  
  		while ((pmu = perf_pmu__scan(pmu)) != NULL) {
  			char *name = pmu->name;
* Unmerged path tools/perf/util/parse-events.y
