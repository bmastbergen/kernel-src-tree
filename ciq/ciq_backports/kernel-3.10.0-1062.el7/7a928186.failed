ALSA: hda/ca0132 - Change firmware name and usage

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Connor McAdams <conmanx360@gmail.com>
commit 7a928186b377a7ef3392e902378dc2d63bf332f7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/7a928186.failed

The Recon3D, AE-5, Z and ZxR all share the same firmware file. Rename
this from the specific "ctefx-sbz.bin" to "ctefx-desktop.bin" and set
the AE-5 and Recon3D to use it as well.

	Signed-off-by: Connor McAdams <conmanx360@gmail.com>
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit 7a928186b377a7ef3392e902378dc2d63bf332f7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/pci/hda/patch_ca0132.c
diff --cc sound/pci/hda/patch_ca0132.c
index 20ce308ff039,4453a53acbf3..000000000000
--- a/sound/pci/hda/patch_ca0132.c
+++ b/sound/pci/hda/patch_ca0132.c
@@@ -77,16 -81,22 +77,26 @@@
  #define SCP_GET    1
  
  #define EFX_FILE   "ctefx.bin"
++<<<<<<< HEAD
 +
 +#ifdef CONFIG_SND_HDA_CODEC_CA0132_DSP
 +MODULE_FIRMWARE(EFX_FILE);
++=======
+ #define DESKTOP_EFX_FILE   "ctefx-desktop.bin"
+ #define R3DI_EFX_FILE  "ctefx-r3di.bin"
+ 
+ #ifdef CONFIG_SND_HDA_CODEC_CA0132_DSP
+ MODULE_FIRMWARE(EFX_FILE);
+ MODULE_FIRMWARE(DESKTOP_EFX_FILE);
+ MODULE_FIRMWARE(R3DI_EFX_FILE);
++>>>>>>> 7a928186b377 (ALSA: hda/ca0132 - Change firmware name and usage)
  #endif
  
 -static const char *const dirstr[2] = { "Playback", "Capture" };
 +static char *dirstr[2] = { "Playback", "Capture" };
  
 -#define NUM_OF_OUTPUTS 3
  enum {
  	SPEAKER_OUT,
 -	HEADPHONE_OUT,
 -	SURROUND_OUT
 +	HEADPHONE_OUT
  };
  
  enum {
@@@ -4443,11 -6760,51 +4453,56 @@@ static void ca0132_set_dsp_msr(struct h
  static bool ca0132_download_dsp_images(struct hda_codec *codec)
  {
  	bool dsp_loaded = false;
 -	struct ca0132_spec *spec = codec->spec;
  	const struct dsp_image_seg *dsp_os_image;
  	const struct firmware *fw_entry;
++<<<<<<< HEAD
 +
 +	if (request_firmware(&fw_entry, EFX_FILE, codec->card->dev) != 0)
 +		return false;
++=======
+ 	/*
+ 	 * Alternate firmwares for different variants. The Recon3Di apparently
+ 	 * can use the default firmware, but I'll leave the option in case
+ 	 * it needs it again.
+ 	 */
+ 	switch (spec->quirk) {
+ 	case QUIRK_SBZ:
+ 	case QUIRK_R3D:
+ 	case QUIRK_AE5:
+ 		if (request_firmware(&fw_entry, DESKTOP_EFX_FILE,
+ 					codec->card->dev) != 0) {
+ 			codec_dbg(codec, "Desktop firmware not found. ");
+ 			spec->alt_firmware_present = false;
+ 		} else {
+ 			codec_dbg(codec, "Desktop firmware selected.");
+ 			spec->alt_firmware_present = true;
+ 		}
+ 		break;
+ 	case QUIRK_R3DI:
+ 		if (request_firmware(&fw_entry, R3DI_EFX_FILE,
+ 					codec->card->dev) != 0) {
+ 			codec_dbg(codec, "Recon3Di alt firmware not detected.");
+ 			spec->alt_firmware_present = false;
+ 		} else {
+ 			codec_dbg(codec, "Recon3Di firmware selected.");
+ 			spec->alt_firmware_present = true;
+ 		}
+ 		break;
+ 	default:
+ 		spec->alt_firmware_present = false;
+ 		break;
+ 	}
+ 	/*
+ 	 * Use default ctefx.bin if no alt firmware is detected, or if none
+ 	 * exists for your particular codec.
+ 	 */
+ 	if (!spec->alt_firmware_present) {
+ 		codec_dbg(codec, "Default firmware selected.");
+ 		if (request_firmware(&fw_entry, EFX_FILE,
+ 					codec->card->dev) != 0)
+ 			return false;
+ 	}
++>>>>>>> 7a928186b377 (ALSA: hda/ca0132 - Change firmware name and usage)
  
  	dsp_os_image = (struct dsp_image_seg *)(fw_entry->data);
  	if (dspload_image(codec, dsp_os_image, 0, 0, true, 0)) {
* Unmerged path sound/pci/hda/patch_ca0132.c
