bpf: show prog and map id in fdinfo

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Daniel Borkmann <daniel@iogearbox.net>
commit 4316b40914ecde3738968225af56e650e8b61938
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/4316b409.failed

Its trivial and straight forward to expose it for scripts that can
then use it along with bpftool in order to inspect an individual
application's used maps and progs. Right now we dump some basic
information in the fdinfo file but with the help of the map/prog
id full introspection becomes possible now.

	Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
	Acked-by: Alexei Starovoitov <ast@kernel.org>
	Acked-by: Song Liu <songliubraving@fb.com>
	Acked-by: Jesper Dangaard Brouer <brouer@redhat.com>
	Signed-off-by: Alexei Starovoitov <ast@kernel.org>
(cherry picked from commit 4316b40914ecde3738968225af56e650e8b61938)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	kernel/bpf/syscall.c
diff --cc kernel/bpf/syscall.c
index f8f3ed8bef67,0fa20624707f..000000000000
--- a/kernel/bpf/syscall.c
+++ b/kernel/bpf/syscall.c
@@@ -312,15 -334,15 +313,16 @@@ static int bpf_map_show_fdinfo(struct s
  		   map->value_size,
  		   map->max_entries,
  		   map->map_flags,
- 		   map->pages * 1ULL << PAGE_SHIFT);
+ 		   map->pages * 1ULL << PAGE_SHIFT,
+ 		   map->id);
  
  	if (owner_prog_type) {
 -		seq_printf(m, "owner_prog_type:\t%u\n",
 -			   owner_prog_type);
 -		seq_printf(m, "owner_jited:\t%u\n",
 -			   owner_jited);
 +		ret += seq_printf(m, "owner_prog_type:\t%u\n",
 +				  owner_prog_type);
 +		ret += seq_printf(m, "owner_jited:\t%u\n",
 +				  owner_jited);
  	}
 +	return ret;
  }
  #endif
  
@@@ -987,9 -1077,8 +990,14 @@@ static int bpf_prog_show_fdinfo(struct 
  		   prog->type,
  		   prog->jited,
  		   prog_tag,
++<<<<<<< HEAD
 +		   prog->pages * 1ULL << PAGE_SHIFT);
 +
 +	return ret;
++=======
+ 		   prog->pages * 1ULL << PAGE_SHIFT,
+ 		   prog->aux->id);
++>>>>>>> 4316b40914ec (bpf: show prog and map id in fdinfo)
  }
  #endif
  
* Unmerged path kernel/bpf/syscall.c
