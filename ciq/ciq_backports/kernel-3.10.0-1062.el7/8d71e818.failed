net/mlx5: Use u16 for Work Queue buffer fragment size

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
Rebuild_CHGLOG: - [netdrv] mlx5: Use u16 for Work Queue buffer fragment size (Alaa Hleihel) [1641348 1642498]
Rebuild_FUZZ: 96.08%
commit-author Tariq Toukan <tariqt@mellanox.com>
commit 8d71e818506718e8d7032ce824b5c74a17d4f7a5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/8d71e818.failed

Minimal stride size is 16.
Hence, the number of strides in a fragment (of PAGE_SIZE)
is <= PAGE_SIZE / 16 <= 4K.

u16 is sufficient to represent this.

Fixes: 388ca8be0037 ("IB/mlx5: Implement fragmented completion queue (CQ)")
	Signed-off-by: Tariq Toukan <tariqt@mellanox.com>
	Reviewed-by: Eran Ben Elisha <eranbe@mellanox.com>
	Signed-off-by: Saeed Mahameed <saeedm@mellanox.com>
(cherry picked from commit 8d71e818506718e8d7032ce824b5c74a17d4f7a5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/wq.c
#	drivers/net/ethernet/mellanox/mlx5/core/wq.h
#	include/linux/mlx5/driver.h
diff --cc drivers/net/ethernet/mellanox/mlx5/core/wq.c
index ea66448ba365,d838af9539b1..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/wq.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/wq.c
@@@ -36,7 -36,12 +36,16 @@@
  
  u32 mlx5_wq_cyc_get_size(struct mlx5_wq_cyc *wq)
  {
++<<<<<<< HEAD
 +	return (u32)wq->sz_m1 + 1;
++=======
+ 	return (u32)wq->fbc.sz_m1 + 1;
+ }
+ 
+ u16 mlx5_wq_cyc_get_frag_size(struct mlx5_wq_cyc *wq)
+ {
+ 	return wq->fbc.frag_sz_m1 + 1;
++>>>>>>> 8d71e8185067 (net/mlx5: Use u16 for Work Queue buffer fragment size)
  }
  
  u32 mlx5_cqwq_get_size(struct mlx5_cqwq *wq)
diff --cc drivers/net/ethernet/mellanox/mlx5/core/wq.h
index f3dfa0ca3c5d,3a1a170bb2d7..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/wq.h
+++ b/drivers/net/ethernet/mellanox/mlx5/core/wq.h
@@@ -87,6 -80,7 +87,10 @@@ int mlx5_wq_cyc_create(struct mlx5_core
  		       void *wqc, struct mlx5_wq_cyc *wq,
  		       struct mlx5_wq_ctrl *wq_ctrl);
  u32 mlx5_wq_cyc_get_size(struct mlx5_wq_cyc *wq);
++<<<<<<< HEAD
++=======
+ u16 mlx5_wq_cyc_get_frag_size(struct mlx5_wq_cyc *wq);
++>>>>>>> 8d71e8185067 (net/mlx5: Use u16 for Work Queue buffer fragment size)
  
  int mlx5_wq_qp_create(struct mlx5_core_dev *mdev, struct mlx5_wq_param *param,
  		      void *qpc, struct mlx5_wq_qp *wq,
diff --cc include/linux/mlx5/driver.h
index 35545005ad03,3a1258fd8ac3..000000000000
--- a/include/linux/mlx5/driver.h
+++ b/include/linux/mlx5/driver.h
@@@ -355,7 -362,8 +355,12 @@@ struct mlx5_frag_buf 
  struct mlx5_frag_buf_ctrl {
  	struct mlx5_frag_buf	frag_buf;
  	u32			sz_m1;
++<<<<<<< HEAD
 +	u32			frag_sz_m1;
++=======
+ 	u16			frag_sz_m1;
+ 	u32			strides_offset;
++>>>>>>> 8d71e8185067 (net/mlx5: Use u16 for Work Queue buffer fragment size)
  	u8			log_sz;
  	u8			log_stride;
  	u8			log_frag_strides;
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/wq.c
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/wq.h
* Unmerged path include/linux/mlx5/driver.h
