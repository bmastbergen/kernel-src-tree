net: sched: act_tunnel_key: fix NULL pointer dereference during init

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
Rebuild_CHGLOG: - [net] sched: act_tunnel_key: fix NULL pointer dereference during init (Davide Caratti) [1706158]
Rebuild_FUZZ: 96.18%
commit-author Vlad Buslov <vladbu@mellanox.com>
commit a3df633a3c92bb96b06552c3f828d7c267774379
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/a3df633a.failed

Metadata pointer is only initialized for action TCA_TUNNEL_KEY_ACT_SET, but
it is unconditionally dereferenced in tunnel_key_init() error handler.
Verify that metadata pointer is not NULL before dereferencing it in
tunnel_key_init error handling code.

Fixes: ee28bb56ac5b ("net/sched: fix memory leak in act_tunnel_key_init()")
	Signed-off-by: Vlad Buslov <vladbu@mellanox.com>
	Reviewed-by: Davide Caratti <dcaratti@redhat.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit a3df633a3c92bb96b06552c3f828d7c267774379)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sched/act_tunnel_key.c
diff --cc net/sched/act_tunnel_key.c
index 0680eb45c108,3f943de9a2c9..000000000000
--- a/net/sched/act_tunnel_key.c
+++ b/net/sched/act_tunnel_key.c
@@@ -357,6 -376,10 +357,13 @@@ static int tunnel_key_init(struct net *
  
  	return ret;
  
++<<<<<<< HEAD
++=======
+ release_tun_meta:
+ 	if (metadata)
+ 		dst_release(&metadata->dst);
+ 
++>>>>>>> a3df633a3c92 (net: sched: act_tunnel_key: fix NULL pointer dereference during init)
  err_out:
  	if (exists)
  		tcf_idr_release(*a, bind);
* Unmerged path net/sched/act_tunnel_key.c
