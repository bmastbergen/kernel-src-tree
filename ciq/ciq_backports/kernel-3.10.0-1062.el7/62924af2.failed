netfilter: nfnetlink: relax strict multicast group check from netlink_bind

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Pablo Neira Ayuso <pablo@netfilter.org>
commit 62924af247e95de7041a6d6f2d06cdd05152e2dc
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/62924af2.failed

Relax the checking that was introduced in 97840cb ("netfilter:
nfnetlink: fix insufficient validation in nfnetlink_bind") when the
subscription bitmask is used. Existing userspace code code may request
to listen to all of the existing netlink groups by setting an all to one
subscription group bitmask. Netlink already validates subscription via
setsockopt() for us.

	Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
(cherry picked from commit 62924af247e95de7041a6d6f2d06cdd05152e2dc)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/netfilter/nfnetlink.c
diff --cc net/netfilter/nfnetlink.c
index 03b05eca74dd,1aa7049c93f5..000000000000
--- a/net/netfilter/nfnetlink.c
+++ b/net/netfilter/nfnetlink.c
@@@ -475,7 -467,12 +475,16 @@@ static void nfnetlink_rcv(struct sk_buf
  static int nfnetlink_bind(int group)
  {
  	const struct nfnetlink_subsystem *ss;
++<<<<<<< HEAD
 +	int type = nfnl_group2type[group];
++=======
+ 	int type;
+ 
+ 	if (group <= NFNLGRP_NONE || group > NFNLGRP_MAX)
+ 		return 0;
+ 
+ 	type = nfnl_group2type[group];
++>>>>>>> 62924af247e9 (netfilter: nfnetlink: relax strict multicast group check from netlink_bind)
  
  	rcu_read_lock();
  	ss = nfnetlink_get_subsys(type);
* Unmerged path net/netfilter/nfnetlink.c
