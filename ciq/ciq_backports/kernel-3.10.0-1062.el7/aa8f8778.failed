ipv6: add RTA_TABLE and RTA_PREFSRC to rtm_ipv6_policy

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Eric Dumazet <edumazet@google.com>
commit aa8f8778493c85fff480cdf8b349b1e1dcb5f243
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/aa8f8778.failed

KMSAN reported use of uninit-value that I tracked to lack
of proper size check on RTA_TABLE attribute.

I also believe RTA_PREFSRC lacks a similar check.

Fixes: 86872cb57925 ("[IPv6] route: FIB6 configuration using struct fib6_config")
Fixes: c3968a857a6b ("ipv6: RTA_PREFSRC support for ipv6 route source address selection")
	Signed-off-by: Eric Dumazet <edumazet@google.com>
	Reported-by: syzbot <syzkaller@googlegroups.com>
	Acked-by: David Ahern <dsahern@gmail.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit aa8f8778493c85fff480cdf8b349b1e1dcb5f243)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv6/route.c
diff --cc net/ipv6/route.c
index be9f52bbafaa,cde7d8251377..000000000000
--- a/net/ipv6/route.c
+++ b/net/ipv6/route.c
@@@ -2735,10 -3981,13 +2736,17 @@@ static const struct nla_policy rtm_ipv6
  	[RTA_PRIORITY]          = { .type = NLA_U32 },
  	[RTA_METRICS]           = { .type = NLA_NESTED },
  	[RTA_MULTIPATH]		= { .len = sizeof(struct rtnexthop) },
 -	[RTA_PREF]              = { .type = NLA_U8 },
 +	[RTA_PREF]		= { .type = NLA_U8 },
  	[RTA_ENCAP_TYPE]	= { .type = NLA_U16 },
  	[RTA_ENCAP]		= { .type = NLA_NESTED },
++<<<<<<< HEAD
 +	[RTA_EXPIRES]           = { .type = NLA_U32 },
++=======
+ 	[RTA_EXPIRES]		= { .type = NLA_U32 },
+ 	[RTA_UID]		= { .type = NLA_U32 },
+ 	[RTA_MARK]		= { .type = NLA_U32 },
+ 	[RTA_TABLE]		= { .type = NLA_U32 },
++>>>>>>> aa8f8778493c (ipv6: add RTA_TABLE and RTA_PREFSRC to rtm_ipv6_policy)
  };
  
  static int rtm_to_fib6_config(struct sk_buff *skb, struct nlmsghdr *nlh,
* Unmerged path net/ipv6/route.c
