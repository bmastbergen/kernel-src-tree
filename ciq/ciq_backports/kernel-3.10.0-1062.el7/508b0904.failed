netfilter: ipv6: Preserve link scope traffic original oif

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Alin Nastac <alin.nastac@gmail.com>
commit 508b09046c0f21678652fb66fd1e9959d55591d2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/508b0904.failed

When ip6_route_me_harder is invoked, it resets outgoing interface of:
  - link-local scoped packets sent by neighbor discovery
  - multicast packets sent by MLD host
  - multicast packets send by MLD proxy daemon that sets outgoing
    interface through IPV6_PKTINFO ipi6_ifindex

Link-local and multicast packets must keep their original oif after
ip6_route_me_harder is called.

	Signed-off-by: Alin Nastac <alin.nastac@gmail.com>
	Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
(cherry picked from commit 508b09046c0f21678652fb66fd1e9959d55591d2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv6/netfilter.c
diff --cc net/ipv6/netfilter.c
index a9957c7115a9,8b075f0bc351..000000000000
--- a/net/ipv6/netfilter.c
+++ b/net/ipv6/netfilter.c
@@@ -25,8 -23,11 +25,13 @@@ int ip6_route_me_harder(struct sk_buff 
  	unsigned int hh_len;
  	struct dst_entry *dst;
  	struct flowi6 fl6 = {
++<<<<<<< HEAD
 +		.flowi6_oif = skb->sk ? skb->sk->sk_bound_dev_if : 0,
++=======
+ 		.flowi6_oif = sk && sk->sk_bound_dev_if ? sk->sk_bound_dev_if :
+ 			rt6_need_strict(&iph->daddr) ? skb_dst(skb)->dev->ifindex : 0,
++>>>>>>> 508b09046c0f (netfilter: ipv6: Preserve link scope traffic original oif)
  		.flowi6_mark = skb->mark,
 -		.flowi6_uid = sock_net_uid(net, sk),
  		.daddr = iph->daddr,
  		.saddr = iph->saddr,
  	};
* Unmerged path net/ipv6/netfilter.c
