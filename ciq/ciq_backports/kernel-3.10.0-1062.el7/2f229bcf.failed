RDMA/rxe: Simplify the error handling code in rxe_create_ah()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Bart Van Assche <bart.vanassche@wdc.com>
commit 2f229bcf25ca076e8d8f46b9b3dccad5751040d2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/2f229bcf.failed

This patch not only simplifies the error handling code in rxe_create_ah()
but also removes the dead code that was left behind by commit 47ec38666210
("RDMA: Convert drivers to use sgid_attr instead of sgid_index").

	Signed-off-by: Bart Van Assche <bart.vanassche@wdc.com>
	Reviewed-by: Parav Pandit <parav@mellanox.com>
	Reviewed-by: Leon Romanovsky <leonro@mellanox.com>
	Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
(cherry picked from commit 2f229bcf25ca076e8d8f46b9b3dccad5751040d2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/sw/rxe/rxe_verbs.c
diff --cc drivers/infiniband/sw/rxe/rxe_verbs.c
index 39cef3e024df,1188e163204d..000000000000
--- a/drivers/infiniband/sw/rxe/rxe_verbs.c
+++ b/drivers/infiniband/sw/rxe/rxe_verbs.c
@@@ -302,17 -250,8 +300,20 @@@ static struct ib_ah *rxe_create_ah(stru
  	rxe_add_ref(pd);
  	ah->pd = pd;
  
 -	rxe_init_av(rxe, attr, &ah->av);
 +	err = rxe_init_av(rxe, attr, &ah->av);
 +	if (err)
 +		goto err2;
 +
  	return &ah->ibah;
++<<<<<<< HEAD
 +
 +err2:
 +	rxe_drop_ref(pd);
 +	rxe_drop_ref(ah);
 +err1:
 +	return ERR_PTR(err);
++=======
++>>>>>>> 2f229bcf25ca (RDMA/rxe: Simplify the error handling code in rxe_create_ah())
  }
  
  static int rxe_modify_ah(struct ib_ah *ibah, struct rdma_ah_attr *attr)
* Unmerged path drivers/infiniband/sw/rxe/rxe_verbs.c
