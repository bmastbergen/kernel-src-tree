bnxt_en: Modify bnxt_ring_alloc_send_msg() to support 57500 chips.

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
Rebuild_CHGLOG: - [netdrv] bnxt_en: Modify bnxt_ring_alloc_send_msg() to support 57500 chips (Jonathan Toppins) [1623230 1643317]
Rebuild_FUZZ: 99.24%
commit-author Michael Chan <michael.chan@broadcom.com>
commit 23aefdd761599e42d7f1f6504ff38c558e18de2a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/23aefdd7.failed

Firmware ring allocation semantics are slightly different for most
ring types on 57500 chips.  Allocation/deallocation for NQ rings are
also added for the new chips.

A CP ring handle is also added so that from the NQ interrupt event,
we can locate the CP ring.

	Signed-off-by: Michael Chan <michael.chan@broadcom.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 23aefdd761599e42d7f1f6504ff38c558e18de2a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/broadcom/bnxt/bnxt.c
diff --cc drivers/net/ethernet/broadcom/bnxt/bnxt.c
index 32307681362b,db1dbad487c0..000000000000
--- a/drivers/net/ethernet/broadcom/bnxt/bnxt.c
+++ b/drivers/net/ethernet/broadcom/bnxt/bnxt.c
@@@ -4566,7 -4641,53 +4605,14 @@@ static int bnxt_hwrm_set_async_event_cr
  static int bnxt_hwrm_ring_alloc(struct bnxt *bp)
  {
  	int i, rc = 0;
 -	u32 type;
  
++<<<<<<< HEAD
++=======
+ 	if (bp->flags & BNXT_FLAG_CHIP_P5)
+ 		type = HWRM_RING_ALLOC_NQ;
+ 	else
+ 		type = HWRM_RING_ALLOC_CMPL;
++>>>>>>> 23aefdd76159 (bnxt_en: Modify bnxt_ring_alloc_send_msg() to support 57500 chips.)
  	for (i = 0; i < bp->cp_nr_rings; i++) {
  		struct bnxt_napi *bnapi = bp->bnapi[i];
  		struct bnxt_cp_ring_info *cpr = &bnapi->cp_ring;
* Unmerged path drivers/net/ethernet/broadcom/bnxt/bnxt.c
diff --git a/drivers/net/ethernet/broadcom/bnxt/bnxt.h b/drivers/net/ethernet/broadcom/bnxt/bnxt.h
index e42bf57bdbc9..395c635512fd 100644
--- a/drivers/net/ethernet/broadcom/bnxt/bnxt.h
+++ b/drivers/net/ethernet/broadcom/bnxt/bnxt.h
@@ -634,6 +634,7 @@ struct bnxt_ring_struct {
 		u16		grp_idx;
 		u16		map_idx; /* Used by cmpl rings */
 	};
+	u32			handle;
 	u8			queue_id;
 };
 
