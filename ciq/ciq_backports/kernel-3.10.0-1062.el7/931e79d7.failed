xfrm_user: fix info leak in build_aevent()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Mathias Krause <minipli@googlemail.com>
commit 931e79d7a7ddee4709c56b39de169a36804589a1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/931e79d7.failed

The memory reserved to dump the ID of the xfrm state includes a padding
byte in struct xfrm_usersa_id added by the compiler for alignment. To
prevent the heap info leak, memset(0) the sa_id before filling it.

	Cc: Jamal Hadi Salim <jhs@mojatatu.com>
Fixes: d51d081d6504 ("[IPSEC]: Sync series - user")
	Signed-off-by: Mathias Krause <minipli@googlemail.com>
	Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>
(cherry picked from commit 931e79d7a7ddee4709c56b39de169a36804589a1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/xfrm/xfrm_user.c
diff --cc net/xfrm/xfrm_user.c
index 3aa299d232db,9391ced05259..000000000000
--- a/net/xfrm/xfrm_user.c
+++ b/net/xfrm/xfrm_user.c
@@@ -1812,7 -1869,8 +1812,12 @@@ static int build_aevent(struct sk_buff 
  		return -EMSGSIZE;
  
  	id = nlmsg_data(nlh);
++<<<<<<< HEAD
 +	memcpy(&id->sa_id.daddr, &x->id.daddr,sizeof(x->id.daddr));
++=======
+ 	memset(&id->sa_id, 0, sizeof(id->sa_id));
+ 	memcpy(&id->sa_id.daddr, &x->id.daddr, sizeof(x->id.daddr));
++>>>>>>> 931e79d7a7dd (xfrm_user: fix info leak in build_aevent())
  	id->sa_id.spi = x->id.spi;
  	id->sa_id.family = x->props.family;
  	id->sa_id.proto = x->id.proto;
* Unmerged path net/xfrm/xfrm_user.c
