gfs2: Put bitmap buffers in put_super

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Andreas Gruenbacher <agruenba@redhat.com>
commit 10283ea525d30f2e99828978fd04d8427876a7ad
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/10283ea5.failed

gfs2_put_super calls gfs2_clear_rgrpd to destroy the gfs2_rgrpd objects
attached to the resource group glocks.  That function should release the
buffers attached to the gfs2_bitmap objects (bi_bh), but the call to
gfs2_rgrp_brelse for doing that is missing.

When gfs2_releasepage later runs across these buffers which are still
referenced, it refuses to free them.  This causes the pages the buffers
are attached to to remain referenced as well.  With enough mount/unmount
cycles, the system will eventually run out of memory.

Fix this by adding the missing call to gfs2_rgrp_brelse in
gfs2_clear_rgrpd.

(Also fix a gfs2_rgrp_relse -> gfs2_rgrp_brelse typo in a comment.)

Fixes: 39b0f1e92908 ("GFS2: Don't brelse rgrp buffer_heads every allocation")
	Cc: stable@vger.kernel.org # v4.2+
	Signed-off-by: Andreas Gruenbacher <agruenba@redhat.com>
(cherry picked from commit 10283ea525d30f2e99828978fd04d8427876a7ad)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/gfs2/rgrp.c
diff --cc fs/gfs2/rgrp.c
index 5268830a971b,b08a530433ad..000000000000
--- a/fs/gfs2/rgrp.c
+++ b/fs/gfs2/rgrp.c
@@@ -679,7 -733,7 +679,11 @@@ void gfs2_clear_rgrpd(struct gfs2_sbd *
  
  		if (gl) {
  			glock_clear_object(gl, rgd);
++<<<<<<< HEAD
 +			gfs2_glock_add_to_lru(gl);
++=======
+ 			gfs2_rgrp_brelse(rgd);
++>>>>>>> 10283ea525d3 (gfs2: Put bitmap buffers in put_super)
  			gfs2_glock_put(gl);
  		}
  
* Unmerged path fs/gfs2/rgrp.c
