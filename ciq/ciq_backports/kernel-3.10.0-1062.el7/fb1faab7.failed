qed: Consider TX tcs while deriving the max num_queues for PF.

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
Rebuild_CHGLOG: - [netdrv] qed: Consider TX tcs while deriving the max num_queues for PF (Manish Chopra) [1682918]
Rebuild_FUZZ: 99.19%
commit-author Sudarsana Reddy Kalluru <skalluru@marvell.com>
commit fb1faab74ddef9ec2d841d54e5d0912a097b3abe
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/fb1faab7.failed

Max supported queues is derived incorrectly in the case of multi-CoS.
Need to consider TCs while calculating num_queues for PF.

	Signed-off-by: Sudarsana Reddy Kalluru <skalluru@marvell.com>
	Signed-off-by: Ariel Elior <aelior@marvell.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit fb1faab74ddef9ec2d841d54e5d0912a097b3abe)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/qlogic/qed/qed_l2.c
diff --cc drivers/net/ethernet/qlogic/qed/qed_l2.c
index fb765690e275,64ac95ca4df2..000000000000
--- a/drivers/net/ethernet/qlogic/qed/qed_l2.c
+++ b/drivers/net/ethernet/qlogic/qed/qed_l2.c
@@@ -2215,7 -2216,7 +2215,11 @@@ static int qed_fill_eth_dev_info(struc
  			u16 num_queues = 0;
  
  			/* Since the feature controls only queue-zones,
++<<<<<<< HEAD
 +			 * make sure we have the contexts [rx, tx] to
++=======
+ 			 * make sure we have the contexts [rx, xdp, tcs] to
++>>>>>>> fb1faab74dde (qed: Consider TX tcs while deriving the max num_queues for PF.)
  			 * match.
  			 */
  			for_each_hwfn(cdev, i) {
@@@ -2225,7 -2226,8 +2229,12 @@@
  				u16 cids;
  
  				cids = hwfn->pf_params.eth_pf_params.num_cons;
++<<<<<<< HEAD
 +				num_queues += min_t(u16, l2_queues, cids / 2);
++=======
+ 				cids /= (2 + info->num_tc);
+ 				num_queues += min_t(u16, l2_queues, cids);
++>>>>>>> fb1faab74dde (qed: Consider TX tcs while deriving the max num_queues for PF.)
  			}
  
  			/* queues might theoretically be >256, but interrupts'
* Unmerged path drivers/net/ethernet/qlogic/qed/qed_l2.c
