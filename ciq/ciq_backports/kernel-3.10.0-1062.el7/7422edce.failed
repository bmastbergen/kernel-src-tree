IB/mlx5: Allow XRC INI usage via verbs in DEVX context

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Yishai Hadas <yishaih@mellanox.com>
commit 7422edce73559d2985f322145c865cea2da3c152
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/7422edce.failed

From device point of view both XRC target and initiator are XRC transport
type.

Fix to use the expected UID as was handled for the XRC target case to
allow its usage via verbs in DEVX context.

Fixes: 5aa3771ded54 ("IB/mlx5: Allow XRC usage via verbs in DEVX context")
	Signed-off-by: Yishai Hadas <yishaih@mellanox.com>
	Reviewed-by: Artemy Kovalyov <artemyko@mellanox.com>
	Signed-off-by: Leon Romanovsky <leonro@mellanox.com>
	Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
(cherry picked from commit 7422edce73559d2985f322145c865cea2da3c152)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/mlx5/qp.c
diff --cc drivers/infiniband/hw/mlx5/qp.c
index 0e92d3e28641,dd2ae640bc84..000000000000
--- a/drivers/infiniband/hw/mlx5/qp.c
+++ b/drivers/infiniband/hw/mlx5/qp.c
@@@ -846,7 -837,9 +846,13 @@@ static int create_user_qp(struct mlx5_i
  		goto err_umem;
  	}
  
++<<<<<<< HEAD
 +	MLX5_SET(create_qp_in, *in, uid, to_mpd(pd)->uid);
++=======
+ 	uid = (attr->qp_type != IB_QPT_XRC_TGT &&
+ 	       attr->qp_type != IB_QPT_XRC_INI) ? to_mpd(pd)->uid : 0;
+ 	MLX5_SET(create_qp_in, *in, uid, uid);
++>>>>>>> 7422edce7355 (IB/mlx5: Allow XRC INI usage via verbs in DEVX context)
  	pas = (__be64 *)MLX5_ADDR_OF(create_qp_in, *in, pas);
  	if (ubuffer->umem)
  		mlx5_ib_populate_pas(dev, ubuffer->umem, page_shift, pas, 0);
* Unmerged path drivers/infiniband/hw/mlx5/qp.c
