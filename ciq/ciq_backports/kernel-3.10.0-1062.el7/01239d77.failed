xfs: fix a null pointer dereference in xfs_bmap_extents_to_btree

jira LE-1907
cve CVE-2018-13095
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Shan Hai <shan.hai@oracle.com>
commit 01239d77b9dd978863d1a75f0d095ab942a1fe66
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/01239d77.failed

Fuzzing tool reports a write to null pointer error in the
xfs_bmap_extents_to_btree, fix it by bailing out on encountering
a null pointer.

	Signed-off-by: Shan Hai <shan.hai@oracle.com>
	Reviewed-by: Darrick J. Wong <darrick.wong@oracle.com>
	Signed-off-by: Darrick J. Wong <darrick.wong@oracle.com>
(cherry picked from commit 01239d77b9dd978863d1a75f0d095ab942a1fe66)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/xfs/libxfs/xfs_bmap.c
diff --cc fs/xfs/libxfs/xfs_bmap.c
index a821827ec13e,2760314fdf7f..000000000000
--- a/fs/xfs/libxfs/xfs_bmap.c
+++ b/fs/xfs/libxfs/xfs_bmap.c
@@@ -742,10 -712,15 +742,22 @@@ xfs_bmap_extents_to_btree
  	args.wasdel = wasdel;
  	*logflagsp = 0;
  	if ((error = xfs_alloc_vextent(&args))) {
++<<<<<<< HEAD
 +		xfs_iroot_realloc(ip, -1, whichfork);
 +		xfs_btree_del_cursor(cur, XFS_BTREE_ERROR);
 +		return error;
 +	}
++=======
+ 		ASSERT(ifp->if_broot == NULL);
+ 		goto err1;
+ 	}
+ 
+ 	if (WARN_ON_ONCE(args.fsbno == NULLFSBLOCK)) {
+ 		ASSERT(ifp->if_broot == NULL);
+ 		error = -ENOSPC;
+ 		goto err1;
+ 	}
++>>>>>>> 01239d77b9dd (xfs: fix a null pointer dereference in xfs_bmap_extents_to_btree)
  	/*
  	 * Allocation can't fail, the space was reserved.
  	 */
* Unmerged path fs/xfs/libxfs/xfs_bmap.c
