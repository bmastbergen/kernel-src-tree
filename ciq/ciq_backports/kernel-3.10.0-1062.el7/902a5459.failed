net/mlx5e: When RXFCS is set, add FCS data into checksum calculation

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
Rebuild_CHGLOG: - [netdrv] mlx5e: When RXFCS is set, add FCS data into checksum calculation (Alaa Hleihel) [1642498]
Rebuild_FUZZ: 96.97%
commit-author Eran Ben Elisha <eranbe@mellanox.com>
commit 902a545904c71d719ed144234d67df75f31db63b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/902a5459.failed

When RXFCS feature is enabled, the HW do not strip the FCS data,
however it is not present in the checksum calculated by the HW.

Fix that by manually calculating the FCS checksum and adding it to the SKB
checksum field.

Add helper function to find the FCS data for all SKB forms (linear,
one fragment or more).

Fixes: 102722fc6832 ("net/mlx5e: Add support for RXFCS feature flag")
	Signed-off-by: Eran Ben Elisha <eranbe@mellanox.com>
	Signed-off-by: Saeed Mahameed <saeedm@mellanox.com>
(cherry picked from commit 902a545904c71d719ed144234d67df75f31db63b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/en_rx.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/en_rx.c
index 95481ee556bb,1ff0b0e93804..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/en_rx.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/en_rx.c
@@@ -666,7 -682,10 +705,14 @@@ static inline void mlx5e_handle_csum(st
  			skb->csum = csum_partial(skb->data + ETH_HLEN,
  						 network_depth - ETH_HLEN,
  						 skb->csum);
++<<<<<<< HEAD
 +		stats->csum_complete++;
++=======
+ 		if (unlikely(netdev->features & NETIF_F_RXFCS))
+ 			skb->csum = csum_add(skb->csum,
+ 					     (__force __wsum)mlx5e_get_fcs(skb));
+ 		rq->stats.csum_complete++;
++>>>>>>> 902a545904c7 (net/mlx5e: When RXFCS is set, add FCS data into checksum calculation)
  		return;
  	}
  
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en_rx.c
