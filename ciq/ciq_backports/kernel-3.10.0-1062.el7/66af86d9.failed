crypto: chelsio - check set_msg_len overflow in generate_b0

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
Rebuild_CHGLOG: - [crypto] chelsio - check set_msg_len overflow in generate_b0 (Arjun Vynipadath) [1642432]
Rebuild_FUZZ: 92.73%
commit-author YueHaibing <yuehaibing@huawei.com>
commit 66af86d93ce32ff5b262ace9a6696873cc1bdb3e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/66af86d9.failed

set_msg_len may fails with -EOVERFLOW, It should be propagate
to upstream.

Fixes: 2debd3325e55 ("crypto: chcr - Add AEAD algos.")
	Signed-off-by: YueHaibing <yuehaibing@huawei.com>
	Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
(cherry picked from commit 66af86d93ce32ff5b262ace9a6696873cc1bdb3e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/crypto/chelsio/chcr_algo.c
diff --cc drivers/crypto/chelsio/chcr_algo.c
index 8a76dcf1a215,bdbdce9fdf25..000000000000
--- a/drivers/crypto/chelsio/chcr_algo.c
+++ b/drivers/crypto/chelsio/chcr_algo.c
@@@ -2698,8 -2762,7 +2698,12 @@@ static int set_msg_len(u8 *block, unsig
  	return 0;
  }
  
++<<<<<<< HEAD
 +static void generate_b0(struct aead_request *req,
 +			struct chcr_aead_ctx *aeadctx,
++=======
+ static int generate_b0(struct aead_request *req, u8 *ivptr,
++>>>>>>> 66af86d93ce3 (crypto: chelsio - check set_msg_len overflow in generate_b0)
  			unsigned short op_type)
  {
  	unsigned int l, lp, m;
@@@ -2756,9 -2823,9 +2762,13 @@@ static int ccm_format_packet(struct aea
  		*((unsigned short *)(reqctx->scratch_pad + 16)) =
  				htons(assoclen);
  
++<<<<<<< HEAD
 +	generate_b0(req, aeadctx, op_type);
++=======
+ 	rc = generate_b0(req, ivptr, op_type);
++>>>>>>> 66af86d93ce3 (crypto: chelsio - check set_msg_len overflow in generate_b0)
  	/* zero the ctr value */
 -	memset(ivptr + 15 - ivptr[0], 0, ivptr[0] + 1);
 +	memset(reqctx->iv + 15 - reqctx->iv[0], 0, reqctx->iv[0] + 1);
  	return rc;
  }
  
* Unmerged path drivers/crypto/chelsio/chcr_algo.c
