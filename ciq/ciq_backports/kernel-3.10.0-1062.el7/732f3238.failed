scsi: csiostor: fix calls to dma_set_mask_and_coherent()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
Rebuild_CHGLOG: - [scsi] csiostor: fix calls to dma_set_mask_and_coherent() (Arjun Vynipadath) [1696189]
Rebuild_FUZZ: 94.34%
commit-author Hannes Reinecke <hare@suse.de>
commit 732f3238dcf27acb92959a99b7923dc49395980e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/732f3238.failed

The change to use dma_set_mask_and_coherent() incorrectly made a second
call with the 32 bit DMA mask value when the call with the 64 bit DMA mask
value succeeded.

Fixes: c22b332d811b ("scsi: csiostor: switch to generic DMA API")
	Cc: <stable@vger.kernel.org>
	Signed-off-by: Hannes Reinecke <hare@suse.com>
	Reviewed-by: Christoph Hellwig <hch@lst.de>
	Reviewed-by: Ewan D. Milne <emilne@redhat.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit 732f3238dcf27acb92959a99b7923dc49395980e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/csiostor/csio_init.c
diff --cc drivers/scsi/csiostor/csio_init.c
index 2df52905c9ec,616b25bf7941..000000000000
--- a/drivers/scsi/csiostor/csio_init.c
+++ b/drivers/scsi/csiostor/csio_init.c
@@@ -209,11 -210,11 +209,19 @@@ csio_pci_init(struct pci_dev *pdev, in
  	pci_set_master(pdev);
  	pci_try_set_mwi(pdev);
  
++<<<<<<< HEAD
 +	if (!pci_set_dma_mask(pdev, DMA_BIT_MASK(64))) {
 +		pci_set_consistent_dma_mask(pdev, DMA_BIT_MASK(64));
 +	} else if (!pci_set_dma_mask(pdev, DMA_BIT_MASK(32))) {
 +		pci_set_consistent_dma_mask(pdev, DMA_BIT_MASK(32));
 +	} else {
++=======
+ 	rv = dma_set_mask_and_coherent(&pdev->dev, DMA_BIT_MASK(64));
+ 	if (rv)
+ 		rv = dma_set_mask_and_coherent(&pdev->dev, DMA_BIT_MASK(32));
+ 	if (rv) {
+ 		rv = -ENODEV;
++>>>>>>> 732f3238dcf2 (scsi: csiostor: fix calls to dma_set_mask_and_coherent())
  		dev_err(&pdev->dev, "No suitable DMA available.\n");
  		goto err_release_regions;
  	}
* Unmerged path drivers/scsi/csiostor/csio_init.c
