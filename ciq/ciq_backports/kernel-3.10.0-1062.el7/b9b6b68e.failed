xsk: add Rx queue setup and mmap support

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Björn Töpel <bjorn.topel@intel.com>
commit b9b6b68e8abd101be6eb5330e4999218c696d1e8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/b9b6b68e.failed

Another setsockopt (XDP_RX_QUEUE) is added to let the process allocate
a queue, where the kernel can pass completed Rx frames from the kernel
to user process.

The mmapping of the queue is done using the XDP_PGOFF_RX_QUEUE offset.

	Signed-off-by: Björn Töpel <bjorn.topel@intel.com>
	Signed-off-by: Alexei Starovoitov <ast@kernel.org>
(cherry picked from commit b9b6b68e8abd101be6eb5330e4999218c696d1e8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/linux/tegra-ahb.h
#	include/uapi/linux/if_xdp.h
#	net/xdp/xsk.c
#	net/xdp/xsk_queue.c
#	net/xdp/xsk_queue.h
diff --cc include/linux/tegra-ahb.h
index f1cd075ceee1,db9a321de087..000000000000
--- a/include/linux/tegra-ahb.h
+++ b/include/linux/tegra-ahb.h
@@@ -11,9 -12,24 +11,27 @@@
   * more details.
   */
  
 -#ifndef _LINUX_XDP_SOCK_H
 -#define _LINUX_XDP_SOCK_H
 +#ifndef __LINUX_AHB_H__
 +#define __LINUX_AHB_H__
  
 -#include <linux/mutex.h>
 -#include <net/sock.h>
 +extern int tegra_ahb_enable_smmu(struct device_node *ahb);
  
++<<<<<<< HEAD:include/linux/tegra-ahb.h
 +#endif	/* __LINUX_AHB_H__ */
++=======
+ struct net_device;
+ struct xsk_queue;
+ struct xdp_umem;
+ 
+ struct xdp_sock {
+ 	/* struct sock must be the first member of struct xdp_sock */
+ 	struct sock sk;
+ 	struct xsk_queue *rx;
+ 	struct net_device *dev;
+ 	struct xdp_umem *umem;
+ 	/* Protects multiple processes in the control path */
+ 	struct mutex mutex;
+ };
+ 
+ #endif /* _LINUX_XDP_SOCK_H */
++>>>>>>> b9b6b68e8abd (xsk: add Rx queue setup and mmap support):include/net/xdp_sock.h
* Unmerged path include/uapi/linux/if_xdp.h
* Unmerged path net/xdp/xsk.c
* Unmerged path net/xdp/xsk_queue.c
* Unmerged path net/xdp/xsk_queue.h
* Unmerged path include/linux/tegra-ahb.h
* Unmerged path include/uapi/linux/if_xdp.h
* Unmerged path net/xdp/xsk.c
* Unmerged path net/xdp/xsk_queue.c
* Unmerged path net/xdp/xsk_queue.h
