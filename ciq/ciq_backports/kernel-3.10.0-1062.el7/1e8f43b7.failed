IB/core: Add CapabilityMask2 to port attributes

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Michael Guralnik <michaelgur@mellanox.com>
commit 1e8f43b7fb25aa7a85db1e81b4689dd394e23b35
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/1e8f43b7.failed

CapabilityMask2 was added in IB Spec 1.3 under PortInfo attribute.  The
new Capapbility mask is needed in order to expose the new 2X width and HDR
speed.

	Signed-off-by: Michael Guralnik <michaelgur@mellanox.com>
	Reviewed-by: Majd Dibbiny <majd@mellanox.com>
	Signed-off-by: Leon Romanovsky <leonro@mellanox.com>
	Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
(cherry picked from commit 1e8f43b7fb25aa7a85db1e81b4689dd394e23b35)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/rdma/ib_mad.h
#	include/rdma/ib_verbs.h
diff --cc include/rdma/ib_mad.h
index 2f4f1768ded4,fdef558e3a2d..000000000000
--- a/include/rdma/ib_mad.h
+++ b/include/rdma/ib_mad.h
@@@ -262,6 -262,49 +262,52 @@@ struct ib_class_port_info 
  	__be32			trap_qkey;
  };
  
++<<<<<<< HEAD
++=======
+ /* PortInfo CapabilityMask */
+ enum ib_port_capability_mask_bits {
+ 	IB_PORT_SM = 1 << 1,
+ 	IB_PORT_NOTICE_SUP = 1 << 2,
+ 	IB_PORT_TRAP_SUP = 1 << 3,
+ 	IB_PORT_OPT_IPD_SUP = 1 << 4,
+ 	IB_PORT_AUTO_MIGR_SUP = 1 << 5,
+ 	IB_PORT_SL_MAP_SUP = 1 << 6,
+ 	IB_PORT_MKEY_NVRAM = 1 << 7,
+ 	IB_PORT_PKEY_NVRAM = 1 << 8,
+ 	IB_PORT_LED_INFO_SUP = 1 << 9,
+ 	IB_PORT_SM_DISABLED = 1 << 10,
+ 	IB_PORT_SYS_IMAGE_GUID_SUP = 1 << 11,
+ 	IB_PORT_PKEY_SW_EXT_PORT_TRAP_SUP = 1 << 12,
+ 	IB_PORT_EXTENDED_SPEEDS_SUP = 1 << 14,
+ 	IB_PORT_CAP_MASK2_SUP = 1 << 15,
+ 	IB_PORT_CM_SUP = 1 << 16,
+ 	IB_PORT_SNMP_TUNNEL_SUP = 1 << 17,
+ 	IB_PORT_REINIT_SUP = 1 << 18,
+ 	IB_PORT_DEVICE_MGMT_SUP = 1 << 19,
+ 	IB_PORT_VENDOR_CLASS_SUP = 1 << 20,
+ 	IB_PORT_DR_NOTICE_SUP = 1 << 21,
+ 	IB_PORT_CAP_MASK_NOTICE_SUP = 1 << 22,
+ 	IB_PORT_BOOT_MGMT_SUP = 1 << 23,
+ 	IB_PORT_LINK_LATENCY_SUP = 1 << 24,
+ 	IB_PORT_CLIENT_REG_SUP = 1 << 25,
+ 	IB_PORT_OTHER_LOCAL_CHANGES_SUP = 1 << 26,
+ 	IB_PORT_LINK_SPEED_WIDTH_TABLE_SUP = 1 << 27,
+ 	IB_PORT_VENDOR_SPECIFIC_MADS_TABLE_SUP = 1 << 28,
+ 	IB_PORT_MCAST_PKEY_TRAP_SUPPRESSION_SUP = 1 << 29,
+ 	IB_PORT_MCAST_FDB_TOP_SUP = 1 << 30,
+ 	IB_PORT_HIERARCHY_INFO_SUP = 1ULL << 31,
+ };
+ 
+ enum ib_port_capability_mask2_bits {
+ 	IB_PORT_SET_NODE_DESC_SUP		= 1 << 0,
+ 	IB_PORT_EX_PORT_INFO_EX_SUP		= 1 << 1,
+ 	IB_PORT_VIRT_SUP			= 1 << 2,
+ 	IB_PORT_SWITCH_PORT_STATE_TABLE_SUP	= 1 << 3,
+ 	IB_PORT_LINK_WIDTH_2X_SUP		= 1 << 4,
+ 	IB_PORT_LINK_SPEED_HDR_SUP		= 1 << 5,
+ };
+ 
++>>>>>>> 1e8f43b7fb25 (IB/core: Add CapabilityMask2 to port attributes)
  #define OPA_CLASS_PORT_INFO_PR_SUPPORT BIT(26)
  
  struct opa_class_port_info {
diff --cc include/rdma/ib_verbs.h
index b950ea239071,b03e24852186..000000000000
--- a/include/rdma/ib_verbs.h
+++ b/include/rdma/ib_verbs.h
@@@ -595,7 -592,7 +595,11 @@@ struct ib_port_attr 
  	u8			active_width;
  	u8			active_speed;
  	u8                      phys_state;
++<<<<<<< HEAD
 +	bool			grh_required;
++=======
+ 	u16			port_cap_flags2;
++>>>>>>> 1e8f43b7fb25 (IB/core: Add CapabilityMask2 to port attributes)
  };
  
  enum ib_device_modify_flags {
* Unmerged path include/rdma/ib_mad.h
* Unmerged path include/rdma/ib_verbs.h
