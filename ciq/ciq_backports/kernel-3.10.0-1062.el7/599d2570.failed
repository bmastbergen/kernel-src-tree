net/sched: cls_flower: Remove old entries from rhashtable

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
Rebuild_CHGLOG: - [net] sched: cls_flower: Remove old entries from rhashtable (Ivan Vecera) [1666481]
Rebuild_FUZZ: 96.36%
commit-author Roi Dayan <roid@mellanox.com>
commit 599d2570b2da7c2f5419332b42b7999d79c85959
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/599d2570.failed

When replacing a rule we add the new rule to the rhashtable
but only remove the old if not in skip_sw.
This commit fix this and remove the old rule anyway.

Fixes: 35cc3cefc4de ("net/sched: cls_flower: Reject duplicated rules also under skip_sw")
	Signed-off-by: Roi Dayan <roid@mellanox.com>
	Reviewed-by: Vlad Buslov <vladbu@mellanox.com>
	Acked-by: Or Gerlitz <ogerlitz@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 599d2570b2da7c2f5419332b42b7999d79c85959)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sched/cls_flower.c
diff --cc net/sched/cls_flower.c
index eb4e6a91f3e1,208d940464d7..000000000000
--- a/net/sched/cls_flower.c
+++ b/net/sched/cls_flower.c
@@@ -1009,11 -1258,11 +1009,17 @@@ static int fl_change(struct net *net, s
  		fnew->flags |= TCA_CLS_FLAGS_NOT_IN_HW;
  
  	if (fold) {
++<<<<<<< HEAD
 +		if (!tc_skip_sw(fold->flags))
 +			rhashtable_remove_fast(&head->ht, &fold->ht_node,
 +					       head->ht_params);
++=======
+ 		rhashtable_remove_fast(&fold->mask->ht,
+ 				       &fold->ht_node,
+ 				       fold->mask->filter_ht_params);
++>>>>>>> 599d2570b2da (net/sched: cls_flower: Remove old entries from rhashtable)
  		if (!tc_skip_hw(fold->flags))
 -			fl_hw_destroy_filter(tp, fold, NULL);
 +			fl_hw_destroy_filter(tp, fold);
  	}
  
  	*arg = fnew;
* Unmerged path net/sched/cls_flower.c
