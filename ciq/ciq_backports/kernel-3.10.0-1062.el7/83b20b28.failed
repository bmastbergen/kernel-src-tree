KVM: x86: don't reset root in kvm_mmu_setup()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Wei Yang <richard.weiyang@gmail.com>
commit 83b20b28c670868bfb717be4fe1557c925a81657
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/83b20b28.failed

Here is the code path which shows kvm_mmu_setup() is invoked after
kvm_mmu_create(). Since kvm_mmu_setup() is only invoked in this code path,
this means the root_hpa and prev_roots are guaranteed to be invalid. And
it is not necessary to reset it again.

    kvm_vm_ioctl_create_vcpu()
        kvm_arch_vcpu_create()
            vmx_create_vcpu()
                kvm_vcpu_init()
                    kvm_arch_vcpu_init()
                        kvm_mmu_create()
        kvm_arch_vcpu_setup()
            kvm_mmu_setup()
                kvm_init_mmu()

This patch set reset_roots to false in kmv_mmu_setup().

Fixes: 50c28f21d045dde8c52548f8482d456b3f0956f5
	Signed-off-by: Wei Yang <richard.weiyang@gmail.com>
	Reviewed-by: Liran Alon <liran.alon@oracle.com>
	Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
(cherry picked from commit 83b20b28c670868bfb717be4fe1557c925a81657)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kvm/mmu.c
diff --cc arch/x86/kvm/mmu.c
index 6785086be3f5,5402c53a079b..000000000000
--- a/arch/x86/kvm/mmu.c
+++ b/arch/x86/kvm/mmu.c
@@@ -4992,7 -5417,12 +4992,16 @@@ void kvm_mmu_setup(struct kvm_vcpu *vcp
  {
  	MMU_WARN_ON(VALID_PAGE(vcpu->arch.mmu.root_hpa));
  
++<<<<<<< HEAD
 +	init_kvm_mmu(vcpu);
++=======
+ 	/*
+ 	 * kvm_mmu_setup() is called only on vCPU initialization.  
+ 	 * Therefore, no need to reset mmu roots as they are not yet
+ 	 * initialized.
+ 	 */
+ 	kvm_init_mmu(vcpu, false);
++>>>>>>> 83b20b28c670 (KVM: x86: don't reset root in kvm_mmu_setup())
  }
  
  static void kvm_mmu_invalidate_zap_pages_in_memslot(struct kvm *kvm,
* Unmerged path arch/x86/kvm/mmu.c
