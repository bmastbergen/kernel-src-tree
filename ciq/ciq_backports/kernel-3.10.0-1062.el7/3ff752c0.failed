r8169: remove rtl_get_events

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Heiner Kallweit <hkallweit1@gmail.com>
commit 3ff752c00288db8f214037ca6280c635d850bab4
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/3ff752c0.failed

This helper is used only once, so remove it.

	Signed-off-by: Heiner Kallweit <hkallweit1@gmail.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 3ff752c00288db8f214037ca6280c635d850bab4)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/realtek/r8169.c
diff --cc drivers/net/ethernet/realtek/r8169.c
index 26ca28b81d85,b2e30e3025b6..000000000000
--- a/drivers/net/ethernet/realtek/r8169.c
+++ b/drivers/net/ethernet/realtek/r8169.c
@@@ -6696,47 -6404,35 +6691,52 @@@ release_descriptor
  static irqreturn_t rtl8169_interrupt(int irq, void *dev_instance)
  {
  	struct rtl8169_private *tp = dev_instance;
++<<<<<<< HEAD
 +	u16 status = rtl_get_events(tp);
++=======
+ 	u16 status = RTL_R16(tp, IntrStatus);
+ 	u16 irq_mask = RTL_R16(tp, IntrMask);
++>>>>>>> 3ff752c00288 (r8169: remove rtl_get_events)
  
 -	if (status == 0xffff || !(status & irq_mask))
 +	if (status == 0xffff || !(status & (RTL_EVENT_NAPI | tp->event_slow)))
  		return IRQ_NONE;
  
 -	if (unlikely(status & SYSErr)) {
 -		rtl8169_pcierr_interrupt(tp->dev);
 -		goto out;
 -	}
 +	rtl_irq_disable(tp);
 +	napi_schedule_irqoff(&tp->napi);
  
 -	if (status & LinkChg && tp->dev->phydev)
 -		phy_mac_interrupt(tp->dev->phydev);
 +	return IRQ_HANDLED;
 +}
  
 -	if (unlikely(status & RxFIFOOver &&
 -	    tp->mac_version == RTL_GIGA_MAC_VER_11)) {
 -		netif_stop_queue(tp->dev);
 -		/* XXX - Hack alert. See rtl_task(). */
 -		set_bit(RTL_FLAG_TASK_RESET_PENDING, tp->wk.flags);
 -	}
 +/*
 + * Workqueue context.
 + */
 +static void rtl_slow_event_work(struct rtl8169_private *tp)
 +{
 +	struct net_device *dev = tp->dev;
 +	u16 status;
  
 -	if (status & RTL_EVENT_NAPI) {
 -		rtl_irq_disable(tp);
 -		napi_schedule_irqoff(&tp->napi);
 -	}
 -out:
 +	status = rtl_get_events(tp) & tp->event_slow;
  	rtl_ack_events(tp, status);
  
 -	return IRQ_HANDLED;
 +	if (unlikely(status & RxFIFOOver)) {
 +		switch (tp->mac_version) {
 +		/* Work around for rx fifo overflow */
 +		case RTL_GIGA_MAC_VER_11:
 +			netif_stop_queue(dev);
 +			/* XXX - Hack alert. See rtl_task(). */
 +			set_bit(RTL_FLAG_TASK_RESET_PENDING, tp->wk.flags);
 +		default:
 +			break;
 +		}
 +	}
 +
 +	if (unlikely(status & SYSErr))
 +		rtl8169_pcierr_interrupt(dev);
 +
 +	if (status & LinkChg)
 +		rtl8169_check_link_status(dev, tp);
 +
 +	rtl_irq_enable_all(tp);
  }
  
  static void rtl_task(struct work_struct *work)
* Unmerged path drivers/net/ethernet/realtek/r8169.c
