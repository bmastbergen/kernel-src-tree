nfp: implement netpoll ndo (thus enabling netconsole)

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Jakub Kicinski <jakub.kicinski@netronome.com>
commit 670b5274ff976a7eed57fd303460a8a9de267c0e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/670b5274.failed

NFP NAPI handling will only complete the TXed packets when called
with budget of 0, implement ndo_poll_controller by scheduling NAPI
on all TX queues.

	Signed-off-by: Jakub Kicinski <jakub.kicinski@netronome.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 670b5274ff976a7eed57fd303460a8a9de267c0e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/netronome/nfp/nfp_net_common.c
diff --cc drivers/net/ethernet/netronome/nfp/nfp_net_common.c
index 82bb77b3f6a2,edc6ef682f6d..000000000000
--- a/drivers/net/ethernet/netronome/nfp/nfp_net_common.c
+++ b/drivers/net/ethernet/netronome/nfp/nfp_net_common.c
@@@ -3478,9 -3497,11 +3493,15 @@@ const struct net_device_ops nfp_net_net
  	.ndo_get_stats64	= nfp_net_stat64,
  	.ndo_vlan_rx_add_vid	= nfp_net_vlan_rx_add_vid,
  	.ndo_vlan_rx_kill_vid	= nfp_net_vlan_rx_kill_vid,
++<<<<<<< HEAD
 +	.extended.ndo_setup_tc_rh		= nfp_port_setup_tc,
++=======
+ #ifdef CONFIG_NET_POLL_CONTROLLER
+ 	.ndo_poll_controller	= nfp_net_netpoll,
+ #endif
++>>>>>>> 670b5274ff97 (nfp: implement netpoll ndo (thus enabling netconsole))
  	.ndo_set_vf_mac         = nfp_app_set_vf_mac,
 -	.ndo_set_vf_vlan        = nfp_app_set_vf_vlan,
 +	.extended.ndo_set_vf_vlan        = nfp_app_set_vf_vlan,
  	.ndo_set_vf_spoofchk    = nfp_app_set_vf_spoofchk,
  	.ndo_get_vf_config	= nfp_app_get_vf_config,
  	.ndo_set_vf_link_state  = nfp_app_set_vf_link_state,
* Unmerged path drivers/net/ethernet/netronome/nfp/nfp_net_common.c
