net/mlx5e: Receive buffer configuration

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
Rebuild_CHGLOG: - [netdrv] mlx5e: Receive buffer configuration (Alaa Hleihel) [1642498]
Rebuild_FUZZ: 94.59%
commit-author Huy Nguyen <huyn@mellanox.com>
commit 0696d60853d58f1b9431bc689e4e4526845b790a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/0696d608.failed

Add APIs for buffer configuration based on the changes in
pfc configuration, cable len, buffer size configuration,
and priority to buffer mapping.

Note that the xoff fomula is as below
  xoff = ((301+2.16 * len [m]) * speed [Gbps] + 2.72 MTU [B]
  xoff_threshold = buffer_size - xoff
  xon_threshold = xoff_threshold - MTU

	Signed-off-by: Huy Nguyen <huyn@mellanox.com>
	Reviewed-by: Parav Pandit <parav@mellanox.com>
	Signed-off-by: Saeed Mahameed <saeedm@mellanox.com>
(cherry picked from commit 0696d60853d58f1b9431bc689e4e4526845b790a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/ipath/port_buffer.c
#	drivers/infiniband/hw/ipath/port_buffer.h
#	drivers/net/ethernet/mellanox/mlx5/core/en.h
diff --cc drivers/net/ethernet/mellanox/mlx5/core/en.h
index 13394c230883,9ab7158a7ce7..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/en.h
+++ b/drivers/net/ethernet/mellanox/mlx5/core/en.h
@@@ -59,7 -64,8 +59,12 @@@
  
  #define MLX5E_HW2SW_MTU(params, hwmtu) ((hwmtu) - ((params)->hard_mtu))
  #define MLX5E_SW2HW_MTU(params, swmtu) ((swmtu) + ((params)->hard_mtu))
++<<<<<<< HEAD
 + 
++=======
+ 
+ #define MLX5E_MAX_PRIORITY      8
++>>>>>>> 0696d60853d5 (net/mlx5e: Receive buffer configuration)
  #define MLX5E_MAX_DSCP          64
  #define MLX5E_MAX_NUM_TC	8
  
* Unmerged path drivers/infiniband/hw/ipath/port_buffer.c
* Unmerged path drivers/infiniband/hw/ipath/port_buffer.h
* Unmerged path drivers/infiniband/hw/ipath/port_buffer.c
* Unmerged path drivers/infiniband/hw/ipath/port_buffer.h
diff --git a/drivers/net/ethernet/mellanox/mlx5/core/Makefile b/drivers/net/ethernet/mellanox/mlx5/core/Makefile
index 24a5d4209b80..64ccc6539a50 100644
--- a/drivers/net/ethernet/mellanox/mlx5/core/Makefile
+++ b/drivers/net/ethernet/mellanox/mlx5/core/Makefile
@@ -20,7 +20,7 @@ mlx5_core-$(CONFIG_MLX5_MPFS) += lib/mpfs.o
 
 mlx5_core-$(CONFIG_MLX5_ESWITCH) += eswitch.o eswitch_offloads.o en_rep.o en_tc.o
 
-mlx5_core-$(CONFIG_MLX5_CORE_EN_DCB) +=  en_dcbnl.o
+mlx5_core-$(CONFIG_MLX5_CORE_EN_DCB) +=  en_dcbnl.o en/port_buffer.o
 
 mlx5_core-$(CONFIG_MLX5_CORE_IPOIB) += ipoib/ipoib.o ipoib/ethtool.o ipoib/ipoib_vlan.o
 
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en.h
