sctp: fix the issue that the cookie-ack with auth can't get processed

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Xin Long <lucien.xin@gmail.com>
commit ce402f044e4e432c296f90eaabb8dbe8f3624391
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/ce402f04.failed

When auth is enabled for cookie-ack chunk, in sctp_inq_pop, sctp
processes auth chunk first, then continues to the next chunk in
this packet if chunk_end + chunk_hdr size < skb_tail_pointer().
Otherwise, it will go to the next packet or discard this chunk.

However, it missed the fact that cookie-ack chunk's size is equal
to chunk_hdr size, which couldn't match that check, and thus this
chunk would not get processed.

This patch fixes it by changing the check to chunk_end + chunk_hdr
size <= skb_tail_pointer().

Fixes: 26b87c788100 ("net: sctp: fix remote memory pressure from excessive queueing")
	Signed-off-by: Xin Long <lucien.xin@gmail.com>
	Acked-by: Neil Horman <nhorman@tuxdriver.com>
	Acked-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit ce402f044e4e432c296f90eaabb8dbe8f3624391)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sctp/inqueue.c
diff --cc net/sctp/inqueue.c
index 9e8840a053ce,eb93ffe2408b..000000000000
--- a/net/sctp/inqueue.c
+++ b/net/sctp/inqueue.c
@@@ -220,11 -214,10 +220,15 @@@ new_skb
  
  	chunk->chunk_hdr = ch;
  	chunk->chunk_end = ((__u8 *)ch) + SCTP_PAD4(ntohs(ch->length));
 -	skb_pull(chunk->skb, sizeof(*ch));
 +	skb_pull(chunk->skb, sizeof(sctp_chunkhdr_t));
  	chunk->subh.v = NULL; /* Subheader is no longer valid.  */
  
++<<<<<<< HEAD
 +	if (chunk->chunk_end + sizeof(sctp_chunkhdr_t) <
 +	    skb_tail_pointer(chunk->skb)) {
++=======
+ 	if (chunk->chunk_end + sizeof(*ch) <= skb_tail_pointer(chunk->skb)) {
++>>>>>>> ce402f044e4e (sctp: fix the issue that the cookie-ack with auth can't get processed)
  		/* This is not a singleton */
  		chunk->singleton = 0;
  	} else if (chunk->chunk_end > skb_tail_pointer(chunk->skb)) {
* Unmerged path net/sctp/inqueue.c
