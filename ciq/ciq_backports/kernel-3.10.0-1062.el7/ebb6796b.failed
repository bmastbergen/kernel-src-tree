IB/uverbs: Add read counters support

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1062.el7
commit-author Raed Salem <raeds@mellanox.com>
commit ebb6796bd397f3fb9b2b46398b2fbb585e1b8bb6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1062.el7/ebb6796b.failed

This patch exposes the read counters verb to user space applications.  By
that verb the user can read the hardware counters which are associated
with the counters object.

The application needs to provide a sufficient memory to hold the
statistics.

	Reviewed-by: Yishai Hadas <yishaih@mellanox.com>
	Signed-off-by: Raed Salem <raeds@mellanox.com>
	Signed-off-by: Leon Romanovsky <leonro@mellanox.com>
	Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
(cherry picked from commit ebb6796bd397f3fb9b2b46398b2fbb585e1b8bb6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/core/uverbs_std_types_counters.c
#	include/uapi/rdma/ib_user_ioctl_cmds.h
diff --cc include/uapi/rdma/ib_user_ioctl_cmds.h
index 77bbbed17ed5,888ac5975a6c..000000000000
--- a/include/uapi/rdma/ib_user_ioctl_cmds.h
+++ b/include/uapi/rdma/ib_user_ioctl_cmds.h
@@@ -80,4 -96,60 +80,63 @@@ enum uverbs_methods_cq 
  	UVERBS_METHOD_CQ_DESTROY,
  };
  
++<<<<<<< HEAD
++=======
+ enum uverbs_methods_actions_flow_action_ops {
+ 	UVERBS_METHOD_FLOW_ACTION_ESP_CREATE,
+ 	UVERBS_METHOD_FLOW_ACTION_DESTROY,
+ 	UVERBS_METHOD_FLOW_ACTION_ESP_MODIFY,
+ };
+ 
+ enum uverbs_attrs_alloc_dm_cmd_attr_ids {
+ 	UVERBS_ATTR_ALLOC_DM_HANDLE,
+ 	UVERBS_ATTR_ALLOC_DM_LENGTH,
+ 	UVERBS_ATTR_ALLOC_DM_ALIGNMENT,
+ };
+ 
+ enum uverbs_attrs_free_dm_cmd_attr_ids {
+ 	UVERBS_ATTR_FREE_DM_HANDLE,
+ };
+ 
+ enum uverbs_methods_dm {
+ 	UVERBS_METHOD_DM_ALLOC,
+ 	UVERBS_METHOD_DM_FREE,
+ };
+ 
+ enum uverbs_attrs_reg_dm_mr_cmd_attr_ids {
+ 	UVERBS_ATTR_REG_DM_MR_HANDLE,
+ 	UVERBS_ATTR_REG_DM_MR_OFFSET,
+ 	UVERBS_ATTR_REG_DM_MR_LENGTH,
+ 	UVERBS_ATTR_REG_DM_MR_PD_HANDLE,
+ 	UVERBS_ATTR_REG_DM_MR_ACCESS_FLAGS,
+ 	UVERBS_ATTR_REG_DM_MR_DM_HANDLE,
+ 	UVERBS_ATTR_REG_DM_MR_RESP_LKEY,
+ 	UVERBS_ATTR_REG_DM_MR_RESP_RKEY,
+ };
+ 
+ enum uverbs_methods_mr {
+ 	UVERBS_METHOD_DM_MR_REG,
+ };
+ 
+ enum uverbs_attrs_create_counters_cmd_attr_ids {
+ 	UVERBS_ATTR_CREATE_COUNTERS_HANDLE,
+ };
+ 
+ enum uverbs_attrs_destroy_counters_cmd_attr_ids {
+ 	UVERBS_ATTR_DESTROY_COUNTERS_HANDLE,
+ };
+ 
+ enum uverbs_attrs_read_counters_cmd_attr_ids {
+ 	UVERBS_ATTR_READ_COUNTERS_HANDLE,
+ 	UVERBS_ATTR_READ_COUNTERS_BUFF,
+ 	UVERBS_ATTR_READ_COUNTERS_FLAGS,
+ };
+ 
+ enum uverbs_methods_actions_counters_ops {
+ 	UVERBS_METHOD_COUNTERS_CREATE,
+ 	UVERBS_METHOD_COUNTERS_DESTROY,
+ 	UVERBS_METHOD_COUNTERS_READ,
+ };
+ 
++>>>>>>> ebb6796bd397 (IB/uverbs: Add read counters support)
  #endif
* Unmerged path drivers/infiniband/core/uverbs_std_types_counters.c
* Unmerged path drivers/infiniband/core/uverbs_std_types_counters.c
* Unmerged path include/uapi/rdma/ib_user_ioctl_cmds.h
