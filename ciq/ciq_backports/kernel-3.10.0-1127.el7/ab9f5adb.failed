scsi: mpt3sas: make driver options visible in sys

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1127.el7
commit-author Tomas Henzl <thenzl@redhat.com>
commit ab9f5adb8d14a59fd5062ac1d880c5d10bb75959
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1127.el7/ab9f5adb.failed

Support is easier with all driver parameters visible in sysfs.  Also I've
replaced a constant with an octal permission.

	Signed-off-by: Tomas Henzl <thenzl@redhat.com>
	Acked-by: Suganath Prabu <suganath-prabu.subramani@broadcom.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit ab9f5adb8d14a59fd5062ac1d880c5d10bb75959)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/mpt3sas/mpt3sas_scsih.c
diff --cc drivers/scsi/mpt3sas/mpt3sas_scsih.c
index e18bcab9ff50,27c731a3fb49..000000000000
--- a/drivers/scsi/mpt3sas/mpt3sas_scsih.c
+++ b/drivers/scsi/mpt3sas/mpt3sas_scsih.c
@@@ -127,10 -123,17 +127,24 @@@ MODULE_PARM_DESC(missing_delay, " devic
  
  /* scsi-mid layer global parmeter is max_report_luns, which is 511 */
  #define MPT3SAS_MAX_LUN (16895)
++<<<<<<< HEAD
 +static int max_lun = MPT3SAS_MAX_LUN;
 +module_param(max_lun, int, 0);
 +MODULE_PARM_DESC(max_lun, " max lun, default=16895 ");
 +
++=======
+ static u64 max_lun = MPT3SAS_MAX_LUN;
+ module_param(max_lun, ullong, 0444);
+ MODULE_PARM_DESC(max_lun, " max lun, default=16895 ");
+ 
+ static ushort hbas_to_enumerate;
+ module_param(hbas_to_enumerate, ushort, 0444);
+ MODULE_PARM_DESC(hbas_to_enumerate,
+ 		" 0 - enumerates both SAS 2.0 & SAS 3.0 generation HBAs\n \
+ 		  1 - enumerates only SAS 2.0 generation HBAs\n \
+ 		  2 - enumerates only SAS 3.0 generation HBAs (default=0)");
+ 
++>>>>>>> ab9f5adb8d14 (scsi: mpt3sas: make driver options visible in sys)
  /* diag_buffer_enable is bitwise
   * bit 0 set = TRACE
   * bit 1 set = SNAPSHOT
diff --git a/drivers/scsi/mpt3sas/mpt3sas_base.c b/drivers/scsi/mpt3sas/mpt3sas_base.c
index 6c383203c42c..f335ad390569 100644
--- a/drivers/scsi/mpt3sas/mpt3sas_base.c
+++ b/drivers/scsi/mpt3sas/mpt3sas_base.c
@@ -74,28 +74,28 @@ static MPT_CALLBACK	mpt_callbacks[MPT_MAX_CALLBACKS];
 #define MAX_HBA_QUEUE_DEPTH	30000
 #define MAX_CHAIN_DEPTH		100000
 static int max_queue_depth = -1;
-module_param(max_queue_depth, int, 0);
+module_param(max_queue_depth, int, 0444);
 MODULE_PARM_DESC(max_queue_depth, " max controller queue depth ");
 
 static int max_sgl_entries = -1;
-module_param(max_sgl_entries, int, 0);
+module_param(max_sgl_entries, int, 0444);
 MODULE_PARM_DESC(max_sgl_entries, " max sg entries ");
 
 static int msix_disable = -1;
-module_param(msix_disable, int, 0);
+module_param(msix_disable, int, 0444);
 MODULE_PARM_DESC(msix_disable, " disable msix routed interrupts (default=0)");
 
 static int smp_affinity_enable = 1;
-module_param(smp_affinity_enable, int, S_IRUGO);
+module_param(smp_affinity_enable, int, 0444);
 MODULE_PARM_DESC(smp_affinity_enable, "SMP affinity feature enable/disable Default: enable(1)");
 
 static int max_msix_vectors = -1;
-module_param(max_msix_vectors, int, 0);
+module_param(max_msix_vectors, int, 0444);
 MODULE_PARM_DESC(max_msix_vectors,
 	" max msix vectors");
 
 static int irqpoll_weight = -1;
-module_param(irqpoll_weight, int, 0);
+module_param(irqpoll_weight, int, 0444);
 MODULE_PARM_DESC(irqpoll_weight,
 	"irq poll weight (default= one fourth of HBA queue depth)");
 
@@ -104,7 +104,7 @@ MODULE_PARM_DESC(mpt3sas_fwfault_debug,
 	" enable detection of firmware fault and halt firmware - (default=0)");
 
 static int perf_mode = -1;
-module_param(perf_mode, int, 0);
+module_param(perf_mode, int, 0444);
 MODULE_PARM_DESC(perf_mode,
 	"Performance mode (only for Aero/Sea Generation), options:\n\t\t"
 	"0 - balanced: high iops mode is enabled &\n\t\t"
* Unmerged path drivers/scsi/mpt3sas/mpt3sas_scsih.c
