s390: wire up sys_renameat2

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1127.el7
commit-author Heiko Carstens <heiko.carstens@de.ibm.com>
commit a1977d128ab7c6c1be296a8fa39219e330abdb07
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1127.el7/a1977d12.failed

Actually this also enable sys_setattr and sys_getattr, since I forgot to
increase NR_syscalls when adding those syscalls.

	Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com>
	Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
(cherry picked from commit a1977d128ab7c6c1be296a8fa39219e330abdb07)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/s390/include/uapi/asm/unistd.h
#	arch/s390/kernel/compat_wrapper.c
#	arch/s390/kernel/syscalls.S
diff --cc arch/s390/include/uapi/asm/unistd.h
index 338776495681,3802d2d3a18d..000000000000
--- a/arch/s390/include/uapi/asm/unistd.h
+++ b/arch/s390/include/uapi/asm/unistd.h
@@@ -280,34 -280,10 +280,41 @@@
  #define __NR_s390_runtime_instr 342
  #define __NR_kcmp		343
  #define __NR_finit_module	344
++<<<<<<< HEAD
 +#define __NR_sched_setattr 345
 +#define __NR_sched_getattr 346
 +/* Number 347 is reserved for sys_renameat2 */
 +#define __NR_seccomp		348
 +#define __NR_getrandom		349
 +#define __NR_memfd_create	350
 +#define __NR_bpf		351
 +#define __NR_s390_pci_mmio_write	352
 +#define __NR_s390_pci_mmio_read		353
 +#define __NR_membarrier		356
 +#define __NR_socket		359
 +#define __NR_bind		361
 +#define __NR_connect		362
 +#define __NR_getsockopt		365
 +#define __NR_setsockopt		366
 +#define __NR_sendto		369
 +#define __NR_sendmsg		370
 +#define __NR_recvfrom		371
 +#define __NR_recvmsg		372
 +#define __NR_shutdown		373
 +#define __NR_mlock2		374
 +#define __NR_copy_file_range	375
 +/* Number 376 is reserved for sys_preadv2 */
 +/* Number 377 is reserved for sys_pwritev2 */
 +#define __NR_s390_guarded_storage	378
 +/* Number 379 is reserved for sys_statx */
 +#define __NR_s390_sthyi		380
 +#define NR_syscalls 381
++=======
+ #define __NR_sched_setattr	345
+ #define __NR_sched_getattr	346
+ #define __NR_renameat2		347
+ #define NR_syscalls 348
++>>>>>>> a1977d128ab7 (s390: wire up sys_renameat2)
  
  /* 
   * There are some system calls that are not present on 64 bit, some
diff --cc arch/s390/kernel/syscalls.S
index 664d6633f9f4,fe5cdf29a001..000000000000
--- a/arch/s390/kernel/syscalls.S
+++ b/arch/s390/kernel/syscalls.S
@@@ -339,53 -339,20 +339,67 @@@ SYSCALL(sys_epoll_create1,sys_epoll_cre
  SYSCALL(sys_preadv,sys_preadv,compat_sys_preadv)
  SYSCALL(sys_pwritev,sys_pwritev,compat_sys_pwritev)
  SYSCALL(sys_rt_tgsigqueueinfo,sys_rt_tgsigqueueinfo,compat_sys_rt_tgsigqueueinfo) /* 330 */
 -SYSCALL(sys_perf_event_open,sys_perf_event_open,compat_sys_perf_event_open)
 -SYSCALL(sys_fanotify_init,sys_fanotify_init,compat_sys_fanotify_init)
 +SYSCALL(sys_perf_event_open,sys_perf_event_open,sys_perf_event_open_wrapper)
 +SYSCALL(sys_fanotify_init,sys_fanotify_init,sys_fanotify_init_wrapper)
  SYSCALL(sys_fanotify_mark,sys_fanotify_mark,compat_sys_fanotify_mark)
 -SYSCALL(sys_prlimit64,sys_prlimit64,compat_sys_prlimit64)
 -SYSCALL(sys_name_to_handle_at,sys_name_to_handle_at,compat_sys_name_to_handle_at) /* 335 */
 +SYSCALL(sys_prlimit64,sys_prlimit64,sys_prlimit64_wrapper)
 +SYSCALL(sys_name_to_handle_at,sys_name_to_handle_at,sys_name_to_handle_at_wrapper) /* 335 */
  SYSCALL(sys_open_by_handle_at,sys_open_by_handle_at,compat_sys_open_by_handle_at)
++<<<<<<< HEAD
 +SYSCALL(sys_clock_adjtime,sys_clock_adjtime,compat_sys_clock_adjtime_wrapper)
 +SYSCALL(sys_syncfs,sys_syncfs,sys_syncfs_wrapper)
 +SYSCALL(sys_setns,sys_setns,sys_setns_wrapper)
 +SYSCALL(sys_process_vm_readv,sys_process_vm_readv,compat_sys_process_vm_readv_wrapper) /* 340 */
 +SYSCALL(sys_process_vm_writev,sys_process_vm_writev,compat_sys_process_vm_writev_wrapper)
 +SYSCALL(sys_ni_syscall,sys_s390_runtime_instr,sys_s390_runtime_instr_wrapper)
 +SYSCALL(sys_kcmp,sys_kcmp,sys_kcmp_wrapper)
 +SYSCALL(sys_finit_module,sys_finit_module,sys_finit_module_wrapper)
 +SYSCALL(sys_sched_setattr,sys_sched_setattr,sys_sched_setattr_wrapper) /* 345 */
 +SYSCALL(sys_sched_getattr,sys_sched_getattr,sys_sched_getattr_wrapper)
 +NI_SYSCALL					/* 347 sys_renameat2 */
 +SYSCALL(sys_seccomp,sys_seccomp,sys_seccomp_wrapper)
 +SYSCALL(sys_getrandom,sys_getrandom,sys_getrandom_wrapper)
 +SYSCALL(sys_memfd_create,sys_memfd_create,sys_memfd_create_wrapper) /* 350 */
 +SYSCALL(sys_bpf,sys_bpf,sys_bpf_wrapper) /* 351 */
 +SYSCALL(sys_ni_syscall,sys_s390_pci_mmio_write,sys_s390_pci_mmio_write_wrapper)
 +SYSCALL(sys_ni_syscall,sys_s390_pci_mmio_read,sys_s390_pci_mmio_read_wrapper)
 +NI_SYSCALL					/* 354 sys_execveat */
 +NI_SYSCALL					/* 355 sys_userfaultfd */
 +SYSCALL(sys_membarrier,sys_membarrier,sys_membarrier_wrapper)
 +NI_SYSCALL					/* 357 sys_recvmmsg */
 +NI_SYSCALL					/* 358 sys_sendmmsg */
 +SYSCALL(sys_socket,sys_socket,sys_socket)
 +NI_SYSCALL					/* 360 sys_socketpair */
 +SYSCALL(sys_bind,sys_bind,sys_bind_wrapper)
 +SYSCALL(sys_connect,sys_connect,sys_connect_wrapper)
 +NI_SYSCALL					/* 363 sys_listen */
 +NI_SYSCALL					/* 364 sys_accept4 */
 +SYSCALL(sys_getsockopt,compat_sys_getsockopt,sys_getsockopt_wrapper)	/* 365 */
 +SYSCALL(sys_setsockopt,compat_sys_setsockopt,sys_setsockopt_wrapper)
 +NI_SYSCALL					/* 367 sys_getsockname */
 +NI_SYSCALL					/* 368 sys_getpeername */
 +SYSCALL(sys_sendto,sys_sendto,sys_sendto_wrapper)
 +SYSCALL(sys_sendmsg,sys_sendmsg,sys_sendmsg_wrapper)	/* 370 */
 +SYSCALL(sys_recvfrom,sys_recvfrom,sys_recvfrom_wrapper)
 +SYSCALL(sys_recvmsg,sys_recvmsg,sys_recvmsg_wrapper)
 +SYSCALL(sys_shutdown,sys_shutdown,sys_shutdown)
 +SYSCALL(sys_mlock2,sys_mlock2,sys_mlock2_wrapper)
 +SYSCALL(sys_copy_file_range,sys_copy_file_range,sys_copy_file_range_wrapper) /* 375 */
 +NI_SYSCALL
 +NI_SYSCALL
 +SYSCALL(sys_s390_guarded_storage,sys_s390_guarded_storage,sys_s390_guarded_storage_wrapper) /* 378 */
 +NI_SYSCALL
 +SYSCALL(sys_s390_sthyi,sys_s390_sthyi,sys_s390_sthyi_wrapper) /* 380 */
++=======
+ SYSCALL(sys_clock_adjtime,sys_clock_adjtime,compat_sys_clock_adjtime)
+ SYSCALL(sys_syncfs,sys_syncfs,compat_sys_syncfs)
+ SYSCALL(sys_setns,sys_setns,compat_sys_setns)
+ SYSCALL(sys_process_vm_readv,sys_process_vm_readv,compat_sys_process_vm_readv) /* 340 */
+ SYSCALL(sys_process_vm_writev,sys_process_vm_writev,compat_sys_process_vm_writev)
+ SYSCALL(sys_ni_syscall,sys_s390_runtime_instr,compat_sys_s390_runtime_instr)
+ SYSCALL(sys_kcmp,sys_kcmp,compat_sys_kcmp)
+ SYSCALL(sys_finit_module,sys_finit_module,compat_sys_finit_module)
+ SYSCALL(sys_sched_setattr,sys_sched_setattr,compat_sys_sched_setattr) /* 345 */
+ SYSCALL(sys_sched_getattr,sys_sched_getattr,compat_sys_sched_getattr)
+ SYSCALL(sys_renameat2,sys_renameat2,compat_sys_renameat2)
++>>>>>>> a1977d128ab7 (s390: wire up sys_renameat2)
* Unmerged path arch/s390/kernel/compat_wrapper.c
* Unmerged path arch/s390/include/uapi/asm/unistd.h
* Unmerged path arch/s390/kernel/compat_wrapper.c
* Unmerged path arch/s390/kernel/syscalls.S
