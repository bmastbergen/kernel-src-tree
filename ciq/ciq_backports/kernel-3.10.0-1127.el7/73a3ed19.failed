stm class: Fix master deallocation in device unregistering

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1127.el7
commit-author Chunyan Zhang <zhang.chunyan@linaro.org>
commit 73a3ed1903f7611f62fb5e1cd3c37afd2908e669
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1127.el7/73a3ed19.failed

The device unregister path uses wrong master index range when it tries
to free the allocated masters, it should, as does the rest of the stm
class code, use real master IDs.

This patch fixes the device unregister path to use real master IDs to
avoid memory leaks after unloading the stm driver.

	Signed-off-by: Chunyan Zhang <zhang.chunyan@linaro.org>
[alexander.shishkin@intel.com: re-wrote the commit message]
	Signed-off-by: Alexander Shishkin <alexander.shishkin@linux.intel.com>
	Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
(cherry picked from commit 73a3ed1903f7611f62fb5e1cd3c37afd2908e669)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/hwtracing/stm/core.c
* Unmerged path drivers/hwtracing/stm/core.c
* Unmerged path drivers/hwtracing/stm/core.c
