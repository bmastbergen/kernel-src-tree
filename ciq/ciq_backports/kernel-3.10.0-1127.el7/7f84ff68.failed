ALSA: line6: toneport: Fix broken usage of timer for delayed execution

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1127.el7
commit-author Takashi Iwai <tiwai@suse.de>
commit 7f84ff68be05ec7a5d2acf8fdc734fe5897af48f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1127.el7/7f84ff68.failed

The line6 toneport driver has code for some delayed initialization,
and this hits the kernel Oops because mutex and other sleepable
functions are used in the timer callback.  Fix the abuse by a delayed
work instead so that everything works gracefully.

	Reported-by: syzbot+a07d0142e74fdd595cfb@syzkaller.appspotmail.com
	Cc: <stable@vger.kernel.org>
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit 7f84ff68be05ec7a5d2acf8fdc734fe5897af48f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/usb/line6/toneport.c
diff --cc sound/usb/line6/toneport.c
index 5c52d41b8d6a,325b07b98b3c..000000000000
--- a/sound/usb/line6/toneport.c
+++ b/sound/usb/line6/toneport.c
@@@ -387,7 -394,9 +388,13 @@@ static void toneport_setup(struct usb_l
  	if (toneport_has_led(toneport))
  		toneport_update_led(toneport);
  
++<<<<<<< HEAD
 +	mod_timer(&toneport->timer, jiffies + TONEPORT_PCM_DELAY * HZ);
++=======
+ 	schedule_delayed_work(&toneport->pcm_work,
+ 			      msecs_to_jiffies(TONEPORT_PCM_DELAY * 1000));
+ 	return 0;
++>>>>>>> 7f84ff68be05 (ALSA: line6: toneport: Fix broken usage of timer for delayed execution)
  }
  
  /*
* Unmerged path sound/usb/line6/toneport.c
