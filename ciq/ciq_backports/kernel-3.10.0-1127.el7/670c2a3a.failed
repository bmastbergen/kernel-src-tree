nvmet-rdma: use generic inet_pton_with_scope

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1127.el7
commit-author Sagi Grimberg <sagi@grimberg.me>
commit 670c2a3ad51de40bad74aef481e1f68347da22d3
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1127.el7/670c2a3a.failed

Instead of parsing address strings, use a generic
helper. This also adds ipv6 (with address scopes)
support.

	Reviewed-by: Christoph Hellwig <hch@lst.de>
	Signed-off-by: Sagi Grimberg <sagi@grimberg.me>
	Signed-off-by: Jens Axboe <axboe@fb.com>
(cherry picked from commit 670c2a3ad51de40bad74aef481e1f68347da22d3)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/nvme/target/rdma.c
diff --cc drivers/nvme/target/rdma.c
index ad411962ac29,99c69018a35f..000000000000
--- a/drivers/nvme/target/rdma.c
+++ b/drivers/nvme/target/rdma.c
@@@ -1549,22 -1449,13 +1553,27 @@@ static int nvmet_rdma_add_port(struct n
  		return -EINVAL;
  	}
  
++<<<<<<< HEAD
 +	if (port->inline_data_size < 0) {
 +		port->inline_data_size = NVMET_RDMA_DEFAULT_INLINE_DATA_SIZE;
 +	} else if (port->inline_data_size > NVMET_RDMA_MAX_INLINE_DATA_SIZE) {
 +		pr_warn("inline_data_size %u is too large, reducing to %u\n",
 +			port->inline_data_size,
 +			NVMET_RDMA_MAX_INLINE_DATA_SIZE);
 +		port->inline_data_size = NVMET_RDMA_MAX_INLINE_DATA_SIZE;
 +	}
 +
 +	ret = kstrtou16(port->disc_addr.trsvcid, 0, &port_in);
 +	if (ret)
++=======
+ 	ret = inet_pton_with_scope(&init_net, af, port->disc_addr.traddr,
+ 			port->disc_addr.trsvcid, &addr);
+ 	if (ret) {
+ 		pr_err("malformed ip/port passed: %s:%s\n",
+ 			port->disc_addr.traddr, port->disc_addr.trsvcid);
++>>>>>>> 670c2a3ad51d (nvmet-rdma: use generic inet_pton_with_scope)
  		return ret;
- 
- 	addr_in.sin_family = AF_INET;
- 	addr_in.sin_addr.s_addr = in_aton(port->disc_addr.traddr);
- 	addr_in.sin_port = htons(port_in);
+ 	}
  
  	cm_id = rdma_create_id(&init_net, nvmet_rdma_cm_handler, port,
  			RDMA_PS_TCP, IB_QPT_RC);
* Unmerged path drivers/nvme/target/rdma.c
