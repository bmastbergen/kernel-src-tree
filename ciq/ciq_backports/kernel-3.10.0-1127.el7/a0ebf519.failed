stm class: Fix device leak in open error path

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1127.el7
commit-author Johan Hovold <johan@kernel.org>
commit a0ebf519b8a2666438d999c62995618c710573e5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1127.el7/a0ebf519.failed

Make sure to drop the reference taken by class_find_device() also on
allocation errors in open().

	Signed-off-by: Johan Hovold <johan@kernel.org>
Fixes: 7bd1d4093c2f ("stm class: Introduce an abstraction for...")
	Cc: stable@vger.kernel.org # v4.6+
	Signed-off-by: Alexander Shishkin <alexander.shishkin@linux.intel.com>
(cherry picked from commit a0ebf519b8a2666438d999c62995618c710573e5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/hwtracing/stm/core.c
* Unmerged path drivers/hwtracing/stm/core.c
* Unmerged path drivers/hwtracing/stm/core.c
