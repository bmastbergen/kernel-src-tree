tun: allow positive return values on dev_get_valid_name() call

jira LE-1907
cve CVE-2018-7191
Rebuild_History Non-Buildable kernel-3.10.0-1127.el7
commit-author Julien Gomes <julien@arista.com>
commit 5c25f65fd1e42685f7ccd80e0621829c105785d9
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1127.el7/5c25f65f.failed

If the name argument of dev_get_valid_name() contains "%d", it will try
to assign it a unit number in __dev__alloc_name() and return either the
unit number (>= 0) or an error code (< 0).
Considering positive values as error values prevent tun device creations
relying this mechanism, therefor we should only consider negative values
as errors here.

	Signed-off-by: Julien Gomes <julien@arista.com>
	Acked-by: Cong Wang <xiyou.wangcong@gmail.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 5c25f65fd1e42685f7ccd80e0621829c105785d9)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/tun.c
diff --cc drivers/net/tun.c
index 4cdb9597f760,b9973fb868b7..000000000000
--- a/drivers/net/tun.c
+++ b/drivers/net/tun.c
@@@ -2046,6 -2027,9 +2046,12 @@@ static int tun_set_iff(struct net *net
  
  		if (!dev)
  			return -ENOMEM;
++<<<<<<< HEAD
++=======
+ 		err = dev_get_valid_name(net, dev, name);
+ 		if (err < 0)
+ 			goto err_free_dev;
++>>>>>>> 5c25f65fd1e4 (tun: allow positive return values on dev_get_valid_name() call)
  
  		dev_net_set(dev, net);
  		dev->rtnl_link_ops = &tun_link_ops;
* Unmerged path drivers/net/tun.c
