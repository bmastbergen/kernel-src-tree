scsi: qla2xxx: Fix partial flash write of MBI

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1127.el7
commit-author Quinn Tran <qutran@marvell.com>
commit 8d8b83f5be2a3bdac3695a94e6cb5e50bd114869
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1127.el7/8d8b83f5.failed

For new adapters with multiple flash regions to write to, current code
allows FW & Boot regions to be written, while other regions are blocked via
sysfs. The fix is to block all flash read/write through sysfs interface.

Fixes: e81d1bcbde06 ("scsi: qla2xxx: Further limit FLASH region write access from SysFS")
	Cc: stable@vger.kernel.org # 5.2
Link: https://lore.kernel.org/r/20191022193643.7076-3-hmadhani@marvell.com
	Signed-off-by: Quinn Tran <qutran@marvell.com>
	Signed-off-by: Girish Basrur <gbasrur@marvell.com>
	Signed-off-by: Himanshu Madhani <hmadhani@marvell.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit 8d8b83f5be2a3bdac3695a94e6cb5e50bd114869)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/qla2xxx/qla_attr.c
diff --cc drivers/scsi/qla2xxx/qla_attr.c
index 6d78a2d9df63,8705ca6395e4..000000000000
--- a/drivers/scsi/qla2xxx/qla_attr.c
+++ b/drivers/scsi/qla2xxx/qla_attr.c
@@@ -421,12 -440,7 +421,16 @@@ qla2x00_sysfs_write_optrom_ctl(struct f
  		valid = 0;
  		if (ha->optrom_size == OPTROM_SIZE_2300 && start == 0)
  			valid = 1;
++<<<<<<< HEAD
 +		else if (start == (ha->flt_region_boot * 4) ||
 +		    start == (ha->flt_region_fw * 4))
 +			valid = 1;
 +		else if (IS_QLA24XX_TYPE(ha) || IS_QLA25XX(ha)
 +			|| IS_CNA_CAPABLE(ha) || IS_QLA2031(ha)
 +			|| IS_QLA27XX(ha))
++=======
+ 		else if (IS_QLA24XX_TYPE(ha) || IS_QLA25XX(ha))
++>>>>>>> 8d8b83f5be2a (scsi: qla2xxx: Fix partial flash write of MBI)
  			valid = 1;
  		if (!valid) {
  			ql_log(ql_log_warn, vha, 0x7065,
* Unmerged path drivers/scsi/qla2xxx/qla_attr.c
