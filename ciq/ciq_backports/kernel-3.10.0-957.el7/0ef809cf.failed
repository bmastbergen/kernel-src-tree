iio: hid-sensor-magn-3d: Introduce PM

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [iio] hid-sensor-magn-3d: Introduce PM (Tony Camuso) [1559170]
Rebuild_FUZZ: 92.75%
commit-author Srinivas Pandruvada <srinivas.pandruvada@linux.intel.com>
commit 0ef809cf9956c156220155203b0df934f2b2fc14
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/0ef809cf.failed

Use common hid sensor iio pm functions. Also the poll time read and
wait is part of power up function of hid sensor iio pm function, so
remove from the client drivers.

	Signed-off-by: Srinivas Pandruvada <srinivas.pandruvada@linux.intel.com>
	Signed-off-by: Jonathan Cameron <jic23@kernel.org>
(cherry picked from commit 0ef809cf9956c156220155203b0df934f2b2fc14)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/iio/magnetometer/hid-sensor-magn-3d.c
diff --cc drivers/iio/magnetometer/hid-sensor-magn-3d.c
index 506126a31fb4,d22993b4066a..000000000000
--- a/drivers/iio/magnetometer/hid-sensor-magn-3d.c
+++ b/drivers/iio/magnetometer/hid-sensor-magn-3d.c
@@@ -117,17 -162,10 +116,10 @@@ static int magn_3d_read_raw(struct iio_
  	*val2 = 0;
  	switch (mask) {
  	case 0:
- 		poll_value = hid_sensor_read_poll_value(
- 					&magn_state->common_attributes);
- 		if (poll_value < 0)
- 				return -EINVAL;
- 
  		hid_sensor_power_state(&magn_state->common_attributes, true);
- 		msleep_interruptible(poll_value * 2);
- 
  		report_id =
 -			magn_state->magn[chan->address].report_id;
 -		address = magn_3d_addresses[chan->address];
 +			magn_state->magn[chan->scan_index].report_id;
 +		address = magn_3d_addresses[chan->scan_index];
  		if (report_id >= 0)
  			*val = sensor_hub_input_attr_get_raw_value(
  				magn_state->common_attributes.hsdev,
@@@ -420,7 -522,7 +412,11 @@@ static struct platform_driver hid_magn_
  	.id_table = hid_magn_3d_ids,
  	.driver = {
  		.name	= KBUILD_MODNAME,
++<<<<<<< HEAD
 +		.owner	= THIS_MODULE,
++=======
+ 		.pm	= &hid_sensor_pm_ops,
++>>>>>>> 0ef809cf9956 (iio: hid-sensor-magn-3d: Introduce PM)
  	},
  	.probe		= hid_magn_3d_probe,
  	.remove		= hid_magn_3d_remove,
* Unmerged path drivers/iio/magnetometer/hid-sensor-magn-3d.c
