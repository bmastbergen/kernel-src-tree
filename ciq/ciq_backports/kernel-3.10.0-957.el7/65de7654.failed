iio: iio: Fix iio_channel_read return if channel havn't info

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [iio] iio: Fix iio_channel_read return if channel havn't info (Tony Camuso) [1559170]
Rebuild_FUZZ: 95.65%
commit-author Fabien Proriol <fabien.proriol@jdsu.com>
commit 65de7654d39c70c2b942f801cea01590cf7e3458
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/65de7654.failed

When xilinx-xadc is used with hwmon driver to read voltage, offset used
for temperature is always applied whatever the channel.

iio_channel_read must return an error to avoid offset for channel
without IIO_CHAN_INFO_OFFSET property.

	Signed-off-by: Fabien Proriol <fabien.proriol@jdsu.com>
	Signed-off-by: Jonathan Cameron <jic23@kernel.org>
(cherry picked from commit 65de7654d39c70c2b942f801cea01590cf7e3458)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/iio/inkern.c
diff --cc drivers/iio/inkern.c
index 4b2d891e0356,d33590e89337..000000000000
--- a/drivers/iio/inkern.c
+++ b/drivers/iio/inkern.c
@@@ -446,8 -426,20 +446,25 @@@ static int iio_channel_read(struct iio_
  	if (val2 == NULL)
  		val2 = &unused;
  
++<<<<<<< HEAD
 +	return chan->indio_dev->info->read_raw(chan->indio_dev, chan->channel,
 +						val, val2, info);
++=======
+ 	if(!iio_channel_has_info(chan->channel, info))
+ 		return -EINVAL;
+ 
+ 	if (chan->indio_dev->info->read_raw_multi) {
+ 		ret = chan->indio_dev->info->read_raw_multi(chan->indio_dev,
+ 					chan->channel, INDIO_MAX_RAW_ELEMENTS,
+ 					vals, &val_len, info);
+ 		*val = vals[0];
+ 		*val2 = vals[1];
+ 	} else
+ 		ret = chan->indio_dev->info->read_raw(chan->indio_dev,
+ 					chan->channel, val, val2, info);
+ 
+ 	return ret;
++>>>>>>> 65de7654d39c (iio: iio: Fix iio_channel_read return if channel havn't info)
  }
  
  int iio_read_channel_raw(struct iio_channel *chan, int *val)
* Unmerged path drivers/iio/inkern.c
