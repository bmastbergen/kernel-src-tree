perf test: Update mmap read functions for backward-ring-buffer test

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
commit-author Kan Liang <kan.liang@intel.com>
commit 600a7cfe88de2c6e44e23d61dd721b996b790eb2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/600a7cfe.failed

Use the new perf_mmap__read_* interfaces for overwrite ringbuffer test.

Commiter notes:

Testing:

  [root@seventh ~]# perf test -v backward
  48: Read backward ring buffer                             :
  --- start ---
  test child forked, pid 8309
  Using CPUID GenuineIntel-6-9E
  mmap size 1052672B
  mmap size 8192B
  Finished reading overwrite ring buffer: rewind
  test child finished with 0
  ---- end ----
  Read backward ring buffer: Ok
  [root@seventh ~]#

	Signed-off-by: Kan Liang <kan.liang@intel.com>
	Acked-by: Jiri Olsa <jolsa@kernel.org>
	Tested-by: Arnaldo Carvalho de Melo <acme@redhat.com>
	Cc: Andi Kleen <ak@linux.intel.com>
	Cc: Jin Yao <yao.jin@linux.intel.com>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Wang Nan <wangnan0@huawei.com>
Link: http://lkml.kernel.org/r/1516310792-208685-10-git-send-email-kan.liang@intel.com
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 600a7cfe88de2c6e44e23d61dd721b996b790eb2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/tests/backward-ring-buffer.c
diff --cc tools/perf/tests/backward-ring-buffer.c
index 18b8baa3fc0e,e0b1b414d466..000000000000
--- a/tools/perf/tests/backward-ring-buffer.c
+++ b/tools/perf/tests/backward-ring-buffer.c
@@@ -30,10 -31,12 +30,17 @@@ static int count_samples(struct perf_ev
  	int i;
  
  	for (i = 0; i < evlist->nr_mmaps; i++) {
+ 		struct perf_mmap *map = &evlist->overwrite_mmap[i];
  		union perf_event *event;
+ 		u64 start, end;
  
++<<<<<<< HEAD
 +		perf_mmap__read_catchup(&evlist->backward_mmap[i]);
 +		while ((event = perf_mmap__read_backward(&evlist->backward_mmap[i])) != NULL) {
++=======
+ 		perf_mmap__read_init(map, true, &start, &end);
+ 		while ((event = perf_mmap__read_event(map, true, &start, end)) != NULL) {
++>>>>>>> 600a7cfe88de (perf test: Update mmap read functions for backward-ring-buffer test)
  			const u32 type = event->header.type;
  
  			switch (type) {
* Unmerged path tools/perf/tests/backward-ring-buffer.c
