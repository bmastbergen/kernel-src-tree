iio:iio_buffer_init(): Only set watermark if not already set

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [iio] iio_buffer_init(): Only set watermark if not already set (Tony Camuso) [1559170]
Rebuild_FUZZ: 96.55%
commit-author Lars-Peter Clausen <lars@metafoo.de>
commit 4a60535726d90bfad16b5c52dcffaeede9fb84a9
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/4a605357.failed

Only initialize the watermark field if it is still 0. This allows drivers
to provide a custom default watermark value. E.g. some driver might have a
fixed watermark or can only support watermarks within a certain range and
the initial value for the watermark should be within this range.

	Signed-off-by: Lars-Peter Clausen <lars@metafoo.de>
	Signed-off-by: Jonathan Cameron <jic23@kernel.org>
(cherry picked from commit 4a60535726d90bfad16b5c52dcffaeede9fb84a9)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/iio/industrialio-buffer.c
diff --cc drivers/iio/industrialio-buffer.c
index f0b219d32278,5f2c8c8c436e..000000000000
--- a/drivers/iio/industrialio-buffer.c
+++ b/drivers/iio/industrialio-buffer.c
@@@ -138,6 -192,9 +138,12 @@@ void iio_buffer_init(struct iio_buffer 
  	INIT_LIST_HEAD(&buffer->demux_list);
  	INIT_LIST_HEAD(&buffer->buffer_list);
  	init_waitqueue_head(&buffer->pollq);
++<<<<<<< HEAD
++=======
+ 	kref_init(&buffer->ref);
+ 	if (!buffer->watermark)
+ 		buffer->watermark = 1;
++>>>>>>> 4a60535726d9 (iio:iio_buffer_init(): Only set watermark if not already set)
  }
  EXPORT_SYMBOL(iio_buffer_init);
  
* Unmerged path drivers/iio/industrialio-buffer.c
