platform/x86: dell-wmi: clean up wmi descriptor check

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [platform] x86: dell-wmi: clean up wmi descriptor check (Jarod Wilson) [1526317]
Rebuild_FUZZ: 90.72%
commit-author Mario Limonciello <mario.limonciello@dell.com>
commit 7e6dcbebcbc5d8cd7d9e564d9cfbf523c2fbcb68
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/7e6dcbeb.failed

Some cases the wrong type was used for errors and checks can be
done more cleanly.

	Signed-off-by: Mario Limonciello <mario.limonciello@dell.com>
	Reviewed-by: Edward O'Callaghan <quasisec@google.com>
	Suggested-by: Andy Shevchenko <andy.shevchenko@gmail.com>
	Reviewed-by: Pali Roh√°r <pali.rohar@gmail.com>
	Signed-off-by: Darren Hart (VMware) <dvhart@infradead.org>
(cherry picked from commit 7e6dcbebcbc5d8cd7d9e564d9cfbf523c2fbcb68)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/platform/x86/dell-wmi.c
diff --cc drivers/platform/x86/dell-wmi.c
index fa90558cb1ae,b2bd396acac5..000000000000
--- a/drivers/platform/x86/dell-wmi.c
+++ b/drivers/platform/x86/dell-wmi.c
@@@ -661,25 -663,31 +661,38 @@@ static int __init dell_wmi_check_descri
  
  	buffer = (u32 *)obj->buffer.pointer;
  
++<<<<<<< HEAD
 +	if (buffer[0] != 0x4C4C4544 && buffer[1] != 0x494D5720)
 +		pr_warn("Dell descriptor buffer has invalid signature (%*ph)\n",
 +			8, buffer);
 +
 +	if (buffer[2] != 0 && buffer[2] != 1)
 +		pr_warn("Dell descriptor buffer has unknown version (%d)\n",
 +			buffer[2]);
++=======
+ 	if (strncmp(obj->string.pointer, "DELL WMI", 8) != 0) {
+ 		dev_err(&wdev->dev, "Dell descriptor buffer has invalid signature (%8ph)\n",
+ 			buffer);
+ 		ret = -EINVAL;
+ 		goto out;
+ 	}
+ 
+ 	if (buffer[2] != 0 && buffer[2] != 1)
+ 		dev_warn(&wdev->dev, "Dell descriptor buffer has unknown version (%lu)\n",
+ 			(unsigned long) buffer[2]);
++>>>>>>> 7e6dcbebcbc5 (platform/x86: dell-wmi: clean up wmi descriptor check)
  
  	if (buffer[3] != 4096)
 -		dev_warn(&wdev->dev, "Dell descriptor buffer has invalid buffer length (%d)\n",
 +		pr_warn("Dell descriptor buffer has invalid buffer length (%d)\n",
  			buffer[3]);
  
 -	priv->interface_version = buffer[2];
 -	ret = 0;
 +	dell_wmi_interface_version = buffer[2];
  
 -	dev_info(&wdev->dev, "Detected Dell WMI interface version %u\n",
 -		priv->interface_version);
 +	pr_info("Detected Dell WMI interface version %u\n",
 +		dell_wmi_interface_version);
  
 -out:
  	kfree(obj);
 -	put_device(&desc_dev->dev);
 -	return ret;
 +	return 0;
  }
  
  /*
* Unmerged path drivers/platform/x86/dell-wmi.c
