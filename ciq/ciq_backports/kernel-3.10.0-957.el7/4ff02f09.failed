usb: typec: wcove: fix the sink capabilities

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [usb] typec: wcove: fix the sink capabilities (Torez Smith) [1540721]
Rebuild_FUZZ: 93.98%
commit-author Heikki Krogerus <heikki.krogerus@linux.intel.com>
commit 4ff02f099f68f1e6be5956849180eaa326c37248
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/4ff02f09.failed

USB Power Delivery Specification (v3.0) dictates in ch.
6.4.1 - Capabilities Message - that the vSafe5V Fixed Supply
Object shall always be the first object. tcpm.c now checks
that this rule is obeyed (commit 5007e1b5db73 "typec: tcpm
Validate source and sink caps"), and that makes the
typec_wcove.c fail to probe. The voltage is higher then what
is permitted for the vSafe5V parameter.

Dropping the voltage in the first Fixed Supply object of the
sink capabilities down to 5V, and maximum current down to
500mA, making the driver probe successfully again.

Also, removing the Battery and Variable Supply objects, as
there is no need for them.

	Signed-off-by: Heikki Krogerus <heikki.krogerus@linux.intel.com>
	Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
(cherry picked from commit 4ff02f099f68f1e6be5956849180eaa326c37248)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/usb/typec/typec_wcove.c
diff --cc drivers/usb/typec/typec_wcove.c
index d5a7b21fa3f1,2e990e0d917d..000000000000
--- a/drivers/usb/typec/typec_wcove.c
+++ b/drivers/usb/typec/typec_wcove.c
@@@ -288,6 -547,34 +288,37 @@@ err
  	return IRQ_HANDLED;
  }
  
++<<<<<<< HEAD
++=======
+ /*
+  * The following power levels should be safe to use with Joule board.
+  */
+ static const u32 src_pdo[] = {
+ 	PDO_FIXED(5000, 1500, PDO_FIXED_DUAL_ROLE | PDO_FIXED_DATA_SWAP |
+ 		  PDO_FIXED_USB_COMM),
+ };
+ 
+ static const u32 snk_pdo[] = {
+ 	PDO_FIXED(5000, 500, PDO_FIXED_DUAL_ROLE | PDO_FIXED_DATA_SWAP |
+ 		  PDO_FIXED_USB_COMM),
+ };
+ 
+ static struct tcpc_config wcove_typec_config = {
+ 	.src_pdo = src_pdo,
+ 	.nr_src_pdo = ARRAY_SIZE(src_pdo),
+ 	.snk_pdo = snk_pdo,
+ 	.nr_snk_pdo = ARRAY_SIZE(snk_pdo),
+ 
+ 	.max_snk_mv = 12000,
+ 	.max_snk_ma = 3000,
+ 	.max_snk_mw = 36000,
+ 	.operating_snk_mw = 15000,
+ 
+ 	.type = TYPEC_PORT_DRP,
+ 	.default_role = TYPEC_SINK,
+ };
+ 
++>>>>>>> 4ff02f099f68 (usb: typec: wcove: fix the sink capabilities)
  static int wcove_typec_probe(struct platform_device *pdev)
  {
  	struct intel_soc_pmic *pmic = dev_get_drvdata(pdev->dev.parent);
* Unmerged path drivers/usb/typec/typec_wcove.c
