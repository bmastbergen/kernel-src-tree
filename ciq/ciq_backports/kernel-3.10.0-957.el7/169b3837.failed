mailbox: pcc: Don't access an unmapped memory address space

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [mailbox] pcc: Don't access an unmapped memory address space (Al Stone) [1568211]
Rebuild_FUZZ: 91.74%
commit-author Shanker Donthineni <shankerd@codeaurora.org>
commit 169b38373fd4a7d47cac0e5fdeeae90b8c076f32
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/169b3837.failed

The acpi_pcc_probe() may end up accessing memory outside of the PCCT
table space causing the kernel panic(). Increment the pcct_entry
pointer after parsing 'HW-reduced Communications Subspace' to fix
the problem. This change also enables the parsing of subtable at
index 0.

	Signed-off-by: Shanker Donthineni <shankerd@codeaurora.org>
	Acked-by: Ashwin Chaugule <ashwin.chaugule@linaro.org>
	Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
(cherry picked from commit 169b38373fd4a7d47cac0e5fdeeae90b8c076f32)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/mailbox/pcc.c
diff --cc drivers/mailbox/pcc.c
index 7afd8f400f55,9d3955e6ab44..000000000000
--- a/drivers/mailbox/pcc.c
+++ b/drivers/mailbox/pcc.c
@@@ -274,7 -364,16 +274,17 @@@ static int __init acpi_pcc_probe(void
  		(unsigned long) pcct_tbl + sizeof(struct acpi_table_pcct));
  
  	for (i = 0; i < count; i++) {
 -		struct acpi_generic_address *db_reg;
 -		struct acpi_pcct_hw_reduced *pcct_ss;
  		pcc_mbox_channels[i].con_priv = pcct_entry;
++<<<<<<< HEAD
++=======
+ 
+ 		/* If doorbell is in system memory cache the virt address */
+ 		pcct_ss = (struct acpi_pcct_hw_reduced *)pcct_entry;
+ 		db_reg = &pcct_ss->doorbell_register;
+ 		if (db_reg->space_id == ACPI_ADR_SPACE_SYSTEM_MEMORY)
+ 			pcc_doorbell_vaddr[i] = acpi_os_ioremap(db_reg->address,
+ 							db_reg->bit_width/8);
++>>>>>>> 169b38373fd4 (mailbox: pcc: Don't access an unmapped memory address space)
  		pcct_entry = (struct acpi_subtable_header *)
  			((unsigned long) pcct_entry + pcct_entry->length);
  	}
* Unmerged path drivers/mailbox/pcc.c
