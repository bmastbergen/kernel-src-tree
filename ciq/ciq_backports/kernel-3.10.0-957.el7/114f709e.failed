perf tool: Add show_feature_header to perf_tool

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
commit-author David Carrillo-Cisneros <davidcc@google.com>
commit 114f709e01e62760a6d03de1358188293dfefdda
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/114f709e.failed

Add show_feat_hdr to control level of printed information of feature
headers.

	Signed-off-by: David Carrillo-Cisneros <davidcc@google.com>
	Acked-by: David Ahern <dsahern@gmail.com>
	Acked-by: Jiri Olsa <jolsa@kernel.org>
	Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
	Cc: Andi Kleen <ak@linux.intel.com>
	Cc: He Kuang <hekuang@huawei.com>
	Cc: Masami Hiramatsu <mhiramat@kernel.org>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: Paul Turner <pjt@google.com>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Simon Que <sque@chromium.org>
	Cc: Stephane Eranian <eranian@google.com>
	Cc: Wang Nan <wangnan0@huawei.com>
Link: http://lkml.kernel.org/r/20170718042549.145161-15-davidcc@google.com
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 114f709e01e62760a6d03de1358188293dfefdda)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/util/tool.h
diff --cc tools/perf/util/tool.h
index ac2590a3de2d,baeca808dfda..000000000000
--- a/tools/perf/util/tool.h
+++ b/tools/perf/util/tool.h
@@@ -66,6 -73,8 +72,11 @@@ struct perf_tool 
  	event_op3	auxtrace;
  	bool		ordered_events;
  	bool		ordering_requires_timestamps;
++<<<<<<< HEAD
++=======
+ 	bool		namespace_events;
+ 	enum show_feature_header show_feat_hdr;
++>>>>>>> 114f709e01e6 (perf tool: Add show_feature_header to perf_tool)
  };
  
  #endif /* __PERF_TOOL_H */
diff --git a/tools/perf/builtin-report.c b/tools/perf/builtin-report.c
index 4aa3887393bb..9cb3eff44e0b 100644
--- a/tools/perf/builtin-report.c
+++ b/tools/perf/builtin-report.c
@@ -987,6 +987,10 @@ repeat:
 	/* Force tty output for header output and per-thread stat. */
 	if (report.header || report.header_only || report.show_threads)
 		use_browser = 0;
+	if (report.header || report.header_only)
+		report.tool.show_feat_hdr = SHOW_FEAT_HEADER;
+	if (report.show_full_info)
+		report.tool.show_feat_hdr = SHOW_FEAT_HEADER_FULL_INFO;
 
 	if (strcmp(input_name, "-") != 0)
 		setup_browser(true);
diff --git a/tools/perf/builtin-script.c b/tools/perf/builtin-script.c
index 1c5919ddf0e7..8121aaa97fca 100644
--- a/tools/perf/builtin-script.c
+++ b/tools/perf/builtin-script.c
@@ -2637,10 +2637,13 @@ int cmd_script(int argc, const char **argv)
 		return -1;
 
 	if (header || header_only) {
+		script.tool.show_feat_hdr = SHOW_FEAT_HEADER;
 		perf_session__fprintf_info(session, stdout, show_full_info);
 		if (header_only)
 			goto out_delete;
 	}
+	if (show_full_info)
+		script.tool.show_feat_hdr = SHOW_FEAT_HEADER_FULL_INFO;
 
 	if (symbol__init(&session->header.env) < 0)
 		goto out_delete;
* Unmerged path tools/perf/util/tool.h
