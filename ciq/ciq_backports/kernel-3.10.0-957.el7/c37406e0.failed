PCI: Allow release of resources that were never assigned

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [pci] Allow release of resources that were never assigned (Rob Clark) [1519691 1515623 1566644]
Rebuild_FUZZ: 95.33%
commit-author Christian König <ckoenig.leichtzumerken@gmail.com>
commit c37406e05d1e541df40b8b81c4bd40753fcaf414
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/c37406e0.failed

It is entirely possible that the BIOS wasn't able to assign resources to a
device. In this case don't crash in pci_release_resource() when we try to
resize the resource.

Fixes: 8bb705e3e79d ("PCI: Add pci_resize_resource() for resizing BARs")
	Signed-off-by: Christian König <christian.koenig@amd.com>
	Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
	Reviewed-by: Andy Shevchenko <andy.shevchenko@gmail.com>
CC: stable@vger.kernel.org	# v4.15+
(cherry picked from commit c37406e05d1e541df40b8b81c4bd40753fcaf414)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/pci/setup-res.c
diff --cc drivers/pci/setup-res.c
index 5b072a115bf6,365447240d95..000000000000
--- a/drivers/pci/setup-res.c
+++ b/drivers/pci/setup-res.c
@@@ -353,7 -400,11 +353,15 @@@ void pci_release_resource(struct pci_de
  {
  	struct resource *res = dev->resource + resno;
  
++<<<<<<< HEAD
 +	dev_info(&dev->dev, "BAR %d: releasing %pR\n", resno, res);
++=======
+ 	pci_info(dev, "BAR %d: releasing %pR\n", resno, res);
+ 
+ 	if (!res->parent)
+ 		return;
+ 
++>>>>>>> c37406e05d1e (PCI: Allow release of resources that were never assigned)
  	release_resource(res);
  	res->end = resource_size(res) - 1;
  	res->start = 0;
* Unmerged path drivers/pci/setup-res.c
