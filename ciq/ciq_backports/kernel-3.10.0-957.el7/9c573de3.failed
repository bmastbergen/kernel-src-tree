MD: make bio mergeable

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [md] make bio mergeable (Nigel Croxon) [1494474]
Rebuild_FUZZ: 90.00%
commit-author Shaohua Li <shli@fb.com>
commit 9c573de3283af007ea11c17bde1e4568d9417328
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/9c573de3.failed

blk_queue_split marks bio unmergeable, which makes sense for normal bio.
But if dispatching the bio to underlayer disk, the blk_queue_split
checks are invalid, hence it's possible the bio becomes mergeable.

In the reported bug, this bug causes trim against raid0 performance slash
https://bugzilla.kernel.org/show_bug.cgi?id=117051

Reported-and-tested-by: Park Ju Hyung <qkrwngud825@gmail.com>
Fixes: 6ac45aeb6bca(block: avoid to merge splitted bio)
	Cc: stable@vger.kernel.org (v4.3+)
	Cc: Ming Lei <ming.lei@canonical.com>
	Cc: Neil Brown <neilb@suse.de>
	Reviewed-by: Jens Axboe <axboe@fb.com>
	Signed-off-by: Shaohua Li <shli@fb.com>
(cherry picked from commit 9c573de3283af007ea11c17bde1e4568d9417328)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/md/md.c
diff --cc drivers/md/md.c
index 7fc346cffd9c,14d3b37944df..000000000000
--- a/drivers/md/md.c
+++ b/drivers/md/md.c
@@@ -327,8 -284,9 +327,14 @@@ static void md_make_request(struct requ
  	 * go away inside make_request
  	 */
  	sectors = bio_sectors(bio);
++<<<<<<< HEAD
 +
 +	md_handle_request(mddev, bio);
++=======
+ 	/* bio could be mergeable after passing to underlayer */
+ 	bio->bi_rw &= ~REQ_NOMERGE;
+ 	mddev->pers->make_request(mddev, bio);
++>>>>>>> 9c573de3283a (MD: make bio mergeable)
  
  	cpu = part_stat_lock();
  	part_stat_inc(cpu, &mddev->gendisk->part0, ios[rw]);
* Unmerged path drivers/md/md.c
