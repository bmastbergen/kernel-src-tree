uio: don't free irq that was not requested

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [uio] don't free irq that was not requested (Xiubo Li) [1560418]
Rebuild_FUZZ: 93.67%
commit-author Stephen Hemminger <stephen@networkplumber.org>
commit 9ff2c132345cab8972a2bd29069aa52a3cadbbcc
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/9ff2c132.failed

UIO base driver should only free_irq that it has requested.
UIO supports drivers without interrupts (irq == 0) or custom handlers.

This fixes warnings like:

WARNING: CPU: 1 PID: 5478 at kernel/irq/manage.c:1244 __free_irq+0xa9/0x1e0()
Trying to free already-free IRQ 0

	Signed-off-by: Stephen Hemminger <stephen@networkplumber.org>
	Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
(cherry picked from commit 9ff2c132345cab8972a2bd29069aa52a3cadbbcc)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/uio/uio.c
diff --cc drivers/uio/uio.c
index df187289f61b,3257d4220d01..000000000000
--- a/drivers/uio/uio.c
+++ b/drivers/uio/uio.c
@@@ -880,13 -877,12 +880,19 @@@ void uio_unregister_device(struct uio_i
  
  	uio_free_minor(idev);
  
 +	if (info->irq && (info->irq != UIO_IRQ_CUSTOM))
 +		free_irq(info->irq, idev);
 +
  	uio_dev_del_attributes(idev);
  
++<<<<<<< HEAD
++=======
+ 	if (info->irq && info->irq != UIO_IRQ_CUSTOM)
+ 		free_irq(info->irq, idev);
+ 
++>>>>>>> 9ff2c132345c (uio: don't free irq that was not requested)
  	device_destroy(&uio_class, MKDEV(uio_major, idev->minor));
 +	kfree(idev);
  
  	return;
  }
* Unmerged path drivers/uio/uio.c
