crypto: testmgr - Allow leading zeros in RSA

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [crypto] testmgr - Allow leading zeros in RSA (Neil Horman) [1546163]
Rebuild_FUZZ: 90.00%
commit-author Herbert Xu <herbert@gondor.apana.org.au>
commit 50d2b643ea6675927435743633a57c2a9cfd8d83
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/50d2b643.failed

This patch allows RSA implementations to produce output with
leading zeroes.  testmgr will skip leading zeroes when comparing
the output.

This patch also tries to make the RSA test function generic enough
to potentially handle other akcipher algorithms.

	Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
(cherry picked from commit 50d2b643ea6675927435743633a57c2a9cfd8d83)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	crypto/testmgr.c
diff --cc crypto/testmgr.c
index 4c9502bba2e2,38e23be315a0..000000000000
--- a/crypto/testmgr.c
+++ b/crypto/testmgr.c
@@@ -2000,9 -1911,10 +2000,9 @@@ static int alg_test_kpp(const struct al
  	return err;
  }
  
- static int do_test_rsa(struct crypto_akcipher *tfm,
- 		       struct akcipher_testvec *vecs)
+ static int test_akcipher_one(struct crypto_akcipher *tfm,
+ 			     struct akcipher_testvec *vecs)
  {
 -	char *xbuf[XBUFSIZE];
  	struct akcipher_request *req;
  	void *outbuf_enc = NULL;
  	void *outbuf_dec = NULL;
@@@ -2052,8 -1972,9 +2052,14 @@@
  		goto free_all;
  	}
  	/* verify that encrypted message is equal to expected */
++<<<<<<< HEAD
 +	if (memcmp(vecs->c, sg_virt(req->dst), vecs->c_size)) {
 +		pr_err("alg: rsa: encrypt test failed. Invalid output\n");
++=======
+ 	if (memcmp(vecs->c, outbuf_enc, vecs->c_size)) {
+ 		pr_err("alg: akcipher: encrypt test failed. Invalid output\n");
+ 		hexdump(outbuf_enc, vecs->c_size);
++>>>>>>> 50d2b643ea66 (crypto: testmgr - Allow leading zeros in RSA)
  		err = -EINVAL;
  		goto free_all;
  	}
* Unmerged path crypto/testmgr.c
