scsi: megaraid_sas: Move initialization of instance parameters inside newly created function megasas_init_ctrl_params

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [scsi] megaraid_sas: Move initialization of instance parameters inside newly created function megasas_init_ctrl_params (Tomas Henzl) [1513838]
Rebuild_FUZZ: 97.37%
commit-author Shivasharan S <shivasharan.srikanteshwara@broadcom.com>
commit 7535f27d1f1408c25176af86feda846fa3d3d307
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/7535f27d.failed

Code refactoring, no functional change. Create new function to
initialize all the controller parameters during load time.

	Signed-off-by: Kashyap Desai <kashyap.desai@broadcom.com>
	Signed-off-by: Shivasharan S <shivasharan.srikanteshwara@broadcom.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit 7535f27d1f1408c25176af86feda846fa3d3d307)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/megaraid/megaraid_sas_base.c
diff --cc drivers/scsi/megaraid/megaraid_sas_base.c
index 3bd6576d3342,a201b6e3fbb1..000000000000
--- a/drivers/scsi/megaraid/megaraid_sas_base.c
+++ b/drivers/scsi/megaraid/megaraid_sas_base.c
@@@ -6283,67 -6351,6 +6345,70 @@@ static int megasas_probe_one(struct pci
  	if (megasas_alloc_ctrl_dma_buffers(instance))
  		goto fail_alloc_dma_buf;
  
++<<<<<<< HEAD
 +	/* Crash dump feature related initialisation*/
 +	instance->drv_buf_index = 0;
 +	instance->drv_buf_alloc = 0;
 +	instance->crash_dump_fw_support = 0;
 +	instance->crash_dump_app_support = 0;
 +	instance->fw_crash_state = UNAVAILABLE;
 +	spin_lock_init(&instance->crashdump_lock);
 +	instance->crash_dump_buf = NULL;
 +
 +	megasas_poll_wait_aen = 0;
 +	instance->flag_ieee = 0;
 +	instance->ev = NULL;
 +	instance->issuepend_done = 1;
 +	atomic_set(&instance->adprecovery, MEGASAS_HBA_OPERATIONAL);
 +	instance->is_imr = 0;
 +
 +	/*
 +	 * Initialize locks and queues
 +	 */
 +	INIT_LIST_HEAD(&instance->cmd_pool);
 +	INIT_LIST_HEAD(&instance->internal_reset_pending_q);
 +
 +	atomic_set(&instance->fw_outstanding,0);
 +
 +	init_waitqueue_head(&instance->int_cmd_wait_q);
 +	init_waitqueue_head(&instance->abort_cmd_wait_q);
 +
 +	spin_lock_init(&instance->mfi_pool_lock);
 +	spin_lock_init(&instance->hba_lock);
 +	spin_lock_init(&instance->stream_lock);
 +	spin_lock_init(&instance->completion_lock);
 +
 +	mutex_init(&instance->reset_mutex);
 +	mutex_init(&instance->hba_mutex);
 +
 +	/*
 +	 * Initialize PCI related and misc parameters
 +	 */
 +	instance->host = host;
 +	instance->unique_id = pdev->bus->number << 8 | pdev->devfn;
 +	instance->init_id = MEGASAS_DEFAULT_INIT_ID;
 +	instance->ctrl_info = NULL;
 +
 +
 +	if ((instance->pdev->device == PCI_DEVICE_ID_LSI_SAS0073SKINNY) ||
 +		(instance->pdev->device == PCI_DEVICE_ID_LSI_SAS0071SKINNY))
 +		instance->flag_ieee = 1;
 +
 +	megasas_dbg_lvl = 0;
 +	instance->flag = 0;
 +	instance->unload = 1;
 +	instance->last_time = 0;
 +	instance->disableOnlineCtrlReset = 1;
 +	instance->UnevenSpanSupport = 0;
 +
 +	if (instance->adapter_type != MFI_SERIES) {
 +		INIT_WORK(&instance->work_init, megasas_fusion_ocr_wq);
 +		INIT_WORK(&instance->crash_init, megasas_fusion_crash_dump_wq);
 +	} else
 +		INIT_WORK(&instance->work_init, process_fw_state_change_wq);
 +
++=======
++>>>>>>> 7535f27d1f14 (scsi: megaraid_sas: Move initialization of instance parameters inside newly created function megasas_init_ctrl_params)
  	/*
  	 * Initialize MFI Firmware
  	 */
* Unmerged path drivers/scsi/megaraid/megaraid_sas_base.c
