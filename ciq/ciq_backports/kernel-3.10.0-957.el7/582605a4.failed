powerpc/pseries: Support firmware disable of RFI flush

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [powerpc] pseries: Support firmware disable of RFI flush (Mauricio Oliveira) [1553927]
Rebuild_FUZZ: 92.00%
commit-author Michael Ellerman <mpe@ellerman.id.au>
commit 582605a429e20ae68fd0b041b2e840af296edd08
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/582605a4.failed

Some versions of firmware will have a setting that can be configured
to disable the RFI flush, add support for it.

Fixes: 8989d56878a7 ("powerpc/pseries: Query hypervisor for RFI flush settings")
	Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
(cherry picked from commit 582605a429e20ae68fd0b041b2e840af296edd08)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/powerpc/platforms/pseries/setup.c
diff --cc arch/powerpc/platforms/pseries/setup.c
index 16f5e74be2ee,1a527625acf7..000000000000
--- a/arch/powerpc/platforms/pseries/setup.c
+++ b/arch/powerpc/platforms/pseries/setup.c
@@@ -544,7 -482,8 +544,12 @@@ static void pSeries_setup_rfi_flush(voi
  		if (types == L1D_FLUSH_NONE)
  			types = L1D_FLUSH_FALLBACK;
  
++<<<<<<< HEAD
 +		if (!(behaviour & H_GET_CPU_CHAR_BEHAV_L1_FLUSH_LOW_PRIV))
++=======
+ 		if ((!(result.behaviour & H_CPU_BEHAV_L1D_FLUSH_PR)) ||
+ 		    (!(result.behaviour & H_CPU_BEHAV_FAVOUR_SECURITY)))
++>>>>>>> 582605a429e2 (powerpc/pseries: Support firmware disable of RFI flush)
  			enable = false;
  	} else {
  		/* Default to fallback if case hcall is not available */
* Unmerged path arch/powerpc/platforms/pseries/setup.c
