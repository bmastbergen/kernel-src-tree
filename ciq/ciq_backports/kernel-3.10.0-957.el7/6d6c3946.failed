ASoC: dmic: replace codec to component

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [sound] alsa: asoc: dmic: replace codec to component (Jaroslav Kysela) [1535427]
Rebuild_FUZZ: 92.68%
commit-author Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
commit 6d6c3946d877adf1e73c6292f947bbb687452ed5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/6d6c3946.failed

Now we can replace Codec to Component. Let's do it.

Note:
	xxx_codec_xxx()		->	xxx_component_xxx()
	.idle_bias_off = 0	->	.idle_bias_on = 1
	.ignore_pmdown_time = 0	->	.use_pmdown_time = 1
	-			->	.endianness = 1
	-			->	.non_legacy_dai_naming = 1

	Signed-off-by: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit 6d6c3946d877adf1e73c6292f947bbb687452ed5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/soc/codecs/dmic.c
diff --cc sound/soc/codecs/dmic.c
index b88a1ee66f80,32a8f71d51f1..000000000000
--- a/sound/soc/codecs/dmic.c
+++ b/sound/soc/codecs/dmic.c
@@@ -107,14 -109,30 +109,35 @@@ static const struct snd_soc_component_d
  
  static int dmic_dev_probe(struct platform_device *pdev)
  {
++<<<<<<< HEAD
 +	return snd_soc_register_codec(&pdev->dev,
 +			&soc_dmic, &dmic_dai, 1);
- }
++=======
+ 	int err;
+ 	u32 chans;
+ 	struct snd_soc_dai_driver *dai_drv = &dmic_dai;
+ 
+ 	if (pdev->dev.of_node) {
+ 		err = of_property_read_u32(pdev->dev.of_node, "num-channels", &chans);
+ 		if (err && (err != -EINVAL))
+ 			return err;
+ 
+ 		if (!err) {
+ 			if (chans < 1 || chans > 8)
+ 				return -EINVAL;
+ 
+ 			dai_drv = devm_kzalloc(&pdev->dev, sizeof(*dai_drv), GFP_KERNEL);
+ 			if (!dai_drv)
+ 				return -ENOMEM;
+ 
+ 			memcpy(dai_drv, &dmic_dai, sizeof(*dai_drv));
+ 			dai_drv->capture.channels_max = chans;
+ 		}
+ 	}
  
- static int dmic_dev_remove(struct platform_device *pdev)
- {
- 	snd_soc_unregister_codec(&pdev->dev);
- 	return 0;
+ 	return devm_snd_soc_register_component(&pdev->dev,
+ 			&soc_dmic, dai_drv, 1);
++>>>>>>> 6d6c3946d877 (ASoC: dmic: replace codec to component)
  }
  
  MODULE_ALIAS("platform:dmic-codec");
* Unmerged path sound/soc/codecs/dmic.c
