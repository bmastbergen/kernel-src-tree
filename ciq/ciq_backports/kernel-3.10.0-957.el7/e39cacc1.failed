ASoC: Intel: bytcr_rt5651: Not being able to find the codec ACPI-dev is an error

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [sound] alsa: asoc: intel: bytcr_rt5651: Not being able to find the codec ACPI-dev is an error (Jaroslav Kysela) [1535427]
Rebuild_FUZZ: 96.39%
commit-author Hans de Goede <hdegoede@redhat.com>
commit e39cacc1b7de2a6d72ce49043c9cfd7dd129135a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/e39cacc1.failed

If we cannot find the codec ACPI-dev, then the snd-soc-core will not be
able to find the codec either and snd_soc_register_card() will just keep
exiting with -EPROBE_DEFER, filling the log with errors each time the
probe gets retried.

Instead simply log an error from the machine driver and exit with -ENODEV.

	Signed-off-by: Hans de Goede <hdegoede@redhat.com>
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit e39cacc1b7de2a6d72ce49043c9cfd7dd129135a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/soc/intel/boards/bytcr_rt5651.c
diff --cc sound/soc/intel/boards/bytcr_rt5651.c
index 9548084b4678,105339c5b693..000000000000
--- a/sound/soc/intel/boards/bytcr_rt5651.c
+++ b/sound/soc/intel/boards/bytcr_rt5651.c
@@@ -652,13 -539,14 +652,23 @@@ static int snd_byt_rt5651_mc_probe(stru
  	}
  
  	/* fixup codec name based on HID */
++<<<<<<< HEAD
 +	i2c_name = sst_acpi_find_name_from_hid(mach->id);
 +	if (i2c_name) {
 +		snprintf(byt_rt5651_codec_name, sizeof(byt_rt5651_codec_name),
 +			"%s%s", "i2c-", i2c_name);
 +
 +		byt_rt5651_dais[dai_index].codec_name = byt_rt5651_codec_name;
++=======
+ 	i2c_name = acpi_dev_get_first_match_name(mach->id, NULL, -1);
+ 	if (!i2c_name) {
+ 		dev_err(&pdev->dev, "Error cannot find '%s' dev\n", mach->id);
+ 		return -ENODEV;
++>>>>>>> e39cacc1b7de (ASoC: Intel: bytcr_rt5651: Not being able to find the codec ACPI-dev is an error)
  	}
+ 	snprintf(byt_rt5651_codec_name, sizeof(byt_rt5651_codec_name),
+ 		"%s%s", "i2c-", i2c_name);
+ 	byt_rt5651_dais[dai_index].codec_name = byt_rt5651_codec_name;
  
  	/* check quirks before creating card */
  	dmi_check_system(byt_rt5651_quirk_table);
* Unmerged path sound/soc/intel/boards/bytcr_rt5651.c
