libnvdimm/nfit_test: adding support for unit testing enable LSS status

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
commit-author Dave Jiang <dave.jiang@intel.com>
commit 674d8bdec770d40288574534eab27d82bdf16b0e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/674d8bde.failed

Adding support code to simulate the enabling of LSS status in support of
the Intel DSM v1.6 Function Index 10: Enable Latch System Shutdown Status.
This is only for testing of libndctl support for LSS enable. The actual
functionality requires a reboot and therefore is not simulated. The enable
value is not recorded in nfit_test since there's no DSM to actually query
the current status of the LSS enable.

	Signed-off-by: Dave Jiang <dave.jiang@intel.com>
	Reviewed-by: Vishal Verma <vishal.l.verma@intel.com>
	Signed-off-by: Dan Williams <dan.j.williams@intel.com>
(cherry picked from commit 674d8bdec770d40288574534eab27d82bdf16b0e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/testing/nvdimm/test/nfit.c
diff --cc tools/testing/nvdimm/test/nfit.c
index af455c4a01ba,42ee1798971d..000000000000
--- a/tools/testing/nvdimm/test/nfit.c
+++ b/tools/testing/nvdimm/test/nfit.c
@@@ -2104,9 -2127,7 +2137,13 @@@ static void nfit_test1_setup(struct nfi
  	set_bit(ND_CMD_ARS_START, &acpi_desc->bus_cmd_force_en);
  	set_bit(ND_CMD_ARS_STATUS, &acpi_desc->bus_cmd_force_en);
  	set_bit(ND_CMD_CLEAR_ERROR, &acpi_desc->bus_cmd_force_en);
++<<<<<<< HEAD
 +	set_bit(ND_CMD_GET_CONFIG_SIZE, &acpi_desc->dimm_cmd_force_en);
 +	set_bit(ND_CMD_GET_CONFIG_DATA, &acpi_desc->dimm_cmd_force_en);
 +	set_bit(ND_CMD_SET_CONFIG_DATA, &acpi_desc->dimm_cmd_force_en);
++=======
+ 	set_bit(ND_INTEL_ENABLE_LSS_STATUS, &acpi_desc->dimm_cmd_force_en);
++>>>>>>> 674d8bdec770 (libnvdimm/nfit_test: adding support for unit testing enable LSS status)
  }
  
  static int nfit_test_blk_do_io(struct nd_blk_region *ndbr, resource_size_t dpa,
* Unmerged path tools/testing/nvdimm/test/nfit.c
diff --git a/tools/testing/nvdimm/test/nfit_test.h b/tools/testing/nvdimm/test/nfit_test.h
index efe43c91bcc5..eb61c416bc2d 100644
--- a/tools/testing/nvdimm/test/nfit_test.h
+++ b/tools/testing/nvdimm/test/nfit_test.h
@@ -85,6 +85,7 @@ struct nd_cmd_ars_err_inj_stat {
 
 #define ND_INTEL_SMART			 1
 #define ND_INTEL_SMART_THRESHOLD	 2
+#define ND_INTEL_ENABLE_LSS_STATUS	10
 #define ND_INTEL_FW_GET_INFO		12
 #define ND_INTEL_FW_START_UPDATE	13
 #define ND_INTEL_FW_SEND_DATA		14
@@ -211,6 +212,11 @@ struct nd_intel_fw_finish_query {
 	__u64 updated_fw_rev;
 } __packed;
 
+struct nd_intel_lss {
+	__u8 enable;
+	__u32 status;
+} __packed;
+
 union acpi_object;
 typedef void *acpi_handle;
 
