nfp: flower: move route ack control messages out of the workqueue

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
commit-author Pieter Jansen van Vuuren <pieter.jansenvanvuuren@netronome.com>
commit 0b1a989ef5a751b5992842d1934e22de861a848e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/0b1a989e.failed

Previously we processed the route ack control messages in the workqueue,
this unnecessarily loads the workqueue. We can deal with these messages
sooner as we know we are going to drop them.

Fixes: 8e6a9046b66a ("nfp: flower vxlan neighbour offload")
	Signed-off-by: Pieter Jansen van Vuuren <pieter.jansenvanvuuren@netronome.com>
	Reviewed-by: Jakub Kicinski <jakub.kicinski@netronome.com>
	Reviewed-by: Simon Horman <simon.horman@netronome.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 0b1a989ef5a751b5992842d1934e22de861a848e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/netronome/nfp/flower/cmsg.c
diff --cc drivers/net/ethernet/netronome/nfp/flower/cmsg.c
index 44008782eb74,8ad857eb89c6..000000000000
--- a/drivers/net/ethernet/netronome/nfp/flower/cmsg.c
+++ b/drivers/net/ethernet/netronome/nfp/flower/cmsg.c
@@@ -223,6 -299,13 +220,16 @@@ void nfp_flower_cmsg_rx(struct nfp_app 
  		/* We need to deal with stats updates from HW asap */
  		nfp_flower_rx_flow_stats(app, skb);
  		dev_consume_skb_any(skb);
++<<<<<<< HEAD
++=======
+ 	} else if (cmsg_hdr->type == NFP_FLOWER_CMSG_TYPE_PORT_MOD &&
+ 		   nfp_flower_process_mtu_ack(app, skb)) {
+ 		/* Handle MTU acks outside wq to prevent RTNL conflict. */
+ 		dev_consume_skb_any(skb);
+ 	} else if (cmsg_hdr->type == NFP_FLOWER_CMSG_TYPE_TUN_NEIGH) {
+ 		/* Acks from the NFP that the route is added - ignore. */
+ 		dev_consume_skb_any(skb);
++>>>>>>> 0b1a989ef5a7 (nfp: flower: move route ack control messages out of the workqueue)
  	} else {
  		skb_queue_tail(&priv->cmsg_skbs, skb);
  		schedule_work(&priv->cmsg_work);
* Unmerged path drivers/net/ethernet/netronome/nfp/flower/cmsg.c
