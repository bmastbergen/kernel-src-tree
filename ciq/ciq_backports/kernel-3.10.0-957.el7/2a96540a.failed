iio: hid-sensor-magn-3d: Scan for usage attributes before setting up iio channels

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [iio] hid-sensor-magn-3d: Scan for usage attributes before setting up iio channels (Tony Camuso) [1559170]
Rebuild_FUZZ: 96.82%
commit-author Reyad Attiyat <reyad.attiyat@gmail.com>
commit 2a96540a5c0d136c3c412ec650fad301aaf12bf7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/2a96540a.failed

Scan for and count the HID usage attributes supported by the driver.
This allows for the driver to only setup the IIO channels for the
sensor usages present in the HID USB reports.

Changes from v5
-Fixed kernel panic from invalid pointer dereference
-Fixed variable assignment style

	Signed-off-by: Reyad Attiyat <reyad.attiyat@gmail.com>
	Acked-by: Srinivas Pandruvada <srinivas.pandruvada@linux.intel.com>
	Signed-off-by: Jonathan Cameron <jic23@kernel.org>
(cherry picked from commit 2a96540a5c0d136c3c412ec650fad301aaf12bf7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/iio/magnetometer/hid-sensor-magn-3d.c
diff --cc drivers/iio/magnetometer/hid-sensor-magn-3d.c
index 506126a31fb4,c0a659cc6715..000000000000
--- a/drivers/iio/magnetometer/hid-sensor-magn-3d.c
+++ b/drivers/iio/magnetometer/hid-sensor-magn-3d.c
@@@ -217,8 -223,8 +219,13 @@@ static int magn_3d_proc_event(struct hi
  	dev_dbg(&indio_dev->dev, "magn_3d_proc_event\n");
  	if (atomic_read(&magn_state->common_attributes.data_ready))
  		hid_sensor_push_data(indio_dev,
++<<<<<<< HEAD
 +				(u8 *)magn_state->magn_val,
 +				sizeof(magn_state->magn_val));
++=======
+ 				magn_state->iio_vals,
+ 				sizeof(magn_state->iio_vals));
++>>>>>>> 2a96540a5c0d (iio: hid-sensor-magn-3d: Scan for usage attributes before setting up iio channels)
  
  	return 0;
  }
* Unmerged path drivers/iio/magnetometer/hid-sensor-magn-3d.c
