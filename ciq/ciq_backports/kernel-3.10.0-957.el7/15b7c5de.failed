ASoC: dmic: don't use codec anymore

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [sound] alsa: asoc: dmic: don't use codec anymore (Jaroslav Kysela) [1535427]
Rebuild_FUZZ: 92.11%
commit-author Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
commit 15b7c5de7c0c4f55d529ca71a5a0feca4cf03ab3
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/15b7c5de.failed

commit 6d6c3946d877 ("ASoC: dmic: replace codec to component")
replaced codec to component, but
commit 05c9b302eda7 ("ASoC: dmic: Add optional wakeup delay")
used codec again. This patch fix it up.

Fixes: 05c9b302eda7 ("ASoC: dmic: Add optional wakeup delay")
	Signed-off-by: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit 15b7c5de7c0c4f55d529ca71a5a0feca4cf03ab3)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/soc/codecs/dmic.c
diff --cc sound/soc/codecs/dmic.c
index b88a1ee66f80,8c4926df9286..000000000000
--- a/sound/soc/codecs/dmic.c
+++ b/sound/soc/codecs/dmic.c
@@@ -29,24 -30,27 +29,31 @@@
  #include <sound/soc.h>
  #include <sound/soc-dapm.h>
  
 -struct dmic {
 -	struct gpio_desc *gpio_en;
 -	int wakeup_delay;
 -};
 +static int dmic_daiops_trigger(struct snd_pcm_substream *substream,
 +		int cmd, struct snd_soc_dai *dai)
 +{
 +	struct gpio_desc *dmic_en = snd_soc_dai_get_drvdata(dai);
  
++<<<<<<< HEAD
 +	if (!dmic_en)
 +		return 0;
++=======
+ static int dmic_aif_event(struct snd_soc_dapm_widget *w,
+ 			  struct snd_kcontrol *kcontrol, int event) {
+ 	struct snd_soc_component *component = snd_soc_dapm_to_component(w->dapm);
+ 	struct dmic *dmic = snd_soc_component_get_drvdata(component);
++>>>>>>> 15b7c5de7c0c (ASoC: dmic: don't use codec anymore)
  
 -	switch (event) {
 -	case SND_SOC_DAPM_POST_PMU:
 -		if (dmic->gpio_en)
 -			gpiod_set_value(dmic->gpio_en, 1);
 -
 -		if (dmic->wakeup_delay)
 -			msleep(dmic->wakeup_delay);
 +	switch (cmd) {
 +	case SNDRV_PCM_TRIGGER_START:
 +	case SNDRV_PCM_TRIGGER_RESUME:
 +	case SNDRV_PCM_TRIGGER_PAUSE_RELEASE:
 +		gpiod_set_value(dmic_en, 1);
  		break;
 -	case SND_SOC_DAPM_POST_PMD:
 -		if (dmic->gpio_en)
 -			gpiod_set_value(dmic->gpio_en, 0);
 +	case SNDRV_PCM_TRIGGER_STOP:
 +	case SNDRV_PCM_TRIGGER_SUSPEND:
 +	case SNDRV_PCM_TRIGGER_PAUSE_PUSH:
 +		gpiod_set_value(dmic_en, 0);
  		break;
  	}
  
* Unmerged path sound/soc/codecs/dmic.c
