selinux: ioctl_has_perm should be static

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
commit-author Geliang Tang <geliangtang@163.com>
commit 1d2a168a085f1c65b895f258ee11a52813d25af6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/1d2a168a.failed

Fixes the following sparse warning:

 security/selinux/hooks.c:3242:5: warning: symbol 'ioctl_has_perm' was
 not declared. Should it be static?

	Signed-off-by: Geliang Tang <geliangtang@163.com>
	Acked-by: Jeff Vander Stoep <jeffv@google.com>
	Acked-by: Stephen Smalley <sds@tycho.nsa.gov>
	Signed-off-by: Paul Moore <pmoore@redhat.com>
(cherry picked from commit 1d2a168a085f1c65b895f258ee11a52813d25af6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	security/selinux/hooks.c
diff --cc security/selinux/hooks.c
index f29754eead4a,799d15aa35f9..000000000000
--- a/security/selinux/hooks.c
+++ b/security/selinux/hooks.c
@@@ -3349,6 -3231,46 +3349,49 @@@ static void selinux_file_free_security(
  	file_free_security(file);
  }
  
++<<<<<<< HEAD
++=======
+ /*
+  * Check whether a task has the ioctl permission and cmd
+  * operation to an inode.
+  */
+ static int ioctl_has_perm(const struct cred *cred, struct file *file,
+ 		u32 requested, u16 cmd)
+ {
+ 	struct common_audit_data ad;
+ 	struct file_security_struct *fsec = file->f_security;
+ 	struct inode *inode = file_inode(file);
+ 	struct inode_security_struct *isec = inode->i_security;
+ 	struct lsm_ioctlop_audit ioctl;
+ 	u32 ssid = cred_sid(cred);
+ 	int rc;
+ 	u8 driver = cmd >> 8;
+ 	u8 xperm = cmd & 0xff;
+ 
+ 	ad.type = LSM_AUDIT_DATA_IOCTL_OP;
+ 	ad.u.op = &ioctl;
+ 	ad.u.op->cmd = cmd;
+ 	ad.u.op->path = file->f_path;
+ 
+ 	if (ssid != fsec->sid) {
+ 		rc = avc_has_perm(ssid, fsec->sid,
+ 				SECCLASS_FD,
+ 				FD__USE,
+ 				&ad);
+ 		if (rc)
+ 			goto out;
+ 	}
+ 
+ 	if (unlikely(IS_PRIVATE(inode)))
+ 		return 0;
+ 
+ 	rc = avc_has_extended_perms(ssid, isec->sid, isec->sclass,
+ 			requested, driver, xperm, &ad);
+ out:
+ 	return rc;
+ }
+ 
++>>>>>>> 1d2a168a085f (selinux: ioctl_has_perm should be static)
  static int selinux_file_ioctl(struct file *file, unsigned int cmd,
  			      unsigned long arg)
  {
* Unmerged path security/selinux/hooks.c
