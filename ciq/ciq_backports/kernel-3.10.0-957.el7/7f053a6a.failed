MD: fix a null dereference

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [md] fix a null dereference (Nigel Croxon) [1494474]
Rebuild_FUZZ: 91.67%
commit-author Shaohua Li <shli@fb.com>
commit 7f053a6a745557b3f3ad63e9d28ba85c3c0b1563
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/7f053a6a.failed

rdev->mddev could be null in start time.

	Reported-by: Ming Lei <ming.lei@redhat.com>
Fix: 5a85071c2cbc(md: use a separate bio_set for synchronous IO.)
	Cc: NeilBrown <neilb@suse.com>
	Signed-off-by: Shaohua Li <shli@fb.com>
(cherry picked from commit 7f053a6a745557b3f3ad63e9d28ba85c3c0b1563)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/md/md.c
diff --cc drivers/md/md.c
index 803a9346c3dc,092b48f8095e..000000000000
--- a/drivers/md/md.c
+++ b/drivers/md/md.c
@@@ -195,15 -203,13 +195,20 @@@ struct bio *bio_alloc_mddev(gfp_t gfp_m
  }
  EXPORT_SYMBOL_GPL(bio_alloc_mddev);
  
 -static struct bio *md_bio_alloc_sync(struct mddev *mddev)
 +struct bio *bio_clone_mddev(struct bio *bio, gfp_t gfp_mask,
 +			    struct mddev *mddev)
  {
++<<<<<<< HEAD
 +	if (!mddev || !mddev->bio_set)
 +		return bio_clone(bio, gfp_mask);
++=======
+ 	if (!mddev || !mddev->sync_set)
+ 		return bio_alloc(GFP_NOIO, 1);
++>>>>>>> 7f053a6a7455 (MD: fix a null dereference)
  
 -	return bio_alloc_bioset(GFP_NOIO, 1, mddev->sync_set);
 +	return bio_clone_bioset(bio, gfp_mask, mddev->bio_set);
  }
 +EXPORT_SYMBOL_GPL(bio_clone_mddev);
  
  /*
   * We have a system wide 'event count' that is incremented
* Unmerged path drivers/md/md.c
