watchdog: core: Fix error handling of watchdog_dev_init()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [watchdog] core: Fix error handling of watchdog_dev_init() (David Arcari) [1576173]
Rebuild_FUZZ: 90.38%
commit-author Wei Yongjun <yongjun_wei@trendmicro.com.cn>
commit 138913cb632be12344982e54ccd12f6f15971bf7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/138913cb.failed

Fix the error handling paths of watchdog_dev_init().

	Signed-off-by: Wei Yongjun <yongjun_wei@trendmicro.com.cn>
	Reviewed-by: Guenter Roeck <linux@roeck-us.net>
	Signed-off-by: Guenter Roeck <linux@roeck-us.net>
	Signed-off-by: Wim Van Sebroeck <wim@iguana.be>
(cherry picked from commit 138913cb632be12344982e54ccd12f6f15971bf7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/watchdog/watchdog_dev.c
diff --cc drivers/watchdog/watchdog_dev.c
index f06fbcf0bea2,f128efc36135..000000000000
--- a/drivers/watchdog/watchdog_dev.c
+++ b/drivers/watchdog/watchdog_dev.c
@@@ -713,17 -965,29 +713,34 @@@ struct class * __init watchdog_dev_init
  	err = class_register(&watchdog_class);
  	if (err < 0) {
  		pr_err("couldn't register class\n");
++<<<<<<< HEAD
 +		return ERR_PTR(err);
++=======
+ 		goto err_register;
++>>>>>>> 138913cb632b (watchdog: core: Fix error handling of watchdog_dev_init())
  	}
  
  	err = alloc_chrdev_region(&watchdog_devt, 0, MAX_DOGS, "watchdog");
  	if (err < 0) {
  		pr_err("watchdog: unable to allocate char dev region\n");
++<<<<<<< HEAD
 +		class_unregister(&watchdog_class);
 +		return ERR_PTR(err);
 +	}
 +
 +	return &watchdog_class;
++=======
+ 		goto err_alloc;
+ 	}
+ 
+ 	return 0;
+ 
+ err_alloc:
+ 	class_unregister(&watchdog_class);
+ err_register:
+ 	destroy_workqueue(watchdog_wq);
+ 	return err;
++>>>>>>> 138913cb632b (watchdog: core: Fix error handling of watchdog_dev_init())
  }
  
  /*
* Unmerged path drivers/watchdog/watchdog_dev.c
