sfc: remove tx and MCDI handling from NAPI budget consideration

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
commit-author Bert Kenward <bkenward@solarflare.com>
commit 5227ecccea2d645d253d243ad287169335a4ae64
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/5227eccc.failed

The NAPI budget is only for RX processing work, not other work such as
 TX or MCDI completion handling.

	Signed-off-by: Bert Kenward <bkenward@solarflare.com>
	Signed-off-by: Edward Cree <ecree@solarflare.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 5227ecccea2d645d253d243ad287169335a4ae64)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/sfc/ef10.c
#	drivers/net/ethernet/sfc/farch.c
diff --cc drivers/net/ethernet/sfc/ef10.c
index a5be2b57d8ac,03ec2cc1eab4..000000000000
--- a/drivers/net/ethernet/sfc/ef10.c
+++ b/drivers/net/ethernet/sfc/ef10.c
@@@ -3579,13 -3579,12 +3579,17 @@@ efx_ef10_handle_tx_event(struct efx_cha
  	struct efx_tx_queue *tx_queue;
  	unsigned int tx_ev_desc_ptr;
  	unsigned int tx_ev_q_label;
- 	int tx_descs = 0;
  
++<<<<<<< HEAD
 +	if (unlikely(ACCESS_ONCE(efx->reset_pending)))
 +		return 0;
++=======
+ 	if (unlikely(READ_ONCE(efx->reset_pending)))
+ 		return;
++>>>>>>> 5227ecccea2d (sfc: remove tx and MCDI handling from NAPI budget consideration)
  
  	if (unlikely(EFX_QWORD_FIELD(*event, ESF_DZ_TX_DROP_EVENT)))
- 		return 0;
+ 		return;
  
  	/* Transmit completion */
  	tx_ev_desc_ptr = EFX_QWORD_FIELD(*event, ESF_DZ_TX_DESCR_INDX);
diff --cc drivers/net/ethernet/sfc/farch.c
index 6608dfe455b1,ca79ac6d0ac3..000000000000
--- a/drivers/net/ethernet/sfc/farch.c
+++ b/drivers/net/ethernet/sfc/farch.c
@@@ -825,10 -825,9 +825,14 @@@ efx_farch_handle_tx_event(struct efx_ch
  	unsigned int tx_ev_q_label;
  	struct efx_tx_queue *tx_queue;
  	struct efx_nic *efx = channel->efx;
- 	int tx_packets = 0;
  
++<<<<<<< HEAD
 +	if (unlikely(ACCESS_ONCE(efx->reset_pending)))
 +		return 0;
++=======
+ 	if (unlikely(READ_ONCE(efx->reset_pending)))
+ 		return;
++>>>>>>> 5227ecccea2d (sfc: remove tx and MCDI handling from NAPI budget consideration)
  
  	if (likely(EFX_QWORD_FIELD(*event, FSF_AZ_TX_EV_COMP))) {
  		/* Transmit completion */
* Unmerged path drivers/net/ethernet/sfc/ef10.c
* Unmerged path drivers/net/ethernet/sfc/farch.c
