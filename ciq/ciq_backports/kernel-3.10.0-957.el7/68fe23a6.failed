drm/nouveau: Remove bogus crtc check in pmops_runtime_idle

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
commit-author Lyude Paul <lyude@redhat.com>
commit 68fe23a626b67b56c912c496ea43ed537ea9708f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/68fe23a6.failed

This both uses the legacy modesetting structures in a racy manner, and
additionally also doesn't even check the right variable (enabled != the
CRTC is actually turned on for atomic).

This fixes issues on my P50 regarding the dedicated GPU not entering
runtime suspend.

	Signed-off-by: Lyude Paul <lyude@redhat.com>
	Cc: stable@vger.kernel.org
	Reviewed-by: Daniel Vetter <daniel.vetter@ffwll.ch>
	Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
(cherry picked from commit 68fe23a626b67b56c912c496ea43ed537ea9708f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/nouveau/nouveau_drm.c
diff --cc drivers/gpu/drm/nouveau/nouveau_drm.c
index 7cbd6aca3c10,514903338782..000000000000
--- a/drivers/gpu/drm/nouveau/nouveau_drm.c
+++ b/drivers/gpu/drm/nouveau/nouveau_drm.c
@@@ -806,21 -879,6 +801,24 @@@ nouveau_pmops_runtime_idle(struct devic
  		return -EBUSY;
  	}
  
++<<<<<<< HEAD
 +	/* if we have a hdmi audio device - make sure it has a driver loaded */
 +	if (drm->hdmi_device) {
 +		if (!drm->hdmi_device->driver) {
 +			DRM_DEBUG_DRIVER("failing to power off - no HDMI audio driver loaded\n");
 +			pm_runtime_mark_last_busy(dev);
 +			return -EBUSY;
 +		}
 +	}
 +
 +	list_for_each_entry(crtc, &drm->dev->mode_config.crtc_list, head) {
 +		if (crtc->enabled) {
 +			DRM_DEBUG_DRIVER("failing to power off - crtc active\n");
 +			return -EBUSY;
 +		}
 +	}
++=======
++>>>>>>> 68fe23a626b6 (drm/nouveau: Remove bogus crtc check in pmops_runtime_idle)
  	pm_runtime_mark_last_busy(dev);
  	pm_runtime_autosuspend(dev);
  	/* we don't want the main rpm_idle to call suspend - we want to autosuspend */
* Unmerged path drivers/gpu/drm/nouveau/nouveau_drm.c
