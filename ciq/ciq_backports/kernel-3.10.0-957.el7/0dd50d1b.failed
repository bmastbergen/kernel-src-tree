random32: add prandom_seed_full_state helper

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
commit-author Daniel Borkmann <daniel@iogearbox.net>
commit 0dd50d1b0c003ab4f17597fe1198bb57a2fadc06
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/0dd50d1b.failed

Factor out the full reseed handling code that populates the state
through get_random_bytes() and runs prandom_warmup(). The resulting
prandom_seed_full_state() will be used later on in more than the
current __prandom_reseed() user. Fix also two minor whitespace
issues along the way.

	Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
	Acked-by: Hannes Frederic Sowa <hannes@stressinduktion.org>
	Acked-by: Alexei Starovoitov <ast@kernel.org>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 0dd50d1b0c003ab4f17597fe1198bb57a2fadc06)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	lib/random32.c
diff --cc lib/random32.c
index fa5da61ce7ad,36c09fb3fec9..000000000000
--- a/lib/random32.c
+++ b/lib/random32.c
@@@ -194,14 -198,13 +194,19 @@@ static int __init prandom_init(void
  {
  	int i;
  
 +#ifdef CONFIG_RANDOM32_SELFTEST
  	prandom_state_selftest();
 +#endif
  
  	for_each_possible_cpu(i) {
++<<<<<<< HEAD
 +		struct rnd_state *state = &per_cpu(net_rand_state,i);
++=======
+ 		struct rnd_state *state = &per_cpu(net_rand_state, i);
+ 		u32 weak_seed = (i + jiffies) ^ random_get_entropy();
++>>>>>>> 0dd50d1b0c00 (random32: add prandom_seed_full_state helper)
  
 -		prandom_seed_early(state, weak_seed, true);
 +		prandom_seed_very_weak(state, (i + jiffies) ^ random_get_entropy());
  		prandom_warmup(state);
  	}
  
* Unmerged path lib/random32.c
