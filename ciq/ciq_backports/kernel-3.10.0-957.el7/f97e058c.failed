platform/x86: wmi: Don't allow drivers to get each other's GUIDs

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [platform] x86: wmi: Don't allow drivers to get each other's GUID (Jarod Wilson) [1562200]
Rebuild_FUZZ: 91.53%
commit-author Mario Limonciello <mario.limonciello@dell.com>
commit f97e058cfe8032504e310bd5c20e35d640ef2858
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/f97e058c.failed

The only driver using this was dell-wmi, and it really was a hack.
The driver was getting a data attribute from another driver and this
type of action should not be encouraged.

Rather drivers that need to interact with one another should pass
data back and forth via exported functions.

	Signed-off-by: Mario Limonciello <mario.limonciello@dell.com>
	Reviewed-by: Edward O'Callaghan <quasisec@google.com>
	Reviewed-by: Pali Roh√°r <pali.rohar@gmail.com>
	Signed-off-by: Darren Hart (VMware) <dvhart@infradead.org>
(cherry picked from commit f97e058cfe8032504e310bd5c20e35d640ef2858)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/platform/x86/wmi.c
#	include/linux/wmi.h
diff --cc drivers/platform/x86/wmi.c
index ce57af6635c6,bcb41c1c7f52..000000000000
--- a/drivers/platform/x86/wmi.c
+++ b/drivers/platform/x86/wmi.c
@@@ -374,8 -332,42 +374,23 @@@ struct acpi_buffer *out
  
  	return status;
  }
 -
 -/**
 - * wmi_query_block - Return contents of a WMI block (deprecated)
 - * @guid_string: 36 char string of the form fa50ff2b-f2e8-45de-83fa-65417f2f49ba
 - * @instance: Instance index
 - * &out: Empty buffer to return the contents of the data block to
 - *
 - * Return the contents of an ACPI-WMI data block to a buffer
 - */
 -acpi_status wmi_query_block(const char *guid_string, u8 instance,
 -			    struct acpi_buffer *out)
 -{
 -	struct wmi_block *wblock;
 -
 -	if (!guid_string)
 -		return AE_BAD_PARAMETER;
 -
 -	if (!find_guid(guid_string, &wblock))
 -		return AE_ERROR;
 -
 -	return __query_block(wblock, instance, out);
 -}
  EXPORT_SYMBOL_GPL(wmi_query_block);
  
++<<<<<<< HEAD
++=======
+ union acpi_object *wmidev_block_query(struct wmi_device *wdev, u8 instance)
+ {
+ 	struct acpi_buffer out = { ACPI_ALLOCATE_BUFFER, NULL };
+ 	struct wmi_block *wblock = container_of(wdev, struct wmi_block, dev);
+ 
+ 	if (ACPI_FAILURE(__query_block(wblock, instance, &out)))
+ 		return NULL;
+ 
+ 	return (union acpi_object *)out.pointer;
+ }
+ EXPORT_SYMBOL_GPL(wmidev_block_query);
+ 
++>>>>>>> f97e058cfe80 (platform/x86: wmi: Don't allow drivers to get each other's GUIDs)
  /**
   * wmi_set_block - Write to a WMI block
   * @guid_string: 36 char string of the form fa50ff2b-f2e8-45de-83fa-65417f2f49ba
* Unmerged path include/linux/wmi.h
* Unmerged path drivers/platform/x86/wmi.c
* Unmerged path include/linux/wmi.h
