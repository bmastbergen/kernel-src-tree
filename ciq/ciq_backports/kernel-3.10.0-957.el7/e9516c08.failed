perf script: Add missing separator for "-F ip,brstack" (and brstackoff)

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [tools] perf script: Add missing separator for "-F ip, brstack" (and brstackoff) (Jiri Olsa) [1540862]
Rebuild_FUZZ: 99.30%
commit-author Mark Santaniello <marksan@fb.com>
commit e9516c0813aeb89ebd19ec0ed39fbfcd78b6ef3a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/e9516c08.failed

Prior to commit 55b9b50811ca ("perf script: Support -F brstack,dso and
brstacksym,dso"), we were printing a space before the brstack data. It
seems that this space was important.  Without it, parsing is difficult.

Very sorry for the mistake.

Notice here how the "ip" and "brstack" run together:

$ perf script -F ip,brstack | head -n 1
          22e18c40x22e19e2/0x22e190b/P/-/-/0 0x22e19a1/0x22e19d0/P/-/-/0 0x22e195d/0x22e1990/P/-/-/0 0x22e18e9/0x22e1943/P/-/-/0 0x22e1a69/0x22e18c0/P/-/-/0 0x22e19f7/0x22e1a20/P/-/-/0 0x22e1910/0x22e19ee/P/-/-/0 0x22e19e2/0x22e190b/P/-/-/0 0x22e19a1/0x22e19d0/P/-/-/0 0x22e195d/0x22e1990/P/-/-/0 0x22e18e9/0x22e1943/P/-/-/0 0x22e1a69/0x22e18c0/P/-/-/0 0x22e19f7/0x22e1a20/P/-/-/0 0x22e1910/0x22e19ee/P/-/-/0 0x22e19e2/0x22e190b/P/-/-/0 0x22e19a1/0x22e19d0/P/-/-/0

After this diff, sanity is restored:

$ perf script -F ip,brstack | head -n 1
          22e18c4 0x22e19e2/0x22e190b/P/-/-/0  0x22e19a1/0x22e19d0/P/-/-/0  0x22e195d/0x22e1990/P/-/-/0  0x22e18e9/0x22e1943/P/-/-/0  0x22e1a69/0x22e18c0/P/-/-/0  0x22e19f7/0x22e1a20/P/-/-/0  0x22e1910/0x22e19ee/P/-/-/0  0x22e19e2/0x22e190b/P/-/-/0  0x22e19a1/0x22e19d0/P/-/-/0  0x22e195d/0x22e1990/P/-/-/0  0x22e18e9/0x22e1943/P/-/-/0  0x22e1a69/0x22e18c0/P/-/-/0  0x22e19f7/0x22e1a20/P/-/-/0  0x22e1910/0x22e19ee/P/-/-/0  0x22e19e2/0x22e190b/P/-/-/0  0x22e19a1/0x22e19d0/P/-/-/0

	Signed-off-by: Mark Santaniello <marksan@fb.com>
	Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: 4.13+ <stable@vger.kernel.org>
Fixes: 55b9b50811ca ("perf script: Support -F brstack,dso and brstacksym,dso")
Link: http://lkml.kernel.org/r/20171006080722.3442046-1-marksan@fb.com
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit e9516c0813aeb89ebd19ec0ed39fbfcd78b6ef3a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/builtin-script.c
diff --cc tools/perf/builtin-script.c
index 5d6697e4eb08,0c977b6e0f8b..000000000000
--- a/tools/perf/builtin-script.c
+++ b/tools/perf/builtin-script.c
@@@ -558,9 -576,31 +558,37 @@@ static void print_sample_brstack(struc
  		return;
  
  	for (i = 0; i < br->nr; i++) {
++<<<<<<< HEAD
 +		printf(" 0x%"PRIx64"/0x%"PRIx64"/%c/%c/%c/%d ",
 +			br->entries[i].from,
 +			br->entries[i].to,
++=======
+ 		from = br->entries[i].from;
+ 		to   = br->entries[i].to;
+ 
+ 		if (PRINT_FIELD(DSO)) {
+ 			memset(&alf, 0, sizeof(alf));
+ 			memset(&alt, 0, sizeof(alt));
+ 			thread__find_addr_map(thread, sample->cpumode, MAP__FUNCTION, from, &alf);
+ 			thread__find_addr_map(thread, sample->cpumode, MAP__FUNCTION, to, &alt);
+ 		}
+ 
+ 		printf(" 0x%"PRIx64, from);
+ 		if (PRINT_FIELD(DSO)) {
+ 			printf("(");
+ 			map__fprintf_dsoname(alf.map, stdout);
+ 			printf(")");
+ 		}
+ 
+ 		printf("/0x%"PRIx64, to);
+ 		if (PRINT_FIELD(DSO)) {
+ 			printf("(");
+ 			map__fprintf_dsoname(alt.map, stdout);
+ 			printf(")");
+ 		}
+ 
+ 		printf("/%c/%c/%c/%d ",
++>>>>>>> e9516c0813ae (perf script: Add missing separator for "-F ip,brstack" (and brstackoff))
  			mispred_str( br->entries + i),
  			br->entries[i].flags.in_tx? 'X' : '-',
  			br->entries[i].flags.abort? 'A' : '-',
@@@ -604,6 -655,51 +632,54 @@@ static void print_sample_brstacksym(str
  	}
  }
  
++<<<<<<< HEAD
++=======
+ static void print_sample_brstackoff(struct perf_sample *sample,
+ 				    struct thread *thread,
+ 				    struct perf_event_attr *attr)
+ {
+ 	struct branch_stack *br = sample->branch_stack;
+ 	struct addr_location alf, alt;
+ 	u64 i, from, to;
+ 
+ 	if (!(br && br->nr))
+ 		return;
+ 
+ 	for (i = 0; i < br->nr; i++) {
+ 
+ 		memset(&alf, 0, sizeof(alf));
+ 		memset(&alt, 0, sizeof(alt));
+ 		from = br->entries[i].from;
+ 		to   = br->entries[i].to;
+ 
+ 		thread__find_addr_map(thread, sample->cpumode, MAP__FUNCTION, from, &alf);
+ 		if (alf.map && !alf.map->dso->adjust_symbols)
+ 			from = map__map_ip(alf.map, from);
+ 
+ 		thread__find_addr_map(thread, sample->cpumode, MAP__FUNCTION, to, &alt);
+ 		if (alt.map && !alt.map->dso->adjust_symbols)
+ 			to = map__map_ip(alt.map, to);
+ 
+ 		printf(" 0x%"PRIx64, from);
+ 		if (PRINT_FIELD(DSO)) {
+ 			printf("(");
+ 			map__fprintf_dsoname(alf.map, stdout);
+ 			printf(")");
+ 		}
+ 		printf("/0x%"PRIx64, to);
+ 		if (PRINT_FIELD(DSO)) {
+ 			printf("(");
+ 			map__fprintf_dsoname(alt.map, stdout);
+ 			printf(")");
+ 		}
+ 		printf("/%c/%c/%c/%d ",
+ 			mispred_str(br->entries + i),
+ 			br->entries[i].flags.in_tx ? 'X' : '-',
+ 			br->entries[i].flags.abort ? 'A' : '-',
+ 			br->entries[i].flags.cycles);
+ 	}
+ }
++>>>>>>> e9516c0813ae (perf script: Add missing separator for "-F ip,brstack" (and brstackoff))
  #define MAXBB 16384UL
  
  static int grab_bb(u8 *buffer, u64 start, u64 end,
* Unmerged path tools/perf/builtin-script.c
