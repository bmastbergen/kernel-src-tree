Input: psmouse - use IS_ENABLED instead of homegrown code

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [input] psmouse - use IS_ENABLED instead of homegrown code (Benjamin Tissoires) [1554926]
Rebuild_FUZZ: 93.46%
commit-author Dmitry Torokhov <dmitry.torokhov@gmail.com>
commit 290b799c390d77d27effee3ce312203aaa32ee74
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/290b799c.failed

Instead of having various protocols provide <protocol>_supported()
functions, let's use IS_ENABLED() macro that works well in "if" statements.

	Acked-by: Hans de Goede <hdegoede@redhat.com>
	Reviewed-by: Benjamin Tissoires <benjamin.tissoires@redhat.com>
	Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
(cherry picked from commit 290b799c390d77d27effee3ce312203aaa32ee74)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/input/mouse/focaltech.c
#	drivers/input/mouse/focaltech.h
#	drivers/input/mouse/psmouse-base.c
diff --cc drivers/input/mouse/psmouse-base.c
index d248b118a8db,4ccd01d7a48d..000000000000
--- a/drivers/input/mouse/psmouse-base.c
+++ b/drivers/input/mouse/psmouse-base.c
@@@ -723,6 -723,24 +723,27 @@@ static int psmouse_extensions(struct ps
  {
  	bool synaptics_hardware = false;
  
++<<<<<<< HEAD
++=======
+ /* Always check for focaltech, this is safe as it uses pnp-id matching */
+ 	if (psmouse_do_detect(focaltech_detect, psmouse, set_properties) == 0) {
+ 		if (max_proto > PSMOUSE_IMEX) {
+ 			if (!set_properties || focaltech_init(psmouse) == 0) {
+ 				if (IS_ENABLED(CONFIG_MOUSE_PS2_FOCALTECH))
+ 					return PSMOUSE_FOCALTECH;
+ 				/*
+ 				 * Note that we need to also restrict
+ 				 * psmouse_max_proto so that psmouse_initialize()
+ 				 * does not try to reset rate and resolution,
+ 				 * because even that upsets the device.
+ 				 */
+ 				psmouse_max_proto = PSMOUSE_PS2;
+ 				return PSMOUSE_PS2;
+ 			}
+ 		}
+ 	}
+ 
++>>>>>>> 290b799c390d (Input: psmouse - use IS_ENABLED instead of homegrown code)
  /*
   * We always check for lifebook because it does not disturb mouse
   * (it only checks DMI information).
* Unmerged path drivers/input/mouse/focaltech.c
* Unmerged path drivers/input/mouse/focaltech.h
diff --git a/drivers/input/mouse/cypress_ps2.c b/drivers/input/mouse/cypress_ps2.c
index 888a81a7ea3d..80f793505563 100644
--- a/drivers/input/mouse/cypress_ps2.c
+++ b/drivers/input/mouse/cypress_ps2.c
@@ -712,8 +712,3 @@ err_exit:
 
 	return -1;
 }
-
-bool cypress_supported(void)
-{
-	return true;
-}
diff --git a/drivers/input/mouse/cypress_ps2.h b/drivers/input/mouse/cypress_ps2.h
index 4720f21d2d70..81f68aaed7c8 100644
--- a/drivers/input/mouse/cypress_ps2.h
+++ b/drivers/input/mouse/cypress_ps2.h
@@ -172,7 +172,6 @@ struct cytp_data {
 #ifdef CONFIG_MOUSE_PS2_CYPRESS
 int cypress_detect(struct psmouse *psmouse, bool set_properties);
 int cypress_init(struct psmouse *psmouse);
-bool cypress_supported(void);
 #else
 inline int cypress_detect(struct psmouse *psmouse, bool set_properties)
 {
@@ -182,10 +181,6 @@ inline int cypress_init(struct psmouse *psmouse)
 {
 	return -ENOSYS;
 }
-inline bool cypress_supported(void)
-{
-	return 0;
-}
 #endif /* CONFIG_MOUSE_PS2_CYPRESS */
 
 #endif  /* _CYPRESS_PS2_H */
* Unmerged path drivers/input/mouse/focaltech.c
* Unmerged path drivers/input/mouse/focaltech.h
* Unmerged path drivers/input/mouse/psmouse-base.c
diff --git a/drivers/input/mouse/synaptics.c b/drivers/input/mouse/synaptics.c
index 550042022186..d949bc4d38c0 100644
--- a/drivers/input/mouse/synaptics.c
+++ b/drivers/input/mouse/synaptics.c
@@ -1803,11 +1803,6 @@ int synaptics_init_relative(struct psmouse *psmouse)
 	return __synaptics_init(psmouse, false);
 }
 
-bool synaptics_supported(void)
-{
-	return true;
-}
-
 #else /* CONFIG_MOUSE_PS2_SYNAPTICS */
 
 void __init synaptics_module_init(void)
@@ -1819,9 +1814,4 @@ int synaptics_init(struct psmouse *psmouse)
 	return -ENOSYS;
 }
 
-bool synaptics_supported(void)
-{
-	return false;
-}
-
 #endif /* CONFIG_MOUSE_PS2_SYNAPTICS */
diff --git a/drivers/input/mouse/synaptics.h b/drivers/input/mouse/synaptics.h
index 361ee6c9fc9c..f773046995ee 100644
--- a/drivers/input/mouse/synaptics.h
+++ b/drivers/input/mouse/synaptics.h
@@ -212,6 +212,5 @@ int synaptics_detect(struct psmouse *psmouse, bool set_properties);
 int synaptics_init(struct psmouse *psmouse);
 int synaptics_init_relative(struct psmouse *psmouse);
 void synaptics_reset(struct psmouse *psmouse);
-bool synaptics_supported(void);
 
 #endif /* _SYNAPTICS_H */
