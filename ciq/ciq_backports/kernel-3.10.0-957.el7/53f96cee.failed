watchdog: pretimeout: add option to select a pretimeout governor in runtime

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [watchdog] pretimeout: add option to select a pretimeout governor in runtime (David Arcari) [1576173]
Rebuild_FUZZ: 92.86%
commit-author Vladimir Zapolskiy <vladimir_zapolskiy@mentor.com>
commit 53f96cee1aff74c8ee3c5f7a25df0c01d7117eeb
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/53f96cee.failed

The change converts watchdog device attribute "pretimeout_governor" from
read-only to read-write type to allow users to select a desirable
watchdog pretimeout governor in runtime, e.g.

  % echo -n panic > /sys/..../watchdog/watchdog0/pretimeout

To get this working a list of registered pretimeout governors is created
and a new helper function watchdog_pretimeout_governor_set() is exported
to watchdog_dev.c.

If a selected governor is gone, a watchdog device pretimeout notification
is delegated to a default built-in pretimeout governor.

	Signed-off-by: Vladimir Zapolskiy <vladimir_zapolskiy@mentor.com>
	Reviewed-by: Guenter Roeck <linux@roeck-us.net>
	Reviewed-by: Wolfram Sang <wsa+renesas@sang-engineering.com>
	Tested-by: Wolfram Sang <wsa+renesas@sang-engineering.com>
	Signed-off-by: Guenter Roeck <linux@roeck-us.net>
	Signed-off-by: Wim Van Sebroeck <wim@iguana.be>
(cherry picked from commit 53f96cee1aff74c8ee3c5f7a25df0c01d7117eeb)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/watchdog/watchdog_dev.c
#	drivers/watchdog/watchdog_pretimeout.c
#	drivers/watchdog/watchdog_pretimeout.h
diff --cc drivers/watchdog/watchdog_dev.c
index f06fbcf0bea2,3fdbe0ab1365..000000000000
--- a/drivers/watchdog/watchdog_dev.c
+++ b/drivers/watchdog/watchdog_dev.c
@@@ -326,6 -489,29 +326,32 @@@ static ssize_t state_show(struct devic
  }
  static DEVICE_ATTR_RO(state);
  
++<<<<<<< HEAD
++=======
+ static ssize_t pretimeout_governor_show(struct device *dev,
+ 					struct device_attribute *attr,
+ 					char *buf)
+ {
+ 	struct watchdog_device *wdd = dev_get_drvdata(dev);
+ 
+ 	return watchdog_pretimeout_governor_get(wdd, buf);
+ }
+ 
+ static ssize_t pretimeout_governor_store(struct device *dev,
+ 					 struct device_attribute *attr,
+ 					 const char *buf, size_t count)
+ {
+ 	struct watchdog_device *wdd = dev_get_drvdata(dev);
+ 	int ret = watchdog_pretimeout_governor_set(wdd, buf);
+ 
+ 	if (!ret)
+ 		ret = count;
+ 
+ 	return ret;
+ }
+ static DEVICE_ATTR_RW(pretimeout_governor);
+ 
++>>>>>>> 53f96cee1aff (watchdog: pretimeout: add option to select a pretimeout governor in runtime)
  static umode_t wdt_is_visible(struct kobject *kobj, struct attribute *attr,
  				int n)
  {
* Unmerged path drivers/watchdog/watchdog_pretimeout.c
* Unmerged path drivers/watchdog/watchdog_pretimeout.h
* Unmerged path drivers/watchdog/watchdog_dev.c
* Unmerged path drivers/watchdog/watchdog_pretimeout.c
* Unmerged path drivers/watchdog/watchdog_pretimeout.h
