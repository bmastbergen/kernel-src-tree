platform/x86: dell-laptop: fix kbd_get_state's request value

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [platform] x86: dell-laptop: fix kbd_get_state's request value (Jarod Wilson) [1517197]
Rebuild_FUZZ: 91.89%
commit-author Laszlo Toth <laszlth@gmail.com>
commit eca39e7f0cdb9bde4003a29149fa695e876c6f73
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/eca39e7f.failed

Commit 9862b43624a5 ("platform/x86: dell-laptop: Allocate buffer on heap
rather than globally")
broke one request, changed it back to the original value.

Tested on a Dell E6540, backlight came back.

Fixes: 9862b43624a5 ("platform/x86: dell-laptop: Allocate buffer on heap rather than globally")
	Signed-off-by: Laszlo Toth <laszlth@gmail.com>
	Reviewed-by: Pali Roh√°r <pali.rohar@gmail.com>
	Reviewed-by: Mario Limonciello <mario.limonciello@dell.com>
	Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
(cherry picked from commit eca39e7f0cdb9bde4003a29149fa695e876c6f73)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/platform/x86/dell-laptop.c
diff --cc drivers/platform/x86/dell-laptop.c
index 0a437b60caef,a37cff9fd8d4..000000000000
--- a/drivers/platform/x86/dell-laptop.c
+++ b/drivers/platform/x86/dell-laptop.c
@@@ -1318,21 -1276,16 +1318,29 @@@ static int kbd_set_level(struct kbd_sta
  
  static int kbd_get_state(struct kbd_state *state)
  {
 -	struct calling_interface_buffer buffer;
 +	struct calling_interface_buffer *buffer;
  	int ret;
  
++<<<<<<< HEAD
 +	buffer = dell_smbios_get_buffer();
++=======
+ 	dell_fill_request(&buffer, 0x1, 0, 0, 0);
+ 	ret = dell_send_request(&buffer,
+ 				CLASS_KBD_BACKLIGHT, SELECT_KBD_BACKLIGHT);
+ 	if (ret)
+ 		return ret;
++>>>>>>> eca39e7f0cdb (platform/x86: dell-laptop: fix kbd_get_state's request value)
 +
 +	buffer->input[0] = 0x1;
 +	dell_smbios_send_request(4, 11);
 +	ret = buffer->output[0];
  
 -	state->mode_bit = ffs(buffer.output[1] & 0xFFFF);
 +	if (ret) {
 +		ret = dell_smbios_error(ret);
 +		goto out;
 +	}
 +
 +	state->mode_bit = ffs(buffer->output[1] & 0xFFFF);
  	if (state->mode_bit != 0)
  		state->mode_bit--;
  
* Unmerged path drivers/platform/x86/dell-laptop.c
