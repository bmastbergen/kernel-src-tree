ixgbe: fix build err, num_rx_queues is only available with CONFIG_RPS

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
commit-author John Fastabend <john.fastabend@gmail.com>
commit 219354d4897fe06cb10d68308c14128a1e3fc074
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/219354d4.failed

In the recent support for layer 2 hardware acceleration, I added a
few references to real_num_rx_queues and num_rx_queues which are
only available with CONFIG_RPS.

The fix is first to remove unnecessary references to num_rx_queues.
Because the hardware offload case is limited to cases where RX queues
and TX queues are equal we only need a single check. Then wrap the
single case in an ifdef.

The patch that introduce this is here,

commit a6cc0cfa72e0b6d9f2c8fd858aacc32313c4f272
Author: John Fastabend <john.r.fastabend@intel.com>
Date:   Wed Nov 6 09:54:46 2013 -0800

    net: Add layer 2 hardware acceleration operations for macvlan devices

	Reported-by: kbuild test robot <fengguang.wu@intel.com>
	Signed-off-by: John Fastabend <john.r.fastabend@intel.com>
	Acked-by: Neil Horman <nhorman@tuxdriver.com>
	Acked-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 219354d4897fe06cb10d68308c14128a1e3fc074)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
diff --cc drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
index 90f60ed0b65b,2e17c307c6df..000000000000
--- a/drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
+++ b/drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
@@@ -9458,19 -7536,17 +9456,28 @@@ static void *ixgbe_fwd_add(struct net_d
  {
  	struct ixgbe_fwd_adapter *fwd_adapter = NULL;
  	struct ixgbe_adapter *adapter = netdev_priv(pdev);
 +	int used_pools = adapter->num_vfs + adapter->num_rx_pools;
  	int pool, err;
  
++<<<<<<< HEAD
 +	/* Hardware has a limited number of available pools. Each VF, and the
 +	 * PF require a pool. Check to ensure we don't attempt to use more
 +	 * then the available number of pools.
 +	 */
 +	if (used_pools >= IXGBE_MAX_VF_FUNCTIONS)
 +		return ERR_PTR(-EINVAL);
 +
++=======
+ #ifdef CONFIG_RPS
+ 	if (vdev->num_rx_queues != vdev->num_tx_queues) {
+ 		netdev_info(pdev, "%s: Only supports a single queue count for TX and RX\n",
+ 			    vdev->name);
+ 		return ERR_PTR(-EINVAL);
+ 	}
+ #endif
++>>>>>>> 219354d4897f (ixgbe: fix build err, num_rx_queues is only available with CONFIG_RPS)
  	/* Check for hardware restriction on number of rx/tx queues */
- 	if (vdev->num_rx_queues != vdev->num_tx_queues ||
- 	    vdev->num_tx_queues > IXGBE_MAX_L2A_QUEUES ||
+ 	if (vdev->num_tx_queues > IXGBE_MAX_L2A_QUEUES ||
  	    vdev->num_tx_queues == IXGBE_BAD_L2A_QUEUE) {
  		netdev_info(pdev,
  			    "%s: Supports RX/TX Queue counts 1,2, and 4\n",
* Unmerged path drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
