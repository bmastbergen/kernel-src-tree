iio: core: Introduce CHANGE event type

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [iio] core: Introduce CHANGE event type (Tony Camuso) [1559170]
Rebuild_FUZZ: 92.96%
commit-author Irina Tirdea <irina.tirdea@intel.com>
commit 27be84236d75c13a83c45d850390f40b58401d97
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/27be8423.failed

A step detector will generate an interrupt each time N step are detected.
A device that has such pedometer functionality is Freescale's MMA9553L:
http://www.freescale.com/files/sensors/doc/ref_manual/MMA9553LSWRM.pdf.

Introduce IIO_EV_TYPE_CHANGE event type for events that are generated
when the channel passes a threshold on the absolute change in value.

	Signed-off-by: Irina Tirdea <irina.tirdea@intel.com>
	Signed-off-by: Jonathan Cameron <jic23@kernel.org>
(cherry picked from commit 27be84236d75c13a83c45d850390f40b58401d97)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	Documentation/ABI/testing/sysfs-bus-iio
#	drivers/iio/industrialio-event.c
#	drivers/staging/iio/Documentation/iio_event_monitor.c
#	include/linux/iio/types.h
diff --cc Documentation/ABI/testing/sysfs-bus-iio
index 7ba396de2c76,c03a1401b9ca..000000000000
--- a/Documentation/ABI/testing/sysfs-bus-iio
+++ b/Documentation/ABI/testing/sysfs-bus-iio
@@@ -768,6 -891,25 +768,28 @@@ Description
  		number or direction is not specified, applies to all channels of
  		this type.
  
++<<<<<<< HEAD
++=======
+ What:		/sys/.../events/in_steps_change_en
+ KernelVersion:	3.20
+ Contact:	linux-iio@vger.kernel.org
+ Description:
+ 		Event generated when channel passes a threshold on the absolute
+ 		change in value. E.g. for steps: a step change event is
+ 		generated each time the user takes N steps, where N is set using
+ 		in_steps_change_value.
+ 
+ What:		/sys/.../events/in_steps_change_value
+ KernelVersion:	3.20
+ Contact:	linux-iio@vger.kernel.org
+ Description:
+ 		Specifies the value of change threshold that the
+ 		device is comparing against for the events enabled by
+ 		<type>[Y][_name]_roc[_rising|falling|]_en. E.g. for steps:
+ 		if set to 3, a step change event will be generated every 3
+ 		steps.
+ 
++>>>>>>> 27be84236d75 (iio: core: Introduce CHANGE event type)
  What:		/sys/bus/iio/devices/iio:deviceX/trigger/current_trigger
  KernelVersion:	2.6.35
  Contact:	linux-iio@vger.kernel.org
diff --cc drivers/iio/industrialio-event.c
index e2b5f552eb77,b33ce55eb695..000000000000
--- a/drivers/iio/industrialio-event.c
+++ b/drivers/iio/industrialio-event.c
@@@ -185,6 -197,8 +185,11 @@@ static const char * const iio_ev_type_t
  	[IIO_EV_TYPE_ROC] = "roc",
  	[IIO_EV_TYPE_THRESH_ADAPTIVE] = "thresh_adaptive",
  	[IIO_EV_TYPE_MAG_ADAPTIVE] = "mag_adaptive",
++<<<<<<< HEAD
++=======
+ 	[IIO_EV_TYPE_INSTANCE] = "instance",
+ 	[IIO_EV_TYPE_CHANGE] = "change",
++>>>>>>> 27be84236d75 (iio: core: Introduce CHANGE event type)
  };
  
  static const char * const iio_ev_dir_text[] = {
diff --cc drivers/staging/iio/Documentation/iio_event_monitor.c
index 3a9b00087403,2e78d58b9b77..000000000000
--- a/drivers/staging/iio/Documentation/iio_event_monitor.c
+++ b/drivers/staging/iio/Documentation/iio_event_monitor.c
@@@ -54,6 -59,8 +54,11 @@@ static const char * const iio_ev_type_t
  	[IIO_EV_TYPE_ROC] = "roc",
  	[IIO_EV_TYPE_THRESH_ADAPTIVE] = "thresh_adaptive",
  	[IIO_EV_TYPE_MAG_ADAPTIVE] = "mag_adaptive",
++<<<<<<< HEAD
++=======
+ 	[IIO_EV_TYPE_INSTANCE] = "instance",
+ 	[IIO_EV_TYPE_CHANGE] = "change",
++>>>>>>> 27be84236d75 (iio: core: Introduce CHANGE event type)
  };
  
  static const char * const iio_ev_dir_text[] = {
@@@ -129,6 -179,8 +134,11 @@@ static bool event_is_known(struct iio_e
  	case IIO_EV_TYPE_ROC:
  	case IIO_EV_TYPE_THRESH_ADAPTIVE:
  	case IIO_EV_TYPE_MAG_ADAPTIVE:
++<<<<<<< HEAD
++=======
+ 	case IIO_EV_TYPE_INSTANCE:
+ 	case IIO_EV_TYPE_CHANGE:
++>>>>>>> 27be84236d75 (iio: core: Introduce CHANGE event type)
  		break;
  	default:
  		return false;
diff --cc include/linux/iio/types.h
index 63fb0a6c6ca4,3ba3d6678412..000000000000
--- a/include/linux/iio/types.h
+++ b/include/linux/iio/types.h
@@@ -73,6 -78,8 +73,11 @@@ enum iio_event_type 
  	IIO_EV_TYPE_ROC,
  	IIO_EV_TYPE_THRESH_ADAPTIVE,
  	IIO_EV_TYPE_MAG_ADAPTIVE,
++<<<<<<< HEAD
++=======
+ 	IIO_EV_TYPE_INSTANCE,
+ 	IIO_EV_TYPE_CHANGE,
++>>>>>>> 27be84236d75 (iio: core: Introduce CHANGE event type)
  };
  
  enum iio_event_info {
* Unmerged path Documentation/ABI/testing/sysfs-bus-iio
* Unmerged path drivers/iio/industrialio-event.c
* Unmerged path drivers/staging/iio/Documentation/iio_event_monitor.c
* Unmerged path include/linux/iio/types.h
