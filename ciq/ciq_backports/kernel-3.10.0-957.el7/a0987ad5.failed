dax: Create local variable for VMA in dax_iomap_pte_fault()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
commit-author Jan Kara <jack@suse.cz>
commit a0987ad5c576626fdb40547f5ac99b4f90608dda
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/a0987ad5.failed

There are already two users and more are coming.

	Reviewed-by: Christoph Hellwig <hch@lst.de>
	Reviewed-by: Ross Zwisler <ross.zwisler@linux.intel.com>
	Signed-off-by: Jan Kara <jack@suse.cz>
	Signed-off-by: Dan Williams <dan.j.williams@intel.com>
(cherry picked from commit a0987ad5c576626fdb40547f5ac99b4f90608dda)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/dax.c
diff --cc fs/dax.c
index 679214f8898b,c09465884bbe..000000000000
--- a/fs/dax.c
+++ b/fs/dax.c
@@@ -1179,13 -1106,13 +1179,14 @@@ static int dax_fault_return(int error
  }
  
  static int dax_iomap_pte_fault(struct vm_fault *vmf,
 -			       const struct iomap_ops *ops)
 +			const struct iomap_ops *ops)
  {
- 	struct address_space *mapping = vmf->vma->vm_file->f_mapping;
+ 	struct vm_area_struct *vma = vmf->vma;
+ 	struct address_space *mapping = vma->vm_file->f_mapping;
  	struct inode *inode = mapping->host;
 -	unsigned long vaddr = vmf->address;
 +	unsigned long vaddr = (unsigned long)vmf->virtual_address;
  	loff_t pos = (loff_t)vmf->pgoff << PAGE_SHIFT;
 +	sector_t sector;
  	struct iomap iomap = { 0 };
  	unsigned flags = IOMAP_FAULT;
  	int error, major = 0;
@@@ -1270,12 -1197,10 +1271,16 @@@
  	case IOMAP_MAPPED:
  		if (iomap.flags & IOMAP_F_NEW) {
  			count_vm_event(PGMAJFAULT);
++<<<<<<< HEAD
 +			mem_cgroup_count_vm_event(vmf->vma->vm_mm,
 +					PGMAJFAULT);
++=======
+ 			count_memcg_event_mm(vma->vm_mm, PGMAJFAULT);
++>>>>>>> a0987ad5c576 (dax: Create local variable for VMA in dax_iomap_pte_fault())
  			major = VM_FAULT_MAJOR;
  		}
 -		error = dax_insert_mapping(vmf, &iomap, pos, entry);
 +		error = dax_insert_mapping(mapping, iomap.bdev, iomap.dax_dev,
 +				sector, PAGE_SIZE, &entry, vmf->vma, vmf);
  		/* -EBUSY is fine, somebody else faulted on the same PTE */
  		if (error == -EBUSY)
  			error = 0;
* Unmerged path fs/dax.c
