libceph: make sure redirect does not change namespace

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
commit-author Yan, Zheng <zyan@redhat.com>
commit cd08e0a274ba6215b79c83809b331e8af17196ba
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/cd08e0a2.failed

	Signed-off-by: Yan, Zheng <zyan@redhat.com>
	Signed-off-by: Ilya Dryomov <idryomov@gmail.com>
(cherry picked from commit cd08e0a274ba6215b79c83809b331e8af17196ba)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ceph/osd_client.c
diff --cc net/ceph/osd_client.c
index 105036300de0,b5ec09612ff7..000000000000
--- a/net/ceph/osd_client.c
+++ b/net/ceph/osd_client.c
@@@ -3194,9 -2608,22 +3194,26 @@@ static int ceph_oloc_decode(void **p, v
  	}
  
  	if (struct_v >= 5) {
+ 		bool changed = false;
+ 
  		len = ceph_decode_32(p);
  		if (len > 0) {
++<<<<<<< HEAD
 +			pr_warn("ceph_object_locator::nspace is set\n");
++=======
+ 			ceph_decode_need(p, end, len, e_inval);
+ 			if (!oloc->pool_ns ||
+ 			    ceph_compare_string(oloc->pool_ns, *p, len))
+ 				changed = true;
+ 			*p += len;
+ 		} else {
+ 			if (oloc->pool_ns)
+ 				changed = true;
+ 		}
+ 		if (changed) {
+ 			/* redirect changes namespace */
+ 			pr_warn("ceph_object_locator::nspace is changed\n");
++>>>>>>> cd08e0a274ba (libceph: make sure redirect does not change namespace)
  			goto e_inval;
  		}
  	}
* Unmerged path net/ceph/osd_client.c
