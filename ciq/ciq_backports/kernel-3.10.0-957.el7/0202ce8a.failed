md: release allocated bitset sync_set

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
Rebuild_CHGLOG: - [md] release allocated bitset sync_set (Nigel Croxon) [1494474]
Rebuild_FUZZ: 94.29%
commit-author Zdenek Kabelac <zkabelac@redhat.com>
commit 0202ce8a90efdc81600e7bf9712d8c324081a924
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/0202ce8a.failed

Patch fixes kmemleak on md_stop() path used likely only by dm-raid wrapper.
Code of md is using  mddev_put() where both bitsets are released however this
freeing is not shared.

Also set NULL to bio_set and sync_set pointers just like mddev_put is
doing.

	Signed-off-by: Zdenek Kabelac <zkabelac@redhat.com>
	Signed-off-by: Shaohua Li <shli@fb.com>
(cherry picked from commit 0202ce8a90efdc81600e7bf9712d8c324081a924)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/md/md.c
diff --cc drivers/md/md.c
index 23c14e0358c0,e014d39159d7..000000000000
--- a/drivers/md/md.c
+++ b/drivers/md/md.c
@@@ -5769,9 -5852,14 +5769,19 @@@ void md_stop(struct mddev *mddev
  	 * This is called from dm-raid
  	 */
  	__md_stop(mddev);
++<<<<<<< HEAD
 +	bitmap_destroy(mddev);
 +	if (mddev->bio_set)
++=======
+ 	if (mddev->bio_set) {
++>>>>>>> 0202ce8a90ef (md: release allocated bitset sync_set)
  		bioset_free(mddev->bio_set);
+ 		mddev->bio_set = NULL;
+ 	}
+ 	if (mddev->sync_set) {
+ 		bioset_free(mddev->sync_set);
+ 		mddev->sync_set = NULL;
+ 	}
  }
  
  EXPORT_SYMBOL_GPL(md_stop);
* Unmerged path drivers/md/md.c
