perf: Fix documentation for sysctls perf_event_paranoid and perf_event_mlock_kb

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
commit-author Konstantin Khlebnikov <khlebnikov@yandex-team.ru>
commit ac0bb6b72f4bbab08f270a919406d971e73698b5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/ac0bb6b7.failed

Fix misprint CAP_IOC_LOCK -> CAP_IPC_LOCK. This capability have nothing
to do with raw tracepoints. This part is about bypassing mlock limits.

Sysctl kernel.perf_event_paranoid = -1 allows raw and ftrace function
tracepoints without CAP_SYS_ADMIN.

	Signed-off-by: Konstantin Khlebnikov <khlebnikov@yandex-team.ru>
	Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
	Cc: Peter Zijlstra <peterz@infradead.org>
Link: http://lkml.kernel.org/r/150322916080.129746.11285255474738558340.stgit@buzz
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit ac0bb6b72f4bbab08f270a919406d971e73698b5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	Documentation/sysctl/kernel.txt
diff --cc Documentation/sysctl/kernel.txt
index 425b3fd3f24b,ce61d1fe08ca..000000000000
--- a/Documentation/sysctl/kernel.txt
+++ b/Documentation/sysctl/kernel.txt
@@@ -60,6 -60,9 +60,12 @@@ show up in /proc/sys/kernel
  - panic_on_rcu_stall
  - perf_cpu_time_max_percent
  - perf_event_paranoid
++<<<<<<< HEAD
++=======
+ - perf_event_max_stack
+ - perf_event_mlock_kb
+ - perf_event_max_contexts_per_stack
++>>>>>>> ac0bb6b72f4b (perf: Fix documentation for sysctls perf_event_paranoid and perf_event_mlock_kb)
  - pid_max
  - powersave-nap               [ PPC only ]
  - printk
@@@ -644,6 -663,40 +652,43 @@@ users (without CAP_SYS_ADMIN).  The def
  
  ==============================================================
  
++<<<<<<< HEAD
++=======
+ perf_event_max_stack:
+ 
+ Controls maximum number of stack frames to copy for (attr.sample_type &
+ PERF_SAMPLE_CALLCHAIN) configured events, for instance, when using
+ 'perf record -g' or 'perf trace --call-graph fp'.
+ 
+ This can only be done when no events are in use that have callchains
+ enabled, otherwise writing to this file will return -EBUSY.
+ 
+ The default value is 127.
+ 
+ ==============================================================
+ 
+ perf_event_mlock_kb:
+ 
+ Control size of per-cpu ring buffer not counted agains mlock limit.
+ 
+ The default value is 512 + 1 page
+ 
+ ==============================================================
+ 
+ perf_event_max_contexts_per_stack:
+ 
+ Controls maximum number of stack frame context entries for
+ (attr.sample_type & PERF_SAMPLE_CALLCHAIN) configured events, for
+ instance, when using 'perf record -g' or 'perf trace --call-graph fp'.
+ 
+ This can only be done when no events are in use that have callchains
+ enabled, otherwise writing to this file will return -EBUSY.
+ 
+ The default value is 8.
+ 
+ ==============================================================
+ 
++>>>>>>> ac0bb6b72f4b (perf: Fix documentation for sysctls perf_event_paranoid and perf_event_mlock_kb)
  pid_max:
  
  PID allocation wrap value.  When the kernel's next PID value
* Unmerged path Documentation/sysctl/kernel.txt
diff --git a/tools/perf/util/evsel.c b/tools/perf/util/evsel.c
index 9020537666a5..3cd6d9549033 100644
--- a/tools/perf/util/evsel.c
+++ b/tools/perf/util/evsel.c
@@ -2615,7 +2615,9 @@ int perf_evsel__open_strerror(struct perf_evsel *evsel, struct target *target,
 		 "unprivileged users (without CAP_SYS_ADMIN).\n\n"
 		 "The current value is %d:\n\n"
 		 "  -1: Allow use of (almost) all events by all users\n"
-		 ">= 0: Disallow raw tracepoint access by users without CAP_IOC_LOCK\n"
+		 "      Ignore mlock limit after perf_event_mlock_kb without CAP_IPC_LOCK\n"
+		 ">= 0: Disallow ftrace function tracepoint by users without CAP_SYS_ADMIN\n"
+		 "      Disallow raw tracepoint access by users without CAP_SYS_ADMIN\n"
 		 ">= 1: Disallow CPU event access by users without CAP_SYS_ADMIN\n"
 		 ">= 2: Disallow kernel profiling by users without CAP_SYS_ADMIN\n\n"
 		 "To make this setting permanent, edit /etc/sysctl.conf too, e.g.:\n\n"
