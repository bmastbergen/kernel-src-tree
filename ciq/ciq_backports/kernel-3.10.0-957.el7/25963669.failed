ceph: don't check quota for snap inode

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-957.el7
commit-author Yan, Zheng <zyan@redhat.com>
commit 2596366907f872de7be0557720bb55bccf7489d9
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-957.el7/25963669.failed

snap inode's i_snap_realm is not pointing to ceph_snap_realm.

	Signed-off-by: "Yan, Zheng" <zyan@redhat.com>
	Signed-off-by: Ilya Dryomov <idryomov@gmail.com>
(cherry picked from commit 2596366907f872de7be0557720bb55bccf7489d9)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/ceph/dir.c
#	fs/ceph/quota.c
diff --cc fs/ceph/dir.c
index 83040cdc8671,6cd92a0e2af9..000000000000
--- a/fs/ceph/dir.c
+++ b/fs/ceph/dir.c
@@@ -947,6 -936,12 +947,15 @@@ static int ceph_mkdir(struct inode *dir
  		goto out;
  	}
  
++<<<<<<< HEAD
++=======
+ 	if (op == CEPH_MDS_OP_MKDIR &&
+ 	    ceph_quota_is_max_files_exceeded(dir)) {
+ 		err = -EDQUOT;
+ 		goto out;
+ 	}
+ 
++>>>>>>> 2596366907f8 (ceph: don't check quota for snap inode)
  	mode |= S_IFDIR;
  	err = ceph_pre_init_acls(dir, &mode, &acls);
  	if (err < 0)
* Unmerged path fs/ceph/quota.c
* Unmerged path fs/ceph/dir.c
* Unmerged path fs/ceph/quota.c
