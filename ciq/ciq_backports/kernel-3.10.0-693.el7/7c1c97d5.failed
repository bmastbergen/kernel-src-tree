net: sched: initialize bstats syncp

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [net] sched: initialize bstats syncp (Ivan Vecera) [1428588]
Rebuild_FUZZ: 92.31%
commit-author Sabrina Dubroca <sd@queasysnail.net>
commit 7c1c97d54f9bfc810908d3903cb8bcacf734df18
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/7c1c97d5.failed

Use netdev_alloc_pcpu_stats to allocate percpu stats and initialize syncp.

Fixes: 22e0f8b9322c "net: sched: make bstats per cpu and estimator RCU safe"
	Signed-off-by: Sabrina Dubroca <sd@queasysnail.net>
	Acked-by: Cong Wang <cwang@twopensource.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 7c1c97d54f9bfc810908d3903cb8bcacf734df18)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sched/sch_api.c
diff --cc net/sched/sch_api.c
index 41f2533fbfbd,76f402e05bd6..000000000000
--- a/net/sched/sch_api.c
+++ b/net/sched/sch_api.c
@@@ -945,6 -945,17 +945,20 @@@ qdisc_create(struct net_device *dev, st
  	sch->handle = handle;
  
  	if (!ops->init || (err = ops->init(sch, tca[TCA_OPTIONS])) == 0) {
++<<<<<<< HEAD
++=======
+ 		if (qdisc_is_percpu_stats(sch)) {
+ 			sch->cpu_bstats =
+ 				netdev_alloc_pcpu_stats(struct gnet_stats_basic_cpu);
+ 			if (!sch->cpu_bstats)
+ 				goto err_out4;
+ 
+ 			sch->cpu_qstats = alloc_percpu(struct gnet_stats_queue);
+ 			if (!sch->cpu_qstats)
+ 				goto err_out4;
+ 		}
+ 
++>>>>>>> 7c1c97d54f9b (net: sched: initialize bstats syncp)
  		if (tca[TCA_STAB]) {
  			stab = qdisc_get_stab(tca[TCA_STAB]);
  			if (IS_ERR(stab)) {
* Unmerged path net/sched/sch_api.c
