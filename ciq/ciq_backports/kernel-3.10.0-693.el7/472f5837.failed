net_sched: cls_bpf: remove unnecessary iteration and use passed arg

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [net] sched: cls_bpf: remove unnecessary iteration and use passed arg (Ivan Vecera) [1428588]
Rebuild_FUZZ: 96.92%
commit-author Jiri Pirko <jiri@resnulli.us>
commit 472f58370128d5e18f9d5429313a87d0f30af45e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/472f5837.failed

	Signed-off-by: Jiri Pirko <jiri@resnulli.us>
	Acked-by: Jamal Hadi Salim <jhs@mojatatu.com>
	Acked-by: Daniel Borkmann <dborkman@redhat.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 472f58370128d5e18f9d5429313a87d0f30af45e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sched/cls_bpf.c
diff --cc net/sched/cls_bpf.c
index f9a9a429c8cb,cbfaf6f8feb3..000000000000
--- a/net/sched/cls_bpf.c
+++ b/net/sched/cls_bpf.c
@@@ -98,23 -100,21 +98,32 @@@ static void cls_bpf_delete_prog(struct 
  	kfree(prog);
  }
  
 -static void __cls_bpf_delete_prog(struct rcu_head *rcu)
 -{
 -	struct cls_bpf_prog *prog = container_of(rcu, struct cls_bpf_prog, rcu);
 -
 -	cls_bpf_delete_prog(prog->tp, prog);
 -}
 -
  static int cls_bpf_delete(struct tcf_proto *tp, unsigned long arg)
  {
++<<<<<<< HEAD
 +	struct cls_bpf_head *head = tp->root;
 +	struct cls_bpf_prog *prog, *todel = (struct cls_bpf_prog *) arg;
 +
 +	list_for_each_entry(prog, &head->plist, link) {
 +		if (prog == todel) {
 +			tcf_tree_lock(tp);
 +			list_del(&prog->link);
 +			tcf_tree_unlock(tp);
 +
 +			cls_bpf_delete_prog(tp, prog);
 +			return 0;
 +		}
 +	}
 +
 +	return -ENOENT;
++=======
+ 	struct cls_bpf_prog *prog = (struct cls_bpf_prog *) arg;
+ 
+ 	list_del_rcu(&prog->link);
+ 	tcf_unbind_filter(tp, &prog->res);
+ 	call_rcu(&prog->rcu, __cls_bpf_delete_prog);
+ 	return 0;
++>>>>>>> 472f58370128 (net_sched: cls_bpf: remove unnecessary iteration and use passed arg)
  }
  
  static void cls_bpf_destroy(struct tcf_proto *tp)
* Unmerged path net/sched/cls_bpf.c
