net_sched: act: use tcf_hash_release() in net/sched/act_police.c

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [net] sched: act: use tcf_hash_release() in net/sched/act_police.c (Ivan Vecera) [1428588]
Rebuild_FUZZ: 96.77%
commit-author WANG Cong <xiyou.wangcong@gmail.com>
commit fb1d598d482d9fd448ea68895751bdfb8f29ee8e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/fb1d598d.failed

	Cc: Jamal Hadi Salim <jhs@mojatatu.com>
	Cc: David S. Miller <davem@davemloft.net>
	Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>
	Acked-by: Jamal Hadi Salim <jhs@mojatatu.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit fb1d598d482d9fd448ea68895751bdfb8f29ee8e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sched/act_police.c
diff --cc net/sched/act_police.c
index 376c02554325,5ba467b6124a..000000000000
--- a/net/sched/act_police.c
+++ b/net/sched/act_police.c
@@@ -111,29 -104,6 +111,32 @@@ nla_put_failure
  	goto done;
  }
  
++<<<<<<< HEAD
 +static void tcf_police_destroy(struct tcf_police *p)
 +{
 +	unsigned int h = tcf_hash(p->tcf_index, POL_TAB_MASK);
 +	struct tcf_common **p1p;
 +
 +	for (p1p = &tcf_police_ht[h]; *p1p; p1p = &(*p1p)->tcfc_next) {
 +		if (*p1p == &p->common) {
 +			write_lock_bh(&police_lock);
 +			*p1p = p->tcf_next;
 +			write_unlock_bh(&police_lock);
 +			gen_kill_estimator(&p->tcf_bstats,
 +					   &p->tcf_rate_est);
 +			/*
 +			 * gen_estimator est_timer() might access p->tcf_lock
 +			 * or bstats, wait a RCU grace period before freeing p
 +			 */
 +			kfree_rcu(p, tcf_rcu);
 +			return;
 +		}
 +	}
 +	WARN_ON(1);
 +}
 +
++=======
++>>>>>>> fb1d598d482d (net_sched: act: use tcf_hash_release() in net/sched/act_police.c)
  static const struct nla_policy police_policy[TCA_POLICE_MAX + 1] = {
  	[TCA_POLICE_RATE]	= { .len = TC_RTAB_SIZE },
  	[TCA_POLICE_PEAKRATE]	= { .len = TC_RTAB_SIZE },
* Unmerged path net/sched/act_police.c
