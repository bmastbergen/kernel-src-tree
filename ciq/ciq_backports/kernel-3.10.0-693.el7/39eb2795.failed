IB/hfi1: Remove redundant sysfs irq affinity entry

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Tadeusz Struk <tadeusz.struk@intel.com>
commit 39eb2795f19233330bc14a8450b4042d784b15a7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/39eb2795.failed

The IRQ affinity entry is not needed after the irq notifier patch has been
added to the hfi1 driver.
The irq affinity settings for SDMA engine should be set using the standard
/proc/irq/<N>/ interface.

	Reviewed-by: Jianxin Xiong <jianxin.xiong@intel.com>
	Signed-off-by: Tadeusz Struk <tadeusz.struk@intel.com>
	Signed-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 39eb2795f19233330bc14a8450b4042d784b15a7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/hfi1/affinity.c
#	drivers/infiniband/hw/hfi1/affinity.h
diff --cc drivers/infiniband/hw/hfi1/affinity.c
index 1ca2154de24c,67ea85a56945..000000000000
--- a/drivers/infiniband/hw/hfi1/affinity.c
+++ b/drivers/infiniband/hw/hfi1/affinity.c
@@@ -423,6 -773,5 +423,9 @@@ void hfi1_put_proc_affinity(struct hfi1
  		set->gen--;
  		cpumask_copy(&set->used, &set->mask);
  	}
 -	mutex_unlock(&affinity->lock);
 +	spin_unlock(&dd->affinity->lock);
  }
++<<<<<<< HEAD
 +
++=======
++>>>>>>> 39eb2795f192 (IB/hfi1: Remove redundant sysfs irq affinity entry)
diff --cc drivers/infiniband/hw/hfi1/affinity.h
index 20f52fe74091,42e63316afd1..000000000000
--- a/drivers/infiniband/hw/hfi1/affinity.h
+++ b/drivers/infiniband/hw/hfi1/affinity.h
@@@ -101,8 -98,30 +101,34 @@@ void hfi1_put_irq_affinity(struct hfi1_
   * Determine a CPU affinity for a user process, if the process does not
   * have an affinity set yet.
   */
 -int hfi1_get_proc_affinity(int);
 +int hfi1_get_proc_affinity(struct hfi1_devdata *, int);
  /* Release a CPU used by a user process. */
++<<<<<<< HEAD
 +void hfi1_put_proc_affinity(struct hfi1_devdata *, int);
++=======
+ void hfi1_put_proc_affinity(int);
+ 
+ struct hfi1_affinity_node {
+ 	int node;
+ 	struct cpu_mask_set def_intr;
+ 	struct cpu_mask_set rcv_intr;
+ 	struct cpumask general_intr_mask;
+ 	struct list_head list;
+ };
+ 
+ struct hfi1_affinity_node_list {
+ 	struct list_head list;
+ 	struct cpumask real_cpu_mask;
+ 	struct cpu_mask_set proc;
+ 	int num_core_siblings;
+ 	int num_online_nodes;
+ 	int num_online_cpus;
+ 	struct mutex lock; /* protects affinity nodes */
+ };
+ 
+ int node_affinity_init(void);
+ void node_affinity_destroy(void);
+ extern struct hfi1_affinity_node_list node_affinity;
++>>>>>>> 39eb2795f192 (IB/hfi1: Remove redundant sysfs irq affinity entry)
  
  #endif /* _HFI1_AFFINITY_H */
* Unmerged path drivers/infiniband/hw/hfi1/affinity.c
* Unmerged path drivers/infiniband/hw/hfi1/affinity.h
