NVMe: don't allocate unused nvme_major

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [nvme] don't allocate unused nvme_major (David Milburn) [1384526 1389755 1366753 1374291 1383834]
Rebuild_FUZZ: 91.43%
commit-author NeilBrown <neilb@suse.com>
commit b09dcf585df959cf26270e65941ea1f79a1345aa
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/b09dcf58.failed

When alloc_disk(0) is used, the ->major number is ignored.  All device
numbers are allocated with a major of BLOCK_EXT_MAJOR.

So remove all references to nvme_major.

[akpm@linux-foundation.org: one unregister_blkdev() was missed]
Link: http://lkml.kernel.org/r/20160602064318.4403.93301.stgit@noble
	Signed-off-by: NeilBrown <neilb@suse.com>
	Reviewed-by: Keith Busch <keith.busch@intel.com>
	Cc: Jens Axboe <axboe@kernel.dk>
	Cc: Maxim Levitsky <maximlevitsky@gmail.com>
	Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
	Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
	Signed-off-by: Jens Axboe <axboe@fb.com>
(cherry picked from commit b09dcf585df959cf26270e65941ea1f79a1345aa)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/nvme/host/core.c
diff --cc drivers/nvme/host/core.c
index 63f6b5f40b5c,cf4b75088876..000000000000
--- a/drivers/nvme/host/core.c
+++ b/drivers/nvme/host/core.c
@@@ -45,8 -48,10 +45,15 @@@ unsigned char shutdown_timeout = 5
  module_param(shutdown_timeout, byte, 0644);
  MODULE_PARM_DESC(shutdown_timeout, "timeout in seconds for controller shutdown");
  
++<<<<<<< HEAD
 +static int nvme_major;
 +module_param(nvme_major, int, 0);
++=======
+ unsigned int nvme_max_retries = 5;
+ module_param_named(max_retries, nvme_max_retries, uint, 0644);
+ MODULE_PARM_DESC(max_retries, "max number of retries a command may have");
+ EXPORT_SYMBOL_GPL(nvme_max_retries);
++>>>>>>> b09dcf585df9 (NVMe: don't allocate unused nvme_major)
  
  static int nvme_char_major;
  module_param(nvme_char_major, int, 0);
@@@ -1592,5 -2104,9 +1589,4 @@@ void nvme_core_exit(void
  {
  	class_destroy(nvme_class);
  	__unregister_chrdev(nvme_char_major, 0, NVME_MINORS, "nvme");
- 	unregister_blkdev(nvme_major, "nvme");
  }
 -
 -MODULE_LICENSE("GPL");
 -MODULE_VERSION("1.0");
 -module_init(nvme_core_init);
 -module_exit(nvme_core_exit);
* Unmerged path drivers/nvme/host/core.c
