net/sched: matchall: Fix configuration race

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [net] sched: matchall: Fix configuration race (Ivan Vecera) [1382040]
Rebuild_FUZZ: 95.12%
commit-author Yotam Gigi <yotamg@mellanox.com>
commit fd62d9f5c575f0792f150109f1fd24a0d4b3f854
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/fd62d9f5.failed

In the current version, the matchall internal state is split into two
structs: cls_matchall_head and cls_matchall_filter. This makes little
sense, as matchall instance supports only one filter, and there is no
situation where one exists and the other does not. In addition, that led
to some races when filter was deleted while packet was processed.

Unify that two structs into one, thus simplifying the process of matchall
creation and deletion. As a result, the new, delete and get callbacks have
a dummy implementation where all the work is done in destroy and change
callbacks, as was done in cls_cgroup.

Fixes: bf3994d2ed31 ("net/sched: introduce Match-all classifier")
	Reported-by: Daniel Borkmann <daniel@iogearbox.net>
	Signed-off-by: Yotam Gigi <yotamg@mellanox.com>
	Acked-by: Jiri Pirko <jiri@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit fd62d9f5c575f0792f150109f1fd24a0d4b3f854)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sched/cls_matchall.c
* Unmerged path net/sched/cls_matchall.c
* Unmerged path net/sched/cls_matchall.c
