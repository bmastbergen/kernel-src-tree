vhost: introduce vhost memory accessors

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [vhost] introduce vhost memory accessors (Wei Xu) [1425127 1283257]
Rebuild_FUZZ: 90.14%
commit-author Jason Wang <jasowang@redhat.com>
commit bfe2bc512884d0b1c5297a15350f940ca80e439b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/bfe2bc51.failed

This patch introduces vhost memory accessors which were just wrappers
for userspace address access helpers. This is a requirement for vhost
device iotlb implementation which will add iotlb translations in those
accessors.

	Signed-off-by: Jason Wang <jasowang@redhat.com>
	Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
(cherry picked from commit bfe2bc512884d0b1c5297a15350f940ca80e439b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/vhost/vhost.c
diff --cc drivers/vhost/vhost.c
index f65052baafd1,e1b5047d8f19..000000000000
--- a/drivers/vhost/vhost.c
+++ b/drivers/vhost/vhost.c
@@@ -1184,17 -1211,22 +1202,25 @@@ int vhost_init_used(struct vhost_virtqu
  
  	r = vhost_update_used_flags(vq);
  	if (r)
 -		goto err;
 +		return r;
  	vq->signalled_used_valid = false;
++<<<<<<< HEAD
 +	if (!access_ok(VERIFY_READ, &vq->used->idx, sizeof vq->used->idx))
 +		return -EFAULT;
 +	r = __get_user(last_used_idx, &vq->used->idx);
++=======
+ 	if (!access_ok(VERIFY_READ, &vq->used->idx, sizeof vq->used->idx)) {
+ 		r = -EFAULT;
+ 		goto err;
+ 	}
+ 	r = vhost_get_user(vq, last_used_idx, &vq->used->idx);
++>>>>>>> bfe2bc512884 (vhost: introduce vhost memory accessors)
  	if (r)
 -		goto err;
 +		return r;
  	vq->last_used_idx = vhost16_to_cpu(vq, last_used_idx);
  	return 0;
 -err:
 -	vq->is_le = is_le;
 -	return r;
  }
 -EXPORT_SYMBOL_GPL(vhost_vq_init_access);
 +EXPORT_SYMBOL_GPL(vhost_init_used);
  
  static int translate_desc(struct vhost_virtqueue *vq, u64 addr, u32 len,
  			  struct iovec iov[], int iov_size)
* Unmerged path drivers/vhost/vhost.c
