xfs: sanitize remount options

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Eric Sandeen <sandeen@sandeen.net>
commit a08ee40a79653d082911cab9fbeff94baa7714cb
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/a08ee40a.failed

Perform basic sanitization of remount options by
passing the option string and a dummy mount structure
through xfs_parseargs and returning the result.

	Signed-off-by: Eric Sandeen <sandeen@redhat.com>
	Reviewed-by: Brian Foster <bfoster@redhat.com>
	Signed-off-by: Dave Chinner <david@fromorbit.com>

(cherry picked from commit a08ee40a79653d082911cab9fbeff94baa7714cb)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/xfs/xfs_super.c
diff --cc fs/xfs/xfs_super.c
index 0ba7a4b9bc63,8dd7d165902d..000000000000
--- a/fs/xfs/xfs_super.c
+++ b/fs/xfs/xfs_super.c
@@@ -177,8 -182,9 +181,14 @@@ xfs_parseargs
  	struct xfs_mount	*mp,
  	char			*options)
  {
++<<<<<<< HEAD
 +	struct super_block	*sb = mp->m_super;
 +	char			*this_char, *value;
++=======
+ 	const struct super_block *sb = mp->m_super;
+ 	char			*p;
+ 	substring_t		args[MAX_OPT_ARGS];
++>>>>>>> a08ee40a7965 (xfs: sanitize remount options)
  	int			dsunit = 0;
  	int			dswidth = 0;
  	int			iosize = 0;
@@@ -1200,6 -1206,12 +1231,15 @@@ xfs_fs_remount
  	char			*p;
  	int			error;
  
++<<<<<<< HEAD
++=======
+ 	/* First, check for complete junk; i.e. invalid options */
+ 	error = xfs_test_remount_options(sb, mp, options);
+ 	if (error)
+ 		return error;
+ 
+ 	sync_filesystem(sb);
++>>>>>>> a08ee40a7965 (xfs: sanitize remount options)
  	while ((p = strsep(&options, ",")) != NULL) {
  		int token;
  
* Unmerged path fs/xfs/xfs_super.c
