KVM: PPC: Decrease the powerpc default halt poll max value

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Suraj Jitindar Singh <sjitindarsingh@gmail.com>
commit f4944613ad1ab6760589d5791488be1236c07fcc
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/f4944613.failed

KVM_HALT_POLL_NS_DEFAULT is an arch specific constant which sets the
default value of the halt_poll_ns kvm module parameter which determines
the global maximum halt polling interval.

The current value for powerpc is 500000 (500us) which means that any
repetitive workload with a period of less than that can drive the cpu
usage to 100% where it may have been mostly idle without halt polling.
This presents the possibility of a large increase in power usage with
a comparatively small performance benefit.

Reduce the default to 10000 (10us) and a user can tune this themselves
to set their affinity for halt polling based on the trade off between power
and performance which they are willing to make.

	Signed-off-by: Suraj Jitindar Singh <sjitindarsingh@gmail.com>
	Signed-off-by: Paul Mackerras <paulus@ozlabs.org>
(cherry picked from commit f4944613ad1ab6760589d5791488be1236c07fcc)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/powerpc/include/asm/kvm_host.h
diff --cc arch/powerpc/include/asm/kvm_host.h
index 8841a038084f,e59b172666cd..000000000000
--- a/arch/powerpc/include/asm/kvm_host.h
+++ b/arch/powerpc/include/asm/kvm_host.h
@@@ -45,6 -48,7 +45,10 @@@
  #ifdef CONFIG_KVM_MMIO
  #define KVM_COALESCED_MMIO_PAGE_OFFSET 1
  #endif
++<<<<<<< HEAD
++=======
+ #define KVM_HALT_POLL_NS_DEFAULT 10000	/* 10 us */
++>>>>>>> f4944613ad1a (KVM: PPC: Decrease the powerpc default halt poll max value)
  
  /* These values are internal and can be increased later */
  #define KVM_NR_IRQCHIPS          1
* Unmerged path arch/powerpc/include/asm/kvm_host.h
