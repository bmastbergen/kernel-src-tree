bridge: Propagate vlan add failure to user

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Elad Raz <eladr@mellanox.com>
commit 08474cc1e6ea71237cab7e4a651a623c9dea1084
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/08474cc1.failed

Disallow adding interfaces to a bridge when vlan filtering operation
failed. Send the failure code to the user.

	Signed-off-by: Elad Raz <eladr@mellanox.com>
	Signed-off-by: Jiri Pirko <jiri@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 08474cc1e6ea71237cab7e4a651a623c9dea1084)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/bridge/br_if.c
diff --cc net/bridge/br_if.c
index c4107a488d8b,c367b3e1b5ac..000000000000
--- a/net/bridge/br_if.c
+++ b/net/bridge/br_if.c
@@@ -533,6 -511,12 +533,15 @@@ int br_add_if(struct net_bridge *br, st
  	if (br_fdb_insert(br, p, dev->dev_addr, 0))
  		netdev_err(dev, "failed insert local address bridge forwarding table\n");
  
++<<<<<<< HEAD
++=======
+ 	err = nbp_vlan_init(p);
+ 	if (err) {
+ 		netdev_err(dev, "failed to initialize vlan filtering on this port\n");
+ 		goto err6;
+ 	}
+ 
++>>>>>>> 08474cc1e6ea (bridge: Propagate vlan add failure to user)
  	spin_lock_bh(&br->lock);
  	changed_addr = br_stp_recalculate_bridge_id(br);
  
* Unmerged path net/bridge/br_if.c
