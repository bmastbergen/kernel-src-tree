nfit: move to nfit/ sub-directory

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Dan Williams <dan.j.williams@intel.com>
commit bdf97013ced5f263da0dc9d559f5c09e922d8423
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/bdf97013.failed

With the arrival of x86-machine-check support the nfit driver will add a
(conditionally-compiled) source file.  Prepare for this by moving all
nfit source to drivers/acpi/nfit/.  This is pure code movement, no
functional changes.

	Signed-off-by: Dan Williams <dan.j.williams@intel.com>
(cherry picked from commit bdf97013ced5f263da0dc9d559f5c09e922d8423)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/acpi/Kconfig
#	drivers/acpi/Makefile
#	tools/testing/nvdimm/Kbuild
diff --cc drivers/acpi/Kconfig
index 6e5abb23f151,415b148a8698..000000000000
--- a/drivers/acpi/Kconfig
+++ b/drivers/acpi/Kconfig
@@@ -377,32 -435,19 +377,48 @@@ config ACPI_BGR
  	  data from the firmware boot splash. It will appear under
  	  /sys/firmware/acpi/bgrt/ .
  
++<<<<<<< HEAD
 +config ACPI_NFIT
 +	tristate "ACPI NVDIMM Firmware Interface Table (NFIT)"
 +	depends on PHYS_ADDR_T_64BIT
 +	depends on BLK_DEV
 +	depends on ARCH_HAS_MMIO_FLUSH
 +	select LIBNVDIMM
 +	help
 +	  Infrastructure to probe ACPI 6 compliant platforms for
 +	  NVDIMMs (NFIT) and register a libnvdimm device tree.  In
 +	  addition to storage devices this also enables libnvdimm to pass
 +	  ACPI._DSM messages for platform/dimm configuration.
 +
 +	  To compile this driver as a module, choose M here:
 +	  the module will be called nfit.
 +
 +config ACPI_NFIT_DEBUG
 +	bool "NFIT DSM debug"
 +	depends on ACPI_NFIT
 +	depends on DYNAMIC_DEBUG
 +	default n
 +	help
 +	  Enabling this option causes the nfit driver to dump the
 +	  input and output buffers of _DSM operations on the ACPI0012
 +	  device and its children.  This can be very verbose, so leave
 +	  it disabled unless you are debugging a hardware / firmware
 +	  issue.
++=======
+ config ACPI_REDUCED_HARDWARE_ONLY
+ 	bool "Hardware-reduced ACPI support only" if EXPERT
+ 	def_bool n
+ 	help
+ 	  This config item changes the way the ACPI code is built.  When this
+ 	  option is selected, the kernel will use a specialized version of
+ 	  ACPICA that ONLY supports the ACPI "reduced hardware" mode.  The
+ 	  resulting kernel will be smaller but it will also be restricted to
+ 	  running in ACPI reduced hardware mode ONLY.
+ 
+ 	  If you are unsure what to do, do not enable this option.
+ 
+ source "drivers/acpi/nfit/Kconfig"
++>>>>>>> bdf97013ced5 (nfit: move to nfit/ sub-directory)
  
  source "drivers/acpi/apei/Kconfig"
  
diff --cc drivers/acpi/Makefile
index 92b6ceaf3cc2,64a575a6f7ef..000000000000
--- a/drivers/acpi/Makefile
+++ b/drivers/acpi/Makefile
@@@ -66,10 -68,11 +66,16 @@@ obj-$(CONFIG_ACPI_FAN)		+= fan.
  obj-$(CONFIG_ACPI_VIDEO)	+= video.o
  obj-$(CONFIG_ACPI_PCI_SLOT)	+= pci_slot.o
  obj-$(CONFIG_ACPI_PROCESSOR)	+= processor.o
 -obj-$(CONFIG_ACPI)		+= container.o
 +obj-$(CONFIG_ACPI_CONTAINER)	+= container.o
  obj-$(CONFIG_ACPI_THERMAL)	+= thermal.o
++<<<<<<< HEAD
 +obj-$(CONFIG_ACPI_NFIT)		+= nfit.o
 +obj-$(CONFIG_ACPI_HOTPLUG_MEMORY) += acpi_memhotplug.o
++=======
+ obj-$(CONFIG_ACPI_NFIT)		+= nfit/
+ obj-$(CONFIG_ACPI)		+= acpi_memhotplug.o
+ obj-$(CONFIG_ACPI_HOTPLUG_IOAPIC) += ioapic.o
++>>>>>>> bdf97013ced5 (nfit: move to nfit/ sub-directory)
  obj-$(CONFIG_ACPI_BATTERY)	+= battery.o
  obj-$(CONFIG_ACPI_SBS)		+= sbshc.o
  obj-$(CONFIG_ACPI_SBS)		+= sbs.o
diff --cc tools/testing/nvdimm/Kbuild
index 06718718bdc0,0dca8ff7557b..000000000000
--- a/tools/testing/nvdimm/Kbuild
+++ b/tools/testing/nvdimm/Kbuild
@@@ -16,7 -16,8 +16,12 @@@ ldflags-y += --wrap=remove_resourc
  
  DRIVERS := ../../../drivers
  NVDIMM_SRC := $(DRIVERS)/nvdimm
++<<<<<<< HEAD
 +ACPI_SRC := $(DRIVERS)/acpi
++=======
+ ACPI_SRC := $(DRIVERS)/acpi/nfit
+ DAX_SRC := $(DRIVERS)/dax
++>>>>>>> bdf97013ced5 (nfit: move to nfit/ sub-directory)
  ccflags-y := -I$(src)/$(NVDIMM_SRC)/
  
  obj-$(CONFIG_LIBNVDIMM) += libnvdimm.o
@@@ -25,8 -26,10 +30,8 @@@ obj-$(CONFIG_ND_BTT) += nd_btt.
  obj-$(CONFIG_ND_BLK) += nd_blk.o
  obj-$(CONFIG_X86_PMEM_LEGACY) += nd_e820.o
  obj-$(CONFIG_ACPI_NFIT) += nfit.o
 -obj-$(CONFIG_DEV_DAX) += dax.o
 -obj-$(CONFIG_DEV_DAX_PMEM) += dax_pmem.o
  
- nfit-y := $(ACPI_SRC)/nfit.o
+ nfit-y := $(ACPI_SRC)/core.o
  nfit-y += config_check.o
  
  nd_pmem-y := $(NVDIMM_SRC)/pmem.o
* Unmerged path drivers/acpi/Kconfig
* Unmerged path drivers/acpi/Makefile
diff --git a/drivers/acpi/nfit/Kconfig b/drivers/acpi/nfit/Kconfig
new file mode 100644
index 000000000000..dd0d53c52552
--- /dev/null
+++ b/drivers/acpi/nfit/Kconfig
@@ -0,0 +1,26 @@
+config ACPI_NFIT
+	tristate "ACPI NVDIMM Firmware Interface Table (NFIT)"
+	depends on PHYS_ADDR_T_64BIT
+	depends on BLK_DEV
+	depends on ARCH_HAS_MMIO_FLUSH
+	select LIBNVDIMM
+	help
+	  Infrastructure to probe ACPI 6 compliant platforms for
+	  NVDIMMs (NFIT) and register a libnvdimm device tree.  In
+	  addition to storage devices this also enables libnvdimm to pass
+	  ACPI._DSM messages for platform/dimm configuration.
+
+	  To compile this driver as a module, choose M here:
+	  the module will be called nfit.
+
+config ACPI_NFIT_DEBUG
+	bool "NFIT DSM debug"
+	depends on ACPI_NFIT
+	depends on DYNAMIC_DEBUG
+	default n
+	help
+	  Enabling this option causes the nfit driver to dump the
+	  input and output buffers of _DSM operations on the ACPI0012
+	  device and its children.  This can be very verbose, so leave
+	  it disabled unless you are debugging a hardware / firmware
+	  issue.
diff --git a/drivers/acpi/nfit/Makefile b/drivers/acpi/nfit/Makefile
new file mode 100644
index 000000000000..eb95c5aff83b
--- /dev/null
+++ b/drivers/acpi/nfit/Makefile
@@ -0,0 +1,2 @@
+obj-$(CONFIG_ACPI_NFIT) := nfit.o
+nfit-y := core.o
diff --git a/drivers/acpi/nfit.c b/drivers/acpi/nfit/core.c
similarity index 100%
rename from drivers/acpi/nfit.c
rename to drivers/acpi/nfit/core.c
diff --git a/drivers/acpi/nfit.h b/drivers/acpi/nfit/nfit.h
similarity index 100%
rename from drivers/acpi/nfit.h
rename to drivers/acpi/nfit/nfit.h
* Unmerged path tools/testing/nvdimm/Kbuild
diff --git a/tools/testing/nvdimm/test/Kbuild b/tools/testing/nvdimm/test/Kbuild
index 9241064970fe..d32f25bba42a 100644
--- a/tools/testing/nvdimm/test/Kbuild
+++ b/tools/testing/nvdimm/test/Kbuild
@@ -1,5 +1,5 @@
 ccflags-y := -I$(src)/../../../../drivers/nvdimm/
-ccflags-y += -I$(src)/../../../../drivers/acpi/
+ccflags-y += -I$(src)/../../../../drivers/acpi/nfit/
 
 obj-m += nfit_test.o
 obj-m += nfit_test_iomap.o
