HID: wacom: fix Intuos wireless report id issue

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [hid] wacom: fix Intuos wireless report id issue (Aristeu Rozanski) [1346348 1388646 1385026]
Rebuild_FUZZ: 94.38%
commit-author Ping Cheng <pinglinux@gmail.com>
commit 7adb91bd78a5e00209c56068dc0ad53d4cf4348f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/7adb91bd.failed

Intuos Pen in wireless mode does not have the same report id (2) as
when it is in USB mode (17).

This patch also moves WIRELESS next to REMOTE in type enum so we
can group devices with similar features easily.

	Reported-by: Dale Brewe <dlbrewe@hotmail.com>
	Tested-by: Dale Brewe <dlbrewe@hotmail.com>
	Signed-off-by: Ping Cheng <pingc@wacom.com>
	Signed-off-by: Jiri Kosina <jkosina@suse.cz>
(cherry picked from commit 7adb91bd78a5e00209c56068dc0ad53d4cf4348f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/hid/wacom_sys.c
#	drivers/hid/wacom_wac.c
#	drivers/hid/wacom_wac.h
diff --cc drivers/hid/wacom_sys.c
index 527bf559d1db,b4de3256aa90..000000000000
--- a/drivers/hid/wacom_sys.c
+++ b/drivers/hid/wacom_sys.c
@@@ -563,22 -408,32 +563,31 @@@ static int wacom_set_device_mode(struc
   * from the tablet, it is necessary to switch the tablet out of this
   * mode and into one which sends the full range of tablet data.
   */
 -static int wacom_query_tablet_data(struct hid_device *hdev,
 -		struct wacom_features *features)
 +static int wacom_query_tablet_data(struct usb_interface *intf, struct wacom_features *features)
  {
 -	if (hdev->bus == BUS_BLUETOOTH)
 -		return wacom_bt_query_tablet_data(hdev, 1, features);
 -
 -	if (features->type == HID_GENERIC)
 -		return wacom_hid_set_device_mode(hdev);
 -
 -	if (features->device_type & WACOM_DEVICETYPE_TOUCH) {
 +	if (features->device_type == BTN_TOOL_FINGER) {
  		if (features->type > TABLETPC) {
  			/* MT Tablet PC touch */
 -			return wacom_set_device_mode(hdev, 3, 4, 4);
 +			return wacom_set_device_mode(intf, 3, 4, 4);
  		}
 -		else if (features->type == WACOM_24HDT || features->type == CINTIQ_HYBRID || features->type == CINTIQ_COMPANION_2) {
 -			return wacom_set_device_mode(hdev, 18, 3, 2);
 +		else if (features->type == WACOM_24HDT) {
 +			return wacom_set_device_mode(intf, 18, 3, 2);
  		}
  		else if (features->type == WACOM_27QHDT) {
 -			return wacom_set_device_mode(hdev, 131, 3, 2);
 +			return wacom_set_device_mode(intf, 131, 3, 2);
  		}
++<<<<<<< HEAD
 +	} else if (features->device_type == BTN_TOOL_PEN) {
 +		if (features->type <= BAMBOO_PT && features->type != WIRELESS) {
 +			return wacom_set_device_mode(intf, 2, 2, 2);
++=======
+ 		else if (features->type == BAMBOO_PAD) {
+ 			return wacom_set_device_mode(hdev, 2, 2, 2);
+ 		}
+ 	} else if (features->device_type & WACOM_DEVICETYPE_PEN) {
+ 		if (features->type <= BAMBOO_PT) {
+ 			return wacom_set_device_mode(hdev, 2, 2, 2);
++>>>>>>> 7adb91bd78a5 (HID: wacom: fix Intuos wireless report id issue)
  		}
  	}
  
diff --cc drivers/hid/wacom_wac.c
index bdf17efa93aa,453da6d5c583..000000000000
--- a/drivers/hid/wacom_wac.c
+++ b/drivers/hid/wacom_wac.c
@@@ -1291,7 -2063,12 +1291,16 @@@ static int wacom_bpt_pen(struct wacom_w
  
  static int wacom_bpt_irq(struct wacom_wac *wacom, size_t len)
  {
++<<<<<<< HEAD
 +	if (len == WACOM_PKGLEN_BBTOUCH)
++=======
+ 	struct wacom_features *features = &wacom->features;
+ 
+ 	if ((features->type == INTUOSHT2) &&
+ 	    (features->device_type & WACOM_DEVICETYPE_PEN))
+ 		return wacom_intuos_irq(wacom);
+ 	else if (len == WACOM_PKGLEN_BBTOUCH)
++>>>>>>> 7adb91bd78a5 (HID: wacom: fix Intuos wireless report id issue)
  		return wacom_bpt_touch(wacom);
  	else if (len == WACOM_PKGLEN_BBTOUCH3)
  		return wacom_bpt3_touch(wacom);
diff --cc drivers/hid/wacom_wac.h
index d220d069f329,d9e9515fd149..000000000000
--- a/drivers/hid/wacom_wac.h
+++ b/drivers/hid/wacom_wac.h
@@@ -93,10 -129,16 +93,23 @@@ enum 
  	WACOM_BEE,
  	WACOM_13HD,
  	WACOM_MO,
++<<<<<<< HEAD
 +	WIRELESS,
 +	BAMBOO_PT,
 +	WACOM_24HDT,
 +	WACOM_27QHDT,
++=======
+ 	BAMBOO_PEN,
+ 	INTUOSHT,
+ 	INTUOSHT2,
+ 	BAMBOO_TOUCH,
+ 	BAMBOO_PT,
+ 	WACOM_24HDT,
+ 	WACOM_27QHDT,
+ 	BAMBOO_PAD,
+ 	WIRELESS,
+ 	REMOTE,
++>>>>>>> 7adb91bd78a5 (HID: wacom: fix Intuos wireless report id issue)
  	TABLETPC,   /* add new TPC below */
  	TABLETPCE,
  	TABLETPC2FG,
* Unmerged path drivers/hid/wacom_sys.c
* Unmerged path drivers/hid/wacom_wac.c
* Unmerged path drivers/hid/wacom_wac.h
