audit: skip sessionid sentinel value when auto-incrementing

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Richard Guy Briggs <rgb@redhat.com>
commit 833fc48d18ce3595990b405ae82a160b33028994
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/833fc48d.failed

The value (unsigned int)-1 is used as a sentinel to indicate the
sessionID is unset.  Skip this value when the session_id value wraps.

	Signed-off-by: Richard Guy Briggs <rgb@redhat.com>
	Signed-off-by: Paul Moore <paul@paul-moore.com>
(cherry picked from commit 833fc48d18ce3595990b405ae82a160b33028994)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	kernel/auditsc.c
diff --cc kernel/auditsc.c
index ac83ba981708,d161b17ce8ce..000000000000
--- a/kernel/auditsc.c
+++ b/kernel/auditsc.c
@@@ -1957,8 -2025,11 +1957,16 @@@ int audit_set_loginuid(kuid_t loginuid
  		goto out;
  
  	/* are we setting or clearing? */
++<<<<<<< HEAD
 +	if (uid_valid(loginuid))
 +		sessionid = atomic_inc_return(&session_id);
++=======
+ 	if (uid_valid(loginuid)) {
+ 		sessionid = (unsigned int)atomic_inc_return(&session_id);
+ 		if (unlikely(sessionid == (unsigned int)-1))
+ 			sessionid = (unsigned int)atomic_inc_return(&session_id);
+ 	}
++>>>>>>> 833fc48d18ce (audit: skip sessionid sentinel value when auto-incrementing)
  
  	task->sessionid = sessionid;
  	task->loginuid = loginuid;
* Unmerged path kernel/auditsc.c
