net/mlx4_en: Add support for UDP tunnel segmentation with outer checksum offload

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [netdrv] mlx4_en: Add support for UDP tunnel segmentation with outer checksum offload (Don Dutile) [1385329 1417284]
Rebuild_FUZZ: 97.44%
commit-author Alexander Duyck <aduyck@mirantis.com>
commit 3c9346b24001523a763c28478b49064589d1c8ab
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/3c9346b2.failed

This patch assumes that the mlx4 hardware will ignore existing IPv4/v6
header fields for length and checksum as well as the length and checksum
fields for outer UDP headers.

	Signed-off-by: Alexander Duyck <aduyck@mirantis.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 3c9346b24001523a763c28478b49064589d1c8ab)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx4/en_netdev.c
diff --cc drivers/net/ethernet/mellanox/mlx4/en_netdev.c
index 89f52fc9186f,bce37cbfde24..000000000000
--- a/drivers/net/ethernet/mellanox/mlx4/en_netdev.c
+++ b/drivers/net/ethernet/mellanox/mlx4/en_netdev.c
@@@ -2441,10 -2357,10 +2441,17 @@@ out
  	}
  
  	/* set offloads */
++<<<<<<< HEAD
 +	priv->dev->hw_enc_features |= NETIF_F_IP_CSUM | NETIF_F_IPV6_CSUM |
 +				      NETIF_F_RXCSUM |
 +				      NETIF_F_TSO | NETIF_F_TSO6 |
 +				      NETIF_F_GSO_UDP_TUNNEL;
++=======
+ 	priv->dev->hw_enc_features |= NETIF_F_IP_CSUM | NETIF_F_RXCSUM |
+ 				      NETIF_F_TSO | NETIF_F_GSO_UDP_TUNNEL |
+ 				      NETIF_F_GSO_UDP_TUNNEL_CSUM |
+ 				      NETIF_F_GSO_PARTIAL;
++>>>>>>> 3c9346b24001 (net/mlx4_en: Add support for UDP tunnel segmentation with outer checksum offload)
  }
  
  static void mlx4_en_del_vxlan_offloads(struct work_struct *work)
@@@ -2453,10 -2369,10 +2460,17 @@@
  	struct mlx4_en_priv *priv = container_of(work, struct mlx4_en_priv,
  						 vxlan_del_task);
  	/* unset offloads */
++<<<<<<< HEAD
 +	priv->dev->hw_enc_features &= ~(NETIF_F_IP_CSUM | NETIF_F_IPV6_CSUM |
 +					NETIF_F_RXCSUM |
 +					NETIF_F_TSO | NETIF_F_TSO6 |
 +					NETIF_F_GSO_UDP_TUNNEL);
++=======
+ 	priv->dev->hw_enc_features &= ~(NETIF_F_IP_CSUM | NETIF_F_RXCSUM |
+ 					NETIF_F_TSO | NETIF_F_GSO_UDP_TUNNEL |
+ 					NETIF_F_GSO_UDP_TUNNEL_CSUM |
+ 					NETIF_F_GSO_PARTIAL);
++>>>>>>> 3c9346b24001 (net/mlx4_en: Add support for UDP tunnel segmentation with outer checksum offload)
  
  	ret = mlx4_SET_PORT_VXLAN(priv->mdev->dev, priv->port,
  				  VXLAN_STEER_BY_OUTER_MAC, 0);
* Unmerged path drivers/net/ethernet/mellanox/mlx4/en_netdev.c
