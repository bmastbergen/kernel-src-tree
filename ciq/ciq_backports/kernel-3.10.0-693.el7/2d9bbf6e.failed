perf callchain: Add option to skip ignore symbol when printing callchains

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Namhyung Kim <namhyung@kernel.org>
commit 2d9bbf6eb3825739efa9e91c256ce7ead60d8367
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/2d9bbf6e.failed

For tracepoint events, callchains always contain certain functions.
Sometimes it'd be better to skip those functions as they have no value.

	Signed-off-by: Namhyung Kim <namhyung@kernel.org>
	Tested-by: Arnaldo Carvalho de Melo <acme@redhat.com>
	Cc: Andi Kleen <andi@firstfloor.org>
	Cc: David Ahern <dsahern@gmail.com>
	Cc: Jiri Olsa <jolsa@kernel.org>
	Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
	Cc: Stephane Eranian <eranian@google.com>
Link: http://lkml.kernel.org/r/20161124011114.7102-2-namhyung@kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 2d9bbf6eb3825739efa9e91c256ce7ead60d8367)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/util/evsel.h
#	tools/perf/util/evsel_fprintf.c
diff --cc tools/perf/util/evsel.h
index 686af5a4b625,6abb89cd27f9..000000000000
--- a/tools/perf/util/evsel.h
+++ b/tools/perf/util/evsel.h
@@@ -359,6 -384,26 +359,29 @@@ struct perf_attr_details 
  int perf_evsel__fprintf(struct perf_evsel *evsel,
  			struct perf_attr_details *details, FILE *fp);
  
++<<<<<<< HEAD
++=======
+ #define EVSEL__PRINT_IP			(1<<0)
+ #define EVSEL__PRINT_SYM		(1<<1)
+ #define EVSEL__PRINT_DSO		(1<<2)
+ #define EVSEL__PRINT_SYMOFFSET		(1<<3)
+ #define EVSEL__PRINT_ONELINE		(1<<4)
+ #define EVSEL__PRINT_SRCLINE		(1<<5)
+ #define EVSEL__PRINT_UNKNOWN_AS_ADDR	(1<<6)
+ #define EVSEL__PRINT_CALLCHAIN_ARROW	(1<<7)
+ #define EVSEL__PRINT_SKIP_IGNORED	(1<<8)
+ 
+ struct callchain_cursor;
+ 
+ int sample__fprintf_callchain(struct perf_sample *sample, int left_alignment,
+ 			      unsigned int print_opts,
+ 			      struct callchain_cursor *cursor, FILE *fp);
+ 
+ int sample__fprintf_sym(struct perf_sample *sample, struct addr_location *al,
+ 			int left_alignment, unsigned int print_opts,
+ 			struct callchain_cursor *cursor, FILE *fp);
+ 
++>>>>>>> 2d9bbf6eb382 (perf callchain: Add option to skip ignore symbol when printing callchains)
  bool perf_evsel__fallback(struct perf_evsel *evsel, int err,
  			  char *msg, size_t msgsize);
  int perf_evsel__open_strerror(struct perf_evsel *evsel, struct target *target,
* Unmerged path tools/perf/util/evsel_fprintf.c
diff --git a/tools/perf/builtin-sched.c b/tools/perf/builtin-sched.c
index 45d4203b804b..903781238b72 100644
--- a/tools/perf/builtin-sched.c
+++ b/tools/perf/builtin-sched.c
@@ -1872,7 +1872,8 @@ static void timehist_print_sample(struct perf_sched *sched,
 
 	sample__fprintf_sym(sample, al, 0,
 			    EVSEL__PRINT_SYM | EVSEL__PRINT_ONELINE |
-			    EVSEL__PRINT_CALLCHAIN_ARROW,
+			    EVSEL__PRINT_CALLCHAIN_ARROW |
+			    EVSEL__PRINT_SKIP_IGNORED,
 			    &callchain_cursor, stdout);
 
 out:
* Unmerged path tools/perf/util/evsel.h
* Unmerged path tools/perf/util/evsel_fprintf.c
