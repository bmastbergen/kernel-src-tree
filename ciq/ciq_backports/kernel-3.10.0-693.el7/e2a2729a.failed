amd-xgbe: Use proper Rx flow control register

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Lendacky, Thomas <Thomas.Lendacky@amd.com>
commit e2a2729a9279eba7366e6a98a1e41ad6baef3caa
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/e2a2729a.failed

Updated hardware documention shows the Rx flow control settings were
moved from the Rx queue operation mode register to a new Rx queue flow
control register.  The old flow control settings are now reserved areas
of the Rx queue operation mode register. Update the code to use the new
register.

	Signed-off-by: Tom Lendacky <thomas.lendacky@amd.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit e2a2729a9279eba7366e6a98a1e41ad6baef3caa)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/amd/xgbe/xgbe-common.h
diff --cc drivers/net/ethernet/amd/xgbe/xgbe-common.h
index 3373e9ef2003,29a09271b64a..000000000000
--- a/drivers/net/ethernet/amd/xgbe/xgbe-common.h
+++ b/drivers/net/ethernet/amd/xgbe/xgbe-common.h
@@@ -672,14 -772,12 +673,17 @@@
  #define MTL_Q_ISR			0x74
  
  /* MTL queue register entry bit positions and sizes */
++<<<<<<< HEAD
 +#define MTL_Q_TCQWR_QW_INDEX		0
 +#define MTL_Q_TCQWR_QW_WIDTH		21
++=======
+ #define MTL_Q_RQFCR_RFA_INDEX		1
+ #define MTL_Q_RQFCR_RFA_WIDTH		6
+ #define MTL_Q_RQFCR_RFD_INDEX		17
+ #define MTL_Q_RQFCR_RFD_WIDTH		6
++>>>>>>> e2a2729a9279 (amd-xgbe: Use proper Rx flow control register)
  #define MTL_Q_RQOMR_EHFC_INDEX		7
  #define MTL_Q_RQOMR_EHFC_WIDTH		1
- #define MTL_Q_RQOMR_RFA_INDEX		8
- #define MTL_Q_RQOMR_RFA_WIDTH		3
- #define MTL_Q_RQOMR_RFD_INDEX		13
- #define MTL_Q_RQOMR_RFD_WIDTH		3
  #define MTL_Q_RQOMR_RQS_INDEX		16
  #define MTL_Q_RQOMR_RQS_WIDTH		9
  #define MTL_Q_RQOMR_RSF_INDEX		5
* Unmerged path drivers/net/ethernet/amd/xgbe/xgbe-common.h
diff --git a/drivers/net/ethernet/amd/xgbe/xgbe-dev.c b/drivers/net/ethernet/amd/xgbe/xgbe-dev.c
index ec5481f846ee..20c4f7437e6c 100644
--- a/drivers/net/ethernet/amd/xgbe/xgbe-dev.c
+++ b/drivers/net/ethernet/amd/xgbe/xgbe-dev.c
@@ -1542,10 +1542,10 @@ static void xgbe_config_flow_control_threshold(struct xgbe_prv_data *pdata)
 
 	for (i = 0; i < pdata->hw_feat.rx_q_cnt; i++) {
 		/* Activate flow control when less than 4k left in fifo */
-		XGMAC_MTL_IOWRITE_BITS(pdata, i, MTL_Q_RQOMR, RFA, 2);
+		XGMAC_MTL_IOWRITE_BITS(pdata, i, MTL_Q_RQFCR, RFA, 2);
 
 		/* De-activate flow control when more than 6k left in fifo */
-		XGMAC_MTL_IOWRITE_BITS(pdata, i, MTL_Q_RQOMR, RFD, 4);
+		XGMAC_MTL_IOWRITE_BITS(pdata, i, MTL_Q_RQFCR, RFD, 4);
 	}
 }
 
