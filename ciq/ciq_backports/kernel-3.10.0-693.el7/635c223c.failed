rps: flow_dissector: Fix uninitialized flow_keys used in __skb_get_hash possibly

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [net] flow_dissector: rps: Fix uninitialized flow_keys used in __skb_get_hash possibly (Jonathan Toppins) [1428557]
Rebuild_FUZZ: 93.75%
commit-author Gao Feng <fgao@ikuai8.com>
commit 635c223cfa05af9523146b2f37e119d945f449ae
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/635c223c.failed

The original codes depend on that the function parameters are evaluated from
left to right. But the parameter's evaluation order is not defined in C
standard actually.

When flow_keys_have_l4(&keys) is invoked before ___skb_get_hash(skb, &keys,
hashrnd) with some compilers or environment, the keys passed to
flow_keys_have_l4 is not initialized.

Fixes: 6db61d79c1e1 ("flow_dissector: Ignore flow dissector return value from ___skb_get_hash")

	Acked-by: Eric Dumazet <edumazet@google.com>
	Signed-off-by: Gao Feng <fgao@ikuai8.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 635c223cfa05af9523146b2f37e119d945f449ae)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/core/flow_dissector.c
diff --cc net/core/flow_dissector.c
index dae6e57d80c3,52742a02814f..000000000000
--- a/net/core/flow_dissector.c
+++ b/net/core/flow_dissector.c
@@@ -376,14 -680,13 +376,21 @@@ EXPORT_SYMBOL(flow_hash_from_keys)
  void __skb_get_hash(struct sk_buff *skb)
  {
  	struct flow_keys keys;
+ 	u32 hash;
  
 -	__flow_hash_secret_init();
 +	if (!skb_flow_dissect(skb, &keys))
 +		return;
 +
++<<<<<<< HEAD
 +	if (keys.ports)
 +		skb->l4_hash = 1;
  
 +	skb->hash = __flow_hash_from_keys(&keys);
++=======
+ 	hash = ___skb_get_hash(skb, &keys, hashrnd);
+ 
+ 	__skb_set_sw_hash(skb, hash, flow_keys_have_l4(&keys));
++>>>>>>> 635c223cfa05 (rps: flow_dissector: Fix uninitialized flow_keys used in __skb_get_hash possibly)
  }
  EXPORT_SYMBOL(__skb_get_hash);
  
* Unmerged path net/core/flow_dissector.c
