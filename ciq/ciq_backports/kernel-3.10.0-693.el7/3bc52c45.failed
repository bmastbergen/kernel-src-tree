dax: define a unified inode/address_space for device-dax mappings

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Dan Williams <dan.j.williams@intel.com>
commit 3bc52c45bac26bf7ed1dc8d287ad1aeaed1250b6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/3bc52c45.failed

In support of enabling resize / truncate of device-dax instances, define
a pseudo-fs to provide a unified inode/address space for vm operations.

	Cc: Al Viro <viro@zeniv.linux.org.uk>
	Signed-off-by: Dan Williams <dan.j.williams@intel.com>
(cherry picked from commit 3bc52c45bac26bf7ed1dc8d287ad1aeaed1250b6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/dax/dax.c
* Unmerged path drivers/dax/dax.c
* Unmerged path drivers/dax/dax.c
diff --git a/fs/char_dev.c b/fs/char_dev.c
index afc2bb691780..7cc8a4557706 100644
--- a/fs/char_dev.c
+++ b/fs/char_dev.c
@@ -422,6 +422,7 @@ void cd_forget(struct inode *inode)
 	spin_lock(&cdev_lock);
 	list_del_init(&inode->i_devices);
 	inode->i_cdev = NULL;
+	inode->i_mapping = &inode->i_data;
 	spin_unlock(&cdev_lock);
 }
 
diff --git a/include/uapi/linux/magic.h b/include/uapi/linux/magic.h
index 2019d4eee864..0a22ae64c35a 100644
--- a/include/uapi/linux/magic.h
+++ b/include/uapi/linux/magic.h
@@ -62,6 +62,7 @@
 #define V9FS_MAGIC		0x01021997
 
 #define BDEVFS_MAGIC            0x62646576
+#define DAXFS_MAGIC             0x64646178
 #define BINFMTFS_MAGIC          0x42494e4d
 #define DEVPTS_SUPER_MAGIC	0x1cd1
 #define FUTEXFS_SUPER_MAGIC	0xBAD1DEA
