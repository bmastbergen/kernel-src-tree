qed: Add missing port-mode

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Yuval Mintz <Yuval.Mintz@qlogic.com>
commit b639f197210d37905a6018ae4297659eb3f48f8f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/b639f197.failed

The 'MODULE_FIBER' value replaced several other FIBER values
in newer management firmware images, so existing code would
fail to properly reflect its mode.

	Signed-off-by: Yuval Mintz <Yuval.Mintz@qlogic.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit b639f197210d37905a6018ae4297659eb3f48f8f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/qlogic/qed/qed_hsi.h
diff --cc drivers/net/ethernet/qlogic/qed/qed_hsi.h
index 592784019994,e29ed5a69566..000000000000
--- a/drivers/net/ethernet/qlogic/qed/qed_hsi.h
+++ b/drivers/net/ethernet/qlogic/qed/qed_hsi.h
@@@ -6964,175 -3611,246 +6964,188 @@@ struct public_path 
  #define GLOBAL_AEU_BIT(aeu_reg_id, aeu_bit) (aeu_reg_id * 32 + aeu_bit)
  };
  
 -/**************************************/
 -/*                                    */
 -/*     P U B L I C      P O R T       */
 -/*                                    */
 -/**************************************/
 -
 -/****************************************************************************
 -* Driver <-> FW Mailbox                                                    *
 -****************************************************************************/
 -
  struct public_port {
 -	u32 validity_map;   /* 0x0 (4*2 = 0x8) */
 -
 -	/* validity bits */
 -#define MCP_VALIDITY_PCI_CFG                    0x00100000
 -#define MCP_VALIDITY_MB                         0x00200000
 -#define MCP_VALIDITY_DEV_INFO                   0x00400000
 -#define MCP_VALIDITY_RESERVED                   0x00000007
 -
 -	/* One licensing bit should be set */
 -#define MCP_VALIDITY_LIC_KEY_IN_EFFECT_MASK     0x00000038
 -#define MCP_VALIDITY_LIC_MANUF_KEY_IN_EFFECT    0x00000008
 -#define MCP_VALIDITY_LIC_UPGRADE_KEY_IN_EFFECT  0x00000010
 -#define MCP_VALIDITY_LIC_NO_KEY_IN_EFFECT       0x00000020
 -
 -	/* Active MFW */
 -#define MCP_VALIDITY_ACTIVE_MFW_UNKNOWN         0x00000000
 -#define MCP_VALIDITY_ACTIVE_MFW_MASK            0x000001c0
 -#define MCP_VALIDITY_ACTIVE_MFW_NCSI            0x00000040
 -#define MCP_VALIDITY_ACTIVE_MFW_NONE            0x000001c0
 +	u32 validity_map;
  
  	u32 link_status;
 -#define LINK_STATUS_LINK_UP \
 -	0x00000001
 -#define LINK_STATUS_SPEED_AND_DUPLEX_MASK                       0x0000001e
 -#define LINK_STATUS_SPEED_AND_DUPLEX_1000THD		BIT(1)
 -#define LINK_STATUS_SPEED_AND_DUPLEX_1000TFD            (2 << 1)
 -#define LINK_STATUS_SPEED_AND_DUPLEX_10G                        (3 << 1)
 -#define LINK_STATUS_SPEED_AND_DUPLEX_20G                        (4 << 1)
 -#define LINK_STATUS_SPEED_AND_DUPLEX_40G                        (5 << 1)
 -#define LINK_STATUS_SPEED_AND_DUPLEX_50G                        (6 << 1)
 -#define LINK_STATUS_SPEED_AND_DUPLEX_100G                       (7 << 1)
 -#define LINK_STATUS_SPEED_AND_DUPLEX_25G                        (8 << 1)
 -
 -#define LINK_STATUS_AUTO_NEGOTIATE_ENABLED                      0x00000020
 -
 -#define LINK_STATUS_AUTO_NEGOTIATE_COMPLETE                     0x00000040
 -#define LINK_STATUS_PARALLEL_DETECTION_USED                     0x00000080
 -
 -#define LINK_STATUS_PFC_ENABLED	\
 -	0x00000100
 -#define LINK_STATUS_LINK_PARTNER_1000TFD_CAPABLE        0x00000200
 -#define LINK_STATUS_LINK_PARTNER_1000THD_CAPABLE        0x00000400
 -#define LINK_STATUS_LINK_PARTNER_10G_CAPABLE            0x00000800
 -#define LINK_STATUS_LINK_PARTNER_20G_CAPABLE            0x00001000
 -#define LINK_STATUS_LINK_PARTNER_40G_CAPABLE            0x00002000
 -#define LINK_STATUS_LINK_PARTNER_50G_CAPABLE            0x00004000
 -#define LINK_STATUS_LINK_PARTNER_100G_CAPABLE           0x00008000
 -#define LINK_STATUS_LINK_PARTNER_25G_CAPABLE            0x00010000
 -
 -#define LINK_STATUS_LINK_PARTNER_FLOW_CONTROL_MASK      0x000C0000
 -#define LINK_STATUS_LINK_PARTNER_NOT_PAUSE_CAPABLE      (0 << 18)
 -#define LINK_STATUS_LINK_PARTNER_SYMMETRIC_PAUSE	BIT(18)
 -#define LINK_STATUS_LINK_PARTNER_ASYMMETRIC_PAUSE       (2 << 18)
 -#define LINK_STATUS_LINK_PARTNER_BOTH_PAUSE                     (3 << 18)
 -
 -#define LINK_STATUS_SFP_TX_FAULT \
 -	0x00100000
 -#define LINK_STATUS_TX_FLOW_CONTROL_ENABLED                     0x00200000
 -#define LINK_STATUS_RX_FLOW_CONTROL_ENABLED                     0x00400000
 -
 -	u32			link_status1;
 -	u32			ext_phy_fw_version;
 -	u32			drv_phy_cfg_addr;
 -
 -	u32			port_stx;
 -
 -	u32			stat_nig_timer;
 -
 -	struct port_mf_cfg	port_mf_config;
 -	struct port_stats	stats;
 -
 +#define LINK_STATUS_LINK_UP			0x00000001
 +#define LINK_STATUS_SPEED_AND_DUPLEX_MASK	0x0000001e
 +#define LINK_STATUS_SPEED_AND_DUPLEX_1000THD	(1 << 1)
 +#define LINK_STATUS_SPEED_AND_DUPLEX_1000TFD	(2 << 1)
 +#define LINK_STATUS_SPEED_AND_DUPLEX_10G	(3 << 1)
 +#define LINK_STATUS_SPEED_AND_DUPLEX_20G	(4 << 1)
 +#define LINK_STATUS_SPEED_AND_DUPLEX_40G	(5 << 1)
 +#define LINK_STATUS_SPEED_AND_DUPLEX_50G	(6 << 1)
 +#define LINK_STATUS_SPEED_AND_DUPLEX_100G	(7 << 1)
 +#define LINK_STATUS_SPEED_AND_DUPLEX_25G	(8 << 1)
 +
 +#define LINK_STATUS_AUTO_NEGOTIATE_ENABLED	0x00000020
 +
 +#define LINK_STATUS_AUTO_NEGOTIATE_COMPLETE	0x00000040
 +#define LINK_STATUS_PARALLEL_DETECTION_USED	0x00000080
 +
 +#define LINK_STATUS_PFC_ENABLED				0x00000100
 +#define LINK_STATUS_LINK_PARTNER_1000TFD_CAPABLE 0x00000200
 +#define LINK_STATUS_LINK_PARTNER_1000THD_CAPABLE 0x00000400
 +#define LINK_STATUS_LINK_PARTNER_10G_CAPABLE		0x00000800
 +#define LINK_STATUS_LINK_PARTNER_20G_CAPABLE		0x00001000
 +#define LINK_STATUS_LINK_PARTNER_40G_CAPABLE		0x00002000
 +#define LINK_STATUS_LINK_PARTNER_50G_CAPABLE		0x00004000
 +#define LINK_STATUS_LINK_PARTNER_100G_CAPABLE		0x00008000
 +#define LINK_STATUS_LINK_PARTNER_25G_CAPABLE		0x00010000
 +
 +#define LINK_STATUS_LINK_PARTNER_FLOW_CONTROL_MASK	0x000C0000
 +#define LINK_STATUS_LINK_PARTNER_NOT_PAUSE_CAPABLE	(0 << 18)
 +#define LINK_STATUS_LINK_PARTNER_SYMMETRIC_PAUSE	(1 << 18)
 +#define LINK_STATUS_LINK_PARTNER_ASYMMETRIC_PAUSE	(2 << 18)
 +#define LINK_STATUS_LINK_PARTNER_BOTH_PAUSE		(3 << 18)
 +
 +#define LINK_STATUS_SFP_TX_FAULT			0x00100000
 +#define LINK_STATUS_TX_FLOW_CONTROL_ENABLED		0x00200000
 +#define LINK_STATUS_RX_FLOW_CONTROL_ENABLED		0x00400000
 +#define LINK_STATUS_RX_SIGNAL_PRESENT			0x00800000
 +#define LINK_STATUS_MAC_LOCAL_FAULT			0x01000000
 +#define LINK_STATUS_MAC_REMOTE_FAULT			0x02000000
 +#define LINK_STATUS_UNSUPPORTED_SPD_REQ			0x04000000
 +
 +	u32 link_status1;
 +	u32 ext_phy_fw_version;
 +	u32 drv_phy_cfg_addr;
 +
 +	u32 port_stx;
 +
 +	u32 stat_nig_timer;
 +
 +	struct port_mf_cfg port_mf_config;
 +	struct port_stats stats;
 +
++<<<<<<< HEAD
 +	u32 media_type;
 +#define MEDIA_UNSPECIFIED	0x0
 +#define MEDIA_SFPP_10G_FIBER	0x1
 +#define MEDIA_XFP_FIBER		0x2
 +#define MEDIA_DA_TWINAX		0x3
 +#define MEDIA_BASE_T		0x4
 +#define MEDIA_SFP_1G_FIBER	0x5
 +#define MEDIA_MODULE_FIBER	0x6
 +#define MEDIA_KR		0xf0
 +#define MEDIA_NOT_PRESENT	0xff
++=======
+ 	u32			media_type;
+ #define MEDIA_UNSPECIFIED       0x0
+ #define MEDIA_SFPP_10G_FIBER    0x1
+ #define MEDIA_XFP_FIBER         0x2
+ #define MEDIA_DA_TWINAX         0x3
+ #define MEDIA_BASE_T            0x4
+ #define MEDIA_SFP_1G_FIBER      0x5
+ #define MEDIA_MODULE_FIBER      0x6
+ #define MEDIA_KR                0xf0
+ #define MEDIA_NOT_PRESENT       0xff
++>>>>>>> b639f197210d (qed: Add missing port-mode)
  
  	u32 lfa_status;
 -#define LFA_LINK_FLAP_REASON_OFFSET             0
 -#define LFA_LINK_FLAP_REASON_MASK               0x000000ff
 -#define LFA_NO_REASON                                   (0 << 0)
 -#define LFA_LINK_DOWN					BIT(0)
 -#define LFA_FORCE_INIT                                  BIT(1)
 -#define LFA_LOOPBACK_MISMATCH                           BIT(2)
 -#define LFA_SPEED_MISMATCH                              BIT(3)
 -#define LFA_FLOW_CTRL_MISMATCH                          BIT(4)
 -#define LFA_ADV_SPEED_MISMATCH                          BIT(5)
 -#define LINK_FLAP_AVOIDANCE_COUNT_OFFSET        8
 -#define LINK_FLAP_AVOIDANCE_COUNT_MASK          0x0000ff00
 -#define LINK_FLAP_COUNT_OFFSET                  16
 -#define LINK_FLAP_COUNT_MASK                    0x00ff0000
 -
 -	u32					link_change_count;
 -
 -	/* LLDP params */
 -	struct lldp_config_params_s		lldp_config_params[
 -		LLDP_MAX_LLDP_AGENTS];
 -	struct lldp_status_params_s		lldp_status_params[
 -		LLDP_MAX_LLDP_AGENTS];
 -	struct lldp_system_tlvs_buffer_s	system_lldp_tlvs_buf;
 +	u32 link_change_count;
 +
 +	struct lldp_config_params_s lldp_config_params[LLDP_MAX_LLDP_AGENTS];
 +	struct lldp_status_params_s lldp_status_params[LLDP_MAX_LLDP_AGENTS];
 +	struct lldp_system_tlvs_buffer_s system_lldp_tlvs_buf;
  
  	/* DCBX related MIB */
 -	struct dcbx_local_params		local_admin_dcbx_mib;
 -	struct dcbx_mib				remote_dcbx_mib;
 -	struct dcbx_mib				operational_dcbx_mib;
 +	struct dcbx_local_params local_admin_dcbx_mib;
 +	struct dcbx_mib remote_dcbx_mib;
 +	struct dcbx_mib operational_dcbx_mib;
  
 -	u32					fc_npiv_nvram_tbl_addr;
 -	u32					fc_npiv_nvram_tbl_size;
 -	u32					transceiver_data;
 -#define PMM_TRANSCEIVER_STATE_MASK		0x000000FF
 -#define PMM_TRANSCEIVER_STATE_SHIFT		0x00000000
 -#define PMM_TRANSCEIVER_STATE_PRESENT		0x00000001
 -};
 +	u32 reserved[2];
 +	u32 transceiver_data;
 +#define ETH_TRANSCEIVER_STATE_MASK	0x000000FF
 +#define ETH_TRANSCEIVER_STATE_SHIFT	0x00000000
 +#define ETH_TRANSCEIVER_STATE_UNPLUGGED	0x00000000
 +#define ETH_TRANSCEIVER_STATE_PRESENT	0x00000001
 +#define ETH_TRANSCEIVER_STATE_VALID	0x00000003
 +#define ETH_TRANSCEIVER_STATE_UPDATING	0x00000008
  
 -/**************************************/
 -/*                                    */
 -/*     P U B L I C      F U N C       */
 -/*                                    */
 -/**************************************/
 +	u32 wol_info;
 +	u32 wol_pkt_len;
 +	u32 wol_pkt_details;
 +	struct dcb_dscp_map dcb_dscp_map;
 +};
  
  struct public_func {
 -	u32	iscsi_boot_signature;
 -	u32	iscsi_boot_block_offset;
 -
 -	u32	mtu_size;
 -	u32	c2s_pcp_map_lower;
 -	u32	c2s_pcp_map_upper;
 -	u32	c2s_pcp_map_default;
 -	u32	reserved[4];
 -
 -	u32	config;
 -
 -	/* E/R/I/D */
 -	/* function 0 of each port cannot be hidden */
 -#define FUNC_MF_CFG_FUNC_HIDE                   0x00000001
 -#define FUNC_MF_CFG_PAUSE_ON_HOST_RING          0x00000002
 -#define FUNC_MF_CFG_PAUSE_ON_HOST_RING_SHIFT    0x00000001
 -
 -#define FUNC_MF_CFG_PROTOCOL_MASK               0x000000f0
 -#define FUNC_MF_CFG_PROTOCOL_SHIFT              4
 -#define FUNC_MF_CFG_PROTOCOL_ETHERNET           0x00000000
 +	u32 reserved0[2];
 +
 +	u32 mtu_size;
 +
 +	u32 reserved[7];
 +
 +	u32 config;
 +#define FUNC_MF_CFG_FUNC_HIDE			0x00000001
 +#define FUNC_MF_CFG_PAUSE_ON_HOST_RING		0x00000002
 +#define FUNC_MF_CFG_PAUSE_ON_HOST_RING_SHIFT	0x00000001
 +
 +#define FUNC_MF_CFG_PROTOCOL_MASK	0x000000f0
 +#define FUNC_MF_CFG_PROTOCOL_SHIFT	4
 +#define FUNC_MF_CFG_PROTOCOL_ETHERNET	0x00000000
  #define FUNC_MF_CFG_PROTOCOL_ISCSI              0x00000010
 -#define FUNC_MF_CFG_PROTOCOL_FCOE               0x00000020
  #define FUNC_MF_CFG_PROTOCOL_ROCE               0x00000030
 -#define FUNC_MF_CFG_PROTOCOL_MAX                0x00000030
 +#define FUNC_MF_CFG_PROTOCOL_MAX	0x00000030
  
 -	/* MINBW, MAXBW */
 -	/* value range - 0..100, increments in 1 %  */
 -#define FUNC_MF_CFG_MIN_BW_MASK                 0x0000ff00
 -#define FUNC_MF_CFG_MIN_BW_SHIFT                8
 -#define FUNC_MF_CFG_MIN_BW_DEFAULT              0x00000000
 -#define FUNC_MF_CFG_MAX_BW_MASK                 0x00ff0000
 -#define FUNC_MF_CFG_MAX_BW_SHIFT                16
 -#define FUNC_MF_CFG_MAX_BW_DEFAULT              0x00640000
 +#define FUNC_MF_CFG_MIN_BW_MASK		0x0000ff00
 +#define FUNC_MF_CFG_MIN_BW_SHIFT	8
 +#define FUNC_MF_CFG_MIN_BW_DEFAULT	0x00000000
 +#define FUNC_MF_CFG_MAX_BW_MASK		0x00ff0000
 +#define FUNC_MF_CFG_MAX_BW_SHIFT	16
 +#define FUNC_MF_CFG_MAX_BW_DEFAULT	0x00640000
  
 -	u32	status;
 -#define FUNC_STATUS_VLINK_DOWN                  0x00000001
 +	u32 status;
 +#define FUNC_STATUS_VLINK_DOWN		0x00000001
  
 -	u32	mac_upper;  /* MAC */
 -#define FUNC_MF_CFG_UPPERMAC_MASK               0x0000ffff
 -#define FUNC_MF_CFG_UPPERMAC_SHIFT              0
 -#define FUNC_MF_CFG_UPPERMAC_DEFAULT            FUNC_MF_CFG_UPPERMAC_MASK
 -	u32	mac_lower;
 -#define FUNC_MF_CFG_LOWERMAC_DEFAULT            0xffffffff
 +	u32 mac_upper;
 +#define FUNC_MF_CFG_UPPERMAC_MASK	0x0000ffff
 +#define FUNC_MF_CFG_UPPERMAC_SHIFT	0
 +#define FUNC_MF_CFG_UPPERMAC_DEFAULT	FUNC_MF_CFG_UPPERMAC_MASK
 +	u32 mac_lower;
 +#define FUNC_MF_CFG_LOWERMAC_DEFAULT	0xffffffff
  
 -	u32	fcoe_wwn_port_name_upper;
 -	u32	fcoe_wwn_port_name_lower;
 +	u32 fcoe_wwn_port_name_upper;
 +	u32 fcoe_wwn_port_name_lower;
  
 -	u32	fcoe_wwn_node_name_upper;
 -	u32	fcoe_wwn_node_name_lower;
 +	u32 fcoe_wwn_node_name_upper;
 +	u32 fcoe_wwn_node_name_lower;
  
 -	u32	ovlan_stag; /* tags */
 -#define FUNC_MF_CFG_OV_STAG_MASK              0x0000ffff
 -#define FUNC_MF_CFG_OV_STAG_SHIFT             0
 -#define FUNC_MF_CFG_OV_STAG_DEFAULT           FUNC_MF_CFG_OV_STAG_MASK
 +	u32 ovlan_stag;
 +#define FUNC_MF_CFG_OV_STAG_MASK	0x0000ffff
 +#define FUNC_MF_CFG_OV_STAG_SHIFT	0
 +#define FUNC_MF_CFG_OV_STAG_DEFAULT	FUNC_MF_CFG_OV_STAG_MASK
  
 -	u32	pf_allocation;  /* vf per pf */
 +	u32 pf_allocation;
  
 -	u32	preserve_data;  /* Will be used bt CCM */
 +	u32 preserve_data;
  
 -	u32	driver_last_activity_ts;
 +	u32 driver_last_activity_ts;
  
 -	u32	drv_ack_vf_disabled[VF_MAX_STATIC / 32]; /* 0x0044 */
 +	u32 drv_ack_vf_disabled[VF_MAX_STATIC / 32];
  
 -	u32	drv_id;
 -#define DRV_ID_PDA_COMP_VER_MASK        0x0000ffff
 -#define DRV_ID_PDA_COMP_VER_SHIFT       0
 +	u32 drv_id;
 +#define DRV_ID_PDA_COMP_VER_MASK	0x0000ffff
 +#define DRV_ID_PDA_COMP_VER_SHIFT	0
  
 -#define DRV_ID_MCP_HSI_VER_MASK         0x00ff0000
 -#define DRV_ID_MCP_HSI_VER_SHIFT        16
 -#define DRV_ID_MCP_HSI_VER_CURRENT	BIT(DRV_ID_MCP_HSI_VER_SHIFT)
 +#define DRV_ID_MCP_HSI_VER_MASK		0x00ff0000
 +#define DRV_ID_MCP_HSI_VER_SHIFT	16
 +#define DRV_ID_MCP_HSI_VER_CURRENT	(1 << DRV_ID_MCP_HSI_VER_SHIFT)
  
 -#define DRV_ID_DRV_TYPE_MASK            0x7f000000
 -#define DRV_ID_DRV_TYPE_SHIFT           24
 -#define DRV_ID_DRV_TYPE_UNKNOWN         (0 << DRV_ID_DRV_TYPE_SHIFT)
 -#define DRV_ID_DRV_TYPE_LINUX           (1 << DRV_ID_DRV_TYPE_SHIFT)
 -#define DRV_ID_DRV_TYPE_WINDOWS         (2 << DRV_ID_DRV_TYPE_SHIFT)
 -#define DRV_ID_DRV_TYPE_DIAG            (3 << DRV_ID_DRV_TYPE_SHIFT)
 -#define DRV_ID_DRV_TYPE_PREBOOT         (4 << DRV_ID_DRV_TYPE_SHIFT)
 -#define DRV_ID_DRV_TYPE_SOLARIS         (5 << DRV_ID_DRV_TYPE_SHIFT)
 -#define DRV_ID_DRV_TYPE_VMWARE          (6 << DRV_ID_DRV_TYPE_SHIFT)
 -#define DRV_ID_DRV_TYPE_FREEBSD         (7 << DRV_ID_DRV_TYPE_SHIFT)
 -#define DRV_ID_DRV_TYPE_AIX             (8 << DRV_ID_DRV_TYPE_SHIFT)
 +#define DRV_ID_DRV_TYPE_MASK		0x7f000000
 +#define DRV_ID_DRV_TYPE_SHIFT		24
 +#define DRV_ID_DRV_TYPE_UNKNOWN		(0 << DRV_ID_DRV_TYPE_SHIFT)
 +#define DRV_ID_DRV_TYPE_LINUX		(1 << DRV_ID_DRV_TYPE_SHIFT)
  
 -#define DRV_ID_DRV_INIT_HW_MASK         0x80000000
 -#define DRV_ID_DRV_INIT_HW_SHIFT        31
 -#define DRV_ID_DRV_INIT_HW_FLAG         BIT(DRV_ID_DRV_INIT_HW_SHIFT)
 +#define DRV_ID_DRV_INIT_HW_MASK		0x80000000
 +#define DRV_ID_DRV_INIT_HW_SHIFT	31
 +#define DRV_ID_DRV_INIT_HW_FLAG		(1 << DRV_ID_DRV_INIT_HW_SHIFT)
  };
  
 -/**************************************/
 -/*                                    */
 -/*     P U B L I C       M B          */
 -/*                                    */
 -/**************************************/
 -/* This is the only section that the driver can write to, and each */
 -/* Basically each driver request to set feature parameters,
 - * will be done using a different command, which will be linked
 - * to a specific data structure from the union below.
 - * For huge strucuture, the common blank structure should be used.
 - */
 -
  struct mcp_mac {
 -	u32	mac_upper;  /* Upper 16 bits are always zeroes */
 -	u32	mac_lower;
 +	u32 mac_upper;
 +	u32 mac_lower;
  };
  
  struct mcp_val64 {
* Unmerged path drivers/net/ethernet/qlogic/qed/qed_hsi.h
diff --git a/drivers/net/ethernet/qlogic/qed/qed_main.c b/drivers/net/ethernet/qlogic/qed/qed_main.c
index 6c4606b44b7e..f160a294cc05 100644
--- a/drivers/net/ethernet/qlogic/qed/qed_main.c
+++ b/drivers/net/ethernet/qlogic/qed/qed_main.c
@@ -1088,6 +1088,7 @@ static int qed_get_port_type(u32 media_type)
 	case MEDIA_SFPP_10G_FIBER:
 	case MEDIA_SFP_1G_FIBER:
 	case MEDIA_XFP_FIBER:
+	case MEDIA_MODULE_FIBER:
 	case MEDIA_KR:
 		port_type = PORT_FIBRE;
 		break;
