Bluetooth: Fix reason code used for rejecting SCO connections

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Johan Hedberg <johan.hedberg@intel.com>
commit d41c15cf95bd91b9c333f6f749670e22c8a47ad9
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/d41c15cf.failed

The core specification defines valid values for the
HCI_Reject_Synchronous_Connection_Request command to be 0x0D-0x0F. So
far the code has been using HCI_ERROR_REMOTE_USER_TERM (0x13) which is
not a valid value and is therefore being rejected by some controllers:

 > HCI Event: Connect Request (0x04) plen 10
	bdaddr 40:6F:2A:6A:E5:E0 class 0x000000 type eSCO
 < HCI Command: Reject Synchronous Connection (0x01|0x002a) plen 7
	bdaddr 40:6F:2A:6A:E5:E0 reason 0x13
	Reason: Remote User Terminated Connection
 > HCI Event: Command Status (0x0f) plen 4
	Reject Synchronous Connection (0x01|0x002a) status 0x12 ncmd 1
	Error: Invalid HCI Command Parameters

This patch introduces a new define for a value from the valid range
(0x0d == Connection Rejected Due To Limited Resources) and uses it
instead for rejecting incoming connections.

	Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>
	Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
(cherry picked from commit d41c15cf95bd91b9c333f6f749670e22c8a47ad9)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/bluetooth/hci_conn.c
diff --cc net/bluetooth/hci_conn.c
index 3809617aa98d,445829cd363c..000000000000
--- a/net/bluetooth/hci_conn.c
+++ b/net/bluetooth/hci_conn.c
@@@ -228,8 -104,33 +228,34 @@@ static void hci_acl_create_connection(s
  	hci_send_cmd(hdev, HCI_OP_CREATE_CONN, sizeof(cp), &cp);
  }
  
++<<<<<<< HEAD
++=======
+ static void hci_acl_create_connection_cancel(struct hci_conn *conn)
+ {
+ 	struct hci_cp_create_conn_cancel cp;
+ 
+ 	BT_DBG("hcon %p", conn);
+ 
+ 	if (conn->hdev->hci_ver < BLUETOOTH_VER_1_2)
+ 		return;
+ 
+ 	bacpy(&cp.bdaddr, &conn->dst);
+ 	hci_send_cmd(conn->hdev, HCI_OP_CREATE_CONN_CANCEL, sizeof(cp), &cp);
+ }
+ 
+ static void hci_reject_sco(struct hci_conn *conn)
+ {
+ 	struct hci_cp_reject_sync_conn_req cp;
+ 
+ 	cp.reason = HCI_ERROR_REJ_LIMITED_RESOURCES;
+ 	bacpy(&cp.bdaddr, &conn->dst);
+ 
+ 	hci_send_cmd(conn->hdev, HCI_OP_REJECT_SYNC_CONN_REQ, sizeof(cp), &cp);
+ }
+ 
++>>>>>>> d41c15cf95bd (Bluetooth: Fix reason code used for rejecting SCO connections)
  int hci_disconnect(struct hci_conn *conn, __u8 reason)
  {
 -	struct hci_cp_disconnect cp;
 -
  	BT_DBG("hcon %p", conn);
  
  	/* When we are master of an established connection and it enters
* Unmerged path net/bluetooth/hci_conn.c
