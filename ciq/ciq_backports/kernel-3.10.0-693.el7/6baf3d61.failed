x86/tsc: Add additional Intel CPU models to the crystal quirk list

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [x86] tsc: Add additional Intel CPU models to the crystal quirk list (Prarit Bhargava) [1369419]
Rebuild_FUZZ: 96.88%
commit-author Prarit Bhargava <prarit@redhat.com>
commit 6baf3d61821f5b38f27b4e9f044ad4d1e8f3d14f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/6baf3d61.failed

commit aa297292d708 ("x86/tsc: Enumerate SKL cpu_khz and tsc_khz via
CPUID") added code to retrieve the crystal and TSC frequency from CPUID
leaves. If the crystal freqency is enumerated as 0,the resulting TSC
frequency is 0 as well. For CPUs with a known fixed crystal frequency a
quirk list is available to set the frequency,

Kabylake and SkylakeX CPUs are missing in the list of CPUs which need this
quirk. Add them so the TSC frequency can be calculated correctly.

[ tglx: Removed the silly default case as the switch() is only invoked when
  	cpu_khz is 0. Massaged changelog. ]

	Signed-off-by: Prarit Bhargava <prarit@redhat.com>
	Cc: Len Brown <len.brown@intel.com>
	Cc: Rafael Aquini <aquini@redhat.com>
	Cc: "Peter Zijlstra (Intel)" <peterz@infradead.org>
	Cc: Andy Lutomirski <luto@kernel.org>
Link: http://lkml.kernel.org/r/1474289501-31717-3-git-send-email-prarit@redhat.com
	Signed-off-by: Thomas Gleixner <tglx@linutronix.de>

(cherry picked from commit 6baf3d61821f5b38f27b4e9f044ad4d1e8f3d14f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kernel/tsc.c
diff --cc arch/x86/kernel/tsc.c
index 18346c131948,46b2f41f8b05..000000000000
--- a/arch/x86/kernel/tsc.c
+++ b/arch/x86/kernel/tsc.c
@@@ -705,11 -687,16 +705,24 @@@ unsigned long native_calibrate_tsc(void
  
  	if (crystal_khz == 0) {
  		switch (boot_cpu_data.x86_model) {
++<<<<<<< HEAD
 +		case 0x4E:	/* SKL */
 +		case 0x5E:	/* SKL */
 +			crystal_khz = 24000;	/* 24.0 MHz */
 +			break;
 +		case 0x5C:	/* BXT */
++=======
+ 		case INTEL_FAM6_SKYLAKE_MOBILE:
+ 		case INTEL_FAM6_SKYLAKE_DESKTOP:
+ 		case INTEL_FAM6_KABYLAKE_MOBILE:
+ 		case INTEL_FAM6_KABYLAKE_DESKTOP:
+ 			crystal_khz = 24000;	/* 24.0 MHz */
+ 			break;
+ 		case INTEL_FAM6_SKYLAKE_X:
+ 			crystal_khz = 25000;	/* 25.0 MHz */
+ 			break;
+ 		case INTEL_FAM6_ATOM_GOLDMONT:
++>>>>>>> 6baf3d61821f (x86/tsc: Add additional Intel CPU models to the crystal quirk list)
  			crystal_khz = 19200;	/* 19.2 MHz */
  			break;
  		}
* Unmerged path arch/x86/kernel/tsc.c
