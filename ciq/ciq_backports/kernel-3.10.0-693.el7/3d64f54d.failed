HID: wacom: move unit and unitExpo initialization to wacom_calculate_res

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [hid] wacom: move unit and unitExpo initialization to wacom_calculate_res (Aristeu Rozanski) [1346348 1388646 1385026]
Rebuild_FUZZ: 96.40%
commit-author Ping Cheng <pinglinux@gmail.com>
commit 3d64f54dd0de57bdbcde4b91495fb8e02c620762
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/3d64f54d.failed

That is where they belong...

	Signed-off-by: Ping Cheng <pingc@wacom.com>
	Reviewed-by: Jason Gerecke <jason.gerecke@wacom.com>
	Signed-off-by: Jiri Kosina <jkosina@suse.cz>
(cherry picked from commit 3d64f54dd0de57bdbcde4b91495fb8e02c620762)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/hid/wacom_sys.c
diff --cc drivers/hid/wacom_sys.c
index 527bf559d1db,b3c6f111093b..000000000000
--- a/drivers/hid/wacom_sys.c
+++ b/drivers/hid/wacom_sys.c
@@@ -1334,43 -1453,35 +1340,47 @@@ static int wacom_probe(struct usb_inter
  	wacom->intf = intf;
  	mutex_init(&wacom->lock);
  	INIT_WORK(&wacom->work, wacom_wireless_work);
 +	usb_make_path(dev, wacom->phys, sizeof(wacom->phys));
 +	strlcat(wacom->phys, "/input0", sizeof(wacom->phys));
  
 -	if (!(features->quirks & WACOM_QUIRK_NO_INPUT)) {
 -		error = wacom_allocate_inputs(wacom);
 -		if (error)
 -			goto fail_allocate_inputs;
 -	}
 +	endpoint = &intf->cur_altsetting->endpoint[0].desc;
 +
 +	/* set the default size in case we do not get them from hid */
 +	wacom_set_default_phy(features);
 +
 +	/* Retrieve the physical and logical size for touch devices */
 +	error = wacom_retrieve_hid_descriptor(intf, features);
 +	if (error)
 +		goto fail3;
  
++<<<<<<< HEAD
  	/*
 -	 * Bamboo Pad has a generic hid handling for the Pen, and we switch it
 -	 * into debug mode for the touch part.
 -	 * We ignore the other interfaces.
 +	 * Intuos5 has no useful data about its touch interface in its
 +	 * HID descriptor. If this is the touch interface (wMaxPacketSize
 +	 * of WACOM_PKGLEN_BBTOUCH3), override the table values.
  	 */
 -	if (features->type == BAMBOO_PAD) {
 -		if (features->pktlen == WACOM_PKGLEN_PENABLED) {
 -			features->type = HID_GENERIC;
 -		} else if ((features->pktlen != WACOM_PKGLEN_BPAD_TOUCH) &&
 -			   (features->pktlen != WACOM_PKGLEN_BPAD_TOUCH_USB)) {
 -			error = -ENODEV;
 -			goto fail_shared_data;
 +	if (features->type >= INTUOS5S && features->type <= INTUOSPL) {
 +		if (endpoint->wMaxPacketSize == WACOM_PKGLEN_BBTOUCH3) {
 +			features->device_type = BTN_TOOL_FINGER;
 +			features->pktlen = WACOM_PKGLEN_BBTOUCH3;
 +
 +			features->x_max = 4096;
 +			features->y_max = 4096;
 +		} else {
 +			features->device_type = BTN_TOOL_PEN;
  		}
  	}
  
 -	/* set the default size in case we do not get them from hid */
 -	wacom_set_default_phy(features);
 -
 -	/* Retrieve the physical and logical size for touch devices */
 -	wacom_retrieve_hid_descriptor(hdev, features);
 +	wacom_setup_device_quirks(features);
  
 +	/* set unit to "100th of a mm" for devices not reported by HID */
 +	if (!features->unit) {
 +		features->unit = 0x11;
 +		features->unitExpo = 16 - 3;
 +	}
++=======
+ 	wacom_setup_device_quirks(wacom);
++>>>>>>> 3d64f54dd0de (HID: wacom: move unit and unitExpo initialization to wacom_calculate_res)
  	wacom_calculate_res(features);
  
  	strlcpy(wacom_wac->name, features->name, sizeof(wacom_wac->name));
* Unmerged path drivers/hid/wacom_sys.c
