tools/power turbostat: decode HWP registers

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [tools] power turbostat: decode HWP registers (Prarit Bhargava) [1422076]
Rebuild_FUZZ: 92.50%
commit-author Len Brown <len.brown@intel.com>
commit 7f5c258e1ce1e0909d3195694ac79f143051e513
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/7f5c258e.failed

 # turbostat --debug
...
CPUID(6): ... HWP, HWPnotify, HWPwindow, HWPepp, HWPpkg ...
...
cpu0: MSR_PM_ENABLE: 0x00000001 (HWP)
cpu0: MSR_HWP_CAPABILITIES: 0x01050916 (high 0x16 guar 0x9 eff 0x5 low 0x1)
cpu0: MSR_HWP_REQUEST: 0x80001604 (min 0x4 max 0x16 des 0x0 epp 0x80 window 0x0 pkg 0x0)
cpu0: MSR_HWP_INTERRUPT: 0x00000001 (EN_Guaranteed_Perf_Change, Dis_Excursion_Min)
cpu0: MSR_HWP_STATUS: 0x00000000 (No-Guaranteed_Perf_Change, No-Excursion_Min)

	Signed-off-by: Len Brown <len.brown@intel.com>
(cherry picked from commit 7f5c258e1ce1e0909d3195694ac79f143051e513)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/power/x86/turbostat/turbostat.c
diff --cc tools/power/x86/turbostat/turbostat.c
index 14d5a1ce6257,af3b955aad1d..000000000000
--- a/tools/power/x86/turbostat/turbostat.c
+++ b/tools/power/x86/turbostat/turbostat.c
@@@ -2697,9 -2770,23 +2794,26 @@@ guess
  
  	return 0;
  }
++<<<<<<< HEAD
++=======
+ 
+ void decode_misc_enable_msr(void)
+ {
+ 	unsigned long long msr;
+ 
+ 	if (!get_msr(base_cpu, MSR_IA32_MISC_ENABLE, &msr))
+ 		fprintf(stderr, "cpu%d: MSR_IA32_MISC_ENABLE: 0x%08llx (%s %s %s)\n",
+ 			base_cpu, msr,
+ 			msr & (1 << 3) ? "TCC" : "",
+ 			msr & (1 << 16) ? "EIST" : "",
+ 			msr & (1 << 18) ? "MONITOR" : "");
+ }
+ 
+ 
++>>>>>>> 7f5c258e1ce1 (tools/power turbostat: decode HWP registers)
  void process_cpuid()
  {
 -	unsigned int eax, ebx, ecx, edx, max_level, max_extended_level;
 +	unsigned int eax, ebx, ecx, edx, max_level;
  	unsigned int fms, family, model, stepping;
  
  	eax = ebx = ecx = edx = 0;
@@@ -2757,13 -2859,22 +2876,19 @@@
  	has_epb = ecx & (1 << 3);
  
  	if (debug)
- 		fprintf(stderr, "CPUID(6): %sAPERF, %sDTS, %sPTM, %sEPB\n",
- 			has_aperf ? "" : "No ",
- 			do_dts ? "" : "No ",
- 			do_ptm ? "" : "No ",
- 			has_epb ? "" : "No ");
+ 		fprintf(stderr, "CPUID(6): %sAPERF, %sDTS, %sPTM, %sHWP, "
+ 			"%sHWPnotify, %sHWPwindow, %sHWPepp, %sHWPpkg, %sEPB\n",
+ 			has_aperf ? "" : "No-",
+ 			do_dts ? "" : "No-",
+ 			do_ptm ? "" : "No-",
+ 			has_hwp ? "" : "No-",
+ 			has_hwp_notify ? "" : "No-",
+ 			has_hwp_activity_window ? "" : "No-",
+ 			has_hwp_epp ? "" : "No-",
+ 			has_hwp_pkg ? "" : "No-",
+ 			has_epb ? "" : "No-");
  
 -	if (debug)
 -		decode_misc_enable_msr();
 -
 -	if (max_level >= 0x15) {
 +	if (max_level > 0x15) {
  		unsigned int eax_crystal;
  		unsigned int ebx_tsc;
  
@@@ -3158,7 -3276,7 +3286,11 @@@ int get_and_dump_counters(void
  }
  
  void print_version() {
++<<<<<<< HEAD
 +	fprintf(stderr, "turbostat version 4.12 5 Apr 2016"
++=======
+ 	fprintf(stderr, "turbostat version 4.10 10 Dec, 2015"
++>>>>>>> 7f5c258e1ce1 (tools/power turbostat: decode HWP registers)
  		" - Len Brown <lenb@kernel.org>\n");
  }
  
* Unmerged path tools/power/x86/turbostat/turbostat.c
