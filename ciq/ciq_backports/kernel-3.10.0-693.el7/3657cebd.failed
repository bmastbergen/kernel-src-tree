PCI: Add quirk for Intersil/Techwell TW686[4589] AV capture cards

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [pci] Add quirk for Intersil/Techwell TW686[4589] AV capture cards (Myron Stowe) [1403464]
Rebuild_FUZZ: 89.83%
commit-author Krzysztof =?utf-8?Q?Ha=C5=82asa?= <khalasa@piap.pl>
commit 3657cebda5eb9dc1c4c6a0ea5b38bfef70aea50a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/3657cebd.failed

Intersil/Techwell TW686[4589]-based video capture cards have an empty
(zero) class code.  Fix it.

	Signed-off-by: Krzysztof Ha≈Çasa <khalasa@piap.pl>
	Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
(cherry picked from commit 3657cebda5eb9dc1c4c6a0ea5b38bfef70aea50a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/pci/quirks.c
diff --cc drivers/pci/quirks.c
index edd835d9c737,1b9fc4ed39a3..000000000000
--- a/drivers/pci/quirks.c
+++ b/drivers/pci/quirks.c
@@@ -3644,19 -3664,26 +3644,42 @@@ DECLARE_PCI_FIXUP_HEADER(0x1283, 0x8892
  DECLARE_PCI_FIXUP_HEADER(0x8086, 0x244e, quirk_use_pcie_bridge_dma_alias);
  
  /*
++<<<<<<< HEAD
 + * MIC x200 NTB forwards PCIe traffic using multiple alien RIDs. They have to
 + * be added as aliases to the DMA device in order to allow buffer access
 + * when IOMMU is enabled. Following devfns have to match RIT-LUT table
 + * programmed in the EEPROM.
 + */
 +static void quirk_mic_x200_dma_alias(struct pci_dev *pdev)
 +{
 +	pci_add_dma_alias(pdev, PCI_DEVFN(0x10, 0x0));
 +	pci_add_dma_alias(pdev, PCI_DEVFN(0x11, 0x0));
 +	pci_add_dma_alias(pdev, PCI_DEVFN(0x12, 0x3));
 +}
 +DECLARE_PCI_FIXUP_HEADER(PCI_VENDOR_ID_INTEL, 0x2260, quirk_mic_x200_dma_alias);
 +DECLARE_PCI_FIXUP_HEADER(PCI_VENDOR_ID_INTEL, 0x2264, quirk_mic_x200_dma_alias);
++=======
+  * Intersil/Techwell TW686[4589]-based video capture cards have an empty (zero)
+  * class code.  Fix it.
+  */
+ static void quirk_tw686x_class(struct pci_dev *pdev)
+ {
+ 	u32 class = pdev->class;
+ 
+ 	/* Use "Multimedia controller" class */
+ 	pdev->class = (PCI_CLASS_MULTIMEDIA_OTHER << 8) | 0x01;
+ 	dev_info(&pdev->dev, "TW686x PCI class overridden (%#08x -> %#08x)\n",
+ 		 class, pdev->class);
+ }
+ DECLARE_PCI_FIXUP_CLASS_EARLY(0x1797, 0x6864, PCI_CLASS_NOT_DEFINED, 0,
+ 			      quirk_tw686x_class);
+ DECLARE_PCI_FIXUP_CLASS_EARLY(0x1797, 0x6865, PCI_CLASS_NOT_DEFINED, 0,
+ 			      quirk_tw686x_class);
+ DECLARE_PCI_FIXUP_CLASS_EARLY(0x1797, 0x6868, PCI_CLASS_NOT_DEFINED, 0,
+ 			      quirk_tw686x_class);
+ DECLARE_PCI_FIXUP_CLASS_EARLY(0x1797, 0x6869, PCI_CLASS_NOT_DEFINED, 0,
+ 			      quirk_tw686x_class);
++>>>>>>> 3657cebda5eb (PCI: Add quirk for Intersil/Techwell TW686[4589] AV capture cards)
  
  /*
   * AMD has indicated that the devices below do not support peer-to-peer
* Unmerged path drivers/pci/quirks.c
