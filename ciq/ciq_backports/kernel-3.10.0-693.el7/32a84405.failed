xen-netfront: respect user provided max_queues

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Wei Liu <wei.liu2@citrix.com>
commit 32a844056fd43dda647e1c3c6b9983bdfa04d17d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/32a84405.failed

Originally that parameter was always reset to num_online_cpus during
module initialisation, which renders it useless.

The fix is to only set max_queues to num_online_cpus when user has not
provided a value.

	Signed-off-by: Wei Liu <wei.liu2@citrix.com>
	Cc: David Vrabel <david.vrabel@citrix.com>
	Reviewed-by: David Vrabel <david.vrabel@citrix.com>
	Tested-by: David Vrabel <david.vrabel@citrix.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 32a844056fd43dda647e1c3c6b9983bdfa04d17d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/xen-netfront.c
diff --cc drivers/net/xen-netfront.c
index 8896052a2ee0,b9c637a0036b..000000000000
--- a/drivers/net/xen-netfront.c
+++ b/drivers/net/xen-netfront.c
@@@ -2076,6 -2132,12 +2076,15 @@@ static int __init netif_init(void
  
  	pr_info("Initialising Xen virtual ethernet driver\n");
  
++<<<<<<< HEAD
++=======
+ 	/* Allow as many queues as there are CPUs if user has not
+ 	 * specified a value.
+ 	 */
+ 	if (xennet_max_queues == 0)
+ 		xennet_max_queues = num_online_cpus();
+ 
++>>>>>>> 32a844056fd4 (xen-netfront: respect user provided max_queues)
  	return xenbus_register_frontend(&netfront_driver);
  }
  module_init(netif_init);
* Unmerged path drivers/net/xen-netfront.c
