pNFS: Clear the layout metadata if the server changed the layout stateid

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Trond Myklebust <trond.myklebust@primarydata.com>
commit d9b61708fe6dcab7b50abfb87cb47690d00269a1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/d9b61708.failed

If the server changed the layout stateid's "other" field, then
we should treat the old layout as being completely gone. In that
case, we want to clear the metadata such as scheduled layoutreturns.

Do this by calling pnfs_mark_layout_stateid_invalid().

	Signed-off-by: Trond Myklebust <trond.myklebust@primarydata.com>
(cherry picked from commit d9b61708fe6dcab7b50abfb87cb47690d00269a1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/nfs/pnfs.c
diff --cc fs/nfs/pnfs.c
index 3653071b6302,e16997da157f..000000000000
--- a/fs/nfs/pnfs.c
+++ b/fs/nfs/pnfs.c
@@@ -1724,7 -1785,7 +1724,11 @@@ pnfs_layout_process(struct nfs4_layoutg
  		 * inode invalid, and don't bother validating the stateid
  		 * sequence number.
  		 */
++<<<<<<< HEAD
 +		pnfs_mark_matching_lsegs_invalid(lo, &free_me, NULL);
++=======
+ 		pnfs_mark_layout_stateid_invalid(lo, &free_me);
++>>>>>>> d9b61708fe6d (pNFS: Clear the layout metadata if the server changed the layout stateid)
  
  		nfs4_stateid_copy(&lo->plh_stateid, &res->stateid);
  		lo->plh_barrier = be32_to_cpu(res->stateid.seqid);
* Unmerged path fs/nfs/pnfs.c
