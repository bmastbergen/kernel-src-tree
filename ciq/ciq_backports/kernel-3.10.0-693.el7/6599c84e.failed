dm mpath: do not modify *__clone if blk_mq_alloc_request() fails

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Bart Van Assche <bart.vanassche@sandisk.com>
commit 6599c84e4ce6e428180f9958c7c40aa4202d8072
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/6599c84e.failed

Purely cleanup, avoids potential for strange coding bugs.  But in
reality if __multipath_map() fails the caller has no business looking at
*__clone.

	Signed-off-by: Bart Van Assche <bart.vanassche@sandisk.com>
	Signed-off-by: Mike Snitzer <snitzer@redhat.com>
(cherry picked from commit 6599c84e4ce6e428180f9958c7c40aa4202d8072)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/md/dm-mpath.c
diff --cc drivers/md/dm-mpath.c
index 90cf35eeddb1,0caab4bf3515..000000000000
--- a/drivers/md/dm-mpath.c
+++ b/drivers/md/dm-mpath.c
@@@ -499,10 -580,10 +499,17 @@@ static int __multipath_map(struct dm_ta
  		 * .request_fn stacked on blk-mq path(s) and
  		 * blk-mq stacked on blk-mq path(s).
  		 */
++<<<<<<< HEAD
 +		*__clone = blk_mq_alloc_request(bdev_get_queue(bdev),
 +						rq_data_dir(rq), GFP_ATOMIC, false);
 +		if (IS_ERR(*__clone)) {
 +			/* ENOMEM, requeue */
++=======
+ 		clone = blk_mq_alloc_request(bdev_get_queue(bdev),
+ 					     rq_data_dir(rq), BLK_MQ_REQ_NOWAIT);
+ 		if (IS_ERR(clone)) {
+ 			/* EBUSY, ENODEV or EWOULDBLOCK: requeue */
++>>>>>>> 6599c84e4ce6 (dm mpath: do not modify *__clone if blk_mq_alloc_request() fails)
  			clear_request_fn_mpio(m, map_context);
  			return r;
  		}
* Unmerged path drivers/md/dm-mpath.c
