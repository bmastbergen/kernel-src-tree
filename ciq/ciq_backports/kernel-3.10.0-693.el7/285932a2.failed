tools build: Add jvmti feature detection support

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Jiri Olsa <jolsa@kernel.org>
commit 285932a25879602407f207e862bc5b8416711f42
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/285932a2.failed

Adding support to detect jvmti support. It is not plugged into the
FEATURE_TESTS machinery, because it's quite rare and will be used
separately from perf via feature_check call.

	Signed-off-by: Jiri Olsa <jolsa@kernel.org>
	Tested-by: Stephane Eranian <eranian@google.com>
	Cc: Andi Kleen <andi@firstfloor.org>
	Cc: David Ahern <dsahern@gmail.com>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
	Cc: William Cohen <wcohen@redhat.com>
Link: http://lkml.kernel.org/r/1478093749-5602-3-git-send-email-jolsa@kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 285932a25879602407f207e862bc5b8416711f42)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/build/feature/Makefile
diff --cc tools/build/feature/Makefile
index 017397a4639a,8f668bce8996..000000000000
--- a/tools/build/feature/Makefile
+++ b/tools/build/feature/Makefile
@@@ -44,7 -44,11 +44,15 @@@ FILES=					
  	test-compile-x32.bin		\
  	test-zlib.bin			\
  	test-lzma.bin			\
++<<<<<<< HEAD
 +	test-get_cpuid.bin
++=======
+ 	test-bpf.bin			\
+ 	test-get_cpuid.bin		\
+ 	test-sdt.bin			\
+ 	test-cxx.bin			\
+ 	test-jvmti.bin
++>>>>>>> 285932a25879 (tools build: Add jvmti feature detection support)
  
  FILES := $(addprefix $(OUTPUT),$(FILES))
  
@@@ -209,6 -217,18 +217,21 @@@ $(OUTPUT)test-lzma.bin
  $(OUTPUT)test-get_cpuid.bin:
  	$(BUILD)
  
++<<<<<<< HEAD
++=======
+ $(OUTPUT)test-bpf.bin:
+ 	$(BUILD)
+ 
+ $(OUTPUT)test-sdt.bin:
+ 	$(BUILD)
+ 
+ $(OUTPUT)test-cxx.bin:
+ 	$(BUILDXX) -std=gnu++11
+ 
+ $(OUTPUT)test-jvmti.bin:
+ 	$(BUILD)
+ 
++>>>>>>> 285932a25879 (tools build: Add jvmti feature detection support)
  -include $(OUTPUT)*.d
  
  ###############################
* Unmerged path tools/build/feature/Makefile
diff --git a/tools/build/feature/test-jvmti.c b/tools/build/feature/test-jvmti.c
new file mode 100644
index 000000000000..1c665f09b9d6
--- /dev/null
+++ b/tools/build/feature/test-jvmti.c
@@ -0,0 +1,13 @@
+#include <jvmti.h>
+#include <jvmticmlr.h>
+
+int main(void)
+{
+	JavaVM			jvm	__attribute__((unused));
+	jvmtiEventCallbacks	cb	__attribute__((unused));
+	jvmtiCapabilities	caps	__attribute__((unused));
+	jvmtiJlocationFormat	format	__attribute__((unused));
+	jvmtiEnv		jvmti	__attribute__((unused));
+
+	return 0;
+}
