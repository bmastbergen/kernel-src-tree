ipv4: Use math to point per net sysctls into the appropriate struct net.

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [net] ipv4: Use math to point per net sysctls into the appropriate struct net (Eric Garver) [1363661]
Rebuild_FUZZ: 99.30%
commit-author Eric W. Biederman <ebiederm@xmission.com>
commit 0a6fa23dcb10eeb21adfd9955f7030f952a8122d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/0a6fa23d.failed

Simplify maintenance of ipv4_net_table by using math to point the per
net sysctls into the appropriate struct net, instead of manually
reassinging all of the variables into hard coded table slots.

	Signed-off-by: "Eric W. Biederman" <ebiederm@xmission.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 0a6fa23dcb10eeb21adfd9955f7030f952a8122d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv4/sysctl_net_ipv4.c
diff --cc net/ipv4/sysctl_net_ipv4.c
index 5529c590cd07,3a05e8123235..000000000000
--- a/net/ipv4/sysctl_net_ipv4.c
+++ b/net/ipv4/sysctl_net_ipv4.c
@@@ -916,24 -844,9 +918,30 @@@ static __net_init int ipv4_sysctl_init_
  		if (table == NULL)
  			goto err_alloc;
  
++<<<<<<< HEAD
 +		table[0].data =
 +			&net->ipv4.sysctl_icmp_echo_ignore_all;
 +		table[1].data =
 +			&net->ipv4.sysctl_icmp_echo_ignore_broadcasts;
 +		table[2].data =
 +			&net->ipv4.sysctl_icmp_ignore_bogus_error_responses;
 +		table[3].data =
 +			&net->ipv4.sysctl_icmp_errors_use_inbound_ifaddr;
 +		table[4].data =
 +			&net->ipv4.sysctl_icmp_ratelimit;
 +		table[5].data =
 +			&net->ipv4.sysctl_icmp_ratemask;
 +		table[6].data =
 +			&net->ipv4.sysctl_ping_group_range;
 +		table[7].data =
 +			&net->ipv4.sysctl_tcp_ecn;
 +		table[8].data =
 +			&net->ipv4_sysctl_local_ports.range;
++=======
+ 		/* Update the variables to point into the current struct net */
+ 		for (i = 0; i < ARRAY_SIZE(ipv4_net_table) - 1; i++)
+ 			table[i].data += (void *)net - (void *)&init_net;
++>>>>>>> 0a6fa23dcb10 (ipv4: Use math to point per net sysctls into the appropriate struct net.)
  
  		/* Don't export sysctls to unprivileged users */
  		if (net->user_ns != &init_user_ns)
* Unmerged path net/ipv4/sysctl_net_ipv4.c
