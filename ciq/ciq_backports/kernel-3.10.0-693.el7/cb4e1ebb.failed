perf record: Change switch-output option to take optional argument

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Jiri Olsa <jolsa@kernel.org>
commit cb4e1ebb6a398ff5b0067034b0d16566af4d78e8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/cb4e1ebb.failed

Next patches will add --switch-output option arguments, changing the
option to allow that and adding its default value to 'signal'.

	Signed-off-by: Jiri Olsa <jolsa@kernel.org>
	Acked-by: Wang Nan <wangnan0@huawei.com>
	Tested-by: Arnaldo Carvalho de Melo <acme@redhat.com>
	Cc: David Ahern <dsahern@gmail.com>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
Link: http://lkml.kernel.org/r/1483955520-29063-4-git-send-email-jolsa@kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit cb4e1ebb6a398ff5b0067034b0d16566af4d78e8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/builtin-record.c
diff --cc tools/perf/builtin-record.c
index 6cb1cbb83a86,2bf811acaf8d..000000000000
--- a/tools/perf/builtin-record.c
+++ b/tools/perf/builtin-record.c
@@@ -41,6 -46,12 +41,15 @@@
  #include <asm/bug.h>
  #include <linux/time64.h>
  
++<<<<<<< HEAD
++=======
+ struct switch_output {
+ 	bool		 signal;
+ 	const char	*str;
+ 	bool		 set;
+ };
+ 
++>>>>>>> cb4e1ebb6a39 (perf record: Change switch-output option to take optional argument)
  struct record {
  	struct perf_tool	tool;
  	struct record_opts	opts;
@@@ -1319,6 -1541,11 +1344,14 @@@ static struct option __record_options[
  		    "Record build-id of all DSOs regardless of hits"),
  	OPT_BOOLEAN(0, "timestamp-filename", &record.timestamp_filename,
  		    "append timestamp to output filename"),
++<<<<<<< HEAD
++=======
+ 	OPT_STRING_OPTARG_SET(0, "switch-output", &record.switch_output.str,
+ 			  &record.switch_output.set, "signal",
+ 			  "Switch output when receive SIGUSR2", "signal"),
+ 	OPT_BOOLEAN(0, "dry-run", &dry_run,
+ 		    "Parse options then exit"),
++>>>>>>> cb4e1ebb6a39 (perf record: Change switch-output option to take optional argument)
  	OPT_END()
  };
  
@@@ -1360,6 -1601,14 +1393,17 @@@ int cmd_record(int argc, const char **a
  		return -EINVAL;
  	}
  
++<<<<<<< HEAD
++=======
+ 	if (switch_output_setup(rec)) {
+ 		parse_options_usage(record_usage, record_options, "switch-output", 0);
+ 		return -EINVAL;
+ 	}
+ 
+ 	if (rec->switch_output.signal)
+ 		rec->timestamp_filename = true;
+ 
++>>>>>>> cb4e1ebb6a39 (perf record: Change switch-output option to take optional argument)
  	if (!rec->itr) {
  		rec->itr = auxtrace_record__init(rec->evlist, &err);
  		if (err)
* Unmerged path tools/perf/builtin-record.c
