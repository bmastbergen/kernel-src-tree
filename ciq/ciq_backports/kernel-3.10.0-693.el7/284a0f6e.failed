crypto: testmgr - Disable fips-allowed for authenc() and des() ciphers

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [crypto] testmgr - Disable fips-allowed for authenc() and des() ciphers (Herbert Xu) [1459191]
Rebuild_FUZZ: 93.94%
commit-author John Haxby <john.haxby@oracle.com>
commit 284a0f6e87b0721e1be8bca419893902d9cf577a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/284a0f6e.failed

No authenc() ciphers are FIPS approved, nor is ecb(des).
After the end of 2015, ansi_cprng will also be non-approved.

	Signed-off-by: John Haxby <john.haxby@oracle.com>
	Acked-by: Stephan Mueller <smueller@chronox.de>
	Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
(cherry picked from commit 284a0f6e87b0721e1be8bca419893902d9cf577a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	crypto/testmgr.c
diff --cc crypto/testmgr.c
index 0d552d3beee3,523c9b955057..000000000000
--- a/crypto/testmgr.c
+++ b/crypto/testmgr.c
@@@ -1985,14 -2078,101 +1985,109 @@@ static const struct alg_test_desc alg_t
  			}
  		}
  	}, {
++<<<<<<< HEAD
++=======
+ 		.alg = "authenc(hmac(md5),ecb(cipher_null))",
+ 		.test = alg_test_aead,
+ 		.suite = {
+ 			.aead = {
+ 				.enc = {
+ 					.vecs = hmac_md5_ecb_cipher_null_enc_tv_template,
+ 					.count = HMAC_MD5_ECB_CIPHER_NULL_ENC_TEST_VECTORS
+ 				},
+ 				.dec = {
+ 					.vecs = hmac_md5_ecb_cipher_null_dec_tv_template,
+ 					.count = HMAC_MD5_ECB_CIPHER_NULL_DEC_TEST_VECTORS
+ 				}
+ 			}
+ 		}
+ 	}, {
++>>>>>>> 284a0f6e87b0 (crypto: testmgr - Disable fips-allowed for authenc() and des() ciphers)
  		.alg = "authenc(hmac(sha1),cbc(aes))",
  		.test = alg_test_aead,
- 		.fips_allowed = 1,
  		.suite = {
  			.aead = {
  				.enc = {
++<<<<<<< HEAD
 +					.vecs = hmac_sha1_aes_cbc_enc_tv_template,
 +					.count = HMAC_SHA1_AES_CBC_ENC_TEST_VECTORS
++=======
+ 					.vecs =
+ 					hmac_sha1_aes_cbc_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA1_AES_CBC_ENC_TEST_VEC
+ 				}
+ 			}
+ 		}
+ 	}, {
+ 		.alg = "authenc(hmac(sha1),cbc(des))",
+ 		.test = alg_test_aead,
+ 		.suite = {
+ 			.aead = {
+ 				.enc = {
+ 					.vecs =
+ 					hmac_sha1_des_cbc_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA1_DES_CBC_ENC_TEST_VEC
+ 				}
+ 			}
+ 		}
+ 	}, {
+ 		.alg = "authenc(hmac(sha1),cbc(des3_ede))",
+ 		.test = alg_test_aead,
+ 		.suite = {
+ 			.aead = {
+ 				.enc = {
+ 					.vecs =
+ 					hmac_sha1_des3_ede_cbc_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA1_DES3_EDE_CBC_ENC_TEST_VEC
+ 				}
+ 			}
+ 		}
+ 	}, {
+ 		.alg = "authenc(hmac(sha1),ecb(cipher_null))",
+ 		.test = alg_test_aead,
+ 		.suite = {
+ 			.aead = {
+ 				.enc = {
+ 					.vecs =
+ 					hmac_sha1_ecb_cipher_null_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA1_ECB_CIPHER_NULL_ENC_TEST_VEC
+ 				},
+ 				.dec = {
+ 					.vecs =
+ 					hmac_sha1_ecb_cipher_null_dec_tv_temp,
+ 					.count =
+ 					HMAC_SHA1_ECB_CIPHER_NULL_DEC_TEST_VEC
+ 				}
+ 			}
+ 		}
+ 	}, {
+ 		.alg = "authenc(hmac(sha224),cbc(des))",
+ 		.test = alg_test_aead,
+ 		.suite = {
+ 			.aead = {
+ 				.enc = {
+ 					.vecs =
+ 					hmac_sha224_des_cbc_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA224_DES_CBC_ENC_TEST_VEC
+ 				}
+ 			}
+ 		}
+ 	}, {
+ 		.alg = "authenc(hmac(sha224),cbc(des3_ede))",
+ 		.test = alg_test_aead,
+ 		.suite = {
+ 			.aead = {
+ 				.enc = {
+ 					.vecs =
+ 					hmac_sha224_des3_ede_cbc_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA224_DES3_EDE_CBC_ENC_TEST_VEC
++>>>>>>> 284a0f6e87b0 (crypto: testmgr - Disable fips-allowed for authenc() and des() ciphers)
  				}
  			}
  		}
@@@ -2002,9 -2182,62 +2097,67 @@@
  		.suite = {
  			.aead = {
  				.enc = {
++<<<<<<< HEAD
 +					.vecs = hmac_sha256_aes_cbc_enc_tv_template,
 +					.count = HMAC_SHA256_AES_CBC_ENC_TEST_VECTORS
++=======
+ 					.vecs =
+ 					hmac_sha256_aes_cbc_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA256_AES_CBC_ENC_TEST_VEC
+ 				}
+ 			}
+ 		}
+ 	}, {
+ 		.alg = "authenc(hmac(sha256),cbc(des))",
+ 		.test = alg_test_aead,
+ 		.suite = {
+ 			.aead = {
+ 				.enc = {
+ 					.vecs =
+ 					hmac_sha256_des_cbc_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA256_DES_CBC_ENC_TEST_VEC
+ 				}
+ 			}
+ 		}
+ 	}, {
+ 		.alg = "authenc(hmac(sha256),cbc(des3_ede))",
+ 		.test = alg_test_aead,
+ 		.suite = {
+ 			.aead = {
+ 				.enc = {
+ 					.vecs =
+ 					hmac_sha256_des3_ede_cbc_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA256_DES3_EDE_CBC_ENC_TEST_VEC
+ 				}
+ 			}
+ 		}
+ 	}, {
+ 		.alg = "authenc(hmac(sha384),cbc(des))",
+ 		.test = alg_test_aead,
+ 		.suite = {
+ 			.aead = {
+ 				.enc = {
+ 					.vecs =
+ 					hmac_sha384_des_cbc_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA384_DES_CBC_ENC_TEST_VEC
+ 				}
+ 			}
+ 		}
+ 	}, {
+ 		.alg = "authenc(hmac(sha384),cbc(des3_ede))",
+ 		.test = alg_test_aead,
+ 		.suite = {
+ 			.aead = {
+ 				.enc = {
+ 					.vecs =
+ 					hmac_sha384_des3_ede_cbc_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA384_DES3_EDE_CBC_ENC_TEST_VEC
++>>>>>>> 284a0f6e87b0 (crypto: testmgr - Disable fips-allowed for authenc() and des() ciphers)
  				}
  			}
  		}
@@@ -2014,9 -2247,36 +2167,41 @@@
  		.suite = {
  			.aead = {
  				.enc = {
++<<<<<<< HEAD
 +					.vecs = hmac_sha512_aes_cbc_enc_tv_template,
 +					.count = HMAC_SHA512_AES_CBC_ENC_TEST_VECTORS
++=======
+ 					.vecs =
+ 					hmac_sha512_aes_cbc_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA512_AES_CBC_ENC_TEST_VEC
+ 				}
+ 			}
+ 		}
+ 	}, {
+ 		.alg = "authenc(hmac(sha512),cbc(des))",
+ 		.test = alg_test_aead,
+ 		.suite = {
+ 			.aead = {
+ 				.enc = {
+ 					.vecs =
+ 					hmac_sha512_des_cbc_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA512_DES_CBC_ENC_TEST_VEC
+ 				}
+ 			}
+ 		}
+ 	}, {
+ 		.alg = "authenc(hmac(sha512),cbc(des3_ede))",
+ 		.test = alg_test_aead,
+ 		.suite = {
+ 			.aead = {
+ 				.enc = {
+ 					.vecs =
+ 					hmac_sha512_des3_ede_cbc_enc_tv_temp,
+ 					.count =
+ 					HMAC_SHA512_DES3_EDE_CBC_ENC_TEST_VEC
++>>>>>>> 284a0f6e87b0 (crypto: testmgr - Disable fips-allowed for authenc() and des() ciphers)
  				}
  			}
  		}
* Unmerged path crypto/testmgr.c
