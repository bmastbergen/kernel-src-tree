Revert "nohz: Fix collision between tick and other hrtimers"

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Linus Torvalds <torvalds@linux-foundation.org>
commit 558e8e27e73f53f8a512485be538b07115fe5f3c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/558e8e27.failed

This reverts commit 24b91e360ef521a2808771633d76ebc68bd5604b and commit
7bdb59f1ad47 ("tick/nohz: Fix possible missing clock reprog after tick
soft restart") that depends on it,

Pavel reports that it causes occasional boot hangs for him that seem to
depend on just how the machine was booted.  In particular, his machine
hangs at around the PCI fixups of the EHCI USB host controller, but only
hangs from cold boot, not from a warm boot.

Thomas Gleixner suspecs it's a CPU hotplug interaction, particularly
since Pavel also saw suspend/resume issues that seem to be related.
We're reverting for now while trying to figure out the root cause.

Reported-bisected-and-tested-by: Pavel Machek <pavel@ucw.cz>
	Acked-by: Frederic Weisbecker <fweisbec@gmail.com>
	Cc: Wanpeng Li <wanpeng.li@hotmail.com>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Rik van Riel <riel@redhat.com>
	Cc: Thomas Gleixner <tglx@linutronix.de>
	Cc: stable@kernel.org  # reverted commits were marked for stable
	Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
(cherry picked from commit 558e8e27e73f53f8a512485be538b07115fe5f3c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	kernel/time/tick-sched.c
#	kernel/time/tick-sched.h
diff --cc kernel/time/tick-sched.c
index 22bf382ff9a8,2c115fdab397..000000000000
--- a/kernel/time/tick-sched.c
+++ b/kernel/time/tick-sched.c
@@@ -636,10 -764,10 +636,14 @@@ static ktime_t tick_nohz_stop_sched_tic
  		expires = KTIME_MAX;
  
  	expires = min_t(u64, expires, next_tick);
 -	tick = expires;
 +	tick.tv64 = expires;
  
  	/* Skip reprogram of event if its not changed */
++<<<<<<< HEAD
 +	if (ts->tick_stopped && (expires == dev->next_event.tv64))
++=======
+ 	if (ts->tick_stopped && (expires == dev->next_event))
++>>>>>>> 558e8e27e73f (Revert "nohz: Fix collision between tick and other hrtimers")
  		goto out;
  
  	/*
* Unmerged path kernel/time/tick-sched.h
* Unmerged path kernel/time/tick-sched.c
* Unmerged path kernel/time/tick-sched.h
