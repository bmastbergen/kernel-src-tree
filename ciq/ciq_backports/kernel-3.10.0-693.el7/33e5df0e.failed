HID: wacom: Report ABS_MISC event for Cintiq Companion Hybrid

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [hid] wacom: Report ABS_MISC event for Cintiq Companion Hybrid (Aristeu Rozanski) [1346348 1388646 1385026]
Rebuild_FUZZ: 95.73%
commit-author Jason Gerecke <killertofu@gmail.com>
commit 33e5df0e0e32027866e9fb00451952998fc957f2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/33e5df0e.failed

It appears that the Cintiq Companion Hybrid does not send an ABS_MISC event to
userspace when any of its ExpressKeys are pressed. This is not strictly
necessary now that the pad exists on its own device, but should be fixed for
consistency's sake.

Traditionally both the stylus and pad shared the same device node, and
xf86-input-wacom would use ABS_MISC for disambiguation. Not sending this causes
the Hybrid to behave incorrectly with xf86-input-wacom beginning with its
8f44f3 commit.

	Signed-off-by: Jason Gerecke <killertofu@gmail.com>
	Reviewed-by: Benjamin Tissoires <benjamin.tissoires@redhat.com>
	Signed-off-by: Jiri Kosina <jkosina@suse.cz>
(cherry picked from commit 33e5df0e0e32027866e9fb00451952998fc957f2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/hid/wacom_wac.c
diff --cc drivers/hid/wacom_wac.c
index e76dca5e56b8,f8861494f4e3..000000000000
--- a/drivers/hid/wacom_wac.c
+++ b/drivers/hid/wacom_wac.c
@@@ -659,15 -767,24 +659,25 @@@ static int wacom_intuos_irq(struct waco
  			} else {
  				input_report_abs(input, ABS_MISC, 0);
  			}
 -		} else if (features->type == CINTIQ_HYBRID) {
 -			/*
 -			 * Do not send hardware buttons under Android. They
 -			 * are already sent to the system through GPIO (and
 -			 * have different meaning).
 -			 */
 -			input_report_key(input, BTN_1, (data[4] & 0x01));
 -			input_report_key(input, BTN_2, (data[4] & 0x02));
 -			input_report_key(input, BTN_3, (data[4] & 0x04));
 -			input_report_key(input, BTN_4, (data[4] & 0x08));
 -
 +		} else if (features->type == WACOM_27QHD) {
 +			input_report_key(input, KEY_PROG1, data[2] & 0x01);
 +			input_report_key(input, KEY_PROG2, data[2] & 0x02);
 +			input_report_key(input, KEY_PROG3, data[2] & 0x04);
 +
++<<<<<<< HEAD
 +			input_report_abs(input, ABS_X, be16_to_cpup((__be16 *)&data[4]));
 +			input_report_abs(input, ABS_Y, be16_to_cpup((__be16 *)&data[6]));
 +			input_report_abs(input, ABS_Z, be16_to_cpup((__be16 *)&data[8]));
 +			if ((data[2] & 0x07) | data[4] | data[5] | data[6] | data[7] | data[8] | data[9]) {
++=======
+ 			input_report_key(input, BTN_5, (data[4] & 0x10));  /* Right  */
+ 			input_report_key(input, BTN_6, (data[4] & 0x20));  /* Up     */
+ 			input_report_key(input, BTN_7, (data[4] & 0x40));  /* Left   */
+ 			input_report_key(input, BTN_8, (data[4] & 0x80));  /* Down   */
+ 			input_report_key(input, BTN_0, (data[3] & 0x01));  /* Center */
+ 
+ 			if (data[4] | (data[3] & 0x01)) {
++>>>>>>> 33e5df0e0e32 (HID: wacom: Report ABS_MISC event for Cintiq Companion Hybrid)
  				input_report_abs(input, ABS_MISC, PAD_DEVICE_ID);
  			} else {
  				input_report_abs(input, ABS_MISC, 0);
* Unmerged path drivers/hid/wacom_wac.c
