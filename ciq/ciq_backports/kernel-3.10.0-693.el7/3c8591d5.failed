net/mlx5e: Don't flush SQ on error

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [netdrv] mlx5e: Don't flush SQ on error (Don Dutile) [1385330 1417285]
Rebuild_FUZZ: 93.75%
commit-author Saeed Mahameed <saeedm@mellanox.com>
commit 3c8591d593a3da9ae8e8342acb1f6ab9ab478e92
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/3c8591d5.failed

We are doing SQ descriptors cleanup in driver.

Fixes: 6e8dd6d6f4bd ("net/mlx5e: Don't wait for SQ completions on close")
	Signed-off-by: Saeed Mahameed <saeedm@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 3c8591d593a3da9ae8e8342acb1f6ab9ab478e92)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/en_main.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/en_main.c
index 98d2ea9b4528,5bf7f86fe31c..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
@@@ -699,11 -1000,12 +699,15 @@@ static int mlx5e_enable_sq(struct mlx5e
  
  	memcpy(sqc, param->sqc, sizeof(param->sqc));
  
 -	MLX5_SET(sqc,  sqc, tis_num_0, param->type == MLX5E_SQ_ICO ?
 -				       0 : priv->tisn[sq->tc]);
 +	MLX5_SET(sqc,  sqc, tis_num_0, param->icosq ? 0 : priv->tisn[sq->tc]);
  	MLX5_SET(sqc,  sqc, cqn,		sq->cq.mcq.cqn);
 -	MLX5_SET(sqc,  sqc, min_wqe_inline_mode, sq->min_inline_mode);
  	MLX5_SET(sqc,  sqc, state,		MLX5_SQC_STATE_RST);
++<<<<<<< HEAD
 +	MLX5_SET(sqc,  sqc, tis_lst_sz,		param->icosq ? 0 : 1);
 +	MLX5_SET(sqc,  sqc, flush_in_error_en,	1);
++=======
+ 	MLX5_SET(sqc,  sqc, tis_lst_sz, param->type == MLX5E_SQ_ICO ? 0 : 1);
++>>>>>>> 3c8591d593a3 (net/mlx5e: Don't flush SQ on error)
  
  	MLX5_SET(wq,   wq, wq_type,       MLX5_WQ_TYPE_CYCLIC);
  	MLX5_SET(wq,   wq, uar_page,      sq->uar.index);
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en_main.c
