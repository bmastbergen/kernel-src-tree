IB/mlx4: Move user vendor structures

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Leon Romanovsky <leon@kernel.org>
commit 9ce28a20eec551cfc032c87cd31a05c14d11155d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/9ce28a20.failed

This patch moves mlx4 vendor's specific structures to
common UAPI folder which will be visible to all consumers.

These structures are used by user-space library driver
(libmlx4) and currently manually copied to that library.

This move will allow cross-compile against these files and
simplify introduction of vendor specific data.

	Signed-off-by: Leon Romanovsky <leon@kernel.org>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 9ce28a20eec551cfc032c87cd31a05c14d11155d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	MAINTAINERS
#	include/uapi/rdma/Kbuild
diff --cc MAINTAINERS
index 34330c037ee5,0af558f501cf..000000000000
--- a/MAINTAINERS
+++ b/MAINTAINERS
@@@ -5550,8 -7798,27 +5550,20 @@@ L:	netdev@vger.kernel.or
  L:	linux-rdma@vger.kernel.org
  W:	http://www.mellanox.com
  Q:	http://patchwork.ozlabs.org/project/netdev/list/
++<<<<<<< HEAD
++=======
+ S:	Supported
+ F:	drivers/net/ethernet/mellanox/mlx4/
+ F:	include/linux/mlx4/
+ F:	include/uapi/rdma/mlx4-abi.h
+ 
+ MELLANOX MLX4 IB driver
+ M:	Yishai Hadas <yishaih@mellanox.com>
+ L:	linux-rdma@vger.kernel.org
+ W:	http://www.mellanox.com
++>>>>>>> 9ce28a20eec5 (IB/mlx4: Move user vendor structures)
  Q:	http://patchwork.kernel.org/project/linux-rdma/list/
 -S:	Supported
 -F:	drivers/infiniband/hw/mlx4/
 -F:	include/linux/mlx4/
 -
 -MELLANOX MLX5 core VPI driver
 -M:	Matan Barak <matanb@mellanox.com>
 -M:	Leon Romanovsky <leonro@mellanox.com>
 -L:	netdev@vger.kernel.org
 -L:	linux-rdma@vger.kernel.org
 -W:	http://www.mellanox.com
 -Q:	http://patchwork.ozlabs.org/project/netdev/list/
 +T:	git://openfabrics.org/~eli/connect-ib.git
  S:	Supported
  F:	drivers/net/ethernet/mellanox/mlx5/core/
  F:	include/linux/mlx5/
diff --cc include/uapi/rdma/Kbuild
index 231901b08f6c,a1090ebc0b34..000000000000
--- a/include/uapi/rdma/Kbuild
+++ b/include/uapi/rdma/Kbuild
@@@ -6,3 -6,8 +6,11 @@@ header-y += ib_user_verbs.
  header-y += rdma_netlink.h
  header-y += rdma_user_cm.h
  header-y += hfi/
++<<<<<<< HEAD
++=======
+ header-y += rdma_user_rxe.h
+ header-y += cxgb3-abi.h
+ header-y += cxgb4-abi.h
+ header-y += mlx4-abi.h
+ header-y += mlx5-abi.h
++>>>>>>> 9ce28a20eec5 (IB/mlx4: Move user vendor structures)
* Unmerged path MAINTAINERS
diff --git a/drivers/infiniband/hw/mlx4/cq.c b/drivers/infiniband/hw/mlx4/cq.c
index 5df63dacaaa3..1ea686b9e0f9 100644
--- a/drivers/infiniband/hw/mlx4/cq.c
+++ b/drivers/infiniband/hw/mlx4/cq.c
@@ -37,7 +37,7 @@
 #include <linux/slab.h>
 
 #include "mlx4_ib.h"
-#include "user.h"
+#include <rdma/mlx4-abi.h>
 
 static void mlx4_ib_cq_comp(struct mlx4_cq *cq)
 {
diff --git a/drivers/infiniband/hw/mlx4/main.c b/drivers/infiniband/hw/mlx4/main.c
index 8b278beb4f4c..3893fb69f6ba 100644
--- a/drivers/infiniband/hw/mlx4/main.c
+++ b/drivers/infiniband/hw/mlx4/main.c
@@ -55,7 +55,7 @@
 #include <linux/mlx4/qp.h>
 
 #include "mlx4_ib.h"
-#include "user.h"
+#include <rdma/mlx4-abi.h>
 
 #define DRV_NAME	MLX4_IB_DRV_NAME
 #define DRV_VERSION	"2.2-1"
diff --git a/drivers/infiniband/hw/mlx4/qp.c b/drivers/infiniband/hw/mlx4/qp.c
index 7fb9629bd12b..4301243de4ba 100644
--- a/drivers/infiniband/hw/mlx4/qp.c
+++ b/drivers/infiniband/hw/mlx4/qp.c
@@ -47,7 +47,7 @@
 #include <linux/mlx4/qp.h>
 
 #include "mlx4_ib.h"
-#include "user.h"
+#include <rdma/mlx4-abi.h>
 
 static void mlx4_ib_lock_cqs(struct mlx4_ib_cq *send_cq,
 			     struct mlx4_ib_cq *recv_cq);
diff --git a/drivers/infiniband/hw/mlx4/srq.c b/drivers/infiniband/hw/mlx4/srq.c
index 0597f3eef5d0..7dd3f267f06b 100644
--- a/drivers/infiniband/hw/mlx4/srq.c
+++ b/drivers/infiniband/hw/mlx4/srq.c
@@ -37,7 +37,7 @@
 #include <linux/vmalloc.h>
 
 #include "mlx4_ib.h"
-#include "user.h"
+#include <rdma/mlx4-abi.h>
 
 static void *get_wqe(struct mlx4_ib_srq *srq, int n)
 {
* Unmerged path include/uapi/rdma/Kbuild
diff --git a/drivers/infiniband/hw/mlx4/user.h b/include/uapi/rdma/mlx4-abi.h
similarity index 97%
rename from drivers/infiniband/hw/mlx4/user.h
rename to include/uapi/rdma/mlx4-abi.h
index 07e6769ef43b..af431752655c 100644
--- a/drivers/infiniband/hw/mlx4/user.h
+++ b/include/uapi/rdma/mlx4-abi.h
@@ -31,8 +31,8 @@
  * SOFTWARE.
  */
 
-#ifndef MLX4_IB_USER_H
-#define MLX4_IB_USER_H
+#ifndef MLX4_ABI_USER_H
+#define MLX4_ABI_USER_H
 
 #include <linux/types.h>
 
@@ -104,4 +104,4 @@ struct mlx4_ib_create_qp {
 	__u8	reserved[5];
 };
 
-#endif /* MLX4_IB_USER_H */
+#endif /* MLX4_ABI_USER_H */
