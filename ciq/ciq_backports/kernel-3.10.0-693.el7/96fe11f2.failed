cxgb4: Implement ndo_get_phys_port_id for mgmt dev

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Ganesh Goudar <ganeshgr@chelsio.com>
commit 96fe11f27b70f6b64f62a2d13ed209aa02e02a48
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/96fe11f2.failed

	Signed-off-by: Ganesh Goudar <ganeshgr@chelsio.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 96fe11f27b70f6b64f62a2d13ed209aa02e02a48)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/chelsio/cxgb4/cxgb4_main.c
diff --cc drivers/net/ethernet/chelsio/cxgb4/cxgb4_main.c
index 8f2bd7d85ee8,4da6f900ff24..000000000000
--- a/drivers/net/ethernet/chelsio/cxgb4/cxgb4_main.c
+++ b/drivers/net/ethernet/chelsio/cxgb4/cxgb4_main.c
@@@ -3096,8 -2565,37 +3096,21 @@@ static int cxgb_set_vf_mac(struct net_d
  
  	dev_info(pi->adapter->pdev_dev,
  		 "Setting MAC %pM on VF %d\n", mac, vf);
 -	ret = t4_set_vf_mac_acl(adap, vf + 1, 1, mac);
 -	if (!ret)
 -		ether_addr_copy(adap->vfinfo[vf].vf_mac_addr, mac);
 -	return ret;
 -}
 -
 -static int cxgb_get_vf_config(struct net_device *dev,
 -			      int vf, struct ifla_vf_info *ivi)
 -{
 -	struct port_info *pi = netdev_priv(dev);
 -	struct adapter *adap = pi->adapter;
 -
 -	if (vf >= adap->num_vfs)
 -		return -EINVAL;
 -	ivi->vf = vf;
 -	ether_addr_copy(ivi->mac, adap->vfinfo[vf].vf_mac_addr);
 -	return 0;
 +	return t4_set_vf_mac_acl(adap, vf + 1, 1, mac);
  }
+ 
+ static int cxgb_get_phys_port_id(struct net_device *dev,
+ 				 struct netdev_phys_item_id *ppid)
+ {
+ 	struct port_info *pi = netdev_priv(dev);
+ 	unsigned int phy_port_id;
+ 
+ 	phy_port_id = pi->adapter->adap_idx * 10 + pi->port_id;
+ 	ppid->id_len = sizeof(phy_port_id);
+ 	memcpy(ppid->id, &phy_port_id, ppid->id_len);
+ 	return 0;
+ }
+ 
  #endif
  
  static int cxgb_set_mac_addr(struct net_device *dev, void *p)
@@@ -3160,6 -2774,8 +3173,11 @@@ static const struct net_device_ops cxgb
  static const struct net_device_ops cxgb4_mgmt_netdev_ops = {
  	.ndo_open             = dummy_open,
  	.ndo_set_vf_mac       = cxgb_set_vf_mac,
++<<<<<<< HEAD
++=======
+ 	.ndo_get_vf_config    = cxgb_get_vf_config,
+ 	.ndo_get_phys_port_id = cxgb_get_phys_port_id,
++>>>>>>> 96fe11f27b70 (cxgb4: Implement ndo_get_phys_port_id for mgmt dev)
  };
  #endif
  
* Unmerged path drivers/net/ethernet/chelsio/cxgb4/cxgb4_main.c
