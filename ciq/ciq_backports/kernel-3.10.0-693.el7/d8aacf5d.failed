KVM: x86: MMU: Remove mapping_level_dirty_bitmap()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Takuya Yoshikawa <yoshikawa_takuya_b1@lab.ntt.co.jp>
commit d8aacf5df86a961923a2c9c547d341d64a9d9f5d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/d8aacf5d.failed

Now that it has only one caller, and its name is not so helpful for
readers, remove it.  The new memslot_valid_for_gpte() function
makes it possible to share the common code between
gfn_to_memslot_dirty_bitmap() and mapping_level().

	Signed-off-by: Takuya Yoshikawa <yoshikawa_takuya_b1@lab.ntt.co.jp>
	Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
(cherry picked from commit d8aacf5df86a961923a2c9c547d341d64a9d9f5d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kvm/mmu.c
diff --cc arch/x86/kvm/mmu.c
index 70c3ecb68058,09833b04fc97..000000000000
--- a/arch/x86/kvm/mmu.c
+++ b/arch/x86/kvm/mmu.c
@@@ -873,15 -875,19 +883,31 @@@ gfn_to_memslot_dirty_bitmap(struct kvm_
  	return slot;
  }
  
++<<<<<<< HEAD
 +static bool mapping_level_dirty_bitmap(struct kvm_vcpu *vcpu, gfn_t large_gfn)
 +{
 +	return !gfn_to_memslot_dirty_bitmap(vcpu, large_gfn, true);
 +}
 +
 +static int mapping_level(struct kvm_vcpu *vcpu, gfn_t large_gfn)
++=======
+ static int mapping_level(struct kvm_vcpu *vcpu, gfn_t large_gfn,
+ 			 bool *force_pt_level)
++>>>>>>> d8aacf5df86a (KVM: x86: MMU: Remove mapping_level_dirty_bitmap())
  {
  	int host_level, level, max_level;
+ 	struct kvm_memory_slot *slot;
+ 
+ 	slot = kvm_vcpu_gfn_to_memslot(vcpu, large_gfn);
+ 
++<<<<<<< HEAD
++=======
+ 	if (likely(!*force_pt_level))
+ 		*force_pt_level = !memslot_valid_for_gpte(slot, true);
+ 	if (unlikely(*force_pt_level))
+ 		return PT_PAGE_TABLE_LEVEL;
  
++>>>>>>> d8aacf5df86a (KVM: x86: MMU: Remove mapping_level_dirty_bitmap())
  	host_level = host_mapping_level(vcpu->kvm, large_gfn);
  
  	if (host_level == PT_PAGE_TABLE_LEVEL)
* Unmerged path arch/x86/kvm/mmu.c
