platform/x86: thinkpad_acpi: Initialize local in_tablet_mode and type

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [platform] x86: thinkpad_acpi: Initialize local in_tablet_mode and type (Lyude Paul) [1389438]
Rebuild_FUZZ: 93.02%
commit-author Darren Hart <dvhart@linux.intel.com>
commit cb2bf25145e0d2abef20f47dd2ae55bff97fd9cb
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/cb2bf251.failed

linux-next reported in_tablet_mode and type may be used uninitialized
after:

b31800283868 ("platform/x86: thinkpad_acpi: Move tablet detection into separate function")

This turns out to be a false positive as the pr_info call cannot be
reached if tp_features.hotkey_tablet (global scope) is 0, and
in_tablet_mode and type are assigned in both places
tp_features.hotkey_tablet is assigned.

Regardless, to make it explicit and avoid further reports, initialize
in_tablet_mode to 0 and type to NULL.

	Signed-off-by: Darren Hart <dvhart@linux.intel.com>
	Acked-by: Henrique de Moraes Holschuh <hmh@hmh.eng.br>
	Cc: Lyude <lyude@redhat.com>
(cherry picked from commit cb2bf25145e0d2abef20f47dd2ae55bff97fd9cb)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/platform/x86/thinkpad_acpi.c
diff --cc drivers/platform/x86/thinkpad_acpi.c
index 6d5105235fe6,aa65a857a6b1..000000000000
--- a/drivers/platform/x86/thinkpad_acpi.c
+++ b/drivers/platform/x86/thinkpad_acpi.c
@@@ -3146,6 -3141,37 +3146,40 @@@ static const struct tpacpi_quirk tpacpi
  typedef u16 tpacpi_keymap_entry_t;
  typedef tpacpi_keymap_entry_t tpacpi_keymap_t[TPACPI_HOTKEY_MAP_LEN];
  
++<<<<<<< HEAD
++=======
+ static int hotkey_init_tablet_mode(void)
+ {
+ 	int in_tablet_mode = 0, res;
+ 	char *type = NULL;
+ 
+ 	if (acpi_evalf(hkey_handle, &res, "MHKG", "qd")) {
+ 		/* For X41t, X60t, X61t Tablets... */
+ 		tp_features.hotkey_tablet = TP_HOTKEY_TABLET_USES_MHKG;
+ 		in_tablet_mode = !!(res & TP_HOTKEY_TABLET_MASK);
+ 		type = "MHKG";
+ 	} else if (acpi_evalf(ec_handle, &res, "CMMD", "qd")) {
+ 		/* For X1 Yoga (2016) */
+ 		tp_features.hotkey_tablet = TP_HOTKEY_TABLET_USES_CMMD;
+ 		in_tablet_mode = res == TP_EC_CMMD_TABLET_MODE;
+ 		type = "CMMD";
+ 	}
+ 
+ 	if (!tp_features.hotkey_tablet)
+ 		return 0;
+ 
+ 	pr_info("Tablet mode switch found (type: %s), currently in %s mode\n",
+ 		type, in_tablet_mode ? "tablet" : "laptop");
+ 
+ 	res = add_to_attr_set(hotkey_dev_attributes,
+ 			      &dev_attr_hotkey_tablet_mode.attr);
+ 	if (res)
+ 		return -1;
+ 
+ 	return in_tablet_mode;
+ }
+ 
++>>>>>>> cb2bf25145e0 (platform/x86: thinkpad_acpi: Initialize local in_tablet_mode and type)
  static int __init hotkey_init(struct ibm_init_struct *iibm)
  {
  	/* Requirements for changing the default keymaps:
* Unmerged path drivers/platform/x86/thinkpad_acpi.c
