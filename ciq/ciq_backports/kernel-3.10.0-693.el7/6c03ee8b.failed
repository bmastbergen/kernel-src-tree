bridge: fix smatch warning / potential null pointer dereference

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Linus Lüssing <linus.luessing@web.de>
commit 6c03ee8bdaa10401f60dee25a719753d2fbbcc36
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/6c03ee8b.failed

"New smatch warnings:
  net/bridge/br_multicast.c:1368 br_ip6_multicast_query() error:
    we previously assumed 'group' could be null (see line 1349)"

In the rare (sort of broken) case of a query having a Maximum
Response Delay of zero, we could create a potential null pointer
dereference.

Fixing this by skipping the multicast specific MLD Query parsing again
if no multicast group address is available.

Introduced by dc4eb53a996a78bfb8ea07b47423ff5a3aadc362
("bridge: adhere to querier election mechanism specified by RFCs")

	Reported-by: Dan Carpenter <dan.carpenter@oracle.com>
	Signed-off-by: Linus Lüssing <linus.luessing@web.de>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 6c03ee8bdaa10401f60dee25a719753d2fbbcc36)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/bridge/br_multicast.c
diff --cc net/bridge/br_multicast.c
index 251bf0711bce,876e5fb2a786..000000000000
--- a/net/bridge/br_multicast.c
+++ b/net/bridge/br_multicast.c
@@@ -1296,12 -1366,16 +1296,18 @@@ static int br_ip6_multicast_query(struc
  		goto out;
  	}
  
 -	if (is_general_query) {
 -		saddr.proto = htons(ETH_P_IPV6);
 -		saddr.u.ip6 = ip6h->saddr;
 +	br_multicast_query_received(br, port, &br->ip6_other_query,
 +				    !ipv6_addr_any(&ip6h->saddr),
 +				    is_general_query, max_delay);
  
 -		br_multicast_query_received(br, port, &br->ip6_other_query,
 -					    &saddr, max_delay);
 +	if (!group)
  		goto out;
++<<<<<<< HEAD
++=======
+ 	} else if (!group) {
+ 		goto out;
+ 	}
++>>>>>>> 6c03ee8bdaa1 (bridge: fix smatch warning / potential null pointer dereference)
  
  	mp = br_mdb_ip6_get(mlock_dereference(br->mdb, br), group, vid);
  	if (!mp)
* Unmerged path net/bridge/br_multicast.c
