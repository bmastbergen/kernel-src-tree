perf tools: Move perf build related variables under non fixdep leg

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Jiri Olsa <jolsa@kernel.org>
commit 8ac1eb7bab7c8d9d6f00b3e2a408611c45d9dff0
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/8ac1eb7b.failed

Because there's no need for them in fixdep build.

	Signed-off-by: Jiri Olsa <jolsa@kernel.org>
	Cc: David Ahern <dsahern@gmail.com>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
Link: http://lkml.kernel.org/r/1481030331-31944-4-git-send-email-jolsa@kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 8ac1eb7bab7c8d9d6f00b3e2a408611c45d9dff0)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/Makefile.perf
diff --cc tools/perf/Makefile.perf
index 9a1c164fc3d3,8f1c258b151a..000000000000
--- a/tools/perf/Makefile.perf
+++ b/tools/perf/Makefile.perf
@@@ -147,10 -164,6 +147,13 @@@ BISON   = biso
  STRIP   = strip
  AWK     = awk
  
++<<<<<<< HEAD
 +LIB_DIR		= $(srctree)/tools/lib/api/
 +TRACE_EVENT_DIR = $(srctree)/tools/lib/traceevent/
 +SUBCMD_DIR	= $(srctree)/tools/lib/subcmd/
 +
++=======
++>>>>>>> 8ac1eb7bab7c (perf tools: Move perf build related variables under non fixdep leg)
  # include Makefile.config by default and rule out
  # non-config cases
  config := 1
@@@ -163,6 -176,40 +166,43 @@@ ifeq ($(filter-out $(NON_CONFIG_TARGETS
  endif
  endif
  
++<<<<<<< HEAD
++=======
+ # The fixdep build - we force fixdep tool to be built as
+ # the first target in the separate make session not to be
+ # disturbed by any parallel make jobs. Once fixdep is done
+ # we issue the requested build with FIXDEP=1 variable.
+ #
+ # The fixdep build is disabled for $(NON_CONFIG_TARGETS)
+ # targets, because it's not necessary.
+ 
+ ifdef FIXDEP
+   force_fixdep := 0
+ else
+   force_fixdep := $(config)
+ endif
+ 
+ export srctree OUTPUT RM CC CXX LD AR CFLAGS CXXFLAGS V BISON FLEX AWK
+ export HOSTCC HOSTLD HOSTAR
+ 
+ include $(srctree)/tools/build/Makefile.include
+ 
+ ifeq ($(force_fixdep),1)
+ goals := $(filter-out all sub-make, $(MAKECMDGOALS))
+ 
+ $(goals) all: sub-make
+ 
+ sub-make: fixdep
+ 	$(Q)$(MAKE) FIXDEP=1 -f Makefile.perf $(goals)
+ 
+ else # force_fixdep
+ 
+ LIB_DIR         = $(srctree)/tools/lib/api/
+ TRACE_EVENT_DIR = $(srctree)/tools/lib/traceevent/
+ BPF_DIR         = $(srctree)/tools/lib/bpf/
+ SUBCMD_DIR      = $(srctree)/tools/lib/subcmd/
+ 
++>>>>>>> 8ac1eb7bab7c (perf tools: Move perf build related variables under non fixdep leg)
  # Set FEATURE_TESTS to 'all' so all possible feature checkers are executed.
  # Without this setting the output feature dump file misses some features, for
  # example, liberty. Select all checkers so we won't get an incomplete feature
* Unmerged path tools/perf/Makefile.perf
