Revert "dm mirror: use all available legs on multiple failures"

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Mike Snitzer <snitzer@redhat.com>
commit cd15fb64ee56192760ad5c1e2ad97a65e735b18b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/cd15fb64.failed

This reverts commit 12a7cf5ba6c776a2621d8972c7d42e8d3d959d20.

This commit apparently attempted to fix an issue that didn't really
exist, furthermore: this commit is the source of deadlocks and crashes
seen in multiple cases related to failing the primary mirror dev while
syncing.

	Reported-by: Jonathan Brassow <jbrassow@redhat.com>
	Signed-off-by: Mike Snitzer <snitzer@redhat.com>
(cherry picked from commit cd15fb64ee56192760ad5c1e2ad97a65e735b18b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/md/dm-raid1.c
diff --cc drivers/md/dm-raid1.c
index c41cafbde60d,4da8858856fb..000000000000
--- a/drivers/md/dm-raid1.c
+++ b/drivers/md/dm-raid1.c
@@@ -1225,7 -1261,7 +1225,11 @@@ static int mirror_end_io(struct dm_targ
  	if (error == -EOPNOTSUPP)
  		goto out;
  
++<<<<<<< HEAD
 +	if ((error == -EWOULDBLOCK) && (bio->bi_rw & REQ_RAHEAD))
++=======
+ 	if ((error == -EWOULDBLOCK) && (bio->bi_opf & REQ_RAHEAD))
++>>>>>>> cd15fb64ee56 (Revert "dm mirror: use all available legs on multiple failures")
  		goto out;
  
  	if (unlikely(error)) {
@@@ -1255,6 -1291,7 +1259,10 @@@
  
  			dm_bio_restore(bd, bio);
  			bio_record->details.bi_bdev = NULL;
++<<<<<<< HEAD
++=======
+ 			bio->bi_error = 0;
++>>>>>>> cd15fb64ee56 (Revert "dm mirror: use all available legs on multiple failures")
  
  			queue_bio(ms, bio, rw);
  			return DM_ENDIO_INCOMPLETE;
* Unmerged path drivers/md/dm-raid1.c
