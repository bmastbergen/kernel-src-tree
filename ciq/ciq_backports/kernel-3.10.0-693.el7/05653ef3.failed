btrfs: hide test-only member under ifdef

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author David Sterba <dsterba@suse.com>
commit 05653ef38659edc46a886c9bda105e64edba6896
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/05653ef3.failed

	Signed-off-by: David Sterba <dsterba@suse.com>
(cherry picked from commit 05653ef38659edc46a886c9bda105e64edba6896)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/btrfs/ctree.h
diff --cc fs/btrfs/ctree.h
index eaff9105e433,8627b7f26a60..000000000000
--- a/fs/btrfs/ctree.h
+++ b/fs/btrfs/ctree.h
@@@ -1148,7 -1181,10 +1148,13 @@@ struct btrfs_root 
  
  	u64 highest_objectid;
  
++<<<<<<< HEAD
++=======
+ #ifdef CONFIG_BTRFS_FS_RUN_SANITY_TESTS
+ 	/* only used with CONFIG_BTRFS_FS_RUN_SANITY_TESTS is enabled */
++>>>>>>> 05653ef38659 (btrfs: hide test-only member under ifdef)
  	u64 alloc_bytenr;
+ #endif
  
  	u64 defrag_trans_start;
  	struct btrfs_key defrag_progress;
* Unmerged path fs/btrfs/ctree.h
diff --git a/fs/btrfs/extent-tree.c b/fs/btrfs/extent-tree.c
index 51360de1f70c..ffbbe893ed05 100644
--- a/fs/btrfs/extent-tree.c
+++ b/fs/btrfs/extent-tree.c
@@ -7979,6 +7979,7 @@ struct extent_buffer *btrfs_alloc_tree_block(struct btrfs_trans_handle *trans,
 	bool skinny_metadata = btrfs_fs_incompat(root->fs_info,
 						 SKINNY_METADATA);
 
+#ifdef CONFIG_BTRFS_FS_RUN_SANITY_TESTS
 	if (btrfs_test_is_dummy_root(root)) {
 		buf = btrfs_init_new_buffer(trans, root, root->alloc_bytenr,
 					    level);
@@ -7986,6 +7987,7 @@ struct extent_buffer *btrfs_alloc_tree_block(struct btrfs_trans_handle *trans,
 			root->alloc_bytenr += blocksize;
 		return buf;
 	}
+#endif
 
 	block_rsv = use_block_rsv(trans, root, blocksize);
 	if (IS_ERR(block_rsv))
