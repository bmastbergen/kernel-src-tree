watchdog: mei_wdt: register wd device only if required

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [watchdog] mei_wdt: register wd device only if required (Jerry Snitselaar) [1404064]
Rebuild_FUZZ: 89.80%
commit-author Tomas Winkler <tomas.winkler@intel.com>
commit 7a23f80eaae9c6b5175cd7a96634a91ed9928aff
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/7a23f80e.failed

For Intel Broadwell and newer platforms, the ME device can inform
the host whether the watchdog functionality is activated or not.
If the watchdog functionality is not activated then the watchdog interface
can be not registered and eliminate unnecessary pings and hence lower the
power consumption by avoiding waking up the device.
The feature can be deactivated also without reboot
in that case the watchdog device should be unregistered at runtime.

The information regarding the deactivation is reported
in the ping response command. In runtime case the unregistration
has to be run from a worker so that the ping initiated by the watchdog
core completes. Otherwise the flow will deadlock on watchdog
core mutex which both ping and unregistration acquire.

	Reviewed-by: Guenter Roeck <linux@roeck-us.net>
	Signed-off-by: Alexander Usyskin <alexander.usyskin@intel.com>
	Signed-off-by: Tomas Winkler <tomas.winkler@intel.com>
	Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
(cherry picked from commit 7a23f80eaae9c6b5175cd7a96634a91ed9928aff)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/watchdog/mei_wdt.c
* Unmerged path drivers/watchdog/mei_wdt.c
* Unmerged path drivers/watchdog/mei_wdt.c
