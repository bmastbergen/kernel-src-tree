net/sched: act_mirred: Use passed lastuse argument

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [net] sched: act_mirred: Use passed lastuse argument (Ivan Vecera) [1455296]
Rebuild_FUZZ: 95.83%
commit-author Paul Blakey <paulb@mellanox.com>
commit 5712bf9c5c30ade3204016147d7b04bece6952d9
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/5712bf9c.failed

stats_update callback is called by NIC drivers doing hardware
offloading of the mirred action. Lastuse is passed as argument
to specify when the stats was actually last updated and is not
always the current time.

Fixes: 9798e6fe4f9b ('net: act_mirred: allow statistic updates from offloaded actions')
	Signed-off-by: Paul Blakey <paulb@mellanox.com>
	Signed-off-by: Or Gerlitz <ogerlitz@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 5712bf9c5c30ade3204016147d7b04bece6952d9)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sched/act_mirred.c
diff --cc net/sched/act_mirred.c
index 4b6188539f6c,6b07fba5770b..000000000000
--- a/net/sched/act_mirred.c
+++ b/net/sched/act_mirred.c
@@@ -212,10 -204,21 +212,25 @@@ out
  	return retval;
  }
  
++<<<<<<< HEAD
 +static int tcf_mirred_dump(struct sk_buff *skb, struct tc_action *a, int bind, int ref)
++=======
+ static void tcf_stats_update(struct tc_action *a, u64 bytes, u32 packets,
+ 			     u64 lastuse)
+ {
+ 	struct tcf_mirred *m = to_mirred(a);
+ 	struct tcf_t *tm = &m->tcf_tm;
+ 
+ 	_bstats_cpu_update(this_cpu_ptr(a->cpu_bstats), bytes, packets);
+ 	tm->lastuse = lastuse;
+ }
+ 
+ static int tcf_mirred_dump(struct sk_buff *skb, struct tc_action *a, int bind,
+ 			   int ref)
++>>>>>>> 5712bf9c5c30 (net/sched: act_mirred: Use passed lastuse argument)
  {
  	unsigned char *b = skb_tail_pointer(skb);
 -	struct tcf_mirred *m = to_mirred(a);
 +	struct tcf_mirred *m = a->priv;
  	struct tc_mirred opt = {
  		.index   = m->tcf_index,
  		.action  = m->tcf_action,
* Unmerged path net/sched/act_mirred.c
