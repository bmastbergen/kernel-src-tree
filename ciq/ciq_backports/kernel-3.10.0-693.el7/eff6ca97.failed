HID: wacom: add missed stylus_in_proximity line back

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [hid] wacom: add missed stylus_in_proximity line back (Aristeu Rozanski) [1346348 1388646 1385026]
Rebuild_FUZZ: 94.95%
commit-author Ping Cheng <pinglinux@gmail.com>
commit eff6ca97998386447b795362cc20213114af2870
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/eff6ca97.failed

Commit 7e12978 ("HID: wacom: break out wacom_intuos_get_tool_type") by accident
removed stylus_in_proximity flag for Intuos series while shuffling the code
around.

Fix that by reintroducing that flag setting in wacom_intuos_inout(), where
it originally was.

Fixes: 7e12978 ("HID: wacom: break out wacom_intuos_get_tool_type")
	Signed-off-by: Ping Cheng <pingc@wacom.com>
	Signed-off-by: Jiri Kosina <jkosina@suse.cz>
(cherry picked from commit eff6ca97998386447b795362cc20213114af2870)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/hid/wacom_wac.c
diff --cc drivers/hid/wacom_wac.c
index 98c7d65145c2,cf2ba43453fd..000000000000
--- a/drivers/hid/wacom_wac.c
+++ b/drivers/hid/wacom_wac.c
@@@ -332,82 -682,23 +332,88 @@@ static int wacom_intuos_inout(struct wa
  		wacom->id[idx] = (data[2] << 4) | (data[3] >> 4) |
  			((data[7] & 0x0f) << 20) | ((data[8] & 0xf0) << 12);
  
 -		wacom->tool[idx] = wacom_intuos_get_tool_type(wacom->id[idx]);
 -
 +		switch (wacom->id[idx]) {
 +		case 0x812: /* Inking pen */
 +		case 0x801: /* Intuos3 Inking pen */
 +		case 0x120802: /* Intuos4/5 Inking Pen */
 +		case 0x012:
 +			wacom->tool[idx] = BTN_TOOL_PENCIL;
 +			break;
 +
++<<<<<<< HEAD
 +		case 0x822: /* Pen */
 +		case 0x842:
 +		case 0x852:
 +		case 0x823: /* Intuos3 Grip Pen */
 +		case 0x813: /* Intuos3 Classic Pen */
 +		case 0x885: /* Intuos3 Marker Pen */
 +		case 0x802: /* Intuos4/5 13HD/24HD General Pen */
 +		case 0x804: /* Intuos4/5 13HD/24HD Marker Pen */
 +		case 0x022:
 +		case 0x100804: /* Intuos4/5 13HD/24HD Art Pen */
 +		case 0x140802: /* Intuos4/5 13HD/24HD Classic Pen */
 +		case 0x160802: /* Cintiq 13HD Pro Pen */
 +		case 0x180802: /* DTH2242 Pen */
 +		case 0x100802: /* Intuos4/5 13HD/24HD General Pen */
 +			wacom->tool[idx] = BTN_TOOL_PEN;
 +			break;
++=======
+ 		wacom->shared->stylus_in_proximity = true;
+ 		return 1;
+ 	}
 -
 -	/* in Range */
 -	if ((data[1] & 0xfe) == 0x20) {
 -		if (features->type != INTUOSHT2)
 -			wacom->shared->stylus_in_proximity = true;
 -
 -		/* in Range while exiting */
 -		if (wacom->reporting_data) {
 -			input_report_key(input, BTN_TOUCH, 0);
 -			input_report_abs(input, ABS_PRESSURE, 0);
 -			input_report_abs(input, ABS_DISTANCE, wacom->features.distance_max);
 -			return 2;
++>>>>>>> eff6ca979983 (HID: wacom: add missed stylus_in_proximity line back)
 +
 +		case 0x832: /* Stroke pen */
 +		case 0x032:
 +			wacom->tool[idx] = BTN_TOOL_BRUSH;
 +			break;
 +
 +		case 0x007: /* Mouse 4D and 2D */
 +		case 0x09c:
 +		case 0x094:
 +		case 0x017: /* Intuos3 2D Mouse */
 +		case 0x806: /* Intuos4 Mouse */
 +			wacom->tool[idx] = BTN_TOOL_MOUSE;
 +			break;
 +
 +		case 0x096: /* Lens cursor */
 +		case 0x097: /* Intuos3 Lens cursor */
 +		case 0x006: /* Intuos4 Lens cursor */
 +			wacom->tool[idx] = BTN_TOOL_LENS;
 +			break;
 +
 +		case 0x82a: /* Eraser */
 +		case 0x85a:
 +		case 0x91a:
 +		case 0xd1a:
 +		case 0x0fa:
 +		case 0x82b: /* Intuos3 Grip Pen Eraser */
 +		case 0x81b: /* Intuos3 Classic Pen Eraser */
 +		case 0x91b: /* Intuos3 Airbrush Eraser */
 +		case 0x80c: /* Intuos4/5 13HD/24HD Marker Pen Eraser */
 +		case 0x80a: /* Intuos4/5 13HD/24HD General Pen Eraser */
 +		case 0x90a: /* Intuos4/5 13HD/24HD Airbrush Eraser */
 +		case 0x14080a: /* Intuos4/5 13HD/24HD Classic Pen Eraser */
 +		case 0x10090a: /* Intuos4/5 13HD/24HD Airbrush Eraser */
 +		case 0x10080c: /* Intuos4/5 13HD/24HD Art Pen Eraser */
 +		case 0x16080a: /* Cintiq 13HD Pro Pen Eraser */
 +		case 0x18080a: /* DTH2242 Eraser */
 +		case 0x10080a: /* Intuos4/5 13HD/24HD General Pen Eraser */
 +			wacom->tool[idx] = BTN_TOOL_RUBBER;
 +			break;
 +
 +		case 0xd12:
 +		case 0x912:
 +		case 0x112:
 +		case 0x913: /* Intuos3 Airbrush */
 +		case 0x902: /* Intuos4/5 13HD/24HD Airbrush */
 +		case 0x100902: /* Intuos4/5 13HD/24HD Airbrush */
 +			wacom->tool[idx] = BTN_TOOL_AIRBRUSH;
 +			break;
 +
 +		default: /* Unknown tool */
 +			wacom->tool[idx] = BTN_TOOL_PEN;
 +			break;
  		}
  		return 1;
  	}
* Unmerged path drivers/hid/wacom_wac.c
