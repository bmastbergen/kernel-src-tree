PCI: pciehp: Simplify pcie_poll_cmd()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [pci] pciehp: Simplify pcie_poll_cmd() (Myron Stowe) [1403464]
Rebuild_FUZZ: 92.75%
commit-author Yijing Wang <wangyijing@huawei.com>
commit ac10836b681289f7e430e52b106a209bbdcaa75e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/ac10836b.failed

Move first slot status read into while to simplify code.

	Signed-off-by: Yijing Wang <wangyijing@huawei.com>
	Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
(cherry picked from commit ac10836b681289f7e430e52b106a209bbdcaa75e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/pci/hotplug/pciehp_hpc.c
diff --cc drivers/pci/hotplug/pciehp_hpc.c
index c039cc7922be,daf54bee720d..000000000000
--- a/drivers/pci/hotplug/pciehp_hpc.c
+++ b/drivers/pci/hotplug/pciehp_hpc.c
@@@ -109,26 -109,8 +109,30 @@@ static int pcie_poll_cmd(struct control
  	struct pci_dev *pdev = ctrl_dev(ctrl);
  	u16 slot_status;
  
++<<<<<<< HEAD
 +	pcie_capability_read_word(pdev, PCI_EXP_SLTSTA, &slot_status);
 +	if (slot_status == (u16) ~0) {
 +		ctrl_info(ctrl, "%s: no response from device\n", __func__);
 +		return 0;
 +	}
 +	if (slot_status & PCI_EXP_SLTSTA_CC) {
 +		pcie_capability_write_word(pdev, PCI_EXP_SLTSTA,
 +					   PCI_EXP_SLTSTA_CC);
 +		return 1;
 +	}
 +	while (timeout > 0) {
 +		msleep(10);
 +		timeout -= 10;
++=======
+ 	while (true) {
++>>>>>>> ac10836b6812 (PCI: pciehp: Simplify pcie_poll_cmd())
  		pcie_capability_read_word(pdev, PCI_EXP_SLTSTA, &slot_status);
 +		if (slot_status == (u16) ~0) {
 +			ctrl_info(ctrl, "%s: no response from device\n",
 +				  __func__);
 +			return 0;
 +		}
 +
  		if (slot_status & PCI_EXP_SLTSTA_CC) {
  			pcie_capability_write_word(pdev, PCI_EXP_SLTSTA,
  						   PCI_EXP_SLTSTA_CC);
* Unmerged path drivers/pci/hotplug/pciehp_hpc.c
