crypto: chcr - Check device is allocated before use

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [crypto] chcr - Check device is allocated before use (Sai Vemuri) [1426189]
Rebuild_FUZZ: 91.49%
commit-author Harsh Jain <harsh@chelsio.com>
commit f5f7bebc91ab378dea5aad5277c4d283e46472d9
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/f5f7bebc.failed

Ensure dev is allocated for crypto uld context before using the device
for crypto operations.

	Cc: <stable@vger.kernel.org>
	Signed-off-by: Atul Gupta <atul.gupta@chelsio.com>
	Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
(cherry picked from commit f5f7bebc91ab378dea5aad5277c4d283e46472d9)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/crypto/chelsio/chcr_core.c
diff --cc drivers/crypto/chelsio/chcr_core.c
index 2f6156b672ce,1c65f07e1cc9..000000000000
--- a/drivers/crypto/chelsio/chcr_core.c
+++ b/drivers/crypto/chelsio/chcr_core.c
@@@ -205,10 -202,8 +205,12 @@@ static int chcr_uld_state_change(void *
  
  static int __init chcr_crypto_init(void)
  {
++<<<<<<< HEAD
 +	if (cxgb4_register_pci_uld(CXGB4_PCI_ULD1, &chcr_uld_info)) {
++=======
+ 	if (cxgb4_register_uld(CXGB4_ULD_CRYPTO, &chcr_uld_info))
++>>>>>>> f5f7bebc91ab (crypto: chcr - Check device is allocated before use)
  		pr_err("ULD register fail: No chcr crypto support in cxgb4");
- 		return -1;
- 	}
  
  	return 0;
  }
* Unmerged path drivers/crypto/chelsio/chcr_core.c
