powerpc/pseries: Advertise Hot Plug Event support to firmware

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [powerpc] pseries: Advertise Hot Plug Event support to firmware (Thomas Huth) [1305399 1323417]
Rebuild_FUZZ: 92.98%
commit-author Michael Roth <mdroth@linux.vnet.ibm.com>
commit 3dbbaf200f532e01e56168b8339f2981f2cb1d67
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/3dbbaf20.failed

With the inclusion of commit 333f7b76865b ("powerpc/pseries: Implement
indexed-count hotplug memory add") and commit 753843471cbb
("powerpc/pseries: Implement indexed-count hotplug memory remove"), we
now have complete handling of the RTAS hotplug event format as described
by PAPR via ACR "PAPR Changes for Hotplug RTAS Events".

This capability is indicated by byte 6, bit 2 (5 in IBM numbering) of
architecture option vector 5, and allows for greater control over
cpu/memory/pci hot plug/unplug operations.

Existing pseries kernels will utilize this capability based on the
existence of the /event-sources/hot-plug-events DT property, so we
only need to advertise it via CAS and do not need a corresponding
FW_FEATURE_* value to test for.

	Signed-off-by: Michael Roth <mdroth@linux.vnet.ibm.com>
	Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
(cherry picked from commit 3dbbaf200f532e01e56168b8339f2981f2cb1d67)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/powerpc/include/asm/prom.h
#	arch/powerpc/kernel/prom_init.c
diff --cc arch/powerpc/include/asm/prom.h
index 4c5bfdf4c5ac,4a90634e8322..000000000000
--- a/arch/powerpc/include/asm/prom.h
+++ b/arch/powerpc/include/asm/prom.h
@@@ -126,10 -153,19 +126,26 @@@ struct of_drconf_cell 
  #define OV5_XCMO		0x0440	/* Page Coalescing */
  #define OV5_TYPE1_AFFINITY	0x0580	/* Type 1 NUMA affinity */
  #define OV5_PRRN		0x0540	/* Platform Resource Reassignment */
++<<<<<<< HEAD
 +#define OV5_PFO_HW_RNG		0x0E80	/* PFO Random Number Generator */
 +#define OV5_PFO_HW_842		0x0E40	/* PFO Compression Accelerator */
 +#define OV5_PFO_HW_ENCR		0x0E20	/* PFO Encryption Accelerator */
 +#define OV5_SUB_PROCESSORS	0x0F01	/* 1,2,or 4 Sub-Processors supported */
++=======
+ #define OV5_HP_EVT		0x0604	/* Hot Plug Event support */
+ #define OV5_RESIZE_HPT		0x0601	/* Hash Page Table resizing */
+ #define OV5_PFO_HW_RNG		0x1180	/* PFO Random Number Generator */
+ #define OV5_PFO_HW_842		0x1140	/* PFO Compression Accelerator */
+ #define OV5_PFO_HW_ENCR		0x1120	/* PFO Encryption Accelerator */
+ #define OV5_SUB_PROCESSORS	0x1501	/* 1,2,or 4 Sub-Processors supported */
+ #define OV5_XIVE_EXPLOIT	0x1701	/* XIVE exploitation supported */
+ #define OV5_MMU_RADIX_300	0x1880	/* ISA v3.00 radix MMU supported */
+ #define OV5_MMU_HASH_300	0x1840	/* ISA v3.00 hash MMU supported */
+ #define OV5_MMU_SEGM_RADIX	0x1820	/* radix mode (no segmentation) */
+ #define OV5_MMU_PROC_TBL	0x1810	/* hcall selects SLB or proc table */
+ #define OV5_MMU_SLB		0x1800	/* always use SLB */
+ #define OV5_MMU_GTSE		0x1808	/* Guest translation shootdown */
++>>>>>>> 3dbbaf200f53 (powerpc/pseries: Advertise Hot Plug Event support to firmware)
  
  /* Option Vector 6: IBM PAPR hints */
  #define OV6_LINUX		0x02	/* Linux is our OS */
diff --cc arch/powerpc/kernel/prom_init.c
index f9ff9d4567b9,1a835e77b54b..000000000000
--- a/arch/powerpc/kernel/prom_init.c
+++ b/arch/powerpc/kernel/prom_init.c
@@@ -824,7 -839,7 +824,11 @@@ struct ibm_arch_vec __cacheline_aligne
  		0,
  #endif
  		.associativity = OV5_FEAT(OV5_TYPE1_AFFINITY) | OV5_FEAT(OV5_PRRN),
++<<<<<<< HEAD
 +		.bin_opts = 0,
++=======
+ 		.bin_opts = OV5_FEAT(OV5_RESIZE_HPT) | OV5_FEAT(OV5_HP_EVT),
++>>>>>>> 3dbbaf200f53 (powerpc/pseries: Advertise Hot Plug Event support to firmware)
  		.micro_checkpoint = 0,
  		.reserved0 = 0,
  		.max_cpus = cpu_to_be32(NR_CPUS),	/* number of cores supported */
* Unmerged path arch/powerpc/include/asm/prom.h
* Unmerged path arch/powerpc/kernel/prom_init.c
