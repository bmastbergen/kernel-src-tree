bnxt_en: Move function reset to bnxt_init_one().

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [netdrv] bnxt_en: Move function reset to bnxt_init_one() (Jonathan Toppins) [1382378]
Rebuild_FUZZ: 98.95%
commit-author Michael Chan <michael.chan@broadcom.com>
commit aa8ed021ab515a93f2a052e9cc80320882889698
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/aa8ed021.failed

Now that MSIX is enabled in bnxt_init_one(), resources may be allocated by
the RDMA driver before the network device is opened.  So we cannot do
function reset in bnxt_open() which will clear all the resources.

The proper place to do function reset now is in bnxt_init_one().
If we get AER, we'll do function reset as well.

	Signed-off-by: Somnath Kotur <somnath.kotur@broadcom.com>
	Signed-off-by: Michael Chan <michael.chan@broadcom.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit aa8ed021ab515a93f2a052e9cc80320882889698)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/broadcom/bnxt/bnxt.c
diff --cc drivers/net/ethernet/broadcom/bnxt/bnxt.c
index c6f371a45f71,30b482b8d1ba..000000000000
--- a/drivers/net/ethernet/broadcom/bnxt/bnxt.c
+++ b/drivers/net/ethernet/broadcom/bnxt/bnxt.c
@@@ -6935,9 -7013,17 +6920,20 @@@ static int bnxt_init_one(struct pci_de
  	if (rc)
  		goto init_err;
  
++<<<<<<< HEAD
++=======
+ 	rc = bnxt_hwrm_func_reset(bp);
+ 	if (rc)
+ 		goto init_err;
+ 
+ 	rc = bnxt_init_int_mode(bp);
+ 	if (rc)
+ 		goto init_err;
+ 
++>>>>>>> aa8ed021ab51 (bnxt_en: Move function reset to bnxt_init_one().)
  	rc = register_netdev(dev);
  	if (rc)
 -		goto init_err_clr_int;
 +		goto init_err;
  
  	netdev_info(dev, "%s found at mem %lx, node addr %pM\n",
  		    board_info[ent->driver_data].name,
* Unmerged path drivers/net/ethernet/broadcom/bnxt/bnxt.c
diff --git a/drivers/net/ethernet/broadcom/bnxt/bnxt.h b/drivers/net/ethernet/broadcom/bnxt/bnxt.h
index d19388f26026..9268f8b21895 100644
--- a/drivers/net/ethernet/broadcom/bnxt/bnxt.h
+++ b/drivers/net/ethernet/broadcom/bnxt/bnxt.h
@@ -1019,7 +1019,6 @@ struct bnxt {
 	unsigned long		state;
 #define BNXT_STATE_OPEN		0
 #define BNXT_STATE_IN_SP_TASK	1
-#define BNXT_STATE_FN_RST_DONE	2
 
 	struct bnxt_irq	*irq_tbl;
 	u8			mac_addr[ETH_ALEN];
