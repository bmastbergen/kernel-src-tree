x86/cpufeature: Add AMD AVIC bit

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [x86] cpufeature: Add AMD AVIC bit (Suravee Suthikulpanit) [1133711]
Rebuild_FUZZ: 93.33%
commit-author Borislav Petkov <bp@suse.de>
commit a1ff5726081858a9ad98934eff7af6616c576875
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/a1ff5726.failed

CPUID Fn8000_000A_EDX[13] denotes support for AMD's Virtual
Interrupt controller, i.e., APIC virtualization.

	Signed-off-by: Borislav Petkov <bp@suse.de>
	Cc: Andy Lutomirski <luto@amacapital.net>
	Cc: Borislav Petkov <bp@alien8.de>
	Cc: Brian Gerst <brgerst@gmail.com>
	Cc: David Kaplan <david.kaplan@amd.com>
	Cc: Denys Vlasenko <dvlasenk@redhat.com>
	Cc: H. Peter Anvin <hpa@zytor.com>
	Cc: Joerg Roedel <joro@8bytes.org>
	Cc: Linus Torvalds <torvalds@linux-foundation.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Thomas Gleixner <tglx@linutronix.de>
	Cc: Tom Lendacky <thomas.lendacky@amd.com>
Link: http://lkml.kernel.org/r/1452938292-12327-1-git-send-email-bp@alien8.de
	Signed-off-by: Ingo Molnar <mingo@kernel.org>
(cherry picked from commit a1ff5726081858a9ad98934eff7af6616c576875)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/include/asm/cpufeature.h
diff --cc arch/x86/include/asm/cpufeature.h
index 9d2d987cf6d5,bbf166e805be..000000000000
--- a/arch/x86/include/asm/cpufeature.h
+++ b/arch/x86/include/asm/cpufeature.h
@@@ -254,8 -241,34 +254,39 @@@
  
  /* Intel-defined CPU QoS Sub-leaf, CPUID level 0x0000000F:1 (edx), word 12 */
  #define X86_FEATURE_CQM_OCCUP_LLC (12*32+ 0) /* LLC occupancy monitoring if 1 */
++<<<<<<< HEAD
 +#define X86_FEATURE_CQM_MBM_TOTAL (12*32+ 1) /* LLC Total MBM monitoring */
 +#define X86_FEATURE_CQM_MBM_LOCAL (12*32+ 2) /* LLC Local MBM monitoring */
++=======
+ 
+ /* AMD-defined CPU features, CPUID level 0x80000008 (ebx), word 13 */
+ #define X86_FEATURE_CLZERO	(13*32+0) /* CLZERO instruction */
+ 
+ /* Thermal and Power Management Leaf, CPUID level 0x00000006 (eax), word 14 */
+ #define X86_FEATURE_DTHERM	(14*32+ 0) /* Digital Thermal Sensor */
+ #define X86_FEATURE_IDA		(14*32+ 1) /* Intel Dynamic Acceleration */
+ #define X86_FEATURE_ARAT	(14*32+ 2) /* Always Running APIC Timer */
+ #define X86_FEATURE_PLN		(14*32+ 4) /* Intel Power Limit Notification */
+ #define X86_FEATURE_PTS		(14*32+ 6) /* Intel Package Thermal Status */
+ #define X86_FEATURE_HWP		(14*32+ 7) /* Intel Hardware P-states */
+ #define X86_FEATURE_HWP_NOTIFY	(14*32+ 8) /* HWP Notification */
+ #define X86_FEATURE_HWP_ACT_WINDOW (14*32+ 9) /* HWP Activity Window */
+ #define X86_FEATURE_HWP_EPP	(14*32+10) /* HWP Energy Perf. Preference */
+ #define X86_FEATURE_HWP_PKG_REQ (14*32+11) /* HWP Package Level Request */
+ 
+ /* AMD SVM Feature Identification, CPUID level 0x8000000a (edx), word 15 */
+ #define X86_FEATURE_NPT		(15*32+ 0) /* Nested Page Table support */
+ #define X86_FEATURE_LBRV	(15*32+ 1) /* LBR Virtualization support */
+ #define X86_FEATURE_SVML	(15*32+ 2) /* "svm_lock" SVM locking MSR */
+ #define X86_FEATURE_NRIPS	(15*32+ 3) /* "nrip_save" SVM next_rip save */
+ #define X86_FEATURE_TSCRATEMSR  (15*32+ 4) /* "tsc_scale" TSC scaling support */
+ #define X86_FEATURE_VMCBCLEAN   (15*32+ 5) /* "vmcb_clean" VMCB clean bits support */
+ #define X86_FEATURE_FLUSHBYASID (15*32+ 6) /* flush-by-ASID support */
+ #define X86_FEATURE_DECODEASSISTS (15*32+ 7) /* Decode Assists support */
+ #define X86_FEATURE_PAUSEFILTER (15*32+10) /* filtered pause intercept */
+ #define X86_FEATURE_PFTHRESHOLD (15*32+12) /* pause filter threshold */
+ #define X86_FEATURE_AVIC	(15*32+13) /* Virtual Interrupt Controller */
++>>>>>>> a1ff57260818 (x86/cpufeature: Add AMD AVIC bit)
  
  /*
   * BUG word(s)
* Unmerged path arch/x86/include/asm/cpufeature.h
