amd-xgbe: Use system workqueue for device restart

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Lendacky, Thomas <Thomas.Lendacky@amd.com>
commit 96aec911482246a319bf457f39fa848ce436c8fd
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/96aec911.failed

A previous patch switched from using the system workqueue to the device
workqueue for various operations. During a device restart the device
workqueue is flushed so the restart cannot use this workqueue or else
a deadlock results.  Move the device restart back to using the system
workqueue.

	Signed-off-by: Tom Lendacky <thomas.lendacky@amd.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 96aec911482246a319bf457f39fa848ce436c8fd)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/amd/xgbe/xgbe-drv.c
diff --cc drivers/net/ethernet/amd/xgbe/xgbe-drv.c
index d58e85811bc9,49f796aaad4f..000000000000
--- a/drivers/net/ethernet/amd/xgbe/xgbe-drv.c
+++ b/drivers/net/ethernet/amd/xgbe/xgbe-drv.c
@@@ -981,6 -1532,14 +981,17 @@@ static int xgbe_change_mtu(struct net_d
  	return 0;
  }
  
++<<<<<<< HEAD
++=======
+ static void xgbe_tx_timeout(struct net_device *netdev)
+ {
+ 	struct xgbe_prv_data *pdata = netdev_priv(netdev);
+ 
+ 	netdev_warn(netdev, "tx timeout, device restarting\n");
+ 	schedule_work(&pdata->restart_work);
+ }
+ 
++>>>>>>> 96aec9114822 (amd-xgbe: Use system workqueue for device restart)
  static struct rtnl_link_stats64 *xgbe_get_stats64(struct net_device *netdev,
  						  struct rtnl_link_stats64 *s)
  {
* Unmerged path drivers/net/ethernet/amd/xgbe/xgbe-drv.c
