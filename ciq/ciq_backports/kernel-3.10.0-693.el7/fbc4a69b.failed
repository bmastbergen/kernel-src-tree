net/mlx5e: Fix aRFS compilation dependency

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
Rebuild_CHGLOG: - [netdrv] mlx5e: Fix aRFS compilation dependency (Don Dutile) [1385330 1417284]
Rebuild_FUZZ: 95.00%
commit-author Maor Gottlieb <maorg@mellanox.com>
commit fbc4a69b562e38d6946bc8bd7e97d30fe0acd5d0
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/fbc4a69b.failed

en_arfs.o should be compiled only if both CONFIG_MLX5_CORE_EN
and CONFIG_RFS_ACCEL are enabled. en_arfs calls to rps_may_expire_flow
which is compiled only if CONFIG_RFS_ACCEL is defined.

Move en_arfs.o compilation dependency to be under CONFIG_MLX5_CORE_EN
and wrap the en_arfs.c content with ifdef of CONFIG_RFS_ACCEL.

Fixes: 1cabe6b0965e ('net/mlx5e: Create aRFS flow tables')
	Signed-off-by: Maor Gottlieb <maorg@mellanox.com>
	Reported-by: Alexei Starovoitov <alexei.starovoitov@gmail.com>
	Signed-off-by: Saeed Mahameed <saeedm@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit fbc4a69b562e38d6946bc8bd7e97d30fe0acd5d0)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/Makefile
#	drivers/net/ethernet/mellanox/mlx5/core/en_arfs.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/Makefile
index 3784a00cd751,b531d4f3c00b..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/Makefile
+++ b/drivers/net/ethernet/mellanox/mlx5/core/Makefile
@@@ -6,7 -6,6 +6,11 @@@ mlx5_core-y :=	main.o cmd.o debugfs.o f
  
  mlx5_core-$(CONFIG_MLX5_CORE_EN) += wq.o eswitch.o \
  		en_main.o en_fs.o en_ethtool.o en_tx.o en_rx.o \
++<<<<<<< HEAD
 +		en_txrx.o en_clock.o
++=======
+ 		en_txrx.o en_clock.o vxlan.o en_tc.o en_arfs.o
++>>>>>>> fbc4a69b562e (net/mlx5e: Fix aRFS compilation dependency)
  
 +mlx5_core-$(CONFIG_MLX5_CORE_EN_VXLAN) += vxlan.o
  mlx5_core-$(CONFIG_MLX5_CORE_EN_DCB) +=  en_dcbnl.o
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en_arfs.c
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/Makefile
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en_arfs.c
