perf config: Move config declarations from util/cache.h to util/config.h

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-693.el7
commit-author Taeung Song <treeze.taeung@gmail.com>
commit 41840d211c518e6af6e327b03e09323824e563bf
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-693.el7/41840d21.failed

Lately util/config.h has been added but util/cache.h has declarations of
functions and a global variable for config features.

To manage codes about configuration at one spot, move them to
util/config.h and let source files that need config features include
config.h And if the source files that included previous cache.h need
only config.h, remove including cache.h.

	Signed-off-by: Taeung Song <treeze.taeung@gmail.com>
	Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
	Cc: Jiri Olsa <jolsa@redhat.com>
	Cc: Masami Hiramatsu <mhiramat@kernel.org>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Wang Nan <wangnan0@huawei.com>
Link: http://lkml.kernel.org/r/1466672119-4852-2-git-send-email-treeze.taeung@gmail.com
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 41840d211c518e6af6e327b03e09323824e563bf)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/util/cache.h
#	tools/perf/util/llvm-utils.c
diff --cc tools/perf/util/cache.h
index 0a3814d0511b,9f90e36b56fb..000000000000
--- a/tools/perf/util/cache.h
+++ b/tools/perf/util/cache.h
@@@ -18,18 -18,6 +18,21 @@@
  #define PERF_TRACEFS_ENVIRONMENT "PERF_TRACEFS_DIR"
  #define PERF_PAGER_ENVIRONMENT "PERF_PAGER"
  
++<<<<<<< HEAD
 +extern const char *config_exclusive_filename;
 +
 +typedef int (*config_fn_t)(const char *, const char *, void *);
 +int perf_default_config(const char *, const char *, void *);
 +int perf_config(config_fn_t fn, void *);
 +int perf_config_int(const char *, const char *);
 +u64 perf_config_u64(const char *, const char *);
 +int perf_config_bool(const char *, const char *);
 +int config_error_nonbool(const char *);
 +const char *perf_config_dirname(const char *, const char *);
 +const char *perf_etc_perfconfig(void);
 +
++=======
++>>>>>>> 41840d211c51 (perf config: Move config declarations from util/cache.h to util/config.h)
  char *alias_lookup(const char *alias);
  int split_cmdline(char *cmdline, const char ***argv);
  
diff --cc tools/perf/util/llvm-utils.c
index 5887bb8c1243,40b6f7269cb4..000000000000
--- a/tools/perf/util/llvm-utils.c
+++ b/tools/perf/util/llvm-utils.c
@@@ -3,18 -3,20 +3,22 @@@
   * Copyright (C) 2015, Huawei Inc.
   */
  
 -#include <limits.h>
  #include <stdio.h>
 -#include <stdlib.h>
 +#include <sys/utsname.h>
 +#include "util.h"
  #include "debug.h"
  #include "llvm-utils.h"
++<<<<<<< HEAD
 +#include "cache.h"
++=======
+ #include "config.h"
++>>>>>>> 41840d211c51 (perf config: Move config declarations from util/cache.h to util/config.h)
  
  #define CLANG_BPF_CMD_DEFAULT_TEMPLATE				\
 -		"$CLANG_EXEC -D__KERNEL__ -D__NR_CPUS__=$NR_CPUS "\
 -		"-DLINUX_VERSION_CODE=$LINUX_VERSION_CODE "	\
 -		"$CLANG_OPTIONS $KERNEL_INC_OPTIONS "		\
 -		"-Wno-unused-value -Wno-pointer-sign "		\
 -		"-working-directory $WORKING_DIR "		\
 -		"-c \"$CLANG_SOURCE\" -target bpf -O2 -o -"
 +		"$CLANG_EXEC -D__KERNEL__ $CLANG_OPTIONS "	\
 +		"$KERNEL_INC_OPTIONS -Wno-unused-value "	\
 +		"-Wno-pointer-sign -working-directory "		\
 +		"$WORKING_DIR -c \"$CLANG_SOURCE\" -target bpf -O2 -o -"
  
  struct llvm_param llvm_param = {
  	.clang_path = "clang",
diff --git a/tools/perf/builtin-help.c b/tools/perf/builtin-help.c
index f9830c902b78..268ab732b8aa 100644
--- a/tools/perf/builtin-help.c
+++ b/tools/perf/builtin-help.c
@@ -4,7 +4,7 @@
  * Builtin help command
  */
 #include "perf.h"
-#include "util/cache.h"
+#include "util/config.h"
 #include "builtin.h"
 #include <subcmd/exec-cmd.h>
 #include "common-cmds.h"
diff --git a/tools/perf/builtin-kmem.c b/tools/perf/builtin-kmem.c
index 83343ed30e8f..436987cbe2b5 100644
--- a/tools/perf/builtin-kmem.c
+++ b/tools/perf/builtin-kmem.c
@@ -4,7 +4,7 @@
 #include "util/evlist.h"
 #include "util/evsel.h"
 #include "util/util.h"
-#include "util/cache.h"
+#include "util/config.h"
 #include "util/symbol.h"
 #include "util/thread.h"
 #include "util/header.h"
diff --git a/tools/perf/builtin-record.c b/tools/perf/builtin-record.c
index 7edf3a758d59..816b307568b3 100644
--- a/tools/perf/builtin-record.c
+++ b/tools/perf/builtin-record.c
@@ -13,6 +13,7 @@
 #include "util/util.h"
 #include <subcmd/parse-options.h>
 #include "util/parse-events.h"
+#include "util/config.h"
 
 #include "util/callchain.h"
 #include "util/cgroup.h"
diff --git a/tools/perf/builtin-report.c b/tools/perf/builtin-report.c
index 75a593c2a7f0..b91bb4faaef7 100644
--- a/tools/perf/builtin-report.c
+++ b/tools/perf/builtin-report.c
@@ -8,7 +8,7 @@
 #include "builtin.h"
 
 #include "util/util.h"
-#include "util/cache.h"
+#include "util/config.h"
 
 #include "util/annotate.h"
 #include "util/color.h"
diff --git a/tools/perf/builtin-top.c b/tools/perf/builtin-top.c
index 91e5ca82ea61..0152d0153e3d 100644
--- a/tools/perf/builtin-top.c
+++ b/tools/perf/builtin-top.c
@@ -22,7 +22,7 @@
 #include "perf.h"
 
 #include "util/annotate.h"
-#include "util/cache.h"
+#include "util/config.h"
 #include "util/color.h"
 #include "util/evlist.h"
 #include "util/evsel.h"
diff --git a/tools/perf/perf.c b/tools/perf/perf.c
index aed877333fb7..eeba2424def4 100644
--- a/tools/perf/perf.c
+++ b/tools/perf/perf.c
@@ -10,7 +10,7 @@
 
 #include "util/env.h"
 #include <subcmd/exec-cmd.h>
-#include "util/cache.h"
+#include "util/config.h"
 #include "util/quote.h"
 #include <subcmd/run-command.h>
 #include "util/parse-events.h"
diff --git a/tools/perf/ui/browser.c b/tools/perf/ui/browser.c
index af68a9d488bf..3eb3edb307a4 100644
--- a/tools/perf/ui/browser.c
+++ b/tools/perf/ui/browser.c
@@ -1,5 +1,5 @@
 #include "../util.h"
-#include "../cache.h"
+#include "../config.h"
 #include "../../perf.h"
 #include "libslang.h"
 #include "ui.h"
diff --git a/tools/perf/ui/browsers/annotate.c b/tools/perf/ui/browsers/annotate.c
index 4fc208e82c6f..0e106bb97525 100644
--- a/tools/perf/ui/browsers/annotate.c
+++ b/tools/perf/ui/browsers/annotate.c
@@ -8,6 +8,7 @@
 #include "../../util/sort.h"
 #include "../../util/symbol.h"
 #include "../../util/evsel.h"
+#include "../../util/config.h"
 #include <pthread.h>
 
 struct disasm_line_samples {
diff --git a/tools/perf/util/alias.c b/tools/perf/util/alias.c
index c0b43ee40d95..6c80f830358b 100644
--- a/tools/perf/util/alias.c
+++ b/tools/perf/util/alias.c
@@ -1,4 +1,5 @@
 #include "cache.h"
+#include "config.h"
 
 static const char *alias_key;
 static char *alias_val;
* Unmerged path tools/perf/util/cache.h
diff --git a/tools/perf/util/color.c b/tools/perf/util/color.c
index 43e84aa27e4a..1210ba555d07 100644
--- a/tools/perf/util/color.c
+++ b/tools/perf/util/color.c
@@ -1,5 +1,6 @@
 #include <linux/kernel.h>
 #include "cache.h"
+#include "config.h"
 #include "color.h"
 #include <math.h>
 
diff --git a/tools/perf/util/config.h b/tools/perf/util/config.h
index 22ec626ac718..155a441343e2 100644
--- a/tools/perf/util/config.h
+++ b/tools/perf/util/config.h
@@ -20,6 +20,17 @@ struct perf_config_set {
 	struct list_head sections;
 };
 
+extern const char *config_exclusive_filename;
+
+typedef int (*config_fn_t)(const char *, const char *, void *);
+int perf_default_config(const char *, const char *, void *);
+int perf_config(config_fn_t fn, void *);
+int perf_config_int(const char *, const char *);
+u64 perf_config_u64(const char *, const char *);
+int perf_config_bool(const char *, const char *);
+int config_error_nonbool(const char *);
+const char *perf_etc_perfconfig(void);
+
 struct perf_config_set *perf_config_set__new(void);
 void perf_config_set__delete(struct perf_config_set *set);
 
diff --git a/tools/perf/util/help-unknown-cmd.c b/tools/perf/util/help-unknown-cmd.c
index d62ccaeeadd6..776e28562345 100644
--- a/tools/perf/util/help-unknown-cmd.c
+++ b/tools/perf/util/help-unknown-cmd.c
@@ -1,4 +1,5 @@
 #include "cache.h"
+#include "config.h"
 #include <subcmd/help.h>
 #include "../builtin.h"
 #include "levenshtein.h"
diff --git a/tools/perf/util/intel-pt.c b/tools/perf/util/intel-pt.c
index 137196990012..a2fe3a2194cc 100644
--- a/tools/perf/util/intel-pt.c
+++ b/tools/perf/util/intel-pt.c
@@ -39,6 +39,7 @@
 #include "auxtrace.h"
 #include "tsc.h"
 #include "intel-pt.h"
+#include "config.h"
 
 #include "intel-pt-decoder/intel-pt-log.h"
 #include "intel-pt-decoder/intel-pt-decoder.h"
* Unmerged path tools/perf/util/llvm-utils.c
