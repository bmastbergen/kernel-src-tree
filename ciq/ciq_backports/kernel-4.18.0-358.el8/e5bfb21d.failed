firmware: smccc: Add HAVE_ARM_SMCCC_DISCOVERY to identify SMCCC v1.1 and above

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-358.el8
commit-author Sudeep Holla <sudeep.holla@arm.com>
commit e5bfb21d98b660580b8cdd8a442d12d38d655d11
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-358.el8/e5bfb21d.failed

SMCCC v1.0 lacked discoverability of version and features. To accelerate
adoption of few mitigations and protect systems more rapidly from various
vulnerability, PSCI v1.0 was updated to add SMCCC discovery mechanism
though the PSCI firmware implementation of PSCI_FEATURES(SMCCC_VERSION)
which returns success on firmware compliant to SMCCC v1.1 and above.

This inturn makes SMCCC v1.1 and above dependent on ARM_PSCI_FW for
backward compatibility. Let us introduce a new hidden config for the
same to build more features on top of SMCCC v1.1 and above.

While at it, also sort alphabetically the psci entry.

	Signed-off-by: Sudeep Holla <sudeep.holla@arm.com>
	Tested-by: Etienne Carriere <etienne.carriere@st.com>
	Reviewed-by: Etienne Carriere <etienne.carriere@st.com>
	Acked-by: Mark Rutland <mark.rutland@arm.com>
Link: https://lore.kernel.org/r/20200518091222.27467-2-sudeep.holla@arm.com
	Signed-off-by: Will Deacon <will@kernel.org>
(cherry picked from commit e5bfb21d98b660580b8cdd8a442d12d38d655d11)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/firmware/Kconfig
diff --cc drivers/firmware/Kconfig
index 89a196fa8a98,4843e94713a4..000000000000
--- a/drivers/firmware/Kconfig
+++ b/drivers/firmware/Kconfig
@@@ -283,14 -265,44 +283,49 @@@ config TI_SCI_PROTOCO
  	  This protocol library is used by client drivers to use the features
  	  provided by the system controller.
  
++<<<<<<< HEAD
 +config HAVE_ARM_SMCCC
 +	bool
 +
 +source "drivers/firmware/psci/Kconfig"
++=======
+ config TRUSTED_FOUNDATIONS
+ 	bool "Trusted Foundations secure monitor support"
+ 	depends on ARM && CPU_V7
+ 	help
+ 	  Some devices (including most early Tegra-based consumer devices on
+ 	  the market) are booted with the Trusted Foundations secure monitor
+ 	  active, requiring some core operations to be performed by the secure
+ 	  monitor instead of the kernel.
+ 
+ 	  This option allows the kernel to invoke the secure monitor whenever
+ 	  required on devices using Trusted Foundations. See the functions and
+ 	  comments in linux/firmware/trusted_foundations.h or the device tree
+ 	  bindings for "tlm,trusted-foundations" for details on how to use it.
+ 
+ 	  Choose N if you don't know what this is about.
+ 
+ config TURRIS_MOX_RWTM
+ 	tristate "Turris Mox rWTM secure firmware driver"
+ 	depends on ARCH_MVEBU || COMPILE_TEST
+ 	depends on HAS_DMA && OF
+ 	depends on MAILBOX
+ 	select HW_RANDOM
+ 	select ARMADA_37XX_RWTM_MBOX
+ 	help
+ 	  This driver communicates with the firmware on the Cortex-M3 secure
+ 	  processor of the Turris Mox router. Enable if you are building for
+ 	  Turris Mox, and you will be able to read the device serial number and
+ 	  other manufacturing data and also utilize the Entropy Bit Generator
+ 	  for hardware random number generation.
+ 
++>>>>>>> e5bfb21d98b6 (firmware: smccc: Add HAVE_ARM_SMCCC_DISCOVERY to identify SMCCC v1.1 and above)
  source "drivers/firmware/broadcom/Kconfig"
  source "drivers/firmware/google/Kconfig"
  source "drivers/firmware/efi/Kconfig"
 -source "drivers/firmware/imx/Kconfig"
  source "drivers/firmware/meson/Kconfig"
+ source "drivers/firmware/psci/Kconfig"
+ source "drivers/firmware/smccc/Kconfig"
  source "drivers/firmware/tegra/Kconfig"
 -source "drivers/firmware/xilinx/Kconfig"
  
  endmenu
* Unmerged path drivers/firmware/Kconfig
diff --git a/drivers/firmware/smccc/Kconfig b/drivers/firmware/smccc/Kconfig
new file mode 100644
index 000000000000..27b675d76235
--- /dev/null
+++ b/drivers/firmware/smccc/Kconfig
@@ -0,0 +1,16 @@
+# SPDX-License-Identifier: GPL-2.0-only
+config HAVE_ARM_SMCCC
+	bool
+	help
+	  Include support for the Secure Monitor Call (SMC) and Hypervisor
+	  Call (HVC) instructions on Armv7 and above architectures.
+
+config HAVE_ARM_SMCCC_DISCOVERY
+	bool
+	depends on ARM_PSCI_FW
+	default y
+	help
+	 SMCCC v1.0 lacked discoverability and hence PSCI v1.0 was updated
+	 to add SMCCC discovery mechanism though the PSCI firmware
+	 implementation of PSCI_FEATURES(SMCCC_VERSION) which returns
+	 success on firmware compliant to SMCCC v1.1 and above.
