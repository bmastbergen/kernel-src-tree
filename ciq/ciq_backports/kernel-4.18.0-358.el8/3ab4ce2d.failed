i2c: designware: Fix return value check in navi_amd_register_client()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-358.el8
commit-author Wei Yongjun <weiyongjun1@huawei.com>
commit 3ab4ce2daf09b62e38934a7afe3e9fc3f3cbcdec
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-358.el8/3ab4ce2d.failed

In case of error, the function i2c_new_client_device() returns
ERR_PTR() and never returns NULL. The NULL test in the return
value check should be replaced with IS_ERR().

Fixes: 17631e8ca2d3 ("i2c: designware: Add driver support for AMD NAVI GPU")
	Reported-by: Hulk Robot <hulkci@huawei.com>
	Signed-off-by: Wei Yongjun <weiyongjun1@huawei.com>
	Acked-by: Jarkko Nikula <jarkko.nikula@linux.intel.com>
	Signed-off-by: Wolfram Sang <wsa@kernel.org>
(cherry picked from commit 3ab4ce2daf09b62e38934a7afe3e9fc3f3cbcdec)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/i2c/busses/i2c-designware-pcidrv.c
diff --cc drivers/i2c/busses/i2c-designware-pcidrv.c
index 3664d76bb976,0f409a4c2da0..000000000000
--- a/drivers/i2c/busses/i2c-designware-pcidrv.c
+++ b/drivers/i2c/busses/i2c-designware-pcidrv.c
@@@ -106,6 -118,35 +106,38 @@@ static int mfld_setup(struct pci_dev *p
  	return -ENODEV;
  }
  
++<<<<<<< HEAD
++=======
+  /*
+   * TODO find a better way how to deduplicate instantiation
+   * of USB PD slave device from nVidia GPU driver.
+   */
+ static int navi_amd_register_client(struct dw_i2c_dev *dev)
+ {
+ 	struct i2c_board_info	info;
+ 
+ 	memset(&info, 0, sizeof(struct i2c_board_info));
+ 	strscpy(info.type, "ccgx-ucsi", I2C_NAME_SIZE);
+ 	info.addr = 0x08;
+ 	info.irq = dev->irq;
+ 
+ 	dev->slave = i2c_new_client_device(&dev->adapter, &info);
+ 	if (IS_ERR(dev->slave))
+ 		return PTR_ERR(dev->slave);
+ 
+ 	return 0;
+ }
+ 
+ static int navi_amd_setup(struct pci_dev *pdev, struct dw_pci_controller *c)
+ {
+ 	struct dw_i2c_dev *dev = dev_get_drvdata(&pdev->dev);
+ 
+ 	dev->flags |= MODEL_AMD_NAVI_GPU;
+ 	dev->timings.bus_freq_hz = I2C_MAX_STANDARD_MODE_FREQ;
+ 	return 0;
+ }
+ 
++>>>>>>> 3ab4ce2daf09 (i2c: designware: Fix return value check in navi_amd_register_client())
  static int mrfld_setup(struct pci_dev *pdev, struct dw_pci_controller *c)
  {
  	/*
* Unmerged path drivers/i2c/busses/i2c-designware-pcidrv.c
