Revert "IB/cm: Mark stale CM id's whenever the mad agent was unregistered"

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-358.el8
commit-author Mark Zhang <markzhang@nvidia.com>
commit 3595c398f6dbab79a38550ff26104c6ec1035cd3
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-358.el8/3595c398.failed

This reverts commit 9db0ff53cb9b43ed75bacd42a89c1a0ab048b2b0, which wasn't
a full fix and still causes to the following panic:

panic @ time 1605623870.843, thread 0xfffffeb63b552000: vm_fault_lookup: fault on nofault entry, addr: 0xfffffe811a94e000
    time = 1605623870
    cpuid = 9, TSC = 0xb7937acc1b6
    Panic occurred in module kernel loaded at 0xffffffff80200000:Stack: --------------------------------------------------
    kernel:vm_fault+0x19da
    kernel:vm_fault_trap+0x6e
    kernel:trap_pfault+0x1f1
    kernel:trap+0x31e
    kernel:cm_destroy_id+0x38c
    kernel:rdma_destroy_id+0x127
    kernel:sdp_shutdown_task+0x3ae
    kernel:taskqueue_run_locked+0x10b
    kernel:taskqueue_thread_loop+0x87
    kernel:fork_exit+0x83

Link: https://lore.kernel.org/r/4346449a7cdacc7a4eedc89cb1b42d8434ec9814.1622629024.git.leonro@nvidia.com
	Signed-off-by: Mark Zhang <markzhang@nvidia.com>
	Signed-off-by: Leon Romanovsky <leonro@nvidia.com>
	Signed-off-by: Jason Gunthorpe <jgg@nvidia.com>
(cherry picked from commit 3595c398f6dbab79a38550ff26104c6ec1035cd3)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/core/cm.c
diff --cc drivers/infiniband/core/cm.c
index 4bfc2f70ab02,8a7ac605fded..000000000000
--- a/drivers/infiniband/core/cm.c
+++ b/drivers/infiniband/core/cm.c
@@@ -202,9 -200,7 +200,13 @@@ static struct attribute *cm_counter_def
  struct cm_port {
  	struct cm_device *cm_dev;
  	struct ib_mad_agent *mad_agent;
++<<<<<<< HEAD
 +	u8 port_num;
 +	struct list_head cm_priv_prim_list;
 +	struct list_head cm_priv_altr_list;
++=======
+ 	u32 port_num;
++>>>>>>> 3595c398f6db (Revert "IB/cm: Mark stale CM id's whenever the mad agent was unregistered")
  	struct cm_counter_group counter_group[CM_COUNTER_GROUPS];
  };
  
* Unmerged path drivers/infiniband/core/cm.c
