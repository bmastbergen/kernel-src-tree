ACPI: IORT: Handle device properties with software node API

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-358.el8
commit-author Heikki Krogerus <heikki.krogerus@linux.intel.com>
commit 0df316b8ec04d849ec7908bc90b61a2dce46f3a9
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-358.el8/0df316b8.failed

The older device property API is going to be removed.
Replacing the device_add_properties() call with software
node API equivalent device_create_managed_software_node().

Fixes: 434b73e61cc6 ("iommu/arm-smmu-v3: Use device properties for pasid-num-bits")
	Signed-off-by: Heikki Krogerus <heikki.krogerus@linux.intel.com>
	Acked-by: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
	Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
(cherry picked from commit 0df316b8ec04d849ec7908bc90b61a2dce46f3a9)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/acpi/arm64/iort.c
diff --cc drivers/acpi/arm64/iort.c
index c928060f50f7,e34937e11186..000000000000
--- a/drivers/acpi/arm64/iort.c
+++ b/drivers/acpi/arm64/iort.c
@@@ -975,15 -968,16 +975,24 @@@ static int iort_pci_iommu_init(struct p
  static void iort_named_component_init(struct device *dev,
  				      struct acpi_iort_node *node)
  {
 -	struct property_entry props[2] = {};
  	struct acpi_iort_named_component *nc;
 +	struct iommu_fwspec *fwspec = dev_iommu_fwspec_get(dev);
 +
 +	if (!fwspec)
 +		return;
  
  	nc = (struct acpi_iort_named_component *)node->node_data;
++<<<<<<< HEAD
 +	fwspec->num_pasid_bits = FIELD_GET(ACPI_IORT_NC_PASID_BITS,
 +					   nc->node_flags);
++=======
+ 	props[0] = PROPERTY_ENTRY_U32("pasid-num-bits",
+ 				      FIELD_GET(ACPI_IORT_NC_PASID_BITS,
+ 						nc->node_flags));
+ 
+ 	if (device_create_managed_software_node(dev, props, NULL))
+ 		dev_warn(dev, "Could not add device properties\n");
++>>>>>>> 0df316b8ec04 (ACPI: IORT: Handle device properties with software node API)
  }
  
  static int iort_nc_iommu_map(struct device *dev, struct acpi_iort_node *node)
* Unmerged path drivers/acpi/arm64/iort.c
