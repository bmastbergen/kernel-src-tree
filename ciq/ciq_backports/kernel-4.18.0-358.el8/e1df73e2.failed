efi/libstub/random: Align allocate size to EFI_ALLOC_ALIGN

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-358.el8
commit-author Ard Biesheuvel <ardb@kernel.org>
commit e1df73e2d18b3b7d66f2ec38d81d9566b3a7fb21
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-358.el8/e1df73e2.failed

The EFI stub uses a per-architecture #define for the minimum base
and size alignment of page allocations, which is set to 4 KB for
all architecures except arm64, which uses 64 KB, to ensure that
allocations can always be (un)mapped efficiently, regardless of
the page size used by the kernel proper, which could be a kexec'ee

The API wrappers around page based allocations assume that this
alignment is always taken into account, and so efi_free() will
also round up its size argument to EFI_ALLOC_ALIGN.

Currently, efi_random_alloc() does not honour this alignment for
the allocated size, and so freeing such an allocation may result
in unrelated memory to be freed, potentially leading to issues
after boot. So let's round up size in efi_random_alloc() as well.

Fixes: 2ddbfc81eac84a29 ("efi: stub: add implementation of efi_random_alloc()")
	Signed-off-by: Ard Biesheuvel <ardb@kernel.org>
(cherry picked from commit e1df73e2d18b3b7d66f2ec38d81d9566b3a7fb21)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/firmware/efi/libstub/randomalloc.c
* Unmerged path drivers/firmware/efi/libstub/randomalloc.c
* Unmerged path drivers/firmware/efi/libstub/randomalloc.c
