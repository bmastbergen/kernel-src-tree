Bluetooth: use crypto_shash_tfm_digest()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-358.el8
commit-author Eric Biggers <ebiggers@google.com>
commit ec0bf6edc4ad80b722ebec12a3c7eb392e28d2cb
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-358.el8/ec0bf6ed.failed

Instead of manually allocating a 'struct shash_desc' on the stack and
calling crypto_shash_digest(), switch to using the new helper function
crypto_shash_tfm_digest() which does this for us.

	Cc: linux-bluetooth@vger.kernel.org
	Signed-off-by: Eric Biggers <ebiggers@google.com>
	Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
(cherry picked from commit ec0bf6edc4ad80b722ebec12a3c7eb392e28d2cb)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/bluetooth/smp.c
diff --cc net/bluetooth/smp.c
index 6f18a20267ef,d022f126eb02..000000000000
--- a/net/bluetooth/smp.c
+++ b/net/bluetooth/smp.c
@@@ -182,9 -180,6 +181,12 @@@ static int aes_cmac(struct crypto_shas
  		return -EINVAL;
  	}
  
++<<<<<<< HEAD
 +	desc->tfm = tfm;
 +	desc->flags = 0;
 +
++=======
++>>>>>>> ec0bf6edc4ad (Bluetooth: use crypto_shash_tfm_digest())
  	/* Swap key and message from LSB to MSB */
  	swap_buf(k, tmp, 16);
  	swap_buf(m, msg_msb, len);
* Unmerged path net/bluetooth/smp.c
