netfilter: conntrack: fix error path in nf_conntrack_pernet_init()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-358.el8
commit-author Cong Wang <xiyou.wangcong@gmail.com>
commit ac088a88b5d544b7b82f00214b1588b3c88a7fc6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-358.el8/ac088a88.failed

When nf_ct_netns_get() fails, it should clean up itself,
its caller doesn't need to call nf_conntrack_fini_net().

nf_conntrack_init_net() is called after registering sysctl
and proc, so its cleanup function should be called before
unregistering sysctl and proc.

Fixes: ba3fbe663635 ("netfilter: nf_conntrack: provide modparam to always register conntrack hooks")
Fixes: b884fa461776 ("netfilter: conntrack: unify sysctl handling")
Reported-and-tested-by: syzbot+fcee88b2d87f0539dfe9@syzkaller.appspotmail.com
	Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com>
	Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
(cherry picked from commit ac088a88b5d544b7b82f00214b1588b3c88a7fc6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/netfilter/nf_conntrack_standalone.c
diff --cc net/netfilter/nf_conntrack_standalone.c
index 7124e0586e2f,c2ae14c720b4..000000000000
--- a/net/netfilter/nf_conntrack_standalone.c
+++ b/net/netfilter/nf_conntrack_standalone.c
@@@ -647,11 -1114,12 +647,20 @@@ static int nf_conntrack_pernet_init(str
  
  	return 0;
  
++<<<<<<< HEAD
 +out_sysctl:
 +	nf_conntrack_standalone_fini_proc(net);
 +out_proc:
 +	nf_conntrack_cleanup_net(net);
 +out_init:
++=======
+ out_hooks:
+ 	nf_conntrack_cleanup_net(net);
+ out_init_net:
+ 	nf_conntrack_standalone_fini_proc(net);
+ out_proc:
+ 	nf_conntrack_standalone_fini_sysctl(net);
++>>>>>>> ac088a88b5d5 (netfilter: conntrack: fix error path in nf_conntrack_pernet_init())
  	return ret;
  }
  
* Unmerged path net/netfilter/nf_conntrack_standalone.c
