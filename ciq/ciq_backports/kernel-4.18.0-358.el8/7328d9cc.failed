mm: sort out the DEVICE_PRIVATE Kconfig mess

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-358.el8
commit-author Christoph Hellwig <hch@lst.de>
commit 7328d9cc1b9fdc52105901072e9a4a1234e29b11
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-358.el8/7328d9cc.failed

The ZONE_DEVICE support doesn't depend on anything HMM related, just on
various bits of arch support as indicated by the architecture.  Also
don't select the option from nouveau as it isn't present in many setups,
and depend on it instead.

	Signed-off-by: Christoph Hellwig <hch@lst.de>
	Reviewed-by: Ira Weiny <ira.weiny@intel.com>
	Reviewed-by: Dan Williams <dan.j.williams@intel.com>
	Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
(cherry picked from commit 7328d9cc1b9fdc52105901072e9a4a1234e29b11)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/nouveau/Kconfig
#	mm/Kconfig
diff --cc drivers/gpu/drm/nouveau/Kconfig
index 9436310d0854,6303d203ab1d..000000000000
--- a/drivers/gpu/drm/nouveau/Kconfig
+++ b/drivers/gpu/drm/nouveau/Kconfig
@@@ -95,12 -84,11 +95,19 @@@ config DRM_NOUVEAU_BACKLIGH
  
  config DRM_NOUVEAU_SVM
  	bool "(EXPERIMENTAL) Enable SVM (Shared Virtual Memory) support"
++<<<<<<< HEAD
++=======
+ 	depends on ARCH_HAS_HMM
++>>>>>>> 7328d9cc1b9f (mm: sort out the DEVICE_PRIVATE Kconfig mess)
  	depends on DEVICE_PRIVATE
  	depends on DRM_NOUVEAU
 +	depends on MMU
  	depends on STAGING
  	select HMM_MIRROR
++<<<<<<< HEAD
 +	select MMU_NOTIFIER
++=======
++>>>>>>> 7328d9cc1b9f (mm: sort out the DEVICE_PRIVATE Kconfig mess)
  	default n
  	help
  	  Say Y here if you want to enable experimental support for
diff --cc mm/Kconfig
index 6da8b7636bba,eecf037a54b3..000000000000
--- a/mm/Kconfig
+++ b/mm/Kconfig
@@@ -686,6 -669,25 +686,28 @@@ config ZONE_DEVIC
  
  	  If FS_DAX is enabled, then say Y.
  
++<<<<<<< HEAD
++=======
+ config ARCH_HAS_HMM_MIRROR
+ 	bool
+ 	default y
+ 	depends on (X86_64 || PPC64)
+ 	depends on MMU && 64BIT
+ 
+ config ARCH_HAS_HMM
+ 	bool
+ 	depends on (X86_64 || PPC64)
+ 	depends on ZONE_DEVICE
+ 	depends on MMU && 64BIT
+ 	depends on MEMORY_HOTPLUG
+ 	depends on MEMORY_HOTREMOVE
+ 	depends on SPARSEMEM_VMEMMAP
+ 	default y
+ 
+ config MIGRATE_VMA_HELPER
+ 	bool
+ 
++>>>>>>> 7328d9cc1b9f (mm: sort out the DEVICE_PRIVATE Kconfig mess)
  config DEV_PAGEMAP_OPS
  	bool
  
* Unmerged path drivers/gpu/drm/nouveau/Kconfig
* Unmerged path mm/Kconfig
