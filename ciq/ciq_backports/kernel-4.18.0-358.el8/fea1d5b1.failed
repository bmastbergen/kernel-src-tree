sctp: send the next probe immediately once the last one is acked

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-358.el8
commit-author Xin Long <lucien.xin@gmail.com>
commit fea1d5b17f821b78abbdadb9cb6f28fe433b635e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-358.el8/fea1d5b1.failed

These is no need to wait for 'interval' period for the next probe
if the last probe is already acked in search state. The 'interval'
period waiting should be only for probe failure timeout and the
current pmtu check when it's in search complete state.

This change will shorten the probe time a lot in search state, and
also fix the document accordingly.

	Signed-off-by: Xin Long <lucien.xin@gmail.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit fea1d5b17f821b78abbdadb9cb6f28fe433b635e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	Documentation/networking/ip-sysctl.txt
diff --cc Documentation/networking/ip-sysctl.txt
index e1b139c4be92,b3fa522e4cd9..000000000000
--- a/Documentation/networking/ip-sysctl.txt
+++ b/Documentation/networking/ip-sysctl.txt
@@@ -2237,12 -2834,28 +2237,24 @@@ encap_port - INTEGE
  
  	Default: 0
  
++<<<<<<< HEAD:Documentation/networking/ip-sysctl.txt
++=======
+ plpmtud_probe_interval - INTEGER
+         The time interval (in milliseconds) for the PLPMTUD probe timer,
+         which is configured to expire after this period to receive an
+         acknowledgment to a probe packet. This is also the time interval
+         between the probes for the current pmtu when the probe search
+         is done.
+ 
+         PLPMTUD will be disabled when 0 is set, and other values for it
+         must be >= 5000.
++>>>>>>> fea1d5b17f82 (sctp: send the next probe immediately once the last one is acked):Documentation/networking/ip-sysctl.rst
  
 -	Default: 0
 -
 -
 -``/proc/sys/net/core/*``
 -========================
 -
 -	Please see: Documentation/admin-guide/sysctl/net.rst for descriptions of these entries.
 -
 +/proc/sys/net/core/*
 +	Please see: Documentation/sysctl/net.txt for descriptions of these entries.
  
 -``/proc/sys/net/unix/*``
 -========================
  
 +/proc/sys/net/unix/*
  max_dgram_qlen - INTEGER
  	The maximum length of dgram socket receive queue
  
* Unmerged path Documentation/networking/ip-sysctl.txt
diff --git a/net/sctp/sm_statefuns.c b/net/sctp/sm_statefuns.c
index 209200b6aac2..146c8124a848 100644
--- a/net/sctp/sm_statefuns.c
+++ b/net/sctp/sm_statefuns.c
@@ -1290,7 +1290,10 @@ enum sctp_disposition sctp_sf_backbeat_8_3(struct net *net,
 			return SCTP_DISPOSITION_DISCARD;
 
 		sctp_transport_pl_recv(link);
-		return SCTP_DISPOSITION_CONSUME;
+		if (link->pl.state == SCTP_PL_COMPLETE)
+			return SCTP_DISPOSITION_CONSUME;
+
+		return sctp_sf_send_probe(net, ep, asoc, type, link, commands);
 	}
 
 	max_interval = link->hbinterval + link->rto;
