net: bridge: fix error in br_multicast_add_port when CONFIG_NET_SWITCHDEV=n

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-358.el8
commit-author Vladimir Oltean <vladimir.oltean@nxp.com>
commit 68f5c12abbc9b6f8c5eea16c62f8b7be70793163
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-358.el8/68f5c12a.failed

When CONFIG_NET_SWITCHDEV is disabled, the shim for switchdev_port_attr_set
inside br_mc_disabled_update returns -EOPNOTSUPP. This is not caught,
and propagated to the caller of br_multicast_add_port, preventing ports
from joining the bridge.

	Reported-by: Christian Borntraeger <borntraeger@de.ibm.com>
Fixes: ae1ea84b33da ("net: bridge: propagate error code and extack from br_mc_disabled_update")
	Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
	Acked-by: Florian Fainelli <f.fainelli@gmail.com>
	Tested-by: Christian Borntraeger <borntraeger@de.ibm.com>
	Acked-by: Nikolay Aleksandrov <nikolay@nvidia.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 68f5c12abbc9b6f8c5eea16c62f8b7be70793163)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/bridge/br_multicast.c
diff --cc net/bridge/br_multicast.c
index 4eaac3b4a6ea,2883601d5c8b..000000000000
--- a/net/bridge/br_multicast.c
+++ b/net/bridge/br_multicast.c
@@@ -1210,8 -1621,12 +1210,17 @@@ int br_multicast_add_port(struct net_br
  	timer_setup(&port->ip6_own_query.timer,
  		    br_ip6_multicast_port_query_expired, 0);
  #endif
++<<<<<<< HEAD
 +	br_mc_disabled_update(port->dev,
 +			      br_opt_get(port->br, BROPT_MULTICAST_ENABLED));
++=======
+ 	err = br_mc_disabled_update(port->dev,
+ 				    br_opt_get(port->br,
+ 					       BROPT_MULTICAST_ENABLED),
+ 				    NULL);
+ 	if (err && err != -EOPNOTSUPP)
+ 		return err;
++>>>>>>> 68f5c12abbc9 (net: bridge: fix error in br_multicast_add_port when CONFIG_NET_SWITCHDEV=n)
  
  	port->mcast_stats = netdev_alloc_pcpu_stats(struct bridge_mcast_stats);
  	if (!port->mcast_stats)
* Unmerged path net/bridge/br_multicast.c
