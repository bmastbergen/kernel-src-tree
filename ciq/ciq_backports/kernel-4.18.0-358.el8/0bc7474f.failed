psci: Split functions to v0.1 and v0.2+ variants

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-358.el8
commit-author David Brazdil <dbrazdil@google.com>
commit 0bc7474fb7673422b134e88feb49cde54b22bb75
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-358.el8/0bc7474f.failed

Refactor implementation of v0.1+ functions (CPU_SUSPEND, CPU_OFF,
CPU_ON, MIGRATE) to have two functions psci_0_1_foo / psci_0_2_foo that
select the function ID and call a common helper __psci_foo.

This is a small cleanup so that the function ID array is only used for
v0.1 configurations.

	Signed-off-by: David Brazdil <dbrazdil@google.com>
	Signed-off-by: Marc Zyngier <maz@kernel.org>
	Acked-by: Mark Rutland <mark.rutland@arm.com>
Link: https://lore.kernel.org/r/20201202184122.26046-5-dbrazdil@google.com
(cherry picked from commit 0bc7474fb7673422b134e88feb49cde54b22bb75)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/firmware/psci/psci.c
diff --cc drivers/firmware/psci/psci.c
index 1606915bfeff,13b9ed71b446..000000000000
--- a/drivers/firmware/psci/psci.c
+++ b/drivers/firmware/psci/psci.c
@@@ -174,12 -156,22 +174,26 @@@ static u32 psci_0_2_get_version(void
  	return invoke_psci_fn(PSCI_0_2_FN_PSCI_VERSION, 0, 0, 0);
  }
  
++<<<<<<< HEAD
 +static int psci_cpu_suspend(u32 state, unsigned long entry_point)
++=======
+ int psci_set_osi_mode(bool enable)
+ {
+ 	unsigned long suspend_mode;
+ 	int err;
+ 
+ 	suspend_mode = enable ? PSCI_1_0_SUSPEND_MODE_OSI :
+ 			PSCI_1_0_SUSPEND_MODE_PC;
+ 
+ 	err = invoke_psci_fn(PSCI_1_0_FN_SET_SUSPEND_MODE, suspend_mode, 0, 0);
+ 	return psci_to_linux_errno(err);
+ }
+ 
+ static int __psci_cpu_suspend(u32 fn, u32 state, unsigned long entry_point)
++>>>>>>> 0bc7474fb767 (psci: Split functions to v0.1 and v0.2+ variants)
  {
  	int err;
- 	u32 fn;
  
- 	fn = psci_function_id[PSCI_FN_CPU_SUSPEND];
  	err = invoke_psci_fn(fn, state, entry_point, 0);
  	return psci_to_linux_errno(err);
  }
* Unmerged path drivers/firmware/psci/psci.c
