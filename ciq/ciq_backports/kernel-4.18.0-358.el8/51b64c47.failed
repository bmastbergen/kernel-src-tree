Bluetooth: Use whitelist for scan policy when suspending

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-358.el8
commit-author Miao-chen Chou <mcchou@chromium.org>
commit 51b64c476a5ddc66d3459f14e98e5de9211e9e24
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-358.el8/51b64c47.failed

Even with one advertisement monitor in place, the scan policy should use
the whitelist while the system is going to suspend to prevent waking by
random advertisement.

The following test was performed.
- With a paired device, register one advertisement monitor, suspend
the system and verify that the host was not awaken by random
advertisements.

	Signed-off-by: Miao-chen Chou <mcchou@chromium.org>
	Reviewed-by: Abhishek Pandit-Subedi <abhishekpandit@chromium.org>
	Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
(cherry picked from commit 51b64c476a5ddc66d3459f14e98e5de9211e9e24)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/bluetooth/hci_request.c
diff --cc net/bluetooth/hci_request.c
index 6c4c587db40a,770b93758112..000000000000
--- a/net/bluetooth/hci_request.c
+++ b/net/bluetooth/hci_request.c
@@@ -798,6 -798,14 +798,17 @@@ static u8 update_white_list(struct hci_
  			return 0x00;
  	}
  
++<<<<<<< HEAD
++=======
+ 	/* Once the controller offloading of advertisement monitor is in place,
+ 	 * the if condition should include the support of MSFT extension
+ 	 * support. If suspend is ongoing, whitelist should be the default to
+ 	 * prevent waking by random advertisements.
+ 	 */
+ 	if (!idr_is_empty(&hdev->adv_monitors_idr) && !hdev->suspended)
+ 		return 0x00;
+ 
++>>>>>>> 51b64c476a5d (Bluetooth: Use whitelist for scan policy when suspending)
  	/* Select filter policy to use white list */
  	return 0x01;
  }
* Unmerged path net/bluetooth/hci_request.c
