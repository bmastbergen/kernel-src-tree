mm/hmm: make HMM_MIRROR an implicit option

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-358.el8
commit-author Christoph Hellwig <hch@lst.de>
commit 9c240a7bb33787d4fed56508425ae0b2936b1674
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-358.el8/9c240a7b.failed

Make HMM_MIRROR an option that is selected by drivers wanting to use it
instead of a user visible option as it is just a low-level implementation
detail.

Link: https://lore.kernel.org/r/20190806160554.14046-15-hch@lst.de
	Signed-off-by: Christoph Hellwig <hch@lst.de>
	Reviewed-by: Jason Gunthorpe <jgg@mellanox.com>
	Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>
(cherry picked from commit 9c240a7bb33787d4fed56508425ae0b2936b1674)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/nouveau/Kconfig
#	mm/Kconfig
diff --cc drivers/gpu/drm/nouveau/Kconfig
index 9436310d0854,df4352c279ba..000000000000
--- a/drivers/gpu/drm/nouveau/Kconfig
+++ b/drivers/gpu/drm/nouveau/Kconfig
@@@ -100,6 -89,7 +100,10 @@@ config DRM_NOUVEAU_SV
  	depends on MMU
  	depends on STAGING
  	select HMM_MIRROR
++<<<<<<< HEAD
++=======
+ 	select MIGRATE_VMA_HELPER
++>>>>>>> 9c240a7bb337 (mm/hmm: make HMM_MIRROR an implicit option)
  	select MMU_NOTIFIER
  	default n
  	help
diff --cc mm/Kconfig
index 7561c594f9aa,563436dc1f24..000000000000
--- a/mm/Kconfig
+++ b/mm/Kconfig
@@@ -689,17 -672,17 +689,25 @@@ config ZONE_DEVIC
  config DEV_PAGEMAP_OPS
  	bool
  
+ #
+ # Helpers to mirror range of the CPU page tables of a process into device page
+ # tables.
+ #
  config HMM_MIRROR
- 	bool "HMM mirror CPU page table into a device page table"
+ 	bool
  	depends on MMU
++<<<<<<< HEAD
 +	select MMU_NOTIFIER
 +	select MIGRATE_VMA_HELPER
 +	help
 +	  Select HMM_MIRROR if you want to mirror range of the CPU page table of a
 +	  process into a device page table. Here, mirror means "keep synchronized".
 +	  Prerequisites: the device must provide the ability to write-protect its
 +	  page tables (at PAGE_SIZE granularity), and must be able to recover from
 +	  the resulting potential page faults.
++=======
+ 	depends on MMU_NOTIFIER
++>>>>>>> 9c240a7bb337 (mm/hmm: make HMM_MIRROR an implicit option)
  
  config DEVICE_PRIVATE
  	bool "Unaddressable device memory (GPU memory, ...)"
* Unmerged path drivers/gpu/drm/nouveau/Kconfig
* Unmerged path mm/Kconfig
