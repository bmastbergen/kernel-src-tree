sched: Add a new SD_SHARE_POWERDOMAIN for sched_domain

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-1160.6.1.el7
commit-author Vincent Guittot <vincent.guittot@linaro.org>
commit d77b3ed5c9f8ebedf154b52b5e943c461f3d37e6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1160.6.1.el7/d77b3ed5.failed

A new flag SD_SHARE_POWERDOMAIN is created to reflect whether groups of CPUs
in a sched_domain level can or not reach different power state. As an example,
the flag should be cleared at CPU level if groups of cores can be power gated
independently. This information can be used in the load balance decision or to
add load balancing level between group of CPUs that can power gate
independantly.
This flag is part of the topology flags that can be set by arch.

	Reviewed-by: Dietmar Eggemann <dietmar.eggemann@arm.com>
	Tested-by: Dietmar Eggemann <dietmar.eggemann@arm.com>
	Signed-off-by: Vincent Guittot <vincent.guittot@linaro.org>
	Signed-off-by: Peter Zijlstra <peterz@infradead.org>
	Cc: Linus Torvalds <torvalds@linux-foundation.org>
	Cc: tony.luck@intel.com
	Cc: fenghua.yu@intel.com
	Cc: schwidefsky@de.ibm.com
	Cc: cmetcalf@tilera.com
	Cc: benh@kernel.crashing.org
	Cc: preeti@linux.vnet.ibm.com
Link: http://lkml.kernel.org/r/1397209481-28542-5-git-send-email-vincent.guittot@linaro.org
	Signed-off-by: Ingo Molnar <mingo@kernel.org>
(cherry picked from commit d77b3ed5c9f8ebedf154b52b5e943c461f3d37e6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	kernel/sched/core.c
diff --cc kernel/sched/core.c
index 565cd89a0240,1c9c3b7b26af..000000000000
--- a/kernel/sched/core.c
+++ b/kernel/sched/core.c
@@@ -7634,8 -5912,9 +7637,14 @@@ int __read_mostly		node_reclaim_distanc
  	(SD_SHARE_CPUPOWER |		\
  	 SD_SHARE_PKG_RESOURCES |	\
  	 SD_NUMA |			\
++<<<<<<< HEAD
 +	 SD_ASYM_PACKING)
 + 
++=======
+ 	 SD_ASYM_PACKING |		\
+ 	 SD_SHARE_POWERDOMAIN)
+ 
++>>>>>>> d77b3ed5c9f8 (sched: Add a new SD_SHARE_POWERDOMAIN for sched_domain)
  static struct sched_domain *
  sd_init(struct sched_domain_topology_level *tl, int cpu)
  {
diff --git a/include/linux/sched.h b/include/linux/sched.h
index f3240ea65cdf..017fe07f367d 100644
--- a/include/linux/sched.h
+++ b/include/linux/sched.h
@@ -956,6 +956,7 @@ extern void wake_up_q(struct wake_q_head *head);
 #define SD_BALANCE_WAKE		0x0010  /* Balance on wakeup */
 #define SD_WAKE_AFFINE		0x0020	/* Wake task to waking CPU */
 #define SD_SHARE_CPUPOWER	0x0080	/* Domain members share cpu power */
+#define SD_SHARE_POWERDOMAIN	0x0100	/* Domain members share power domain */
 #define SD_SHARE_PKG_RESOURCES	0x0200	/* Domain members share cpu pkg resources */
 #define SD_SERIALIZE		0x0400	/* Only a single load balancing instance */
 #define SD_ASYM_PACKING		0x0800  /* Place busy groups earlier in the domain */
* Unmerged path kernel/sched/core.c
