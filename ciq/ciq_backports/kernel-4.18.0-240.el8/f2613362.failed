KVM: arm64: Change CONFIG_KVM to a menuconfig entry

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Will Deacon <will@kernel.org>
commit f26133624d602b0d984815168a2d3a1f630b02e2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/f2613362.failed

Changing CONFIG_KVM to be a 'menuconfig' entry in Kconfig mean that we
can straightforwardly enumerate optional features, such as the virtual
PMU device as dependent options.

	Signed-off-by: Will Deacon <will@kernel.org>
	Signed-off-by: Fuad Tabba <tabba@google.com>
	Signed-off-by: Marc Zyngier <maz@kernel.org>
Link: https://lore.kernel.org/r/20200505154520.194120-4-tabba@google.com
(cherry picked from commit f26133624d602b0d984815168a2d3a1f630b02e2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/arm64/kvm/Kconfig
diff --cc arch/arm64/kvm/Kconfig
index 4fbee6845e2b,f1c1f981482c..000000000000
--- a/arch/arm64/kvm/Kconfig
+++ b/arch/arm64/kvm/Kconfig
@@@ -18,12 -17,13 +17,12 @@@ menuconfig VIRTUALIZATIO
  
  if VIRTUALIZATION
  
- config KVM
+ menuconfig KVM
  	bool "Kernel-based Virtual Machine (KVM) support"
  	depends on OF
 -	# for TASKSTATS/TASK_DELAY_ACCT:
 -	depends on NET && MULTIUSER
  	select MMU_NOTIFIER
  	select PREEMPT_NOTIFIERS
 +	select ANON_INODES
  	select HAVE_KVM_CPU_RELAX_INTERCEPT
  	select HAVE_KVM_ARCH_TLB_FLUSH_ALL
  	select KVM_MMIO
@@@ -45,20 -45,21 +43,30 @@@
  
  	  If unsure, say N.
  
++<<<<<<< HEAD
 +config KVM_ARM_HOST
 +	bool
 +	---help---
 +	  Provides host support for ARM processors.
++=======
+ if KVM
+ 
+ source "virt/kvm/Kconfig"
++>>>>>>> f26133624d60 (KVM: arm64: Change CONFIG_KVM to a menuconfig entry)
  
  config KVM_ARM_PMU
- 	bool
+ 	bool "Virtual Performance Monitoring Unit (PMU) support"
+ 	depends on HW_PERF_EVENTS
+ 	default y
  	---help---
  	  Adds support for a virtual Performance Monitoring Unit (PMU) in
  	  virtual machines.
  
  config KVM_INDIRECT_VECTORS
-        def_bool KVM && (HARDEN_BRANCH_PREDICTOR || HARDEN_EL2_VECTORS)
+ 	def_bool HARDEN_BRANCH_PREDICTOR || HARDEN_EL2_VECTORS
+ 
+ endif # KVM
  
 +source drivers/vhost/Kconfig
 +
  endif # VIRTUALIZATION
* Unmerged path arch/arm64/kvm/Kconfig
