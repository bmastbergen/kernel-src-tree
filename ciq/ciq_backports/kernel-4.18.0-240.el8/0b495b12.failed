perf evswitch: Add the names of on/off events

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Arnaldo Carvalho de Melo <acme@redhat.com>
commit 0b495b121585a1b6ca120fe13f950e2f86ca8197
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/0b495b12.failed

So that we can have macros for the OPT_ entries and also for finding
those in an evlist, this way other tools will use this very easily.

	Cc: Adrian Hunter <adrian.hunter@intel.com>
	Cc: Florian Weimer <fweimer@redhat.com>
	Cc: Jiri Olsa <jolsa@kernel.org>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: William Cohen <wcohen@redhat.com>
Link: https://lkml.kernel.org/n/tip-q0og1xoqqi0w38ve5u0a43k2@git.kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 0b495b121585a1b6ca120fe13f950e2f86ca8197)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/builtin-script.c
diff --cc tools/perf/builtin-script.c
index e747fa78aabb,177e4e91b199..000000000000
--- a/tools/perf/builtin-script.c
+++ b/tools/perf/builtin-script.c
@@@ -3539,6 -3543,12 +3539,15 @@@ int cmd_script(int argc, const char **a
  		   "file", "file saving guest os /proc/kallsyms"),
  	OPT_STRING(0, "guestmodules", &symbol_conf.default_guest_modules,
  		   "file", "file saving guest os /proc/modules"),
++<<<<<<< HEAD
++=======
+ 	OPT_STRING(0, "switch-on", &script.evswitch.on_name,
+ 		   "event", "Consider events after the ocurrence of this event"),
+ 	OPT_STRING(0, "switch-off", &script.evswitch.off_name,
+ 		   "event", "Stop considering events after the ocurrence of this event"),
+ 	OPT_BOOLEAN(0, "show-on-off-events", &script.evswitch.show_on_off_events,
+ 		    "Show the on/off switch events, used with --switch-on"),
++>>>>>>> 0b495b121585 (perf evswitch: Add the names of on/off events)
  	OPT_END()
  	};
  	const char * const script_subcommands[] = { "record", "report", NULL };
@@@ -3863,6 -3873,25 +3872,28 @@@
  						  script.range_num);
  	}
  
++<<<<<<< HEAD
++=======
+ 	if (script.evswitch.on_name) {
+ 		script.evswitch.on = perf_evlist__find_evsel_by_str(session->evlist, script.evswitch.on_name);
+ 		if (script.evswitch.on == NULL) {
+ 			fprintf(stderr, "switch-on event not found (%s)\n", script.evswitch.on_name);
+ 			err = -ENOENT;
+ 			goto out_delete;
+ 		}
+ 		script.evswitch.discarding = true;
+ 	}
+ 
+ 	if (script.evswitch.off_name) {
+ 		script.evswitch.off = perf_evlist__find_evsel_by_str(session->evlist, script.evswitch.off_name);
+ 		if (script.evswitch.off == NULL) {
+ 			fprintf(stderr, "switch-off event not found (%s)\n", script.evswitch.off_name);
+ 			err = -ENOENT;
+ 			goto out_delete;
+ 		}
+ 	}
+ 
++>>>>>>> 0b495b121585 (perf evswitch: Add the names of on/off events)
  	err = __cmd_script(&script);
  
  	flush_scripting();
* Unmerged path tools/perf/builtin-script.c
diff --git a/tools/perf/util/evswitch.h b/tools/perf/util/evswitch.h
index bb88e8002f39..2f1c46776f2d 100644
--- a/tools/perf/util/evswitch.h
+++ b/tools/perf/util/evswitch.h
@@ -9,6 +9,7 @@ struct evsel;
 
 struct evswitch {
 	struct evsel *on, *off;
+	const char   *on_name, *off_name;
 	bool	     discarding;
 	bool	     show_on_off_events;
 };
