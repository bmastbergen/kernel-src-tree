libsubcmd: Make _FORTIFY_SOURCE defines dependent on the feature

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Ian Rogers <irogers@google.com>
commit 4b0b2b096da9d296e0e5668cdfba8613bd6f5bc8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/4b0b2b09.failed

Unconditionally defining _FORTIFY_SOURCE can break tools that don't work
with it, such as memory sanitizers:

  https://github.com/google/sanitizers/wiki/AddressSanitizer#faq

Fixes: 4b6ab94eabe4 ("perf subcmd: Create subcmd library")
	Signed-off-by: Ian Rogers <irogers@google.com>
	Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
	Cc: Andi Kleen <ak@linux.intel.com>
	Cc: Jiri Olsa <jolsa@redhat.com>
	Cc: Josh Poimboeuf <jpoimboe@redhat.com>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Stephane Eranian <eranian@google.com>
Link: http://lore.kernel.org/lkml/20190925195924.152834-1-irogers@google.com
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 4b0b2b096da9d296e0e5668cdfba8613bd6f5bc8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/lib/subcmd/Makefile
diff --cc tools/lib/subcmd/Makefile
index ff282f81b547,5b2cd5e58df0..000000000000
--- a/tools/lib/subcmd/Makefile
+++ b/tools/lib/subcmd/Makefile
@@@ -20,7 -20,13 +20,17 @@@ MAKEFLAGS += --no-print-director
  LIBFILE = $(OUTPUT)libsubcmd.a
  
  CFLAGS := $(EXTRA_WARNINGS) $(EXTRA_CFLAGS)
++<<<<<<< HEAD
 +CFLAGS += -g -Wall -Wextra -std=gnu99 -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2 -fPIC
++=======
+ CFLAGS += -ggdb3 -Wall -Wextra -std=gnu99 -fPIC
+ 
+ ifeq ($(DEBUG),0)
+   ifeq ($(feature-fortify-source), 1)
+     CFLAGS += -U_FORTIFY_SOURCE -D_FORTIFY_SOURCE=2
+   endif
+ endif
++>>>>>>> 4b0b2b096da9 (libsubcmd: Make _FORTIFY_SOURCE defines dependent on the feature)
  
  ifeq ($(CC_NO_CLANG), 0)
    CFLAGS += -O3
* Unmerged path tools/lib/subcmd/Makefile
