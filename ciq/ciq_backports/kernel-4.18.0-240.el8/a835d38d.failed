tools/bpf/runqslower: Fix override option for VMLINUX_BTF

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Toke Høiland-Jørgensen <toke@redhat.com>
commit a835d38d41ca4f8eab5f97512446212f42f094a1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/a835d38d.failed

The runqslower tool refuses to build without a file to read vmlinux BTF
from. The build fails with an error message to override the location by
setting the VMLINUX_BTF variable if autodetection fails. However, the
Makefile doesn't actually work with that override - the error message is
still emitted.

Fix this by including the value of VMLINUX_BTF in the expansion, and only
emitting the error message if the *result* is empty. Also permit running
'make clean' even though no VMLINUX_BTF is set.

Fixes: 9c01546d26d2 ("tools/bpf: Add runqslower tool to tools/bpf")
	Signed-off-by: Toke Høiland-Jørgensen <toke@redhat.com>
	Signed-off-by: Alexei Starovoitov <ast@kernel.org>
	Acked-by: Andrii Nakryiko <andriin@fb.com>
Link: https://lore.kernel.org/bpf/157952560237.1683545.17771785178857224877.stgit@toke.dk
(cherry picked from commit a835d38d41ca4f8eab5f97512446212f42f094a1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/bpf/runqslower/Makefile
diff --cc tools/bpf/runqslower/Makefile
index f1363ae8e473,3242ab874ac0..000000000000
--- a/tools/bpf/runqslower/Makefile
+++ b/tools/bpf/runqslower/Makefile
@@@ -10,13 -10,9 +10,19 @@@ CFLAGS := -g -Wal
  
  # Try to detect best kernel BTF source
  KERNEL_REL := $(shell uname -r)
++<<<<<<< HEAD
 +ifneq ("$(wildcard /sys/kenerl/btf/vmlinux)","")
 +VMLINUX_BTF := /sys/kernel/btf/vmlinux
 +else ifneq ("$(wildcard /boot/vmlinux-$(KERNEL_REL))","")
 +VMLINUX_BTF := /boot/vmlinux-$(KERNEL_REL)
 +else
 +$(error "Can't detect kernel BTF, use VMLINUX_BTF to specify it explicitly")
 +endif
++=======
+ VMLINUX_BTF_PATHS := /sys/kernel/btf/vmlinux /boot/vmlinux-$(KERNEL_REL)
+ VMLINUX_BTF_PATH := $(or $(VMLINUX_BTF),$(firstword			       \
+ 					  $(wildcard $(VMLINUX_BTF_PATHS))))
++>>>>>>> a835d38d41ca (tools/bpf/runqslower: Fix override option for VMLINUX_BTF)
  
  abs_out := $(abspath $(OUTPUT))
  ifeq ($(V),1)
* Unmerged path tools/bpf/runqslower/Makefile
