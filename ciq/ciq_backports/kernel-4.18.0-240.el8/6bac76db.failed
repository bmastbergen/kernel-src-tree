netfilter: nat: fix udp checksum corruption

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Florian Westphal <fw@strlen.de>
commit 6bac76db1da3cb162c425d58ae421486f8e43955
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/6bac76db.failed

Due to copy&paste error nf_nat_mangle_udp_packet passes IPPROTO_TCP,
resulting in incorrect udp checksum when payload had to be mangled.

Fixes: dac3fe72596f9 ("netfilter: nat: remove csum_recalc hook")
	Reported-by: Marc Haber <mh+netdev@zugschlus.de>
	Tested-by: Marc Haber <mh+netdev@zugschlus.de>
	Signed-off-by: Florian Westphal <fw@strlen.de>
	Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
(cherry picked from commit 6bac76db1da3cb162c425d58ae421486f8e43955)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/netfilter/nf_nat_helper.c
diff --cc net/netfilter/nf_nat_helper.c
index 99606baedda4,53aeb12b70fb..000000000000
--- a/net/netfilter/nf_nat_helper.c
+++ b/net/netfilter/nf_nat_helper.c
@@@ -178,9 -170,8 +178,14 @@@ nf_nat_mangle_udp_packet(struct sk_buf
  	if (!udph->check && skb->ip_summed != CHECKSUM_PARTIAL)
  		return true;
  
++<<<<<<< HEAD
 +	l3proto = __nf_nat_l3proto_find(nf_ct_l3num(ct));
 +	l3proto->csum_recalc(skb, IPPROTO_UDP, udph, &udph->check,
 +			     datalen, oldlen);
++=======
+ 	nf_nat_csum_recalc(skb, nf_ct_l3num(ct), IPPROTO_UDP,
+ 			   udph, &udph->check, datalen, oldlen);
++>>>>>>> 6bac76db1da3 (netfilter: nat: fix udp checksum corruption)
  
  	return true;
  }
* Unmerged path net/netfilter/nf_nat_helper.c
