netfilter: flowtable: add nf_flowtable_hw_offload() helper function

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Pablo Neira Ayuso <pablo@netfilter.org>
commit a5449cdcaac5c78d62b8bea8f79158071f23da01
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/a5449cdc.failed

This function checks for the NF_FLOWTABLE_HW_OFFLOAD flag, meaning that
the flowtable hardware offload is enabled.

	Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
(cherry picked from commit a5449cdcaac5c78d62b8bea8f79158071f23da01)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/netfilter/nf_flow_table_core.c
#	net/netfilter/nf_flow_table_offload.c
diff --cc net/netfilter/nf_flow_table_core.c
index 4ccaaabe1a6c,e919bafd68d1..000000000000
--- a/net/netfilter/nf_flow_table_core.c
+++ b/net/netfilter/nf_flow_table_core.c
@@@ -248,6 -243,9 +248,12 @@@ int flow_offload_add(struct nf_flowtabl
  		return err;
  	}
  
++<<<<<<< HEAD
++=======
+ 	if (nf_flowtable_hw_offload(flow_table))
+ 		nf_flow_offload_add(flow_table, flow);
+ 
++>>>>>>> a5449cdcaac5 (netfilter: flowtable: add nf_flowtable_hw_offload() helper function)
  	return 0;
  }
  EXPORT_SYMBOL_GPL(flow_offload_add);
* Unmerged path net/netfilter/nf_flow_table_offload.c
diff --git a/include/net/netfilter/nf_flow_table.h b/include/net/netfilter/nf_flow_table.h
index ebceddb778ea..375fc79ed80e 100644
--- a/include/net/netfilter/nf_flow_table.h
+++ b/include/net/netfilter/nf_flow_table.h
@@ -28,6 +28,11 @@ struct nf_flowtable {
 	struct delayed_work		gc_work;
 };
 
+static inline bool nf_flowtable_hw_offload(struct nf_flowtable *flowtable)
+{
+	return flowtable->flags & NF_FLOWTABLE_HW_OFFLOAD;
+}
+
 enum flow_offload_tuple_dir {
 	FLOW_OFFLOAD_DIR_ORIGINAL = IP_CT_DIR_ORIGINAL,
 	FLOW_OFFLOAD_DIR_REPLY = IP_CT_DIR_REPLY,
* Unmerged path net/netfilter/nf_flow_table_core.c
* Unmerged path net/netfilter/nf_flow_table_offload.c
