drm/nouveau/kms/nv50-: Initialize core channel in nouveau_display_create()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Lyude Paul <lyude@redhat.com>
commit fa1232ea84515533a8c52f9b88151d2bef4c913d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/fa1232ea.failed

We'll need the core channel initialized and ready by the time that we
start creating modesetting objects, so that we can call the
NV507D_GET_CAPABILITIES method to make the hardware expose it's
modesetting capabilities for later probing.

So, when loading the driver prepare the core channel from within
nouveau_display_create(). Everywhere else, we initialize the core
channel during resume.

	Signed-off-by: Lyude Paul <lyude@redhat.com>
	Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
(cherry picked from commit fa1232ea84515533a8c52f9b88151d2bef4c913d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/nouveau/dispnv50/disp.c
diff --cc drivers/gpu/drm/nouveau/dispnv50/disp.c
index da6dd0902c41,d5488c85eb43..000000000000
--- a/drivers/gpu/drm/nouveau/dispnv50/disp.c
+++ b/drivers/gpu/drm/nouveau/dispnv50/disp.c
@@@ -2494,6 -2461,17 +2495,20 @@@ nv50_display_create(struct drm_device *
  	if (ret)
  		goto out;
  
++<<<<<<< HEAD
++=======
+ 	disp->core->func->init(disp->core);
+ 
+ 	/* Assign the correct format modifiers */
+ 	if (disp->disp->object.oclass >= TU102_DISP)
+ 		nouveau_display(dev)->format_modifiers = wndwc57e_modifiers;
+ 	else
+ 	if (disp->disp->object.oclass >= GF110_DISP)
+ 		nouveau_display(dev)->format_modifiers = disp90xx_modifiers;
+ 	else
+ 		nouveau_display(dev)->format_modifiers = disp50xx_modifiers;
+ 
++>>>>>>> fa1232ea8451 (drm/nouveau/kms/nv50-: Initialize core channel in nouveau_display_create())
  	/* create crtc objects to represent the hw heads */
  	if (disp->disp->object.oclass >= GV100_DISP)
  		crtcs = nvif_rd32(&device->object, 0x610060) & 0xff;
* Unmerged path drivers/gpu/drm/nouveau/dispnv50/disp.c
