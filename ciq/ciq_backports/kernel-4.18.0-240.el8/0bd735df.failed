scsi: sd: Signal drive managed SMR disks

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Damien Le Moal <damien.lemoal@wdc.com>
commit 0bd735df7681e41647a69b1fad0eb5594c60a727
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/0bd735df.failed

Print a message indicating that a disk is a drive-managed SMR model when
such drive is found using the ZONED field of the Block Device
Characteristics VPD page (IDENTIFY data on ATA side).

[mkp: typo]

Link: https://lore.kernel.org/r/20200514081953.1252087-1-damien.lemoal@wdc.com
	Reviewed-by: Johannes Thumshirn <johannes.thumshirn@wdc.com>
	Signed-off-by: Damien Le Moal <damien.lemoal@wdc.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit 0bd735df7681e41647a69b1fad0eb5594c60a727)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/sd.c
diff --cc drivers/scsi/sd.c
index f47667376a1a,8929e178c6f8..000000000000
--- a/drivers/scsi/sd.c
+++ b/drivers/scsi/sd.c
@@@ -2888,15 -2946,19 +2888,22 @@@ static void sd_read_block_characteristi
  		q->limits.zoned = BLK_ZONED_HM;
  	} else {
  		sdkp->zoned = (buffer[8] >> 4) & 3;
 -		if (sdkp->zoned == 1 && !disk_has_partitions(sdkp->disk)) {
 +		if (sdkp->zoned == 1)
  			/* Host-aware */
  			q->limits.zoned = BLK_ZONED_HA;
 -		} else {
 +		else
  			/*
 -			 * Treat drive-managed devices and host-aware devices
 -			 * with partitions as regular block devices.
 +			 * Treat drive-managed devices as
 +			 * regular block devices.
  			 */
  			q->limits.zoned = BLK_ZONED_NONE;
++<<<<<<< HEAD
++=======
+ 			if (sdkp->zoned == 2 && sdkp->first_scan)
+ 				sd_printk(KERN_NOTICE, sdkp,
+ 					  "Drive-managed SMR disk\n");
+ 		}
++>>>>>>> 0bd735df7681 (scsi: sd: Signal drive managed SMR disks)
  	}
  	if (blk_queue_is_zoned(q) && sdkp->first_scan)
  		sd_printk(KERN_NOTICE, sdkp, "Host-%s zoned block device\n",
* Unmerged path drivers/scsi/sd.c
