Drivers: hv: vmbus: Fix crash handler reset of Hyper-V synic

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
Rebuild_CHGLOG: - [hv] hv: vmbus: Fix crash handler reset of Hyper-V synic (Mohammed Gamal) [1828451 1815498]
Rebuild_FUZZ: 91.89%
commit-author Michael Kelley <mikelley@microsoft.com>
commit 7a1323b5dfe44a9013a2cc56ef2973034a00bf88
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/7a1323b5.failed

The crash handler calls hv_synic_cleanup() to shutdown the
Hyper-V synthetic interrupt controller.  But if the CPU
that calls hv_synic_cleanup() has a VMbus channel interrupt
assigned to it (which is likely the case in smaller VM sizes),
hv_synic_cleanup() returns an error and the synthetic
interrupt controller isn't shutdown.  While the lack of
being shutdown hasn't caused a known problem, it still
should be fixed for highest reliability.

So directly call hv_synic_disable_regs() instead of
hv_synic_cleanup(), which ensures that the synic is always
shutdown.

	Signed-off-by: Michael Kelley <mikelley@microsoft.com>
	Reviewed-by: Vitaly Kuznetsov <vkuznets@redhat.com>
	Reviewed-by: Dexuan Cui <decui@microsoft.com>
	Signed-off-by: Sasha Levin <sashal@kernel.org>
(cherry picked from commit 7a1323b5dfe44a9013a2cc56ef2973034a00bf88)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/hv/vmbus_drv.c
diff --cc drivers/hv/vmbus_drv.c
index 025478aac9f2,f3d0bddc80a7..000000000000
--- a/drivers/hv/vmbus_drv.c
+++ b/drivers/hv/vmbus_drv.c
@@@ -2093,7 -2308,9 +2093,13 @@@ static void hv_crash_handler(struct pt_
  	 * for kdump.
  	 */
  	vmbus_connection.conn_state = DISCONNECTED;
++<<<<<<< HEAD
 +	hv_synic_cleanup(smp_processor_id());
++=======
+ 	cpu = smp_processor_id();
+ 	hv_stimer_cleanup(cpu);
+ 	hv_synic_disable_regs(cpu);
++>>>>>>> 7a1323b5dfe4 (Drivers: hv: vmbus: Fix crash handler reset of Hyper-V synic)
  	hyperv_cleanup();
  };
  
* Unmerged path drivers/hv/vmbus_drv.c
