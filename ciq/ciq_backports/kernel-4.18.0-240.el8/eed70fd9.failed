net: phylink: fix failure to register on x86 systems

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Russell King <rmk+kernel@armlinux.org.uk>
commit eed70fd9452fe0fcd1a221731a4333b51a8081f2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/eed70fd9.failed

The kernel test robot reports a boot failure with qemu in 5.5-rc,
referencing commit 2203cbf2c8b5 ("net: sfp: move fwnode parsing into
sfp-bus layer"). This is caused by phylink_create() being passed a
NULL fwnode, causing fwnode_property_get_reference_args() to return
-EINVAL.

Don't attempt to attach to a SFP bus if we have no fwnode, which
avoids this issue.

	Reported-by: kernel test robot <rong.a.chen@intel.com>
Fixes: 2203cbf2c8b5 ("net: sfp: move fwnode parsing into sfp-bus layer")
	Signed-off-by: Russell King <rmk+kernel@armlinux.org.uk>
	Reviewed-by: Florian Fainelli <f.fainelli@gmail.com>
	Reviewed-by: Andrew Lunn <andrew@lunn.ch>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit eed70fd9452fe0fcd1a221731a4333b51a8081f2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/phy/phylink.c
diff --cc drivers/net/phy/phylink.c
index 4c9a364eb550,ee7a718662c6..000000000000
--- a/drivers/net/phy/phylink.c
+++ b/drivers/net/phy/phylink.c
@@@ -511,14 -569,10 +511,21 @@@ static int phylink_register_sfp(struct 
  	if (!fwnode)
  		return 0;
  
++<<<<<<< HEAD
 +	ret = fwnode_property_get_reference_args(fwnode, "sfp", NULL,
 +						 0, 0, &ref);
 +	if (ret < 0) {
 +		if (ret == -ENOENT)
 +			return 0;
 +
 +		netdev_err(pl->netdev, "unable to parse \"sfp\" node: %d\n",
 +			   ret);
++=======
+ 	bus = sfp_bus_find_fwnode(fwnode);
+ 	if (IS_ERR(bus)) {
+ 		ret = PTR_ERR(bus);
+ 		phylink_err(pl, "unable to attach SFP bus: %d\n", ret);
++>>>>>>> eed70fd9452f (net: phylink: fix failure to register on x86 systems)
  		return ret;
  	}
  
* Unmerged path drivers/net/phy/phylink.c
