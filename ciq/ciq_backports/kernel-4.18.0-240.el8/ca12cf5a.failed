mlx5: Reject requests to enable time stamping on both edges.

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
Rebuild_CHGLOG: - [netdrv] mlx5: Reject requests to enable time stamping on both edges (Petr Oros) [1795192]
Rebuild_FUZZ: 99.16%
commit-author Richard Cochran <richardcochran@gmail.com>
commit ca12cf5ac9c8fcbf64bc18e0dc2974dc3217f97d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/ca12cf5a.failed

This driver enables rising edge or falling edge, but not both, and so
this patch validates that the request contains only one of the two
edges.

	Signed-off-by: Richard Cochran <richardcochran@gmail.com>
	Reviewed-by: Saeed Mahameed <saeedm@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit ca12cf5ac9c8fcbf64bc18e0dc2974dc3217f97d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/lib/clock.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/lib/clock.c
index 0059b290e095,43f97601b500..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/lib/clock.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/lib/clock.c
@@@ -236,6 -236,19 +236,22 @@@ static int mlx5_extts_configure(struct 
  	if (!MLX5_PPS_CAP(mdev))
  		return -EOPNOTSUPP;
  
++<<<<<<< HEAD
++=======
+ 	/* Reject requests with unsupported flags */
+ 	if (rq->extts.flags & ~(PTP_ENABLE_FEATURE |
+ 				PTP_RISING_EDGE |
+ 				PTP_FALLING_EDGE |
+ 				PTP_STRICT_FLAGS))
+ 		return -EOPNOTSUPP;
+ 
+ 	/* Reject requests to enable time stamping on both edges. */
+ 	if ((rq->extts.flags & PTP_STRICT_FLAGS) &&
+ 	    (rq->extts.flags & PTP_ENABLE_FEATURE) &&
+ 	    (rq->extts.flags & PTP_EXTTS_EDGES) == PTP_EXTTS_EDGES)
+ 		return -EOPNOTSUPP;
+ 
++>>>>>>> ca12cf5ac9c8 (mlx5: Reject requests to enable time stamping on both edges.)
  	if (rq->extts.index >= clock->ptp_info.n_pins)
  		return -EINVAL;
  
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/lib/clock.c
