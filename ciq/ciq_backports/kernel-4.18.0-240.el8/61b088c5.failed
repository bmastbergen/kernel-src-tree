drm/i915/ehl: Restrict w/a 1607087056 for EHL/JSL

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Swathi Dhanavanthri <swathi.dhanavanthri@intel.com>
commit 61b088c5374a9f886efa1edbb49ce552bd1f9cba
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/61b088c5.failed

This w/a is fixed in B0 stepping and needs to be restricted for
A0 stepping only.
Bspec: 33451

	Signed-off-by: Swathi Dhanavanthri <swathi.dhanavanthri@intel.com>
	Reviewed-by: José Roberto de Souza <jose.souza@intel.com>
	Signed-off-by: José Roberto de Souza <jose.souza@intel.com>
Link: https://patchwork.freedesktop.org/patch/msgid/20200512180050.6785-1-swathi.dhanavanthri@intel.com
(cherry picked from commit 61b088c5374a9f886efa1edbb49ce552bd1f9cba)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/i915/gt/intel_workarounds.c
#	drivers/gpu/drm/i915/i915_drv.h
diff --cc drivers/gpu/drm/i915/gt/intel_workarounds.c
index f8ed29b62e58,90a2b9e399b0..000000000000
--- a/drivers/gpu/drm/i915/gt/intel_workarounds.c
+++ b/drivers/gpu/drm/i915/gt/intel_workarounds.c
@@@ -898,6 -916,32 +898,35 @@@ icl_gt_workarounds_init(struct drm_i915
  	wa_write_or(wal,
  		    GAMT_CHKN_BIT_REG,
  		    GAMT_CHKN_DISABLE_L3_COH_PIPE);
++<<<<<<< HEAD
++=======
+ 
+ 	/* Wa_1607087056:icl,ehl,jsl */
+ 	if (IS_ICELAKE(i915) ||
+ 	    IS_EHL_REVID(i915, EHL_REVID_A0, EHL_REVID_A0)) {
+ 		wa_write_or(wal,
+ 			    SLICE_UNIT_LEVEL_CLKGATE,
+ 			    L3_CLKGATE_DIS | L3_CR2X_CLKGATE_DIS);
+ 	}
+ }
+ 
+ static void
+ tgl_gt_workarounds_init(struct drm_i915_private *i915, struct i915_wa_list *wal)
+ {
+ 	wa_init_mcr(i915, wal);
+ 
+ 	/* Wa_1409420604:tgl */
+ 	if (IS_TGL_REVID(i915, TGL_REVID_A0, TGL_REVID_A0))
+ 		wa_write_or(wal,
+ 			    SUBSLICE_UNIT_LEVEL_CLKGATE2,
+ 			    CPSSUNIT_CLKGATE_DIS);
+ 
+ 	/* Wa_1607087056:tgl also know as BUG:1409180338 */
+ 	if (IS_TGL_REVID(i915, TGL_REVID_A0, TGL_REVID_A0))
+ 		wa_write_or(wal,
+ 			    SLICE_UNIT_LEVEL_CLKGATE,
+ 			    L3_CLKGATE_DIS | L3_CR2X_CLKGATE_DIS);
++>>>>>>> 61b088c5374a (drm/i915/ehl: Restrict w/a 1607087056 for EHL/JSL)
  }
  
  static void
diff --cc drivers/gpu/drm/i915/i915_drv.h
index 6f70e09e3726,5ca932c1fe37..000000000000
--- a/drivers/gpu/drm/i915/i915_drv.h
+++ b/drivers/gpu/drm/i915/i915_drv.h
@@@ -2231,6 -1514,18 +2231,21 @@@ IS_SUBPLATFORM(const struct drm_i915_pr
  #define IS_ICL_REVID(p, since, until) \
  	(IS_ICELAKE(p) && IS_REVID(p, since, until))
  
++<<<<<<< HEAD
++=======
+ #define EHL_REVID_A0            0x0
+ 
+ #define IS_EHL_REVID(p, since, until) \
+ 	(IS_ELKHARTLAKE(p) && IS_REVID(p, since, until))
+ 
+ #define TGL_REVID_A0		0x0
+ #define TGL_REVID_B0		0x1
+ #define TGL_REVID_C0		0x2
+ 
+ #define IS_TGL_REVID(p, since, until) \
+ 	(IS_TIGERLAKE(p) && IS_REVID(p, since, until))
+ 
++>>>>>>> 61b088c5374a (drm/i915/ehl: Restrict w/a 1607087056 for EHL/JSL)
  #define IS_LP(dev_priv)	(INTEL_INFO(dev_priv)->is_lp)
  #define IS_GEN9_LP(dev_priv)	(IS_GEN(dev_priv, 9) && IS_LP(dev_priv))
  #define IS_GEN9_BC(dev_priv)	(IS_GEN(dev_priv, 9) && !IS_LP(dev_priv))
* Unmerged path drivers/gpu/drm/i915/gt/intel_workarounds.c
* Unmerged path drivers/gpu/drm/i915/i915_drv.h
