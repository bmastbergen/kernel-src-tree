ASoC: amd: Adding TDM support in hw_params.

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
Rebuild_CHGLOG: - [sound] ALSA: ASoC: amd: Adding TDM support in hw_params (Jaroslav Kysela) [1797509]
Rebuild_FUZZ: 92.31%
commit-author Ravulapati Vishnu vardhan rao <Vishnuvardhanrao.Ravulapati@amd.com>
commit ab985be95da1d68a0cdba1ed702961aae047bf89
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/ab985be9.failed

TDM related settings for ACP registers in hw_params.
When TDM mode is enabled, Hw_params needs to read and write
from/to respective TX/RX (ACP_(I2S/BT)TDM_(TX/RX)FRMT) registers.

	Signed-off-by: Ravulapati Vishnu vardhan rao <Vishnuvardhanrao.Ravulapati@amd.com>
Link: https://lore.kernel.org/r/1583751029-2850-1-git-send-email-Vishnuvardhanrao.Ravulapati@amd.com
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit ab985be95da1d68a0cdba1ed702961aae047bf89)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/soc/amd/raven/acp3x-i2s.c
diff --cc sound/soc/amd/raven/acp3x-i2s.c
index b195d26fa983,3a3c47e820ab..000000000000
--- a/sound/soc/amd/raven/acp3x-i2s.c
+++ b/sound/soc/amd/raven/acp3x-i2s.c
@@@ -42,7 -42,7 +42,11 @@@ static int acp3x_i2s_set_tdm_slot(struc
  		u32 tx_mask, u32 rx_mask, int slots, int slot_width)
  {
  	struct i2s_dev_data *adata;
++<<<<<<< HEAD
 +	u32 val, reg_val, frmt_val, frm_len;
++=======
+ 	u32 frm_len;
++>>>>>>> ab985be95da1 (ASoC: amd: Adding TDM support in hw_params.)
  	u16 slot_len;
  
  	adata = snd_soc_dai_get_drvdata(cpu_dai);
@@@ -64,20 -64,7 +68,20 @@@
  	default:
  		return -EINVAL;
  	}
- 
- 	/* Enable I2S/BT channels TDM, respective TX/RX frame lengths.*/
- 
  	frm_len = FRM_LEN | (slots << 15) | (slot_len << 18);
++<<<<<<< HEAD
 +	if (adata->substream_type == SNDRV_PCM_STREAM_PLAYBACK) {
 +		reg_val = mmACP_BTTDM_ITER;
 +		frmt_val = mmACP_BTTDM_TXFRMT;
 +	} else {
 +		reg_val = mmACP_BTTDM_IRER;
 +		frmt_val = mmACP_BTTDM_RXFRMT;
 +	}
 +	val = rv_readl(adata->acp3x_base + reg_val);
 +	rv_writel(val | 0x2, adata->acp3x_base + reg_val);
 +	rv_writel(frm_len, adata->acp3x_base + frmt_val);
++=======
++>>>>>>> ab985be95da1 (ASoC: amd: Adding TDM support in hw_params.)
  	adata->tdm_fmt = frm_len;
  	return 0;
  }
* Unmerged path sound/soc/amd/raven/acp3x-i2s.c
