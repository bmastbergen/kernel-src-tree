Bluetooth: Fix Suspicious RCU usage warnings

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Madhuparna Bhowmik <madhuparnabhowmik10@gmail.com>
commit d7d41682efc25d58b5bd8b80e85e3c9ce586635c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/d7d41682.failed

The following functions in hci_core are always called with
hdev->lock held. No need to use list_for_each_entry_rcu(), therefore
change the usage of list_for_each_entry_rcu() in these functions
to list_for_each_entry().

hci_link_keys_clear()
hci_smp_ltks_clear()
hci_smp_irks_clear()
hci_blocked_keys_clear()

Warning encountered with CONFIG_PROVE_RCU_LIST:

[   72.213184] =============================
[   72.213188] WARNING: suspicious RCU usage
[   72.213192] 5.6.0-rc1+ #5 Not tainted
[   72.213195] -----------------------------
[   72.213198] net/bluetooth/hci_core.c:2288 RCU-list traversed in non-reader section!!

[   72.213676] =============================
[   72.213679] WARNING: suspicious RCU usage
[   72.213683] 5.6.0-rc1+ #5 Not tainted
[   72.213685] -----------------------------
[   72.213689] net/bluetooth/hci_core.c:2298 RCU-list traversed in non-reader section!!

[   72.214195] =============================
[   72.214198] WARNING: suspicious RCU usage
[   72.214201] 5.6.0-rc1+ #5 Not tainted
[   72.214204] -----------------------------
[   72.214208] net/bluetooth/hci_core.c:2308 RCU-list traversed in non-reader section!!

[  333.456972] =============================
[  333.456979] WARNING: suspicious RCU usage
[  333.457001] 5.6.0-rc1+ #5 Not tainted
[  333.457007] -----------------------------
[  333.457014] net/bluetooth/hci_core.c:2318 RCU-list traversed in non-reader section!!

	Signed-off-by: Madhuparna Bhowmik <madhuparnabhowmik10@gmail.com>
	Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
(cherry picked from commit d7d41682efc25d58b5bd8b80e85e3c9ce586635c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/bluetooth/hci_core.c
diff --cc net/bluetooth/hci_core.c
index 692fa43be8ec,8ddd1bea02be..000000000000
--- a/net/bluetooth/hci_core.c
+++ b/net/bluetooth/hci_core.c
@@@ -2189,6 -2311,33 +2189,36 @@@ void hci_smp_irks_clear(struct hci_dev 
  	}
  }
  
++<<<<<<< HEAD
++=======
+ void hci_blocked_keys_clear(struct hci_dev *hdev)
+ {
+ 	struct blocked_key *b;
+ 
+ 	list_for_each_entry(b, &hdev->blocked_keys, list) {
+ 		list_del_rcu(&b->list);
+ 		kfree_rcu(b, rcu);
+ 	}
+ }
+ 
+ bool hci_is_blocked_key(struct hci_dev *hdev, u8 type, u8 val[16])
+ {
+ 	bool blocked = false;
+ 	struct blocked_key *b;
+ 
+ 	rcu_read_lock();
+ 	list_for_each_entry(b, &hdev->blocked_keys, list) {
+ 		if (b->type == type && !memcmp(b->val, val, sizeof(b->val))) {
+ 			blocked = true;
+ 			break;
+ 		}
+ 	}
+ 
+ 	rcu_read_unlock();
+ 	return blocked;
+ }
+ 
++>>>>>>> d7d41682efc2 (Bluetooth: Fix Suspicious RCU usage warnings)
  struct link_key *hci_find_link_key(struct hci_dev *hdev, bdaddr_t *bdaddr)
  {
  	struct link_key *k;
* Unmerged path net/bluetooth/hci_core.c
