ASoC: cs4270: pull reset GPIO low then high

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
Rebuild_CHGLOG: - [sound] ALSA: ASoC: cs4270: pull reset GPIO low then high (Jaroslav Kysela) [1797509]
Rebuild_FUZZ: 93.48%
commit-author Mike Willard <mwillard@izotope.com>
commit ccfc531695f3a4aada042f6bdb33ac6be24e1aec
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/ccfc5316.failed

Pull the RST line low then high when initializing the driver,
in order to force a reset of the chip.
Previously, the line was not pulled low, which could result in
the chip registers not resetting to their default values on boot.

	Signed-off-by: Mike Willard <mwillard@izotope.com>
	Cc: stable@vger.kernel.org
Link: https://lore.kernel.org/r/20200401205454.79792-1-mwillard@izotope.com
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit ccfc531695f3a4aada042f6bdb33ac6be24e1aec)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/soc/codecs/cs4270.c
diff --cc sound/soc/codecs/cs4270.c
index 793a14d58667,8a02791e44ad..000000000000
--- a/sound/soc/codecs/cs4270.c
+++ b/sound/soc/codecs/cs4270.c
@@@ -679,11 -697,21 +697,29 @@@ static int cs4270_i2c_probe(struct i2c_
  	if (ret < 0)
  		return ret;
  
++<<<<<<< HEAD
 +	reset_gpiod = devm_gpiod_get_optional(&i2c_client->dev, "reset",
 +					      GPIOD_OUT_HIGH);
 +	if (IS_ERR(reset_gpiod) &&
 +	    PTR_ERR(reset_gpiod) == -EPROBE_DEFER)
 +		return -EPROBE_DEFER;
++=======
+ 	/* reset the device */
+ 	cs4270->reset_gpio = devm_gpiod_get_optional(&i2c_client->dev, "reset",
+ 						     GPIOD_OUT_LOW);
+ 	if (IS_ERR(cs4270->reset_gpio)) {
+ 		dev_dbg(&i2c_client->dev, "Error getting CS4270 reset GPIO\n");
+ 		return PTR_ERR(cs4270->reset_gpio);
+ 	}
+ 
+ 	if (cs4270->reset_gpio) {
+ 		dev_dbg(&i2c_client->dev, "Found reset GPIO\n");
+ 		gpiod_set_value_cansleep(cs4270->reset_gpio, 1);
+ 	}
+ 
+ 	/* Sleep 500ns before i2c communications */
+ 	ndelay(500);
++>>>>>>> ccfc531695f3 (ASoC: cs4270: pull reset GPIO low then high)
  
  	cs4270->regmap = devm_regmap_init_i2c(i2c_client, &cs4270_regmap);
  	if (IS_ERR(cs4270->regmap))
* Unmerged path sound/soc/codecs/cs4270.c
