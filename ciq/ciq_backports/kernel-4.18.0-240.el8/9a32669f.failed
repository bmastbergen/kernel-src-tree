netfilter: nf_tables_offload: support indr block call

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author wenxu <wenxu@ucloud.cn>
commit 9a32669fecfb484a1f78fe48d0e42a5efccb0675
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/9a32669f.failed

nftable support indr-block call. It makes nftable an offload vlan
and tunnel device.

nft add table netdev firewall
nft add chain netdev firewall aclout { type filter hook ingress offload device mlx_pf0vf0 priority - 300 \; }
nft add rule netdev firewall aclout ip daddr 10.0.0.1 fwd to vlan0
nft add chain netdev firewall aclin { type filter hook ingress device vlan0 priority - 300 \; }
nft add rule netdev firewall aclin ip daddr 10.0.0.7 fwd to mlx_pf0vf0

	Signed-off-by: wenxu <wenxu@ucloud.cn>
	Acked-by: Jakub Kicinski <jakub.kicinski@netronome.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 9a32669fecfb484a1f78fe48d0e42a5efccb0675)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/net/netfilter/nf_tables_offload.h
#	net/netfilter/nf_tables_api.c
#	net/netfilter/nf_tables_offload.c
diff --cc net/netfilter/nf_tables_api.c
index b6b54e6a024b,fe3b7b0c6c66..000000000000
--- a/net/netfilter/nf_tables_api.c
+++ b/net/netfilter/nf_tables_api.c
@@@ -7615,17 -7626,17 +7620,22 @@@ static int __init nf_tables_module_init
  	/* must be last */
  	err = nfnetlink_subsys_register(&nf_tables_subsys);
  	if (err < 0)
 -		goto err5;
 +		goto err6;
  
++<<<<<<< HEAD
++=======
+ 	nft_chain_route_init();
+ 	flow_indr_add_block_ing_cb(&block_ing_entry);
++>>>>>>> 9a32669fecfb (netfilter: nf_tables_offload: support indr block call)
  	return err;
 -err5:
 +err6:
  	rhltable_destroy(&nft_objname_ht);
 -err4:
 +err5:
  	unregister_netdevice_notifier(&nf_tables_flowtable_notifier);
 -err3:
 +err4:
  	nf_tables_core_module_exit();
 +err3:
 +	kfree(info);
  err2:
  	nft_chain_filter_fini();
  err1:
* Unmerged path include/net/netfilter/nf_tables_offload.h
* Unmerged path net/netfilter/nf_tables_offload.c
* Unmerged path include/net/netfilter/nf_tables_offload.h
* Unmerged path net/netfilter/nf_tables_api.c
* Unmerged path net/netfilter/nf_tables_offload.c
