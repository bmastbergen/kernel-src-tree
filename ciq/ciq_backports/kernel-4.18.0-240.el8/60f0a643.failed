KVM: PPC: Book3S HV: Shared pages support for secure guests

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Bharata B Rao <bharata@linux.ibm.com>
commit 60f0a643aa44e4bed3a74ea671110707dd64d892
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/60f0a643.failed

A secure guest will share some of its pages with hypervisor (Eg. virtio
bounce buffers etc). Support sharing of pages between hypervisor and
ultravisor.

Shared page is reachable via both HV and UV side page tables. Once a
secure page is converted to shared page, the device page that represents
the secure page is unmapped from the HV side page tables.

	Signed-off-by: Bharata B Rao <bharata@linux.ibm.com>
	Signed-off-by: Paul Mackerras <paulus@ozlabs.org>
(cherry picked from commit 60f0a643aa44e4bed3a74ea671110707dd64d892)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/powerpc/include/asm/hvcall.h
#	arch/powerpc/kvm/book3s_hv_uvmem.c
diff --cc arch/powerpc/include/asm/hvcall.h
index 11112023e327,13bd870609c3..000000000000
--- a/arch/powerpc/include/asm/hvcall.h
+++ b/arch/powerpc/include/asm/hvcall.h
@@@ -342,6 -342,15 +342,18 @@@
  #define H_TLB_INVALIDATE	0xF808
  #define H_COPY_TOFROM_GUEST	0xF80C
  
++<<<<<<< HEAD
++=======
+ /* Flags for H_SVM_PAGE_IN */
+ #define H_PAGE_IN_SHARED        0x1
+ 
+ /* Platform-specific hcalls used by the Ultravisor */
+ #define H_SVM_PAGE_IN		0xEF00
+ #define H_SVM_PAGE_OUT		0xEF04
+ #define H_SVM_INIT_START	0xEF08
+ #define H_SVM_INIT_DONE		0xEF0C
+ 
++>>>>>>> 60f0a643aa44 (KVM: PPC: Book3S HV: Shared pages support for secure guests)
  /* Values for 2nd argument to H_SET_MODE */
  #define H_SET_MODE_RESOURCE_SET_CIABR		1
  #define H_SET_MODE_RESOURCE_SET_DAWR		2
* Unmerged path arch/powerpc/kvm/book3s_hv_uvmem.c
* Unmerged path arch/powerpc/include/asm/hvcall.h
* Unmerged path arch/powerpc/kvm/book3s_hv_uvmem.c
