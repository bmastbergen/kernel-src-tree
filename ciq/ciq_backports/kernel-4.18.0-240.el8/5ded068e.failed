libperf: Add PERF_RECORD_EVENT_UPDATE 'struct event_update_event' to perf/event.h

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Jiri Olsa <jolsa@kernel.org>
commit 5ded068e923837068e39c0fd4ab40c0dacaa08e8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/5ded068e.failed

Move the PERF_RECORD_EVENT_UPDATE event definition to libperf's event.h.

In order to keep libperf simple, we switch 'u64/u32/u16/u8'
types used events to their generic '__u*' versions.

	Signed-off-by: Jiri Olsa <jolsa@kernel.org>
	Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
	Cc: Michael Petlan <mpetlan@redhat.com>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
Link: http://lkml.kernel.org/r/20190828135717.7245-4-jolsa@kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 5ded068e923837068e39c0fd4ab40c0dacaa08e8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/lib/include/perf/event.h
#	tools/perf/util/event.h
diff --cc tools/perf/lib/include/perf/event.h
index 585c9d82dba3,3d99818077d8..000000000000
--- a/tools/perf/lib/include/perf/event.h
+++ b/tools/perf/lib/include/perf/event.h
@@@ -104,4 -104,63 +104,66 @@@ struct bpf_event 
  	__u8			 tag[BPF_TAG_SIZE];  // prog tag
  };
  
++<<<<<<< HEAD
++=======
+ struct perf_record_sample {
+ 	struct perf_event_header header;
+ 	__u64			 array[];
+ };
+ 
+ struct attr_event {
+ 	struct perf_event_header header;
+ 	struct perf_event_attr	 attr;
+ 	__u64			 id[];
+ };
+ 
+ enum {
+ 	PERF_CPU_MAP__CPUS = 0,
+ 	PERF_CPU_MAP__MASK = 1,
+ };
+ 
+ struct cpu_map_entries {
+ 	__u16			 nr;
+ 	__u16			 cpu[];
+ };
+ 
+ struct cpu_map_mask {
+ 	__u16			 nr;
+ 	__u16			 long_size;
+ 	unsigned long		 mask[];
+ };
+ 
+ struct cpu_map_data {
+ 	__u16			 type;
+ 	char			 data[];
+ };
+ 
+ struct cpu_map_event {
+ 	struct perf_event_header header;
+ 	struct cpu_map_data	 data;
+ };
+ 
+ enum {
+ 	PERF_EVENT_UPDATE__UNIT  = 0,
+ 	PERF_EVENT_UPDATE__SCALE = 1,
+ 	PERF_EVENT_UPDATE__NAME  = 2,
+ 	PERF_EVENT_UPDATE__CPUS  = 3,
+ };
+ 
+ struct event_update_event_cpus {
+ 	struct cpu_map_data	 cpus;
+ };
+ 
+ struct event_update_event_scale {
+ 	double			 scale;
+ };
+ 
+ struct event_update_event {
+ 	struct perf_event_header header;
+ 	__u64			 type;
+ 	__u64			 id;
+ 	char			 data[];
+ };
+ 
++>>>>>>> 5ded068e9238 (libperf: Add PERF_RECORD_EVENT_UPDATE 'struct event_update_event' to perf/event.h)
  #endif /* __LIBPERF_EVENT_H */
diff --cc tools/perf/util/event.h
index ba0ec1b6aad3,a579e6b439d6..000000000000
--- a/tools/perf/util/event.h
+++ b/tools/perf/util/event.h
@@@ -342,61 -337,6 +342,64 @@@ struct events_stats 
  	u32 nr_proc_map_timeout;
  };
  
++<<<<<<< HEAD
 +enum {
 +	PERF_CPU_MAP__CPUS = 0,
 +	PERF_CPU_MAP__MASK = 1,
 +};
 +
 +struct cpu_map_entries {
 +	u16	nr;
 +	u16	cpu[];
 +};
 +
 +struct cpu_map_mask {
 +	u16	nr;
 +	u16	long_size;
 +	unsigned long mask[];
 +};
 +
 +struct cpu_map_data {
 +	u16	type;
 +	char	data[];
 +};
 +
 +struct cpu_map_event {
 +	struct perf_event_header	header;
 +	struct cpu_map_data		data;
 +};
 +
 +struct attr_event {
 +	struct perf_event_header header;
 +	struct perf_event_attr attr;
 +	u64 id[];
 +};
 +
 +enum {
 +	PERF_EVENT_UPDATE__UNIT  = 0,
 +	PERF_EVENT_UPDATE__SCALE = 1,
 +	PERF_EVENT_UPDATE__NAME  = 2,
 +	PERF_EVENT_UPDATE__CPUS  = 3,
 +};
 +
 +struct event_update_event_cpus {
 +	struct cpu_map_data cpus;
 +};
 +
 +struct event_update_event_scale {
 +	double scale;
 +};
 +
 +struct event_update_event {
 +	struct perf_event_header header;
 +	u64 type;
 +	u64 id;
 +
 +	char data[];
 +};
 +
++=======
++>>>>>>> 5ded068e9238 (libperf: Add PERF_RECORD_EVENT_UPDATE 'struct event_update_event' to perf/event.h)
  #define MAX_EVENT_NAME 64
  
  struct perf_trace_event_type {
* Unmerged path tools/perf/lib/include/perf/event.h
* Unmerged path tools/perf/util/event.h
diff --git a/tools/perf/util/header.c b/tools/perf/util/header.c
index f9721694453e..ae8979caa47d 100644
--- a/tools/perf/util/header.c
+++ b/tools/perf/util/header.c
@@ -3883,7 +3883,7 @@ size_t perf_event__fprintf_event_update(union perf_event *event, FILE *fp)
 	struct cpu_map *map;
 	size_t ret;
 
-	ret = fprintf(fp, "\n... id:    %" PRIu64 "\n", ev->id);
+	ret = fprintf(fp, "\n... id:    %" PRI_lu64 "\n", ev->id);
 
 	switch (ev->type) {
 	case PERF_EVENT_UPDATE__SCALE:
