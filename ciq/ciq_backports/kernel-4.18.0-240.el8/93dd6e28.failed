libperf: Introduce perf_evlist__exit()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Jiri Olsa <jolsa@kernel.org>
commit 93dd6e2831ff399f7685aa2157b997b6392efac8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/93dd6e28.failed

Add the perf_evlist__exit() function, so far it's not exported and added
only for internal use for perf and libperf.

USe it to release cpus/threads and pollfd array.

	Signed-off-by: Jiri Olsa <jolsa@kernel.org>
	Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
	Cc: Michael Petlan <mpetlan@redhat.com>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
Link: http://lore.kernel.org/lkml/20191007125344.14268-25-jolsa@kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 93dd6e2831ff399f7685aa2157b997b6392efac8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/lib/evlist.c
#	tools/perf/lib/include/internal/evlist.h
#	tools/perf/util/evlist.c
diff --cc tools/perf/util/evlist.c
index 29a998d183ce,031ace3696a2..000000000000
--- a/tools/perf/util/evlist.c
+++ b/tools/perf/util/evlist.c
@@@ -135,22 -138,18 +135,33 @@@ void perf_evlist__exit(struct perf_evli
  {
  	zfree(&evlist->mmap);
  	zfree(&evlist->overwrite_mmap);
++<<<<<<< HEAD
 +	fdarray__exit(&evlist->pollfd);
++=======
+ 	perf_evlist__exit(&evlist->core);
++>>>>>>> 93dd6e2831ff (libperf: Introduce perf_evlist__exit())
  }
  
 -void evlist__delete(struct evlist *evlist)
 +void perf_evlist__delete(struct perf_evlist *evlist)
  {
  	if (evlist == NULL)
  		return;
  
++<<<<<<< HEAD
 +	perf_evlist__munmap(evlist);
 +	perf_evlist__close(evlist);
 +	cpu_map__put(evlist->cpus);
 +	thread_map__put(evlist->threads);
 +	evlist->cpus = NULL;
 +	evlist->threads = NULL;
 +	perf_evlist__purge(evlist);
 +	perf_evlist__exit(evlist);
++=======
+ 	evlist__munmap(evlist);
+ 	evlist__close(evlist);
+ 	evlist__purge(evlist);
+ 	evlist__exit(evlist);
++>>>>>>> 93dd6e2831ff (libperf: Introduce perf_evlist__exit())
  	free(evlist);
  }
  
* Unmerged path tools/perf/lib/evlist.c
* Unmerged path tools/perf/lib/include/internal/evlist.h
* Unmerged path tools/perf/lib/evlist.c
* Unmerged path tools/perf/lib/include/internal/evlist.h
* Unmerged path tools/perf/util/evlist.c
