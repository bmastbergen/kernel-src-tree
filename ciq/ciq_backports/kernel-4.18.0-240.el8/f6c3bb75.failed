mlxsw: spectrum_router: Ignore IPv6 multipath notifications

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Ido Schimmel <idosch@mellanox.com>
commit f6c3bb75165cb4d0a0beb2ea6df5b392b7131645
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/f6c3bb75.failed

IPv6 multipath notifications are about to be sent, but mlxsw is not
ready to process them, so ignore them.

The limitation will be lifted by a subsequent patch which will also stop
the kernel from sending a notification for each nexthop.

	Signed-off-by: Ido Schimmel <idosch@mellanox.com>
	Acked-by: Jiri Pirko <jiri@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit f6c3bb75165cb4d0a0beb2ea6df5b392b7131645)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
diff --cc drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
index 97a0410caf5d,ca47aa74e5d5..000000000000
--- a/drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
+++ b/drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
@@@ -6176,6 -6182,30 +6176,33 @@@ static int mlxsw_sp_router_fib_event(st
  			NL_SET_ERR_MSG_MOD(info->extack, "FIB offload was aborted. Not configuring route");
  			return notifier_from_errno(-EINVAL);
  		}
++<<<<<<< HEAD
++=======
+ 		if (info->family == AF_INET) {
+ 			struct fib_entry_notifier_info *fen_info = ptr;
+ 
+ 			if (fen_info->fi->fib_nh_is_v6) {
+ 				NL_SET_ERR_MSG_MOD(info->extack, "IPv6 gateway with IPv4 route is not supported");
+ 				return notifier_from_errno(-EINVAL);
+ 			}
+ 			if (fen_info->fi->nh) {
+ 				NL_SET_ERR_MSG_MOD(info->extack, "IPv4 route with nexthop objects is not supported");
+ 				return notifier_from_errno(-EINVAL);
+ 			}
+ 		} else if (info->family == AF_INET6) {
+ 			struct fib6_entry_notifier_info *fen6_info;
+ 
+ 			fen6_info = container_of(info,
+ 						 struct fib6_entry_notifier_info,
+ 						 info);
+ 			if (fen6_info->rt->nh) {
+ 				NL_SET_ERR_MSG_MOD(info->extack, "IPv6 route with nexthop objects is not supported");
+ 				return notifier_from_errno(-EINVAL);
+ 			}
+ 			if (fen6_info->multipath_rt)
+ 				return NOTIFY_DONE;
+ 		}
++>>>>>>> f6c3bb75165c (mlxsw: spectrum_router: Ignore IPv6 multipath notifications)
  		break;
  	}
  
* Unmerged path drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
