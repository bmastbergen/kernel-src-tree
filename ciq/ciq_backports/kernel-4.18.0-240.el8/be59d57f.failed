efi/tpm: Fix sanity check of unsigned tbl_size being less than zero

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Colin Ian King <colin.king@canonical.com>
commit be59d57f98065af0b8472f66a0a969207b168680
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/be59d57f.failed

Currently the check for tbl_size being less than zero is always false
because tbl_size is unsigned. Fix this by making it a signed int.

Addresses-Coverity: ("Unsigned compared against 0")
	Signed-off-by: Colin Ian King <colin.king@canonical.com>
	Cc: Ard Biesheuvel <ard.biesheuvel@linaro.org>
	Cc: Jerry Snitselaar <jsnitsel@redhat.com>
	Cc: Linus Torvalds <torvalds@linux-foundation.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Thomas Gleixner <tglx@linutronix.de>
	Cc: kernel-janitors@vger.kernel.org
	Cc: linux-efi@vger.kernel.org
Fixes: e658c82be556 ("efi/tpm: Only set 'efi_tpm_final_log_size' after successful event log parsing")
Link: https://lkml.kernel.org/r/20191008100153.8499-1-colin.king@canonical.com
	Signed-off-by: Ingo Molnar <mingo@kernel.org>
(cherry picked from commit be59d57f98065af0b8472f66a0a969207b168680)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/firmware/efi/tpm.c
diff --cc drivers/firmware/efi/tpm.c
index 0cbeb3d46b18,ebd7977653a8..000000000000
--- a/drivers/firmware/efi/tpm.c
+++ b/drivers/firmware/efi/tpm.c
@@@ -19,10 -39,17 +19,16 @@@
  int __init efi_tpm_eventlog_init(void)
  {
  	struct linux_efi_tpm_eventlog *log_tbl;
++<<<<<<< HEAD
 +	unsigned int tbl_size;
++=======
+ 	struct efi_tcg2_final_events_table *final_tbl;
+ 	int tbl_size;
+ 	int ret = 0;
++>>>>>>> be59d57f9806 (efi/tpm: Fix sanity check of unsigned tbl_size being less than zero)
  
 -	if (efi.tpm_log == EFI_INVALID_TABLE_ADDR) {
 -		/*
 -		 * We can't calculate the size of the final events without the
 -		 * first entry in the TPM log, so bail here.
 -		 */
 +	if (efi.tpm_log == EFI_INVALID_TABLE_ADDR)
  		return 0;
 -	}
  
  	log_tbl = early_memremap(efi.tpm_log, sizeof(*log_tbl));
  	if (!log_tbl) {
* Unmerged path drivers/firmware/efi/tpm.c
