perf event: Remove needless include directives from event.h

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Arnaldo Carvalho de Melo <acme@redhat.com>
commit 4cb3c6d546aa5493a960d05eb73bad8e69a58574
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/4cb3c6d5.failed

bpf.h and build-id.h are not needed at all in event.h, remove them.

And fixup the fallout of files that were getting needed stuff from this
now pruned include.

	Cc: Adrian Hunter <adrian.hunter@intel.com>
	Cc: Jiri Olsa <jolsa@kernel.org>
	Cc: Namhyung Kim <namhyung@kernel.org>
Link: https://lkml.kernel.org/n/tip-rdm3dgtlrndmmnlc4bafsg3b@git.kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 4cb3c6d546aa5493a960d05eb73bad8e69a58574)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/perf.c
#	tools/perf/util/event.h
diff --cc tools/perf/perf.c
index 34763a9b873d,8763b2c0fbfd..000000000000
--- a/tools/perf/perf.c
+++ b/tools/perf/perf.c
@@@ -8,7 -8,10 +8,12 @@@
   * perf top, perf record, perf report, etc.) are started.
   */
  #include "builtin.h"
 -#include "perf.h"
  
++<<<<<<< HEAD
++=======
+ #include "util/build-id.h"
+ #include "util/cache.h"
++>>>>>>> 4cb3c6d546aa (perf event: Remove needless include directives from event.h)
  #include "util/env.h"
  #include <subcmd/exec-cmd.h>
  #include "util/config.h"
diff --cc tools/perf/util/event.h
index ba0ec1b6aad3,006aa432be19..000000000000
--- a/tools/perf/util/event.h
+++ b/tools/perf/util/event.h
@@@ -1,18 -1,23 +1,28 @@@
  /* SPDX-License-Identifier: GPL-2.0 */
  #ifndef __PERF_RECORD_H
  #define __PERF_RECORD_H
- 
- #include <limits.h>
+ /*
+  * The linux/stddef.h isn't need here, but is needed for __always_inline used
+  * in files included from uapi/linux/perf_event.h such as
+  * /usr/include/linux/swab.h and /usr/include/linux/byteorder/little_endian.h,
+  * detected in at least musl libc, used in Alpine Linux. -acme
+  */
  #include <stdio.h>
- #include <linux/kernel.h>
- #include <linux/bpf.h>
- #include <linux/perf_event.h>
+ #include <linux/stddef.h>
  #include <perf/event.h>
+ #include <linux/types.h>
  
++<<<<<<< HEAD
 +#include "../perf.h"
 +#include "build-id.h"
++=======
++>>>>>>> 4cb3c6d546aa (perf event: Remove needless include directives from event.h)
  #include "perf_regs.h"
  
+ struct dso;
+ struct machine;
+ struct perf_event_attr;
+ 
  #ifdef __LP64__
  /*
   * /usr/include/inttypes.h uses just 'lu' for PRIu64, but we end up defining
diff --git a/tools/perf/arch/powerpc/util/unwind-libdw.c b/tools/perf/arch/powerpc/util/unwind-libdw.c
index 7a1f05ef2fc0..abf2dbc7f829 100644
--- a/tools/perf/arch/powerpc/util/unwind-libdw.c
+++ b/tools/perf/arch/powerpc/util/unwind-libdw.c
@@ -1,5 +1,6 @@
 // SPDX-License-Identifier: GPL-2.0
 #include <elfutils/libdwfl.h>
+#include <linux/kernel.h>
 #include "../../util/unwind-libdw.h"
 #include "../../util/perf_regs.h"
 #include "../../util/event.h"
diff --git a/tools/perf/arch/x86/util/perf_regs.c b/tools/perf/arch/x86/util/perf_regs.c
index 0d7b77ff0ae6..b3fd3f2b4b28 100644
--- a/tools/perf/arch/x86/util/perf_regs.c
+++ b/tools/perf/arch/x86/util/perf_regs.c
@@ -2,6 +2,7 @@
 #include <errno.h>
 #include <string.h>
 #include <regex.h>
+#include <linux/kernel.h>
 #include <linux/zalloc.h>
 
 #include "../../perf.h"
* Unmerged path tools/perf/perf.c
diff --git a/tools/perf/util/bpf-event.h b/tools/perf/util/bpf-event.h
index 04c33b3bfe28..91d7499665ed 100644
--- a/tools/perf/util/bpf-event.h
+++ b/tools/perf/util/bpf-event.h
@@ -13,6 +13,7 @@ struct machine;
 union perf_event;
 struct perf_env;
 struct perf_sample;
+struct perf_session;
 struct record_opts;
 struct evlist;
 struct target;
diff --git a/tools/perf/util/callchain.h b/tools/perf/util/callchain.h
index 80e056a3d882..3dc751a8abf8 100644
--- a/tools/perf/util/callchain.h
+++ b/tools/perf/util/callchain.h
@@ -8,6 +8,7 @@
 #include "map_symbol.h"
 #include "branch.h"
 
+struct evsel;
 struct map;
 
 #define HELP_PAD "\t\t\t\t"
diff --git a/tools/perf/util/config.c b/tools/perf/util/config.c
index 042ffbc8c53f..1e6a77905366 100644
--- a/tools/perf/util/config.c
+++ b/tools/perf/util/config.c
@@ -17,6 +17,8 @@
 #include "util/event.h"  /* proc_map_timeout */
 #include "util/hist.h"  /* perf_hist_config */
 #include "util/llvm-utils.h"   /* perf_llvm_config */
+#include "build-id.h"
+#include "debug.h"
 #include "config.h"
 #include <sys/types.h>
 #include <sys/stat.h>
diff --git a/tools/perf/util/debug.c b/tools/perf/util/debug.c
index c822c5943340..c5d717c264b0 100644
--- a/tools/perf/util/debug.c
+++ b/tools/perf/util/debug.c
@@ -8,6 +8,7 @@
 #include <stdlib.h>
 #include <sys/wait.h>
 #include <api/debug.h>
+#include <linux/kernel.h>
 #include <linux/time64.h>
 #ifdef HAVE_BACKTRACE_SUPPORT
 #include <execinfo.h>
* Unmerged path tools/perf/util/event.h
