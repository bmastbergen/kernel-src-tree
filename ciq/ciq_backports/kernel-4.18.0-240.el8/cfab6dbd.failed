netfilter: flowtable: add tunnel match offload support

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author wenxu <wenxu@ucloud.cn>
commit cfab6dbd0ecf342fc904952d8565c8d80c741a63
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/cfab6dbd.failed

This patch support both ipv4 and ipv6 tunnel_id, tunnel_src and
tunnel_dst match for flowtable offload

	Signed-off-by: wenxu <wenxu@ucloud.cn>
	Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
(cherry picked from commit cfab6dbd0ecf342fc904952d8565c8d80c741a63)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/net/netfilter/nf_flow_table.h
#	net/netfilter/nf_flow_table_offload.c
diff --cc include/net/netfilter/nf_flow_table.h
index ebceddb778ea,f523ea87b6ae..000000000000
--- a/include/net/netfilter/nf_flow_table.h
+++ b/include/net/netfilter/nf_flow_table.h
@@@ -10,6 -11,39 +10,41 @@@
  #include <net/dst.h>
  
  struct nf_flowtable;
++<<<<<<< HEAD
++=======
+ struct nf_flow_rule;
+ struct flow_offload;
+ enum flow_offload_tuple_dir;
+ 
+ struct nf_flow_key {
+ 	struct flow_dissector_key_meta			meta;
+ 	struct flow_dissector_key_control		control;
+ 	struct flow_dissector_key_control		enc_control;
+ 	struct flow_dissector_key_basic			basic;
+ 	union {
+ 		struct flow_dissector_key_ipv4_addrs	ipv4;
+ 		struct flow_dissector_key_ipv6_addrs	ipv6;
+ 	};
+ 	struct flow_dissector_key_keyid			enc_key_id;
+ 	union {
+ 		struct flow_dissector_key_ipv4_addrs	enc_ipv4;
+ 		struct flow_dissector_key_ipv6_addrs	enc_ipv6;
+ 	};
+ 	struct flow_dissector_key_tcp			tcp;
+ 	struct flow_dissector_key_ports			tp;
+ } __aligned(BITS_PER_LONG / 8); /* Ensure that we can do comparisons as longs. */
+ 
+ struct nf_flow_match {
+ 	struct flow_dissector	dissector;
+ 	struct nf_flow_key	key;
+ 	struct nf_flow_key	mask;
+ };
+ 
+ struct nf_flow_rule {
+ 	struct nf_flow_match	match;
+ 	struct flow_rule	*rule;
+ };
++>>>>>>> cfab6dbd0ecf (netfilter: flowtable: add tunnel match offload support)
  
  struct nf_flowtable_type {
  	struct list_head		list;
* Unmerged path net/netfilter/nf_flow_table_offload.c
* Unmerged path include/net/netfilter/nf_flow_table.h
* Unmerged path net/netfilter/nf_flow_table_offload.c
