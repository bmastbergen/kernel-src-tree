rcu/sync: Remove custom check for RCU readers

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Joel Fernandes (Google) <joel@joelfernandes.org>
commit fbab8d6735e2643365040bd9e1057addc0d9b4cf
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/fbab8d67.failed

The rcu/sync code currently does a special check for being in an RCU
read-side critical section.  With RCU consolidating flavors and the
generic helper added earlier in this series, this check is no longer need.
This commit switches to the generic helper, saving a couple of lines
of code.

	Cc: Oleg Nesterov <oleg@redhat.com>
	Acked-by: Oleg Nesterov <oleg@redhat.com>
	Signed-off-by: Joel Fernandes (Google) <joel@joelfernandes.org>
	Signed-off-by: Paul E. McKenney <paulmck@linux.ibm.com>
(cherry picked from commit fbab8d6735e2643365040bd9e1057addc0d9b4cf)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/linux/rcu_sync.h
diff --cc include/linux/rcu_sync.h
index ece7ed9a4a70,0027d4c8087c..000000000000
--- a/include/linux/rcu_sync.h
+++ b/include/linux/rcu_sync.h
@@@ -52,13 -31,12 +52,19 @@@ extern void rcu_sync_lockdep_assert(str
   */
  static inline bool rcu_sync_is_idle(struct rcu_sync *rsp)
  {
++<<<<<<< HEAD
 +#ifdef CONFIG_PROVE_RCU
 +	rcu_sync_lockdep_assert(rsp);
 +#endif
 +	return !rsp->gp_state; /* GP_IDLE */
++=======
+ 	RCU_LOCKDEP_WARN(!rcu_read_lock_any_held(),
+ 			 "suspicious rcu_sync_is_idle() usage");
+ 	return !READ_ONCE(rsp->gp_state); /* GP_IDLE */
++>>>>>>> fbab8d6735e2 (rcu/sync: Remove custom check for RCU readers)
  }
  
 -extern void rcu_sync_init(struct rcu_sync *);
 +extern void rcu_sync_init(struct rcu_sync *, enum rcu_sync_type);
  extern void rcu_sync_enter_start(struct rcu_sync *);
  extern void rcu_sync_enter(struct rcu_sync *);
  extern void rcu_sync_exit(struct rcu_sync *);
* Unmerged path include/linux/rcu_sync.h
