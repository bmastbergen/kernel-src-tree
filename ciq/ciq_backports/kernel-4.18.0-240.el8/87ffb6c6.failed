perf env: Remove needless cpumap.h header

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Arnaldo Carvalho de Melo <acme@redhat.com>
commit 87ffb6c6407023419ae6b2770142b0754d9cbaa1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/87ffb6c6.failed

Only a 'struct perf_cmp_map' forward allocation is necessary, fix the
places that need the header but were getting it indirectly, by luck,
from env.h.

	Cc: Adrian Hunter <adrian.hunter@intel.com>
	Cc: Jiri Olsa <jolsa@kernel.org>
	Cc: Namhyung Kim <namhyung@kernel.org>
Link: https://lkml.kernel.org/n/tip-3sj3n534zghxhk7ygzeaqlx9@git.kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 87ffb6c6407023419ae6b2770142b0754d9cbaa1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/arch/arm64/util/header.c
#	tools/perf/arch/x86/tests/perf-time-to-tsc.c
#	tools/perf/bench/epoll-ctl.c
#	tools/perf/bench/epoll-wait.c
#	tools/perf/bench/futex-hash.c
#	tools/perf/bench/futex-lock-pi.c
#	tools/perf/bench/futex-requeue.c
#	tools/perf/bench/futex-wake.c
#	tools/perf/builtin-c2c.c
#	tools/perf/tests/bitmap.c
#	tools/perf/tests/event_update.c
#	tools/perf/tests/mem2node.c
#	tools/perf/tests/switch-tracking.c
#	tools/perf/tests/task-exit.c
#	tools/perf/tests/topology.c
#	tools/perf/util/event.c
#	tools/perf/util/session.c
#	tools/perf/util/stat.c
#	tools/perf/util/svghelper.c
diff --cc tools/perf/arch/arm64/util/header.c
index dbbcdab2e988,a32e4b72a98f..000000000000
--- a/tools/perf/arch/arm64/util/header.c
+++ b/tools/perf/arch/arm64/util/header.c
@@@ -28,8 -30,8 +30,13 @@@ char *get_cpuid_str(struct perf_pmu *pm
  		return NULL;
  
  	/* read midr from list of cpus mapped to this pmu */
++<<<<<<< HEAD
 +	cpus = cpu_map__get(pmu->cpus);
 +	for (cpu = 0; cpu < cpus->nr; cpu++) {
++=======
+ 	cpus = perf_cpu_map__get(pmu->cpus);
+ 	for (cpu = 0; cpu < perf_cpu_map__nr(cpus); cpu++) {
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  		scnprintf(path, PATH_MAX, "%s/devices/system/cpu/cpu%d"MIDR,
  				sysfs, cpus->map[cpu]);
  
diff --cc tools/perf/arch/x86/tests/perf-time-to-tsc.c
index 7a7721604b86,0a4570b340fa..000000000000
--- a/tools/perf/arch/x86/tests/perf-time-to-tsc.c
+++ b/tools/perf/arch/x86/tests/perf-time-to-tsc.c
@@@ -10,7 -15,7 +10,11 @@@
  #include "evlist.h"
  #include "evsel.h"
  #include "thread_map.h"
++<<<<<<< HEAD
 +#include "cpumap.h"
++=======
+ #include "record.h"
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  #include "tsc.h"
  #include "tests/tests.h"
  
diff --cc tools/perf/bench/epoll-ctl.c
index 2af067859966,bb617e568841..000000000000
--- a/tools/perf/bench/epoll-ctl.c
+++ b/tools/perf/bench/epoll-ctl.c
@@@ -20,6 -21,8 +20,11 @@@
  #include <sys/resource.h>
  #include <sys/epoll.h>
  #include <sys/eventfd.h>
++<<<<<<< HEAD
++=======
+ #include <internal/cpumap.h>
+ #include <perf/cpumap.h>
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  
  #include "../util/stat.h"
  #include <subcmd/parse-options.h>
diff --cc tools/perf/bench/epoll-wait.c
index fe85448abd45,7af694437f4e..000000000000
--- a/tools/perf/bench/epoll-wait.c
+++ b/tools/perf/bench/epoll-wait.c
@@@ -75,6 -76,8 +75,11 @@@
  #include <sys/epoll.h>
  #include <sys/eventfd.h>
  #include <sys/types.h>
++<<<<<<< HEAD
++=======
+ #include <internal/cpumap.h>
+ #include <perf/cpumap.h>
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  
  #include "../util/stat.h"
  #include <subcmd/parse-options.h>
diff --cc tools/perf/bench/futex-hash.c
index a80797763e1f,8ba0c3330a9a..000000000000
--- a/tools/perf/bench/futex-hash.c
+++ b/tools/perf/bench/futex-hash.c
@@@ -20,6 -20,8 +20,11 @@@
  #include <linux/kernel.h>
  #include <linux/zalloc.h>
  #include <sys/time.h>
++<<<<<<< HEAD
++=======
+ #include <internal/cpumap.h>
+ #include <perf/cpumap.h>
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  
  #include "../util/stat.h"
  #include <subcmd/parse-options.h>
diff --cc tools/perf/bench/futex-lock-pi.c
index d02330a69745,d0cae8125423..000000000000
--- a/tools/perf/bench/futex-lock-pi.c
+++ b/tools/perf/bench/futex-lock-pi.c
@@@ -14,9 -14,10 +14,13 @@@
  #include <linux/kernel.h>
  #include <linux/zalloc.h>
  #include <errno.h>
++<<<<<<< HEAD
++=======
+ #include <internal/cpumap.h>
+ #include <perf/cpumap.h>
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  #include "bench.h"
  #include "futex.h"
- #include "cpumap.h"
  
  #include <err.h>
  #include <stdlib.h>
diff --cc tools/perf/bench/futex-requeue.c
index fc692efa0c05,a00a6891447a..000000000000
--- a/tools/perf/bench/futex-requeue.c
+++ b/tools/perf/bench/futex-requeue.c
@@@ -20,9 -20,10 +20,13 @@@
  #include <linux/kernel.h>
  #include <linux/time64.h>
  #include <errno.h>
++<<<<<<< HEAD
++=======
+ #include <internal/cpumap.h>
+ #include <perf/cpumap.h>
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  #include "bench.h"
  #include "futex.h"
- #include "cpumap.h"
  
  #include <err.h>
  #include <stdlib.h>
diff --cc tools/perf/bench/futex-wake.c
index e8181ad7d088,df810096abfe..000000000000
--- a/tools/perf/bench/futex-wake.c
+++ b/tools/perf/bench/futex-wake.c
@@@ -20,9 -20,10 +20,13 @@@
  #include <linux/kernel.h>
  #include <linux/time64.h>
  #include <errno.h>
++<<<<<<< HEAD
++=======
+ #include <internal/cpumap.h>
+ #include <perf/cpumap.h>
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  #include "bench.h"
  #include "futex.h"
- #include "cpumap.h"
  
  #include <err.h>
  #include <stdlib.h>
diff --cc tools/perf/builtin-c2c.c
index 0630f22b0b56,61aaacc2aedd..000000000000
--- a/tools/perf/builtin-c2c.c
+++ b/tools/perf/builtin-c2c.c
@@@ -21,7 -20,10 +21,12 @@@
  #include <sys/param.h>
  #include "debug.h"
  #include "builtin.h"
++<<<<<<< HEAD
++=======
+ #include <perf/cpumap.h>
+ #include <subcmd/pager.h>
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  #include <subcmd/parse-options.h>
 -#include "map_symbol.h"
  #include "mem-events.h"
  #include "session.h"
  #include "hist.h"
diff --cc tools/perf/tests/bitmap.c
index 96e7fc1ad3f9,96c137360918..000000000000
--- a/tools/perf/tests/bitmap.c
+++ b/tools/perf/tests/bitmap.c
@@@ -1,8 -1,9 +1,12 @@@
  // SPDX-License-Identifier: GPL-2.0
  #include <linux/compiler.h>
  #include <linux/bitmap.h>
++<<<<<<< HEAD
++=======
+ #include <perf/cpumap.h>
+ #include <internal/cpumap.h>
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  #include "tests.h"
- #include "cpumap.h"
  #include "debug.h"
  
  #define NBITS 100
diff --cc tools/perf/tests/event_update.c
index f14dcd613438,317eb8c5ccd4..000000000000
--- a/tools/perf/tests/event_update.c
+++ b/tools/perf/tests/event_update.c
@@@ -1,8 -1,13 +1,14 @@@
  // SPDX-License-Identifier: GPL-2.0
  #include <linux/compiler.h>
++<<<<<<< HEAD
++=======
+ #include <perf/cpumap.h>
+ #include <string.h>
+ #include "cpumap.h"
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  #include "evlist.h"
  #include "evsel.h"
 -#include "header.h"
  #include "machine.h"
 -#include "tool.h"
  #include "tests.h"
  #include "debug.h"
  
diff --cc tools/perf/tests/mem2node.c
index 520cc91af256,a258bd51f1a4..000000000000
--- a/tools/perf/tests/mem2node.c
+++ b/tools/perf/tests/mem2node.c
@@@ -1,8 -1,12 +1,15 @@@
  // SPDX-License-Identifier: GPL-2.0
  #include <linux/compiler.h>
  #include <linux/bitmap.h>
 -#include <linux/kernel.h>
  #include <linux/zalloc.h>
++<<<<<<< HEAD
 +#include "cpumap.h"
++=======
+ #include <perf/cpumap.h>
+ #include <internal/cpumap.h>
+ #include "debug.h"
+ #include "env.h"
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  #include "mem2node.h"
  #include "tests.h"
  
diff --cc tools/perf/tests/switch-tracking.c
index 6cdab5f4812a,3fb1ff7b8a2f..000000000000
--- a/tools/perf/tests/switch-tracking.c
+++ b/tools/perf/tests/switch-tracking.c
@@@ -10,7 -14,7 +10,11 @@@
  #include "evlist.h"
  #include "evsel.h"
  #include "thread_map.h"
++<<<<<<< HEAD
 +#include "cpumap.h"
++=======
+ #include "record.h"
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  #include "tests.h"
  
  static int spin_sleep(void)
diff --cc tools/perf/tests/task-exit.c
index e92fa6029ac7,088c7708b03a..000000000000
--- a/tools/perf/tests/task-exit.c
+++ b/tools/perf/tests/task-exit.c
@@@ -1,12 -1,16 +1,17 @@@
  // SPDX-License-Identifier: GPL-2.0
 -#include "debug.h"
  #include "evlist.h"
  #include "evsel.h"
 -#include "target.h"
  #include "thread_map.h"
- #include "cpumap.h"
  #include "tests.h"
  
  #include <errno.h>
  #include <signal.h>
++<<<<<<< HEAD
++=======
+ #include <linux/string.h>
+ #include <perf/cpumap.h>
+ #include <perf/evlist.h>
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  
  static int exited;
  static int nr_exit;
diff --cc tools/perf/tests/topology.c
index c22c9d8190e8,7d845d913d7d..000000000000
--- a/tools/perf/tests/topology.c
+++ b/tools/perf/tests/topology.c
@@@ -2,8 -2,9 +2,13 @@@
  #include <string.h>
  #include <stdlib.h>
  #include <stdio.h>
++<<<<<<< HEAD
++=======
+ #include <perf/cpumap.h>
+ #include "cpumap.h"
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  #include "tests.h"
 +#include "util.h"
  #include "session.h"
  #include "evlist.h"
  #include "debug.h"
diff --cc tools/perf/util/event.c
index cd16181746f7,d65ae7cf9316..000000000000
--- a/tools/perf/util/event.c
+++ b/tools/perf/util/event.c
@@@ -11,6 -12,8 +12,11 @@@
  #include <api/fs/fs.h>
  #include <linux/perf_event.h>
  #include <linux/zalloc.h>
++<<<<<<< HEAD
++=======
+ #include "cpumap.h"
+ #include "dso.h"
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  #include "event.h"
  #include "debug.h"
  #include "hist.h"
diff --cc tools/perf/util/session.c
index 82adeb8dfbcf,2b583e6adb49..000000000000
--- a/tools/perf/util/session.c
+++ b/tools/perf/util/session.c
@@@ -18,8 -22,6 +18,11 @@@
  #include "symbol.h"
  #include "session.h"
  #include "tool.h"
++<<<<<<< HEAD
 +#include "sort.h"
 +#include "cpumap.h"
++=======
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  #include "perf_regs.h"
  #include "asm/bug.h"
  #include "auxtrace.h"
diff --cc tools/perf/util/stat.c
index 9b8d699cb791,d309c1cc13db..000000000000
--- a/tools/perf/util/stat.c
+++ b/tools/perf/util/stat.c
@@@ -2,8 -2,14 +2,14 @@@
  #include <errno.h>
  #include <inttypes.h>
  #include <math.h>
 -#include <string.h>
  #include "counts.h"
++<<<<<<< HEAD
++=======
+ #include "cpumap.h"
+ #include "debug.h"
+ #include "header.h"
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  #include "stat.h"
 -#include "session.h"
 -#include "target.h"
  #include "evlist.h"
  #include "evsel.h"
  #include "thread_map.h"
diff --cc tools/perf/util/svghelper.c
index d5c4d063a545,96f941e01681..000000000000
--- a/tools/perf/util/svghelper.c
+++ b/tools/perf/util/svghelper.c
@@@ -18,8 -14,11 +18,13 @@@
  #include <unistd.h>
  #include <string.h>
  #include <linux/bitmap.h>
 -#include <linux/string.h>
  #include <linux/time64.h>
  #include <linux/zalloc.h>
++<<<<<<< HEAD
++=======
+ #include <internal/cpumap.h>
+ #include <perf/cpumap.h>
++>>>>>>> 87ffb6c64070 (perf env: Remove needless cpumap.h header)
  
  #include "env.h"
  #include "svghelper.h"
* Unmerged path tools/perf/arch/arm64/util/header.c
* Unmerged path tools/perf/arch/x86/tests/perf-time-to-tsc.c
* Unmerged path tools/perf/bench/epoll-ctl.c
* Unmerged path tools/perf/bench/epoll-wait.c
* Unmerged path tools/perf/bench/futex-hash.c
* Unmerged path tools/perf/bench/futex-lock-pi.c
* Unmerged path tools/perf/bench/futex-requeue.c
diff --git a/tools/perf/bench/futex-wake-parallel.c b/tools/perf/bench/futex-wake-parallel.c
index 69d8fdc87315..6141b37c8719 100644
--- a/tools/perf/bench/futex-wake-parallel.c
+++ b/tools/perf/bench/futex-wake-parallel.c
@@ -29,7 +29,8 @@ int bench_futex_wake_parallel(int argc __maybe_unused, const char **argv __maybe
 #include <linux/time64.h>
 #include <errno.h>
 #include "futex.h"
-#include "cpumap.h"
+#include <internal/cpumap.h>
+#include <perf/cpumap.h>
 
 #include <err.h>
 #include <stdlib.h>
* Unmerged path tools/perf/bench/futex-wake.c
* Unmerged path tools/perf/builtin-c2c.c
diff --git a/tools/perf/builtin-sched.c b/tools/perf/builtin-sched.c
index e65d0c8a68cc..a180b5ec2639 100644
--- a/tools/perf/builtin-sched.c
+++ b/tools/perf/builtin-sched.c
@@ -2,6 +2,7 @@
 #include "builtin.h"
 #include "perf.h"
 
+#include "util/cpumap.h"
 #include "util/evlist.h"
 #include "util/cache.h"
 #include "util/evsel.h"
@@ -35,6 +36,7 @@
 #include <pthread.h>
 #include <math.h>
 #include <api/fs/fs.h>
+#include <perf/cpumap.h>
 #include <linux/time64.h>
 #include <linux/err.h>
 
* Unmerged path tools/perf/tests/bitmap.c
diff --git a/tools/perf/tests/code-reading.c b/tools/perf/tests/code-reading.c
index aa6df122b175..518f66e7a67c 100644
--- a/tools/perf/tests/code-reading.c
+++ b/tools/perf/tests/code-reading.c
@@ -13,7 +13,6 @@
 #include "evlist.h"
 #include "evsel.h"
 #include "thread_map.h"
-#include "cpumap.h"
 #include "machine.h"
 #include "map.h"
 #include "symbol.h"
* Unmerged path tools/perf/tests/event_update.c
diff --git a/tools/perf/tests/keep-tracking.c b/tools/perf/tests/keep-tracking.c
index 17c46f3e6f1e..020305837e11 100644
--- a/tools/perf/tests/keep-tracking.c
+++ b/tools/perf/tests/keep-tracking.c
@@ -7,7 +7,6 @@
 #include "evlist.h"
 #include "evsel.h"
 #include "thread_map.h"
-#include "cpumap.h"
 #include "tests.h"
 
 #define CHECK__(x) {				\
@@ -138,7 +137,7 @@ int test__keep_tracking(struct test *test __maybe_unused, int subtest __maybe_un
 
 	found = find_comm(evlist, comm);
 	if (found != 1) {
-		pr_debug("Seconf time, failed to find tracking event.\n");
+		pr_debug("Second time, failed to find tracking event.\n");
 		goto out_err;
 	}
 
* Unmerged path tools/perf/tests/mem2node.c
diff --git a/tools/perf/tests/mmap-basic.c b/tools/perf/tests/mmap-basic.c
index 0919b0793e5b..40807f4275ed 100644
--- a/tools/perf/tests/mmap-basic.c
+++ b/tools/perf/tests/mmap-basic.c
@@ -7,7 +7,6 @@
 #include "evlist.h"
 #include "evsel.h"
 #include "thread_map.h"
-#include "cpumap.h"
 #include "tests.h"
 #include <linux/err.h>
 #include <linux/kernel.h>
@@ -48,7 +47,7 @@ int test__basic_mmap(struct test *test __maybe_unused, int subtest __maybe_unuse
 
 	cpus = cpu_map__new(NULL);
 	if (cpus == NULL) {
-		pr_debug("cpu_map__new\n");
+		pr_debug("perf_cpu_map__new\n");
 		goto out_free_threads;
 	}
 
diff --git a/tools/perf/tests/openat-syscall-all-cpus.c b/tools/perf/tests/openat-syscall-all-cpus.c
index 981aa23ff761..f1691784e820 100644
--- a/tools/perf/tests/openat-syscall-all-cpus.c
+++ b/tools/perf/tests/openat-syscall-all-cpus.c
@@ -13,7 +13,8 @@
 #include "evsel.h"
 #include "tests.h"
 #include "thread_map.h"
-#include "cpumap.h"
+#include <perf/cpumap.h>
+#include <internal/cpumap.h>
 #include "debug.h"
 #include "stat.h"
 #include "util/counts.h"
@@ -36,7 +37,7 @@ int test__openat_syscall_event_on_all_cpus(struct test *test __maybe_unused, int
 
 	cpus = cpu_map__new(NULL);
 	if (cpus == NULL) {
-		pr_debug("cpu_map__new\n");
+		pr_debug("perf_cpu_map__new\n");
 		goto out_thread_map_delete;
 	}
 
* Unmerged path tools/perf/tests/switch-tracking.c
* Unmerged path tools/perf/tests/task-exit.c
* Unmerged path tools/perf/tests/topology.c
diff --git a/tools/perf/util/arm-spe.c b/tools/perf/util/arm-spe.c
index a36f117f5091..f8c3d73f815c 100644
--- a/tools/perf/util/arm-spe.c
+++ b/tools/perf/util/arm-spe.c
@@ -16,7 +16,6 @@
 #include <linux/log2.h>
 #include <linux/zalloc.h>
 
-#include "cpumap.h"
 #include "color.h"
 #include "evsel.h"
 #include "machine.h"
diff --git a/tools/perf/util/auxtrace.c b/tools/perf/util/auxtrace.c
index 2e60b09cfd97..36f83fe133fe 100644
--- a/tools/perf/util/auxtrace.c
+++ b/tools/perf/util/auxtrace.c
@@ -41,7 +41,6 @@
 #include "map.h"
 #include "pmu.h"
 #include "evsel.h"
-#include "cpumap.h"
 #include "symbol.h"
 #include "thread_map.h"
 #include "asm/bug.h"
diff --git a/tools/perf/util/env.h b/tools/perf/util/env.h
index d5d9865aa812..b5af5169bf8c 100644
--- a/tools/perf/util/env.h
+++ b/tools/perf/util/env.h
@@ -4,9 +4,10 @@
 
 #include <linux/types.h>
 #include <linux/rbtree.h>
-#include "cpumap.h"
 #include "rwsem.h"
 
+struct perf_cpu_map;
+
 struct cpu_topology_map {
 	int	socket_id;
 	int	die_id;
* Unmerged path tools/perf/util/event.c
diff --git a/tools/perf/util/evsel.c b/tools/perf/util/evsel.c
index 90bfc2303a40..01db1e512660 100644
--- a/tools/perf/util/evsel.c
+++ b/tools/perf/util/evsel.c
@@ -29,7 +29,7 @@
 #include "event.h"
 #include "evsel.h"
 #include "evlist.h"
-#include "cpumap.h"
+#include <perf/cpumap.h>
 #include "thread_map.h"
 #include "target.h"
 #include "perf_regs.h"
diff --git a/tools/perf/util/intel-bts.c b/tools/perf/util/intel-bts.c
index 902b67a0538f..9e836d536d85 100644
--- a/tools/perf/util/intel-bts.c
+++ b/tools/perf/util/intel-bts.c
@@ -23,7 +23,6 @@
 #include <linux/log2.h>
 #include <linux/zalloc.h>
 
-#include "cpumap.h"
 #include "color.h"
 #include "evsel.h"
 #include "evlist.h"
diff --git a/tools/perf/util/parse-events.c b/tools/perf/util/parse-events.c
index 5941be0e92cc..d6aa862f861b 100644
--- a/tools/perf/util/parse-events.c
+++ b/tools/perf/util/parse-events.c
@@ -28,7 +28,6 @@
 #include "parse-events-flex.h"
 #include "pmu.h"
 #include "thread_map.h"
-#include "cpumap.h"
 #include "probe-file.h"
 #include "asm/bug.h"
 #include "util/parse-branch-options.h"
diff --git a/tools/perf/util/pmu.c b/tools/perf/util/pmu.c
index 38d5cd18e5d3..02cb82219189 100644
--- a/tools/perf/util/pmu.c
+++ b/tools/perf/util/pmu.c
@@ -17,7 +17,6 @@
 #include <regex.h>
 #include "pmu.h"
 #include "parse-events.h"
-#include "cpumap.h"
 #include "header.h"
 #include "pmu-events/pmu-events.h"
 #include "cache.h"
diff --git a/tools/perf/util/python.c b/tools/perf/util/python.c
index 9c3b43665909..afaa7f178862 100644
--- a/tools/perf/util/python.c
+++ b/tools/perf/util/python.c
@@ -8,7 +8,6 @@
 #include "callchain.h"
 #include "evsel.h"
 #include "event.h"
-#include "cpumap.h"
 #include "print_binary.h"
 #include "thread_map.h"
 #include "mmap.h"
diff --git a/tools/perf/util/record.c b/tools/perf/util/record.c
index 9cfc7bf16531..c559301a803c 100644
--- a/tools/perf/util/record.c
+++ b/tools/perf/util/record.c
@@ -1,7 +1,6 @@
 // SPDX-License-Identifier: GPL-2.0
 #include "evlist.h"
 #include "evsel.h"
-#include "cpumap.h"
 #include "parse-events.h"
 #include <errno.h>
 #include <api/fs/fs.h>
diff --git a/tools/perf/util/s390-cpumsf.c b/tools/perf/util/s390-cpumsf.c
index 83d2e149ef19..9608401edf12 100644
--- a/tools/perf/util/s390-cpumsf.c
+++ b/tools/perf/util/s390-cpumsf.c
@@ -151,7 +151,6 @@
 #include <sys/stat.h>
 #include <sys/types.h>
 
-#include "cpumap.h"
 #include "color.h"
 #include "evsel.h"
 #include "evlist.h"
diff --git a/tools/perf/util/scripting-engines/trace-event-python.c b/tools/perf/util/scripting-engines/trace-event-python.c
index a8189337ec3a..858bb7d033e8 100644
--- a/tools/perf/util/scripting-engines/trace-event-python.c
+++ b/tools/perf/util/scripting-engines/trace-event-python.c
@@ -47,7 +47,6 @@
 #include "map.h"
 #include "symbol.h"
 #include "thread_map.h"
-#include "cpumap.h"
 #include "print_binary.h"
 #include "stat.h"
 #include "mem-events.h"
* Unmerged path tools/perf/util/session.c
* Unmerged path tools/perf/util/stat.c
* Unmerged path tools/perf/util/svghelper.c
diff --git a/tools/perf/util/top.c b/tools/perf/util/top.c
index 4c8da8c4435f..80b708ba9430 100644
--- a/tools/perf/util/top.c
+++ b/tools/perf/util/top.c
@@ -6,7 +6,6 @@
  * Released under the GPL v2. (and only v2, not any later version)
  */
 
-#include "cpumap.h"
 #include "event.h"
 #include "evlist.h"
 #include "evsel.h"
