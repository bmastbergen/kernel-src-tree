net: phylink: Fix phylink_dbg() macro

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Florian Fainelli <f.fainelli@gmail.com>
commit 9d68db5092c5fac99fccfdeab3f04df0b27d1762
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/9d68db50.failed

The phylink_dbg() macro does not follow dynamic debug or defined(DEBUG)
and as a result, it spams the kernel log since a PR_DEBUG level is
currently used. Fix it to be defined appropriately whether
CONFIG_DYNAMIC_DEBUG or defined(DEBUG) are set.

Fixes: 17091180b152 ("net: phylink: Add phylink_{printk, err, warn, info, dbg} macros")
	Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 9d68db5092c5fac99fccfdeab3f04df0b27d1762)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/phy/phylink.c
diff --cc drivers/net/phy/phylink.c
index 3e70c842a997,a578f7ebf715..000000000000
--- a/drivers/net/phy/phylink.c
+++ b/drivers/net/phy/phylink.c
@@@ -70,6 -73,39 +70,42 @@@ struct phylink 
  	struct sfp_bus *sfp_bus;
  };
  
++<<<<<<< HEAD
++=======
+ #define phylink_printk(level, pl, fmt, ...) \
+ 	do { \
+ 		if ((pl)->config->type == PHYLINK_NETDEV) \
+ 			netdev_printk(level, (pl)->netdev, fmt, ##__VA_ARGS__); \
+ 		else if ((pl)->config->type == PHYLINK_DEV) \
+ 			dev_printk(level, (pl)->dev, fmt, ##__VA_ARGS__); \
+ 	} while (0)
+ 
+ #define phylink_err(pl, fmt, ...) \
+ 	phylink_printk(KERN_ERR, pl, fmt, ##__VA_ARGS__)
+ #define phylink_warn(pl, fmt, ...) \
+ 	phylink_printk(KERN_WARNING, pl, fmt, ##__VA_ARGS__)
+ #define phylink_info(pl, fmt, ...) \
+ 	phylink_printk(KERN_INFO, pl, fmt, ##__VA_ARGS__)
+ #if defined(CONFIG_DYNAMIC_DEBUG)
+ #define phylink_dbg(pl, fmt, ...) \
+ do {									\
+ 	if ((pl)->config->type == PHYLINK_NETDEV)			\
+ 		netdev_dbg((pl)->netdev, fmt, ##__VA_ARGS__);		\
+ 	else if ((pl)->config->type == PHYLINK_DEV)			\
+ 		dev_dbg((pl)->dev, fmt, ##__VA_ARGS__);			\
+ } while (0)
+ #elif defined(DEBUG)
+ #define phylink_dbg(pl, fmt, ...)					\
+ 	phylink_printk(KERN_DEBUG, pl, fmt, ##__VA_ARGS__)
+ #else
+ #define phylink_dbg(pl, fmt, ...)					\
+ ({									\
+ 	if (0)								\
+ 		phylink_printk(KERN_DEBUG, pl, fmt, ##__VA_ARGS__);	\
+ })
+ #endif
+ 
++>>>>>>> 9d68db5092c5 (net: phylink: Fix phylink_dbg() macro)
  /**
   * phylink_set_port_modes() - set the port type modes in the ethtool mask
   * @mask: ethtool link mode mask
* Unmerged path drivers/net/phy/phylink.c
