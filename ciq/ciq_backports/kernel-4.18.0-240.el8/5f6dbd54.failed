drm/amd/display: fix counter in wait_for_no_pipes_pending

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Roman Li <roman.li@amd.com>
commit 5f6dbd54c05f38d30da9c1d310219808a69afd35
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/5f6dbd54.failed

[Why]
Wait counter is not being reset for each pipe.

[How]
Move counter reset into pipe loop scope.

	Signed-off-by: Roman Li <roman.li@amd.com>
	Reviewed-by: Zhan Liu <Zhan.Liu@amd.com>
	Acked-by: Aurabindo Pillai <aurabindo.pillai@amd.com>
	Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
(cherry picked from commit 5f6dbd54c05f38d30da9c1d310219808a69afd35)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/amd/display/dc/core/dc.c
diff --cc drivers/gpu/drm/amd/display/dc/core/dc.c
index d8c0d01bb191,0a12d13349c1..000000000000
--- a/drivers/gpu/drm/amd/display/dc/core/dc.c
+++ b/drivers/gpu/drm/amd/display/dc/core/dc.c
@@@ -757,6 -836,32 +757,35 @@@ static void disable_dangling_plane(stru
  	dc_release_state(current_ctx);
  }
  
++<<<<<<< HEAD
++=======
+ static void wait_for_no_pipes_pending(struct dc *dc, struct dc_state *context)
+ {
+ 	int i;
+ 	PERF_TRACE();
+ 	for (i = 0; i < MAX_PIPES; i++) {
+ 		int count = 0;
+ 		struct pipe_ctx *pipe = &context->res_ctx.pipe_ctx[i];
+ 
+ 		if (!pipe->plane_state)
+ 			continue;
+ 
+ 		/* Timeout 100 ms */
+ 		while (count < 100000) {
+ 			/* Must set to false to start with, due to OR in update function */
+ 			pipe->plane_state->status.is_flip_pending = false;
+ 			dc->hwss.update_pending_status(pipe);
+ 			if (!pipe->plane_state->status.is_flip_pending)
+ 				break;
+ 			udelay(1);
+ 			count++;
+ 		}
+ 		ASSERT(!pipe->plane_state->status.is_flip_pending);
+ 	}
+ 	PERF_TRACE();
+ }
+ 
++>>>>>>> 5f6dbd54c05f (drm/amd/display: fix counter in wait_for_no_pipes_pending)
  /*******************************************************************************
   * Public functions
   ******************************************************************************/
* Unmerged path drivers/gpu/drm/amd/display/dc/core/dc.c
