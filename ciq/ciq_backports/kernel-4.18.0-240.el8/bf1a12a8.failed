mm: move the backup x_devmap() functions to asm-generic/pgtable.h

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Thomas Hellstrom <thellstrom@vmware.com>
commit bf1a12a8095615c9486f5463ca473d2d69ff6952
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/bf1a12a8.failed

The asm-generic/pgtable.h include file appears to be the correct place for
the backup x_devmap() inline functions.  Moving them here is also
necessary if we want to include x_devmap() in the [pmd|pud]_unstable
functions.  So move the x_devmap() functions to asm-generic/pgtable.h

Link: http://lkml.kernel.org/r/20191115115808.21181-1-thomas_os@shipmail.org
	Signed-off-by: Thomas Hellstrom <thellstrom@vmware.com>
	Cc: Arnd Bergmann <arnd@arndb.de>
	Cc: "Kirill A. Shutemov" <kirill.shutemov@linux.intel.com>
	Cc: Matthew Wilcox <willy@infradead.org>
	Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
	Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
(cherry picked from commit bf1a12a8095615c9486f5463ca473d2d69ff6952)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/linux/mm.h
diff --cc include/linux/mm.h
index b148311a033c,06b51d8728ec..000000000000
--- a/include/linux/mm.h
+++ b/include/linux/mm.h
@@@ -479,21 -564,6 +479,24 @@@ static inline void vma_set_anonymous(st
  struct mmu_gather;
  struct inode;
  
++<<<<<<< HEAD
 +#if !defined(__HAVE_ARCH_PTE_DEVMAP) || !defined(CONFIG_TRANSPARENT_HUGEPAGE)
 +static inline int pmd_devmap(pmd_t pmd)
 +{
 +	return 0;
 +}
 +static inline int pud_devmap(pud_t pud)
 +{
 +	return 0;
 +}
 +static inline int pgd_devmap(pgd_t pgd)
 +{
 +	return 0;
 +}
 +#endif
 +
++=======
++>>>>>>> bf1a12a80956 (mm: move the backup x_devmap() functions to asm-generic/pgtable.h)
  /*
   * FIXME: take this include out, include page-flags.h in
   * files which need it (119 of them)
diff --git a/include/asm-generic/pgtable.h b/include/asm-generic/pgtable.h
index 6ebca2e305b2..ac648884c76c 100644
--- a/include/asm-generic/pgtable.h
+++ b/include/asm-generic/pgtable.h
@@ -903,6 +903,21 @@ static inline int pud_write(pud_t pud)
 }
 #endif /* pud_write */
 
+#if !defined(CONFIG_ARCH_HAS_PTE_DEVMAP) || !defined(CONFIG_TRANSPARENT_HUGEPAGE)
+static inline int pmd_devmap(pmd_t pmd)
+{
+	return 0;
+}
+static inline int pud_devmap(pud_t pud)
+{
+	return 0;
+}
+static inline int pgd_devmap(pgd_t pgd)
+{
+	return 0;
+}
+#endif
+
 #if !defined(CONFIG_TRANSPARENT_HUGEPAGE) || \
 	(defined(CONFIG_TRANSPARENT_HUGEPAGE) && \
 	 !defined(CONFIG_HAVE_ARCH_TRANSPARENT_HUGEPAGE_PUD))
* Unmerged path include/linux/mm.h
