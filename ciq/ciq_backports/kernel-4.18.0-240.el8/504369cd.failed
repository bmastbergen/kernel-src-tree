gpiolib: Switch order of valid mask and hw init

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Linus Walleij <linus.walleij@linaro.org>
commit 504369cd6d2ce34c1225063071ac7e0a5a4d5e30
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/504369cd.failed

The GPIO irqchip needs to initialize the valid mask
before initializing the IRQ hardware, because sometimes
the latter require the former to be executed first.

	Cc: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
	Cc: Mika Westerberg <mika.westerberg@linux.intel.com>
	Reported-by: Hans de Goede <hdegoede@redhat.com>
Link: https://lore.kernel.org/r/20191030122914.967-1-linus.walleij@linaro.org
	Acked-by: Hans de Goede <hdegoede@redhat.com>
	Reviewed-by: Mika Westerberg <mika.westerberg@linux.intel.com>
	Reviewed-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
	Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
(cherry picked from commit 504369cd6d2ce34c1225063071ac7e0a5a4d5e30)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpio/gpiolib.c
diff --cc drivers/gpio/gpiolib.c
index 3959d8ae5324,e865c889ba8d..000000000000
--- a/drivers/gpio/gpiolib.c
+++ b/drivers/gpio/gpiolib.c
@@@ -1406,12 -1411,16 +1406,25 @@@ int gpiochip_add_data_with_key(struct g
  
  	machine_gpiochip_add(chip);
  
++<<<<<<< HEAD
 +	status = gpiochip_irqchip_init_valid_mask(chip);
 +	if (status)
 +		goto err_remove_acpi_chip;
 +
 +	status = gpiochip_add_irqchip(chip, lock_key, request_key);
 +	if (status)
++=======
+ 	ret = gpiochip_irqchip_init_valid_mask(chip);
+ 	if (ret)
+ 		goto err_remove_acpi_chip;
+ 
+ 	ret = gpiochip_irqchip_init_hw(chip);
+ 	if (ret)
+ 		goto err_remove_acpi_chip;
+ 
+ 	ret = gpiochip_add_irqchip(chip, lock_key, request_key);
+ 	if (ret)
++>>>>>>> 504369cd6d2c (gpiolib: Switch order of valid mask and hw init)
  		goto err_remove_irqchip_mask;
  
  	/*
* Unmerged path drivers/gpio/gpiolib.c
