netfilter: nf_tables: add enum nft_flowtable_flags to uapi

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Pablo Neira Ayuso <pablo@netfilter.org>
commit cfbd1125fc8778913d0956a757438bbb2c35f031
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/cfbd1125.failed

Expose the NFT_FLOWTABLE_HW_OFFLOAD flag through uapi.

	Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
(cherry picked from commit cfbd1125fc8778913d0956a757438bbb2c35f031)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/net/netfilter/nf_flow_table.h
#	net/netfilter/nf_tables_api.c
diff --cc include/net/netfilter/nf_flow_table.h
index ebceddb778ea,4beb7f13bc50..000000000000
--- a/include/net/netfilter/nf_flow_table.h
+++ b/include/net/netfilter/nf_flow_table.h
@@@ -20,6 -61,10 +20,13 @@@ struct nf_flowtable_type 
  	struct module			*owner;
  };
  
++<<<<<<< HEAD
++=======
+ enum nf_flowtable_flags {
+ 	NF_FLOWTABLE_HW_OFFLOAD		= 0x1,	/* NFT_FLOWTABLE_HW_OFFLOAD */
+ };
+ 
++>>>>>>> cfbd1125fc87 (netfilter: nf_tables: add enum nft_flowtable_flags to uapi)
  struct nf_flowtable {
  	struct list_head		list;
  	struct rhashtable		rhashtable;
diff --cc net/netfilter/nf_tables_api.c
index 08c962632d4c,ace325218edb..000000000000
--- a/net/netfilter/nf_tables_api.c
+++ b/net/netfilter/nf_tables_api.c
@@@ -5902,6 -6372,14 +5902,17 @@@ static int nf_tables_newflowtable(struc
  		goto err2;
  	}
  
++<<<<<<< HEAD
++=======
+ 	if (nla[NFTA_FLOWTABLE_FLAGS]) {
+ 		flowtable->data.flags =
+ 			ntohl(nla_get_be32(nla[NFTA_FLOWTABLE_FLAGS]));
+ 		if (flowtable->data.flags & ~NFT_FLOWTABLE_MASK)
+ 			goto err3;
+ 	}
+ 
+ 	write_pnet(&flowtable->data.net, net);
++>>>>>>> cfbd1125fc87 (netfilter: nf_tables: add enum nft_flowtable_flags to uapi)
  	flowtable->data.type = type;
  	err = type->init(&flowtable->data);
  	if (err < 0)
* Unmerged path include/net/netfilter/nf_flow_table.h
diff --git a/include/uapi/linux/netfilter/nf_tables.h b/include/uapi/linux/netfilter/nf_tables.h
index 8a0bf59999aa..e9d8ad3eb559 100644
--- a/include/uapi/linux/netfilter/nf_tables.h
+++ b/include/uapi/linux/netfilter/nf_tables.h
@@ -1483,6 +1483,16 @@ enum nft_object_attributes {
 };
 #define NFTA_OBJ_MAX		(__NFTA_OBJ_MAX - 1)
 
+/**
+ * enum nft_flowtable_flags - nf_tables flowtable flags
+ *
+ * @NFT_FLOWTABLE_HW_OFFLOAD: flowtable hardware offload is enabled
+ */
+enum nft_flowtable_flags {
+	NFT_FLOWTABLE_HW_OFFLOAD	= 0x1,
+	NFT_FLOWTABLE_MASK		= NFT_FLOWTABLE_HW_OFFLOAD
+};
+
 /**
  * enum nft_flowtable_attributes - nf_tables flow table netlink attributes
  *
* Unmerged path net/netfilter/nf_tables_api.c
