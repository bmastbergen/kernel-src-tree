perf tools: Make usage of test_attr__* optional for perf-sys.h

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Björn Töpel <bjorn.topel@intel.com>
commit 06f84d1989b7e58d56fa2e448664585749d41221
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/06f84d19.failed

For users of perf-sys.h outside perf, e.g. samples/bpf/bpf_load.c, it's
convenient not to depend on test_attr__*.

After commit 91854f9a077e ("perf tools: Move everything related to
sys_perf_event_open() to perf-sys.h"), all users of perf-sys.h will
depend on test_attr__enabled and test_attr__open.

This commit enables a user to define HAVE_ATTR_TEST to zero in order
to omit the test dependency.

Fixes: 91854f9a077e ("perf tools: Move everything related to sys_perf_event_open() to perf-sys.h")
	Signed-off-by: Björn Töpel <bjorn.topel@intel.com>
	Acked-by: Song Liu <songliubraving@fb.com>
	Cc: Adrian Hunter <adrian.hunter@intel.com>
	Cc: Alexei Starovoitov <ast@kernel.org>
	Cc: Daniel Borkmann <daniel@iogearbox.net>
	Cc: Jiri Olsa <jolsa@kernel.org>
	Cc: Namhyung Kim <namhyung@kernel.org>
	Cc: bpf@vger.kernel.org
	Cc: netdev@vger.kernel.org
Link: http://lore.kernel.org/lkml/20191001113307.27796-2-bjorn.topel@gmail.com
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 06f84d1989b7e58d56fa2e448664585749d41221)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/perf-sys.h
diff --cc tools/perf/perf-sys.h
index 6ffb0fbd6237,15e458e150bd..000000000000
--- a/tools/perf/perf-sys.h
+++ b/tools/perf/perf-sys.h
@@@ -5,10 -5,19 +5,25 @@@
  #include <unistd.h>
  #include <sys/types.h>
  #include <sys/syscall.h>
 +#include <linux/types.h>
  #include <linux/compiler.h>
++<<<<<<< HEAD
 +#include <linux/perf_event.h>
 +#include <asm/barrier.h>
++=======
+ 
+ struct perf_event_attr;
+ 
+ extern bool test_attr__enabled;
+ void test_attr__ready(void);
+ void test_attr__init(void);
+ void test_attr__open(struct perf_event_attr *attr, pid_t pid, int cpu,
+ 		     int fd, int group_fd, unsigned long flags);
+ 
+ #ifndef HAVE_ATTR_TEST
+ #define HAVE_ATTR_TEST 1
+ #endif
++>>>>>>> 06f84d1989b7 (perf tools: Make usage of test_attr__* optional for perf-sys.h)
  
  static inline int
  sys_perf_event_open(struct perf_event_attr *attr,
* Unmerged path tools/perf/perf-sys.h
