perf evsel: Move config terms to a separate header

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Arnaldo Carvalho de Melo <acme@redhat.com>
commit 95be9d197da6f9006f6a70a0d141498ea2488858
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/95be9d19.failed

Further reducing the size of util/evsel.h.

	Cc: Adrian Hunter <adrian.hunter@intel.com>
	Cc: Jiri Olsa <jolsa@kernel.org>
	Cc: Namhyung Kim <namhyung@kernel.org>
Link: https://lkml.kernel.org/n/tip-20zr7di9eynm0272mtjfdhfc@git.kernel.org
	Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>
(cherry picked from commit 95be9d197da6f9006f6a70a0d141498ea2488858)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/perf/util/evsel.c
#	tools/perf/util/evsel.h
#	tools/perf/util/parse-events.c
diff --cc tools/perf/util/evsel.c
index 90bfc2303a40,5591af81a070..000000000000
--- a/tools/perf/util/evsel.c
+++ b/tools/perf/util/evsel.c
@@@ -26,10 -25,15 +26,15 @@@
  #include "asm/bug.h"
  #include "callchain.h"
  #include "cgroup.h"
 -#include "counts.h"
  #include "event.h"
  #include "evsel.h"
++<<<<<<< HEAD
++=======
+ #include "util/evsel_config.h"
+ #include "util/evsel_fprintf.h"
++>>>>>>> 95be9d197da6 (perf evsel: Move config terms to a separate header)
  #include "evlist.h"
 -#include <perf/cpumap.h>
 +#include "cpumap.h"
  #include "thread_map.h"
  #include "target.h"
  #include "perf_regs.h"
diff --cc tools/perf/util/evsel.h
index 2ab992b39a4c,ddc5ee6f6592..000000000000
--- a/tools/perf/util/evsel.h
+++ b/tools/perf/util/evsel.h
@@@ -4,78 -4,19 +4,84 @@@
  
  #include <linux/list.h>
  #include <stdbool.h>
 -#include <sys/types.h>
 +#include <stdio.h>
  #include <linux/perf_event.h>
  #include <linux/types.h>
 -#include <internal/evsel.h>
 -#include <perf/evsel.h>
 +#include "xyarray.h"
  #include "symbol_conf.h"
 -#include <internal/cpumap.h>
 +#include "cpumap.h"
 +#include "counts.h"
  
 +struct perf_evsel;
 +
 +/*
 + * Per fd, to map back from PERF_SAMPLE_ID to evsel, only used when there are
 + * more than one entry in the evlist.
 + */
 +struct perf_sample_id {
 +	struct hlist_node 	node;
 +	u64		 	id;
 +	struct perf_evsel	*evsel;
 +	int			idx;
 +	int			cpu;
 +	pid_t			tid;
 +
 +	/* Holds total ID period value for PERF_SAMPLE_READ processing. */
 +	u64			period;
 +};
 +
 +struct cgroup;
 +
++<<<<<<< HEAD
 +/*
 + * The 'struct perf_evsel_config_term' is used to pass event
 + * specific configuration data to perf_evsel__config routine.
 + * It is allocated within event parsing and attached to
 + * perf_evsel::config_terms list head.
 +*/
 +enum term_type {
 +	PERF_EVSEL__CONFIG_TERM_PERIOD,
 +	PERF_EVSEL__CONFIG_TERM_FREQ,
 +	PERF_EVSEL__CONFIG_TERM_TIME,
 +	PERF_EVSEL__CONFIG_TERM_CALLGRAPH,
 +	PERF_EVSEL__CONFIG_TERM_STACK_USER,
 +	PERF_EVSEL__CONFIG_TERM_INHERIT,
 +	PERF_EVSEL__CONFIG_TERM_MAX_STACK,
 +	PERF_EVSEL__CONFIG_TERM_MAX_EVENTS,
 +	PERF_EVSEL__CONFIG_TERM_OVERWRITE,
 +	PERF_EVSEL__CONFIG_TERM_DRV_CFG,
 +	PERF_EVSEL__CONFIG_TERM_BRANCH,
 +	PERF_EVSEL__CONFIG_TERM_PERCORE,
 +	PERF_EVSEL__CONFIG_TERM_AUX_OUTPUT,
 +};
 +
 +struct perf_evsel_config_term {
 +	struct list_head	list;
 +	enum term_type	type;
 +	union {
 +		u64	period;
 +		u64	freq;
 +		bool	time;
 +		char	*callgraph;
 +		char	*drv_cfg;
 +		u64	stack_user;
 +		int	max_stack;
 +		bool	inherit;
 +		bool	overwrite;
 +		char	*branch;
 +		unsigned long max_events;
 +		bool	percore;
 +		bool	aux_output;
 +	} val;
 +	bool weak;
 +};
 +
++=======
+ struct bpf_object;
+ struct cgroup;
+ struct perf_counts;
++>>>>>>> 95be9d197da6 (perf evsel: Move config terms to a separate header)
  struct perf_stat_evsel;
 -union perf_event;
  
  typedef int (perf_evsel__sb_cb_t)(union perf_event *event, void *data);
  
diff --cc tools/perf/util/parse-events.c
index 5941be0e92cc,50737046fa63..000000000000
--- a/tools/perf/util/parse-events.c
+++ b/tools/perf/util/parse-events.c
@@@ -33,6 -34,8 +33,11 @@@
  #include "asm/bug.h"
  #include "util/parse-branch-options.h"
  #include "metricgroup.h"
++<<<<<<< HEAD
++=======
+ #include "util/evsel_config.h"
+ #include "util/mmap.h"
++>>>>>>> 95be9d197da6 (perf evsel: Move config terms to a separate header)
  
  #define MAX_NAME_LEN 100
  
diff --git a/tools/perf/arch/arm/util/cs-etm.c b/tools/perf/arch/arm/util/cs-etm.c
index 4208974c24f8..9deb153e5fb4 100644
--- a/tools/perf/arch/arm/util/cs-etm.c
+++ b/tools/perf/arch/arm/util/cs-etm.c
@@ -20,6 +20,7 @@
 #include "../../util/cpumap.h"
 #include "../../util/evlist.h"
 #include "../../util/evsel.h"
+#include "../../util/evsel_config.h"
 #include "../../util/pmu.h"
 #include "../../util/thread_map.h"
 #include "../../util/cs-etm.h"
diff --git a/tools/perf/builtin-top.c b/tools/perf/builtin-top.c
index 95aec2602043..e2746acc792a 100644
--- a/tools/perf/builtin-top.c
+++ b/tools/perf/builtin-top.c
@@ -27,6 +27,7 @@
 #include "util/color.h"
 #include "util/evlist.h"
 #include "util/evsel.h"
+#include "util/evsel_config.h"
 #include "util/event.h"
 #include "util/machine.h"
 #include "util/map.h"
* Unmerged path tools/perf/util/evsel.c
* Unmerged path tools/perf/util/evsel.h
diff --git a/tools/perf/util/evsel_config.h b/tools/perf/util/evsel_config.h
new file mode 100644
index 000000000000..8a7648037c18
--- /dev/null
+++ b/tools/perf/util/evsel_config.h
@@ -0,0 +1,50 @@
+// SPDX-License-Identifier: GPL-2.0
+#ifndef __PERF_EVSEL_CONFIG_H
+#define __PERF_EVSEL_CONFIG_H 1
+
+#include <linux/types.h>
+#include <stdbool.h>
+
+/*
+ * The 'struct perf_evsel_config_term' is used to pass event
+ * specific configuration data to perf_evsel__config routine.
+ * It is allocated within event parsing and attached to
+ * perf_evsel::config_terms list head.
+*/
+enum evsel_term_type {
+	PERF_EVSEL__CONFIG_TERM_PERIOD,
+	PERF_EVSEL__CONFIG_TERM_FREQ,
+	PERF_EVSEL__CONFIG_TERM_TIME,
+	PERF_EVSEL__CONFIG_TERM_CALLGRAPH,
+	PERF_EVSEL__CONFIG_TERM_STACK_USER,
+	PERF_EVSEL__CONFIG_TERM_INHERIT,
+	PERF_EVSEL__CONFIG_TERM_MAX_STACK,
+	PERF_EVSEL__CONFIG_TERM_MAX_EVENTS,
+	PERF_EVSEL__CONFIG_TERM_OVERWRITE,
+	PERF_EVSEL__CONFIG_TERM_DRV_CFG,
+	PERF_EVSEL__CONFIG_TERM_BRANCH,
+	PERF_EVSEL__CONFIG_TERM_PERCORE,
+	PERF_EVSEL__CONFIG_TERM_AUX_OUTPUT,
+};
+
+struct perf_evsel_config_term {
+	struct list_head      list;
+	enum evsel_term_type  type;
+	union {
+		u64	      period;
+		u64	      freq;
+		bool	      time;
+		char	      *callgraph;
+		char	      *drv_cfg;
+		u64	      stack_user;
+		int	      max_stack;
+		bool	      inherit;
+		bool	      overwrite;
+		char	      *branch;
+		unsigned long max_events;
+		bool	      percore;
+		bool	      aux_output;
+	} val;
+	bool weak;
+};
+#endif // __PERF_EVSEL_CONFIG_H
* Unmerged path tools/perf/util/parse-events.c
