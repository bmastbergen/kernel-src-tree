drm/amdgpu/powerplay: using the FCLK DPM table to set the MCLK

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Yuxian Dai <Yuxian.Dai@amd.com>
commit 575b0a6e6a2f35babc7991d8e63e701d2fec9d00
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/575b0a6e.failed

1.Using the FCLK DPM table to set the MCLK for DPM states consist of
three entities:
 FCLK
 UCLK
 MEMCLK
All these three clk change together, MEMCLK from FCLK, so use the fclk
frequency.
2.we should show the current working clock freqency from clock table metric

	Signed-off-by: Yuxian Dai <Yuxian.Dai@amd.com>
	Reviewed-by: Alex Deucher <alexander.deucher@amd.com>
	Reviewed-by: Huang Rui <ray.huang@amd.com>
	Reviewed-by: Kevin Wang <Kevin1.Wang@amd.com>
	Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
(cherry picked from commit 575b0a6e6a2f35babc7991d8e63e701d2fec9d00)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/amd/display/dc/i2caux/dce110/i2c_sw_engine_dce110.h
#	drivers/gpu/drm/amd/powerplay/renoir_ppt.c
diff --cc drivers/gpu/drm/amd/display/dc/i2caux/dce110/i2c_sw_engine_dce110.h
index c48c61f540a8,89cd6da118a3..000000000000
--- a/drivers/gpu/drm/amd/display/dc/i2caux/dce110/i2c_sw_engine_dce110.h
+++ b/drivers/gpu/drm/amd/display/dc/i2caux/dce110/i2c_sw_engine_dce110.h
@@@ -19,25 -19,35 +19,47 @@@
   * ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
   * OTHER DEALINGS IN THE SOFTWARE.
   *
 + * Authors: AMD
 + *
   */
 -#ifndef __RENOIR_PPT_H__
 -#define __RENOIR_PPT_H__
  
 -extern void renoir_set_ppt_funcs(struct smu_context *smu);
 +#ifndef __DAL_I2C_SW_ENGINE_DCE110_H__
 +#define __DAL_I2C_SW_ENGINE_DCE110_H__
 +
 +struct i2c_sw_engine_dce110 {
 +	struct i2c_sw_engine base;
 +	uint32_t engine_id;
 +};
  
 -/* UMD PState Renoir Msg Parameters in MHz */
 -#define RENOIR_UMD_PSTATE_GFXCLK       700
 -#define RENOIR_UMD_PSTATE_SOCCLK       678
 -#define RENOIR_UMD_PSTATE_FCLK         800
++<<<<<<< HEAD:drivers/gpu/drm/amd/display/dc/i2caux/dce110/i2c_sw_engine_dce110.h
 +struct i2c_sw_engine_dce110_create_arg {
 +	uint32_t engine_id;
 +	uint32_t default_speed;
 +	struct dc_context *ctx;
 +};
  
 +struct i2c_engine *dal_i2c_sw_engine_dce110_create(
 +	const struct i2c_sw_engine_dce110_create_arg *arg);
++=======
+ #define GET_DPM_CUR_FREQ(table, clk_type, dpm_level, freq)		\
+ 	do {								\
+ 		switch (clk_type) {					\
+ 		case SMU_SOCCLK:					\
+ 			freq = table->SocClocks[dpm_level].Freq;	\
+ 			break;						\
+ 		case SMU_MCLK:						\
+ 			freq = table->FClocks[dpm_level].Freq;	\
+ 			break;						\
+ 		case SMU_DCEFCLK:					\
+ 			freq = table->DcfClocks[dpm_level].Freq;	\
+ 			break;						\
+ 		case SMU_FCLK:						\
+ 			freq = table->FClocks[dpm_level].Freq;		\
+ 			break;						\
+ 		default:						\
+ 			break;						\
+ 		}							\
+ 	} while (0)
++>>>>>>> 575b0a6e6a2f (drm/amdgpu/powerplay: using the FCLK DPM table to set the MCLK):drivers/gpu/drm/amd/powerplay/renoir_ppt.h
  
  #endif
* Unmerged path drivers/gpu/drm/amd/powerplay/renoir_ppt.c
* Unmerged path drivers/gpu/drm/amd/display/dc/i2caux/dce110/i2c_sw_engine_dce110.h
* Unmerged path drivers/gpu/drm/amd/powerplay/renoir_ppt.c
