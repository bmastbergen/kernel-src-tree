bpf: Enable retrival of pid/tgid/comm from bpf cgroup hooks

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Daniel Borkmann <daniel@iogearbox.net>
commit 834ebca8456c5f7a03d3351227b7c59318ccab62
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/834ebca8.failed

We already have the bpf_get_current_uid_gid() helper enabled, and
given we now have perf event RB output available for connect(),
sendmsg(), recvmsg() and bind-related hooks, add a trivial change
to enable bpf_get_current_pid_tgid() and bpf_get_current_comm()
as well.

	Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
	Signed-off-by: Alexei Starovoitov <ast@kernel.org>
	Acked-by: Andrii Nakryiko <andriin@fb.com>
Link: https://lore.kernel.org/bpf/18744744ed93c06343be8b41edcfd858706f39d7.1585323121.git.daniel@iogearbox.net
(cherry picked from commit 834ebca8456c5f7a03d3351227b7c59318ccab62)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/core/filter.c
diff --cc net/core/filter.c
index f77b9440c7a9,bb4a196c8809..000000000000
--- a/net/core/filter.c
+++ b/net/core/filter.c
@@@ -6040,8 -6014,20 +6040,21 @@@ sock_filter_func_proto(enum bpf_func_i
  		return &bpf_get_local_storage_proto;
  	case BPF_FUNC_get_socket_cookie:
  		return &bpf_get_socket_cookie_sock_proto;
 -	case BPF_FUNC_get_netns_cookie:
 -		return &bpf_get_netns_cookie_sock_proto;
  	case BPF_FUNC_perf_event_output:
  		return &bpf_event_output_data_proto;
++<<<<<<< HEAD
++=======
+ 	case BPF_FUNC_get_current_pid_tgid:
+ 		return &bpf_get_current_pid_tgid_proto;
+ 	case BPF_FUNC_get_current_comm:
+ 		return &bpf_get_current_comm_proto;
+ #ifdef CONFIG_CGROUPS
+ 	case BPF_FUNC_get_current_cgroup_id:
+ 		return &bpf_get_current_cgroup_id_proto;
+ 	case BPF_FUNC_get_current_ancestor_cgroup_id:
+ 		return &bpf_get_current_ancestor_cgroup_id_proto;
+ #endif
++>>>>>>> 834ebca8456c (bpf: Enable retrival of pid/tgid/comm from bpf cgroup hooks)
  #ifdef CONFIG_CGROUP_NET_CLASSID
  	case BPF_FUNC_get_cgroup_classid:
  		return &bpf_get_cgroup_classid_curr_proto;
@@@ -6074,6 -6062,16 +6087,19 @@@ sock_addr_func_proto(enum bpf_func_id f
  		return &bpf_get_local_storage_proto;
  	case BPF_FUNC_perf_event_output:
  		return &bpf_event_output_data_proto;
++<<<<<<< HEAD
++=======
+ 	case BPF_FUNC_get_current_pid_tgid:
+ 		return &bpf_get_current_pid_tgid_proto;
+ 	case BPF_FUNC_get_current_comm:
+ 		return &bpf_get_current_comm_proto;
+ #ifdef CONFIG_CGROUPS
+ 	case BPF_FUNC_get_current_cgroup_id:
+ 		return &bpf_get_current_cgroup_id_proto;
+ 	case BPF_FUNC_get_current_ancestor_cgroup_id:
+ 		return &bpf_get_current_ancestor_cgroup_id_proto;
+ #endif
++>>>>>>> 834ebca8456c (bpf: Enable retrival of pid/tgid/comm from bpf cgroup hooks)
  #ifdef CONFIG_CGROUP_NET_CLASSID
  	case BPF_FUNC_get_cgroup_classid:
  		return &bpf_get_cgroup_classid_curr_proto;
* Unmerged path net/core/filter.c
