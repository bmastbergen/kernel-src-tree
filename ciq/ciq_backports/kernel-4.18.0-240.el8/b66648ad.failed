gfs2: Move inode generation number check into gfs2_inode_lookup

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Andreas Gruenbacher <agruenba@redhat.com>
commit b66648ad6dcfefd9f02b5408c1381987c090cb13
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/b66648ad.failed

Move the inode generation number check from gfs2_lookup_by_inum into
gfs2_inode_lookup: gfs2_inode_lookup may be able to decide that an inode with
the given inode generation number cannot exist without having to verify the
block type or reading the inode from disk.

	Signed-off-by: Andreas Gruenbacher <agruenba@redhat.com>
(cherry picked from commit b66648ad6dcfefd9f02b5408c1381987c090cb13)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/gfs2/inode.c
diff --cc fs/gfs2/inode.c
index b0d12e170499,499f861b6e09..000000000000
--- a/fs/gfs2/inode.c
+++ b/fs/gfs2/inode.c
@@@ -220,12 -245,7 +240,14 @@@ struct inode *gfs2_lookup_by_inum(struc
  	if (IS_ERR(inode))
  		return inode;
  
- 	/* Two extra checks for NFS only */
  	if (no_formal_ino) {
++<<<<<<< HEAD
 +		error = -ESTALE;
 +		if (GFS2_I(inode)->i_no_formal_ino != *no_formal_ino)
 +			goto fail_iput;
 +
++=======
++>>>>>>> b66648ad6dcf (gfs2: Move inode generation number check into gfs2_inode_lookup)
  		error = -EIO;
  		if (GFS2_I(inode)->i_diskflags & GFS2_DIF_SYSTEM)
  			goto fail_iput;
* Unmerged path fs/gfs2/inode.c
