netfilter: flowtable: Add pending bit for offload work

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Paul Blakey <paulb@mellanox.com>
commit 2c8897953f3b2ff5498f3f275708a742bfcdbc24
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/2c889795.failed

Gc step can queue offloaded flow del work or stats work.
Those work items can race each other and a flow could be freed
before the stats work is executed and querying it.
To avoid that, add a pending bit that if a work exists for a flow
don't queue another work for it.
This will also avoid adding multiple stats works in case stats work
didn't complete but gc step started again.

	Signed-off-by: Paul Blakey <paulb@mellanox.com>
	Reviewed-by: Roi Dayan <roid@mellanox.com>
	Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
(cherry picked from commit 2c8897953f3b2ff5498f3f275708a742bfcdbc24)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/net/netfilter/nf_flow_table.h
#	net/netfilter/nf_flow_table_offload.c
diff --cc include/net/netfilter/nf_flow_table.h
index 4165d3a5a8ed,c54a7f707e50..000000000000
--- a/include/net/netfilter/nf_flow_table.h
+++ b/include/net/netfilter/nf_flow_table.h
@@@ -64,10 -119,16 +64,23 @@@ struct flow_offload_tuple_rhash 
  	struct flow_offload_tuple	tuple;
  };
  
++<<<<<<< HEAD
 +#define FLOW_OFFLOAD_SNAT	0x1
 +#define FLOW_OFFLOAD_DNAT	0x2
 +#define FLOW_OFFLOAD_DYING	0x4
 +#define FLOW_OFFLOAD_TEARDOWN	0x8
++=======
+ enum nf_flow_flags {
+ 	NF_FLOW_SNAT,
+ 	NF_FLOW_DNAT,
+ 	NF_FLOW_TEARDOWN,
+ 	NF_FLOW_HW,
+ 	NF_FLOW_HW_DYING,
+ 	NF_FLOW_HW_DEAD,
+ 	NF_FLOW_HW_REFRESH,
+ 	NF_FLOW_HW_PENDING,
+ };
++>>>>>>> 2c8897953f3b (netfilter: flowtable: Add pending bit for offload work)
  
  enum flow_offload_type {
  	NF_FLOW_OFFLOAD_UNSPEC	= 0,
* Unmerged path net/netfilter/nf_flow_table_offload.c
* Unmerged path include/net/netfilter/nf_flow_table.h
* Unmerged path net/netfilter/nf_flow_table_offload.c
