drm/amdgpu/display: use blanked rather than plane state for sync groups

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Alex Deucher <alexander.deucher@amd.com>
commit b7f839d292948142eaab77cedd031aad0bfec872
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/b7f839d2.failed

We may end up with no planes set yet, depending on the ordering, but we
should have the proper blanking state which is either handled by either
DPG or TG depending on the hardware generation.  Check both to determine
the proper blanked state.

Bug: https://gitlab.freedesktop.org/drm/amd/issues/781
Fixes: 5fc0cbfad45648 ("drm/amd/display: determine if a pipe is synced by plane state")
	Cc: nicholas.kazlauskas@amd.com
	Reviewed-by: Nicholas Kazlauskas <nicholas.kazlauskas@amd.com>
	Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
	Cc: stable@vger.kernel.org
(cherry picked from commit b7f839d292948142eaab77cedd031aad0bfec872)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/amd/display/dc/core/dc.c
diff --cc drivers/gpu/drm/amd/display/dc/core/dc.c
index 2edef284dd38,b4e2053bca9f..000000000000
--- a/drivers/gpu/drm/amd/display/dc/core/dc.c
+++ b/drivers/gpu/drm/amd/display/dc/core/dc.c
@@@ -886,11 -1016,17 +886,23 @@@ static void program_timing_sync
  			}
  		}
  
- 		/* set first pipe with plane as master */
+ 		/* set first unblanked pipe as master */
  		for (j = 0; j < group_size; j++) {
++<<<<<<< HEAD
 +			struct pipe_ctx *temp;
 +
 +			if (pipe_set[j]->plane_state) {
++=======
+ 			bool is_blanked;
+ 
+ 			if (pipe_set[j]->stream_res.opp->funcs->dpg_is_blanked)
+ 				is_blanked =
+ 					pipe_set[j]->stream_res.opp->funcs->dpg_is_blanked(pipe_set[j]->stream_res.opp);
+ 			else
+ 				is_blanked =
+ 					pipe_set[j]->stream_res.tg->funcs->is_blanked(pipe_set[j]->stream_res.tg);
+ 			if (!is_blanked) {
++>>>>>>> b7f839d29294 (drm/amdgpu/display: use blanked rather than plane state for sync groups)
  				if (j == 0)
  					break;
  
* Unmerged path drivers/gpu/drm/amd/display/dc/core/dc.c
