PCI/AER: Remove redundant dev->aer_cap checks

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-240.el8
commit-author Kuppuswamy Sathyanarayanan <sathyanarayanan.kuppuswamy@linux.intel.com>
commit af10cce7ad515aa819ee8a4ef6777c28b19ddfb7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-240.el8/af10cce7.failed

pcie_aer_get_firmware_first() checks dev->aer_cap, so we can remove
redundant dev->aer_cap checks in the callers.

Link: https://lore.kernel.org/r/d5ccc7a060ec9cdc234bdae7df8a0a4410f13f42.1590534843.git.sathyanarayanan.kuppuswamy@linux.intel.com
	Signed-off-by: Kuppuswamy Sathyanarayanan <sathyanarayanan.kuppuswamy@linux.intel.com>
	Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
(cherry picked from commit af10cce7ad515aa819ee8a4ef6777c28b19ddfb7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/pci/pcie/aer.c
diff --cc drivers/pci/pcie/aer.c
index 4bb737c9a96d,61e8cb23e98b..000000000000
--- a/drivers/pci/pcie/aer.c
+++ b/drivers/pci/pcie/aer.c
@@@ -346,16 -251,12 +346,20 @@@ void pci_aer_clear_device_status(struc
  	pcie_capability_write_word(dev, PCI_EXP_DEVSTA, sta);
  }
  
 -int pci_aer_clear_nonfatal_status(struct pci_dev *dev)
 +int pci_cleanup_aer_uncorrect_error_status(struct pci_dev *dev)
  {
- 	int pos;
+ 	int pos = dev->aer_cap;
  	u32 status, sev;
  
++<<<<<<< HEAD
 +	pos = dev->aer_cap;
 +	if (!pos)
 +		return -EIO;
 +
 +	if (pcie_aer_get_firmware_first(dev))
++=======
+ 	if (!pcie_aer_is_native(dev))
++>>>>>>> af10cce7ad51 (PCI/AER: Remove redundant dev->aer_cap checks)
  		return -EIO;
  
  	/* Clear status bits for ERR_NONFATAL errors only */
@@@ -371,14 -272,10 +375,18 @@@ EXPORT_SYMBOL_GPL(pci_cleanup_aer_uncor
  
  void pci_aer_clear_fatal_status(struct pci_dev *dev)
  {
- 	int pos;
+ 	int pos = dev->aer_cap;
  	u32 status, sev;
  
++<<<<<<< HEAD
 +	pos = dev->aer_cap;
 +	if (!pos)
 +		return;
 +
 +	if (pcie_aer_get_firmware_first(dev))
++=======
+ 	if (!pcie_aer_is_native(dev))
++>>>>>>> af10cce7ad51 (PCI/AER: Remove redundant dev->aer_cap checks)
  		return;
  
  	/* Clear status bits for ERR_FATAL errors only */
* Unmerged path drivers/pci/pcie/aer.c
