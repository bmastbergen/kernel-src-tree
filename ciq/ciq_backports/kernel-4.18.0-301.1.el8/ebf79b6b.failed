net/mlx5e: Fix CQ params of ICOSQ and async ICOSQ

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-301.1.el8
commit-author Maxim Mikityanskiy <maximmi@mellanox.com>
commit ebf79b6be67c0a77a9ab7cdf74c43fd7d9619f0c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-301.1.el8/ebf79b6b.failed

The commit mentioned below has split the parameters of ICOSQ and async
ICOSQ, but it contained a typo: the CQ parameters were swapped for ICOSQ
and async ICOSQ. Async ICOSQ is longer than the normal ICOSQ, and the CQ
size must be the same as the size of the corresponding SQ, but due to
this bug, the CQ of async ICOSQ was much shorter than async ICOSQ
itself. It led to overflows of the CQ with such messages in dmesg, in
particular, when running multiple kTLS-offloaded streams:

mlx5_core 0000:08:00.0: cq_err_event_notifier:529:(pid 9422): CQ error
on CQN 0x406, syndrome 0x1
mlx5_core 0000:08:00.0 eth2: mlx5e_cq_error_event: cqn=0x000406
event=0x04

This commit fixes the issue by using the corresponding parameters for
ICOSQ and async ICOSQ.

Fixes: c293ac927fbb ("net/mlx5e: Refactor build channel params")
	Signed-off-by: Maxim Mikityanskiy <maximmi@mellanox.com>
	Reviewed-by: Tariq Toukan <tariqt@nvidia.com>
	Signed-off-by: Saeed Mahameed <saeedm@nvidia.com>
(cherry picked from commit ebf79b6be67c0a77a9ab7cdf74c43fd7d9619f0c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/en_main.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/en_main.c
index d535d3d5edbb,a2e0b548bf57..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/en_main.c
@@@ -1832,13 -1822,18 +1832,25 @@@ static int mlx5e_open_queues(struct mlx
  			     struct mlx5e_channel_param *cparam)
  {
  	struct dim_cq_moder icocq_moder = {0, 0};
 -	struct mlx5e_create_cq_param ccp;
  	int err;
  
++<<<<<<< HEAD
 +	err = mlx5e_open_cq(c, icocq_moder, &cparam->icosq.cqp, &c->async_icosq.cq);
 +	if (err)
 +		return err;
 +
 +	err = mlx5e_open_cq(c, icocq_moder, &cparam->async_icosq.cqp, &c->icosq.cq);
++=======
+ 	mlx5e_build_create_cq_param(&ccp, c);
+ 
+ 	err = mlx5e_open_cq(c->priv, icocq_moder, &cparam->async_icosq.cqp, &ccp,
+ 			    &c->async_icosq.cq);
+ 	if (err)
+ 		return err;
+ 
+ 	err = mlx5e_open_cq(c->priv, icocq_moder, &cparam->icosq.cqp, &ccp,
+ 			    &c->icosq.cq);
++>>>>>>> ebf79b6be67c (net/mlx5e: Fix CQ params of ICOSQ and async ICOSQ)
  	if (err)
  		goto err_close_async_icosq_cq;
  
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/en_main.c
