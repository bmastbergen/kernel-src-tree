rtc: disallow update interrupts when time is invalid

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-301.1.el8
commit-author Alexandre Belloni <alexandre.belloni@bootlin.com>
commit 3e74ddaa7ca06f4c41bc3c83286534cb7ebc90eb
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-301.1.el8/3e74ddaa.failed

Never enable update interrupts when the time set on the rtc is invalid.
In that case, also avoid enabling the emulation because it will fail for
the same reason.

Link: https://lore.kernel.org/r/20191021155631.3342-2-alexandre.belloni@bootlin.com
Link: https://lore.kernel.org/r/CA+ASDXMarBG5C1Kz42B9i_iVZ1=i6GgH9Yja2cdmSueKD_As_g@mail.gmail.com
	Reported-by: Jeffy Chen <jeffy.chen@rock-chips.com>
	Reported-by: Brian Norris <briannorris@chromium.org>
	Signed-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
(cherry picked from commit 3e74ddaa7ca06f4c41bc3c83286534cb7ebc90eb)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/rtc/interface.c
diff --cc drivers/rtc/interface.c
index b2392af7d151,bd8034b7bc93..000000000000
--- a/drivers/rtc/interface.c
+++ b/drivers/rtc/interface.c
@@@ -556,7 -545,9 +556,13 @@@ EXPORT_SYMBOL_GPL(rtc_alarm_irq_enable)
  
  int rtc_update_irq_enable(struct rtc_device *rtc, unsigned int enabled)
  {
++<<<<<<< HEAD
 +	int err = mutex_lock_interruptible(&rtc->ops_lock);
++=======
+ 	int rc = 0, err;
+ 
+ 	err = mutex_lock_interruptible(&rtc->ops_lock);
++>>>>>>> 3e74ddaa7ca0 (rtc: disallow update interrupts when time is invalid)
  	if (err)
  		return err;
  
* Unmerged path drivers/rtc/interface.c
