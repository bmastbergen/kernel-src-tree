Revert "e1000e: disable s0ix entry and exit flows for ME systems"

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-301.1.el8
commit-author Mario Limonciello <mario.limonciello@dell.com>
commit 6cecf02e77ab9bf97e9252f9fcb8f0738a6de12c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-301.1.el8/6cecf02e.failed

commit e086ba2fccda ("e1000e: disable s0ix entry and exit flows for ME
systems") disabled s0ix flows for systems that have various incarnations of
the i219-LM ethernet controller.  This changed caused power consumption
regressions on the following shipping Dell Comet Lake based laptops:
* Latitude 5310
* Latitude 5410
* Latitude 5410
* Latitude 5510
* Precision 3550
* Latitude 5411
* Latitude 5511
* Precision 3551
* Precision 7550
* Precision 7750

This commit was introduced because of some regressions on certain Thinkpad
laptops.  This comment was potentially caused by an earlier
commit 632fbd5eb5b0e ("e1000e: fix S0ix flows for cable connected case").
or it was possibly caused by a system not meeting platform architectural
requirements for low power consumption.  Other changes made in the driver
with extended timeouts are expected to make the driver more impervious to
platform firmware behavior.

Fixes: e086ba2fccda ("e1000e: disable s0ix entry and exit flows for ME systems")
	Reviewed-by: Alexander Duyck <alexander.duyck@gmail.com>
	Signed-off-by: Mario Limonciello <mario.limonciello@dell.com>
	Reviewed-by: Hans de Goede <hdegoede@redhat.com>
	Tested-by: Yijun Shen <Yijun.shen@dell.com>
	Signed-off-by: Tony Nguyen <anthony.l.nguyen@intel.com>
(cherry picked from commit 6cecf02e77ab9bf97e9252f9fcb8f0738a6de12c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/e1000e/netdev.c
diff --cc drivers/net/ethernet/intel/e1000e/netdev.c
index 128ab6898070,b9800ba2006c..000000000000
--- a/drivers/net/ethernet/intel/e1000e/netdev.c
+++ b/drivers/net/ethernet/intel/e1000e/netdev.c
@@@ -6970,13 -6931,13 +6931,21 @@@ static __maybe_unused int e1000e_pm_sus
  	e1000e_pm_freeze(dev);
  
  	rc = __e1000_shutdown(pdev, false);
 -	if (rc) {
 +	if (rc)
  		e1000e_pm_thaw(dev);
++<<<<<<< HEAD
 +
 +	/* Introduce S0ix implementation */
 +	if (hw->mac.type >= e1000_pch_cnp &&
 +	    !e1000e_check_me(hw->adapter->pdev->device))
 +		e1000e_s0ix_entry_flow(adapter);
++=======
+ 	} else {
+ 		/* Introduce S0ix implementation */
+ 		if (hw->mac.type >= e1000_pch_cnp)
+ 			e1000e_s0ix_entry_flow(adapter);
+ 	}
++>>>>>>> 6cecf02e77ab (Revert "e1000e: disable s0ix entry and exit flows for ME systems")
  
  	return rc;
  }
* Unmerged path drivers/net/ethernet/intel/e1000e/netdev.c
