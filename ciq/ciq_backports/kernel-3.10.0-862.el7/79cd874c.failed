netvsc: fix hang on netvsc module removal

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author stephen hemminger <stephen@networkplumber.org>
commit 79cd874c96b38694fb2b4ee3850f6fbbc3015439
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/79cd874c.failed

The code in netvsc_device_remove was incorrectly calling napi_disable
repeatedly on the same element. This would cause attempts
to remove netvsc module to hang.

Fixes: 2506b1dc4bbe ("netvsc: implement NAPI")
	Signed-off-by: Stephen Hemminger <sthemmin@microsoft.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 79cd874c96b38694fb2b4ee3850f6fbbc3015439)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/hyperv/netvsc.c
diff --cc drivers/net/hyperv/netvsc.c
index 2adfe0ec4fe2,8f9aeec2ce0f..000000000000
--- a/drivers/net/hyperv/netvsc.c
+++ b/drivers/net/hyperv/netvsc.c
@@@ -583,8 -562,10 +583,14 @@@ void netvsc_device_remove(struct hv_dev
  	/* Now, we can close the channel safely */
  	vmbus_close(device->channel);
  
++<<<<<<< HEAD
++=======
+ 	for (i = 0; i < net_device->num_chn; i++)
+ 		napi_disable(&net_device->chan_table[i].napi);
+ 
++>>>>>>> 79cd874c96b3 (netvsc: fix hang on netvsc module removal)
  	/* Release all resources */
 +	vfree(net_device->sub_cb_buf);
  	free_netvsc_device(net_device);
  }
  
* Unmerged path drivers/net/hyperv/netvsc.c
