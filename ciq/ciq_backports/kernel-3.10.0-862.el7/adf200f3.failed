devlink: fix the name of eswitch commands

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Jiri Pirko <jiri@mellanox.com>
commit adf200f31c000d707e4afe238ed1d1199e0cce7c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/adf200f3.failed

The eswitch_[gs]et command is supposed to be similar to port_[gs]et
command - for multiple eswitch attributes. However, when it was introduced
by 08f4b5918b2d ("net/devlink: Add E-Switch mode control") it was wrongly
named with the word "mode" in it. So fix this now, make the oririnal
enum value existing but obsolete.

	Signed-off-by: Jiri Pirko <jiri@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit adf200f31c000d707e4afe238ed1d1199e0cce7c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/core/devlink.c
diff --cc net/core/devlink.c
index a17fcd87f267,7aa8e5369dc5..000000000000
--- a/net/core/devlink.c
+++ b/net/core/devlink.c
@@@ -1648,6 -1628,34 +1648,37 @@@ static const struct genl_ops devlink_nl
  				  DEVLINK_NL_FLAG_NEED_SB |
  				  DEVLINK_NL_FLAG_LOCK_PORTS,
  	},
++<<<<<<< HEAD
++=======
+ 	{
+ 		.cmd = DEVLINK_CMD_ESWITCH_GET,
+ 		.doit = devlink_nl_cmd_eswitch_get_doit,
+ 		.policy = devlink_nl_policy,
+ 		.flags = GENL_ADMIN_PERM,
+ 		.internal_flags = DEVLINK_NL_FLAG_NEED_DEVLINK,
+ 	},
+ 	{
+ 		.cmd = DEVLINK_CMD_ESWITCH_SET,
+ 		.doit = devlink_nl_cmd_eswitch_set_doit,
+ 		.policy = devlink_nl_policy,
+ 		.flags = GENL_ADMIN_PERM,
+ 		.internal_flags = DEVLINK_NL_FLAG_NEED_DEVLINK,
+ 	},
+ };
+ 
+ static struct genl_family devlink_nl_family __ro_after_init = {
+ 	.name		= DEVLINK_GENL_NAME,
+ 	.version	= DEVLINK_GENL_VERSION,
+ 	.maxattr	= DEVLINK_ATTR_MAX,
+ 	.netnsok	= true,
+ 	.pre_doit	= devlink_nl_pre_doit,
+ 	.post_doit	= devlink_nl_post_doit,
+ 	.module		= THIS_MODULE,
+ 	.ops		= devlink_nl_ops,
+ 	.n_ops		= ARRAY_SIZE(devlink_nl_ops),
+ 	.mcgrps		= devlink_nl_mcgrps,
+ 	.n_mcgrps	= ARRAY_SIZE(devlink_nl_mcgrps),
++>>>>>>> adf200f31c00 (devlink: fix the name of eswitch commands)
  };
  
  /**
diff --git a/include/uapi/linux/devlink.h b/include/uapi/linux/devlink.h
index 9014c33d4e77..0f1f3a12e23c 100644
--- a/include/uapi/linux/devlink.h
+++ b/include/uapi/linux/devlink.h
@@ -57,8 +57,14 @@ enum devlink_command {
 	DEVLINK_CMD_SB_OCC_SNAPSHOT,
 	DEVLINK_CMD_SB_OCC_MAX_CLEAR,
 
-	DEVLINK_CMD_ESWITCH_MODE_GET,
-	DEVLINK_CMD_ESWITCH_MODE_SET,
+	DEVLINK_CMD_ESWITCH_GET,
+#define DEVLINK_CMD_ESWITCH_MODE_GET /* obsolete, never use this! */ \
+	DEVLINK_CMD_ESWITCH_GET
+
+	DEVLINK_CMD_ESWITCH_SET,
+#define DEVLINK_CMD_ESWITCH_MODE_SET /* obsolete, never use this! */ \
+	DEVLINK_CMD_ESWITCH_SET
+
 	/* add new commands above here */
 
 	__DEVLINK_CMD_MAX,
* Unmerged path net/core/devlink.c
