audit: Abstract hash key handling

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Jan Kara <jack@suse.cz>
commit f410ff65548c548fed5f7e38c4ef57a73ebfe3bd
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/f410ff65.failed

Audit tree currently uses inode pointer as a key into the hash table.
Getting that from notification mark will be somewhat more difficult with
coming fsnotify changes. So abstract getting of hash key from the audit
chunk and inode so that we can change the method to obtain a key easily.

	Reviewed-by: Miklos Szeredi <mszeredi@redhat.com>
CC: Paul Moore <paul@paul-moore.com>
	Acked-by: Paul Moore <paul@paul-moore.com>
	Signed-off-by: Jan Kara <jack@suse.cz>
(cherry picked from commit f410ff65548c548fed5f7e38c4ef57a73ebfe3bd)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	kernel/audit_tree.c
diff --cc kernel/audit_tree.c
index 4dfdb945bae9,11c7ac441624..000000000000
--- a/kernel/audit_tree.c
+++ b/kernel/audit_tree.c
@@@ -587,7 -603,8 +602,12 @@@ int audit_remove_tree_rule(struct audit
  
  static int compare_root(struct vfsmount *mnt, void *arg)
  {
++<<<<<<< HEAD
 +	return mnt->mnt_root->d_inode == arg;
++=======
+ 	return inode_to_key(d_backing_inode(mnt->mnt_root)) ==
+ 	       (unsigned long)arg;
++>>>>>>> f410ff65548c (audit: Abstract hash key handling)
  }
  
  void audit_trim_trees(void)
* Unmerged path kernel/audit_tree.c
