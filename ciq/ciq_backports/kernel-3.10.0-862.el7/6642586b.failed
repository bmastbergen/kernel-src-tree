ext4: add ext4_should_use_dax()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Ross Zwisler <ross.zwisler@linux.intel.com>
commit 6642586b3e5f9e0b559d20352d8d42ad84224d1f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/6642586b.failed

This helper, in the spirit of ext4_should_dioread_nolock() et al., replaces
the complex conditional in ext4_set_inode_flags().

	Signed-off-by: Ross Zwisler <ross.zwisler@linux.intel.com>
	Signed-off-by: Theodore Ts'o <tytso@mit.edu>
	Reviewed-by: Jan Kara <jack@suse.cz>
(cherry picked from commit 6642586b3e5f9e0b559d20352d8d42ad84224d1f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/ext4/inode.c
diff --cc fs/ext4/inode.c
index f49ba18669c7,9f836e2ec18c..000000000000
--- a/fs/ext4/inode.c
+++ b/fs/ext4/inode.c
@@@ -4097,8 -4640,7 +4112,12 @@@ void ext4_set_inode_flags(struct inode 
  		new_fl |= S_NOATIME;
  	if (flags & EXT4_DIRSYNC_FL)
  		new_fl |= S_DIRSYNC;
++<<<<<<< HEAD
 +	if (test_opt(inode->i_sb, DAX) && S_ISREG(inode->i_mode) &&
 +	    !ext4_should_journal_data(inode) && !ext4_has_inline_data(inode))
++=======
+ 	if (ext4_should_use_dax(inode))
++>>>>>>> 6642586b3e5f (ext4: add ext4_should_use_dax())
  		new_fl |= S_DAX;
  	inode_set_flags(inode, new_fl,
  			S_SYNC|S_APPEND|S_IMMUTABLE|S_NOATIME|S_DIRSYNC|S_DAX);
* Unmerged path fs/ext4/inode.c
