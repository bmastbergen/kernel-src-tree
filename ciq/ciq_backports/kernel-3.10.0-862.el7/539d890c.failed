scsi: cxlflash: Update cxlflash_afu_sync() to return errno

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [scsi] cxlflash: Update cxlflash_afu_sync() to return errno (Gustavo Duarte) [1456494]
Rebuild_FUZZ: 94.55%
commit-author Uma Krishnan <ukrishn@linux.vnet.ibm.com>
commit 539d890cecee6b5d7304914afc51b7f53150163d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/539d890c.failed

The cxlflash_afu_sync() routine returns a negative one to indicate any kind
of failure. This makes it impossible to establish why the error occurred.

Update the return codes to clearly indicate the failure cause to the
caller.

	Signed-off-by: Uma Krishnan <ukrishn@linux.vnet.ibm.com>
	Acked-by: Matthew R. Ochs <mrochs@linux.vnet.ibm.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit 539d890cecee6b5d7304914afc51b7f53150163d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/cxlflash/main.c
diff --cc drivers/scsi/cxlflash/main.c
index c68badcfa77f,815d04b3e7aa..000000000000
--- a/drivers/scsi/cxlflash/main.c
+++ b/drivers/scsi/cxlflash/main.c
@@@ -1843,20 -2069,20 +1842,33 @@@ int cxlflash_afu_sync(struct afu *afu, 
  	*((__be16 *)&cmd->rcb.cdb[2]) = cpu_to_be16(ctx_hndl_u);
  	*((__be32 *)&cmd->rcb.cdb[4]) = cpu_to_be32(res_hndl_u);
  
++<<<<<<< HEAD
 +	rc = send_cmd(afu, cmd);
 +	if (unlikely(rc))
++=======
+ 	rc = afu->send_cmd(afu, cmd);
+ 	if (unlikely(rc)) {
+ 		rc = -ENOBUFS;
++>>>>>>> 539d890cecee (scsi: cxlflash: Update cxlflash_afu_sync() to return errno)
  		goto out;
+ 	}
  
++<<<<<<< HEAD
 +	wait_resp(afu, cmd);
 +
 +	/* Set on timeout */
 +	if (unlikely((cmd->sa.ioasc != 0) ||
 +		     (cmd->sa.host_use_b[0] & B_ERROR)))
 +		rc = -1;
++=======
+ 	rc = wait_resp(afu, cmd);
+ 	if (unlikely(rc))
+ 		rc = -EIO;
++>>>>>>> 539d890cecee (scsi: cxlflash: Update cxlflash_afu_sync() to return errno)
  out:
 -	atomic_dec(&afu->cmds_active);
  	mutex_unlock(&sync_active);
  	kfree(buf);
 -	dev_dbg(dev, "%s: returning rc=%d\n", __func__, rc);
 +	pr_debug("%s: returning rc=%d\n", __func__, rc);
  	return rc;
  }
  
* Unmerged path drivers/scsi/cxlflash/main.c
