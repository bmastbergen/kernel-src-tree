ALSA: x86: Don't return an error from chmap ctl at disconnected

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Takashi Iwai <tiwai@suse.de>
commit a72ccfbad7fd6f604d8edd068119edb57e7984e1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/a72ccfba.failed

It's not wise to return an error at info/get callback when
disconnected, which happens at any time.
The chmap ctl is supposed to fill zero for such a case, instead.

	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit a72ccfbad7fd6f604d8edd068119edb57e7984e1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/x86/intel_hdmi_audio.c
diff --cc sound/x86/intel_hdmi_audio.c
index 3dd33e089501,71f01204a590..000000000000
--- a/sound/x86/intel_hdmi_audio.c
+++ b/sound/x86/intel_hdmi_audio.c
@@@ -532,11 -504,6 +532,14 @@@ void had_build_channel_allocation_map(s
  static int had_chmap_ctl_info(struct snd_kcontrol *kcontrol,
  				struct snd_ctl_elem_info *uinfo)
  {
++<<<<<<< HEAD
 +	struct snd_pcm_chmap *info = snd_kcontrol_chip(kcontrol);
 +	struct snd_intelhad *intelhaddata = info->private_data;
 +
 +	if (intelhaddata->drv_status == HAD_DRV_DISCONNECTED)
 +		return -ENODEV;
++=======
++>>>>>>> a72ccfbad7fd (ALSA: x86: Don't return an error from chmap ctl at disconnected)
  	uinfo->type = SNDRV_CTL_ELEM_TYPE_INTEGER;
  	uinfo->count = HAD_MAX_CHANNEL;
  	uinfo->value.integer.min = 0;
@@@ -549,18 -516,21 +552,29 @@@ static int had_chmap_ctl_get(struct snd
  {
  	struct snd_pcm_chmap *info = snd_kcontrol_chip(kcontrol);
  	struct snd_intelhad *intelhaddata = info->private_data;
 -	int i;
 +	int i = 0;
  	const struct snd_pcm_chmap_elem *chmap;
  
++<<<<<<< HEAD
 +	if (intelhaddata->drv_status == HAD_DRV_DISCONNECTED)
 +		return -ENODEV;
 +	if (intelhaddata->chmap->chmap ==  NULL)
 +		return -ENODATA;
++=======
+ 	memset(ucontrol->value.integer.value, 0,
+ 	       sizeof(long) * HAD_MAX_CHANNEL);
+ 	mutex_lock(&intelhaddata->mutex);
+ 	if (!intelhaddata->chmap->chmap) {
+ 		mutex_unlock(&intelhaddata->mutex);
+ 		return 0;
+ 	}
+ 
++>>>>>>> a72ccfbad7fd (ALSA: x86: Don't return an error from chmap ctl at disconnected)
  	chmap = intelhaddata->chmap->chmap;
 -	for (i = 0; i < chmap->channels; i++)
 +	for (i = 0; i < chmap->channels; i++) {
  		ucontrol->value.integer.value[i] = chmap->map[i];
 -	mutex_unlock(&intelhaddata->mutex);
 +		pr_debug("chmap->map[%d] = %d\n", i, chmap->map[i]);
 +	}
  
  	return 0;
  }
* Unmerged path sound/x86/intel_hdmi_audio.c
