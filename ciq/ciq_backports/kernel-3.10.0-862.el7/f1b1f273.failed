mlxsw: spectrum_router: Simplify a piece of code

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Petr Machata <petrm@mellanox.com>
commit f1b1f273aec0478c17ead69c5f285edd495d3d58
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/f1b1f273.failed

	Signed-off-by: Petr Machata <petrm@mellanox.com>
	Reviewed-by: Ido Schimmel <idosch@mellanox.com>
	Signed-off-by: Jiri Pirko <jiri@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit f1b1f273aec0478c17ead69c5f285edd495d3d58)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
diff --cc drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
index d4e543d198c7,600268cf4fa1..000000000000
--- a/drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
+++ b/drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
@@@ -2732,24 -3107,36 +2732,28 @@@ static int mlxsw_sp_router_rif_disable(
  }
  
  static void mlxsw_sp_router_rif_gone_sync(struct mlxsw_sp *mlxsw_sp,
 -					  struct mlxsw_sp_rif *rif)
 +					  struct mlxsw_sp_rif *r)
  {
 -	mlxsw_sp_router_rif_disable(mlxsw_sp, rif->rif_index);
 -	mlxsw_sp_nexthop_rif_gone_sync(mlxsw_sp, rif);
 -	mlxsw_sp_neigh_rif_gone_sync(mlxsw_sp, rif);
 +	mlxsw_sp_router_rif_disable(mlxsw_sp, r->rif);
 +	mlxsw_sp_nexthop_rif_gone_sync(mlxsw_sp, r);
 +	mlxsw_sp_neigh_rif_gone_sync(mlxsw_sp, r);
  }
  
 -static bool
 -mlxsw_sp_rif_should_config(struct mlxsw_sp_rif *rif, struct net_device *dev,
 -			   unsigned long event)
 +static bool mlxsw_sp_rif_should_config(struct mlxsw_sp_rif *r,
 +				       const struct in_device *in_dev,
 +				       unsigned long event)
  {
 -	struct inet6_dev *inet6_dev;
 -	bool addr_list_empty = true;
 -	struct in_device *idev;
 -
  	switch (event) {
  	case NETDEV_UP:
++<<<<<<< HEAD
 +		if (!r)
 +			return true;
 +		return false;
++=======
+ 		return rif == NULL;
++>>>>>>> f1b1f273aec0 (mlxsw: spectrum_router: Simplify a piece of code)
  	case NETDEV_DOWN:
 -		idev = __in_dev_get_rtnl(dev);
 -		if (idev && idev->ifa_list)
 -			addr_list_empty = false;
 -
 -		inet6_dev = __in6_dev_get(dev);
 -		if (addr_list_empty && inet6_dev &&
 -		    !list_empty(&inet6_dev->addr_list))
 -			addr_list_empty = false;
 -
 -		if (rif && addr_list_empty &&
 -		    !netif_is_l3_slave(rif->dev))
 +		if (r && !in_dev->ifa_list && !netif_is_l3_slave(r->dev))
  			return true;
  		/* It is possible we already removed the RIF ourselves
  		 * if it was assigned to a netdev that is now a bridge
* Unmerged path drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
