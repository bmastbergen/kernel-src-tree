ipv4: fib: Set offload indication according to nexthop flags

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Ido Schimmel <idosch@mellanox.com>
commit 475abbf1ef67fdf35eed0720adcf59ed25ad924e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/475abbf1.failed

We're going to have capable drivers indicate route offload using the
nexthop flags, but for non-multipath routes these flags aren't dumped to
user space.

Instead, set the offload indication in the route message flags.

	Signed-off-by: Ido Schimmel <idosch@mellanox.com>
	Signed-off-by: Jiri Pirko <jiri@mellanox.com>
	Acked-by: David Ahern <dsahern@gmail.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 475abbf1ef67fdf35eed0720adcf59ed25ad924e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv4/fib_semantics.c
diff --cc net/ipv4/fib_semantics.c
index 22ec44cc4020,f62dc2463280..000000000000
--- a/net/ipv4/fib_semantics.c
+++ b/net/ipv4/fib_semantics.c
@@@ -1193,6 -1336,14 +1193,17 @@@ int fib_dump_info(struct sk_buff *skb, 
  		if (fi->fib_nh->nh_oif &&
  		    nla_put_u32(skb, RTA_OIF, fi->fib_nh->nh_oif))
  			goto nla_put_failure;
++<<<<<<< HEAD
++=======
+ 		if (fi->fib_nh->nh_flags & RTNH_F_LINKDOWN) {
+ 			in_dev = __in_dev_get_rtnl(fi->fib_nh->nh_dev);
+ 			if (in_dev &&
+ 			    IN_DEV_IGNORE_ROUTES_WITH_LINKDOWN(in_dev))
+ 				rtm->rtm_flags |= RTNH_F_DEAD;
+ 		}
+ 		if (fi->fib_nh->nh_flags & RTNH_F_OFFLOAD)
+ 			rtm->rtm_flags |= RTNH_F_OFFLOAD;
++>>>>>>> 475abbf1ef67 (ipv4: fib: Set offload indication according to nexthop flags)
  #ifdef CONFIG_IP_ROUTE_CLASSID
  		if (fi->fib_nh[0].nh_tclassid &&
  		    nla_put_u32(skb, RTA_FLOW, fi->fib_nh[0].nh_tclassid))
* Unmerged path net/ipv4/fib_semantics.c
