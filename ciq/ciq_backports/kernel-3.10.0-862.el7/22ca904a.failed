genetlink: fix error return code in genl_register_family()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Wei Yongjun <weiyongjun1@huawei.com>
commit 22ca904ad70afc831d8503e80be1b6558a978759
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/22ca904a.failed

Fix to return a negative error code from the idr_alloc() error handling
case instead of 0, as done elsewhere in this function.

Also fix the return value check of idr_alloc() since idr_alloc return
negative errors on failure, not zero.

Fixes: 2ae0f17df1cd ("genetlink: use idr to track families")
	Signed-off-by: Wei Yongjun <weiyongjun1@huawei.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 22ca904ad70afc831d8503e80be1b6558a978759)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/netlink/genetlink.c
diff --cc net/netlink/genetlink.c
index a93aabe188f7,bbd3bff885a1..000000000000
--- a/net/netlink/genetlink.c
+++ b/net/netlink/genetlink.c
@@@ -399,11 -360,17 +399,21 @@@ int __genl_register_family(struct genl_
  	} else
  		family->attrbuf = NULL;
  
++<<<<<<< HEAD
++=======
+ 	family->id = idr_alloc(&genl_fam_idr, family,
+ 			       start, end + 1, GFP_KERNEL);
+ 	if (family->id < 0) {
+ 		err = family->id;
+ 		goto errout_locked;
+ 	}
+ 
++>>>>>>> 22ca904ad70a (genetlink: fix error return code in genl_register_family())
  	err = genl_validate_assign_mc_groups(family);
  	if (err)
 -		goto errout_remove;
 +		goto errout_locked;
  
 +	list_add_tail(&family->family_list, genl_family_chain(family->id));
  	genl_unlock_all();
  
  	/* send all events */
* Unmerged path net/netlink/genetlink.c
