drm/i915: add DP support in LPE audio mode

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [sound] alsa: drm/i915: add DP support in LPE audio mode (Jaroslav Kysela) [1463624]
Rebuild_FUZZ: 93.33%
commit-author Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
commit b5f2be9ae5bf88f5751cc9f5813ed28e7f87402d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/b5f2be9a.failed

If DisplayPort is detected, pass flag and link rate to audio driver

	Signed-off-by: Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>
	Acked-by: Ville Syrjälä <ville.syrjala@linux.intel.com>
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit b5f2be9ae5bf88f5751cc9f5813ed28e7f87402d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/i915/i915_drv.h
#	drivers/gpu/drm/i915/intel_audio.c
#	drivers/gpu/drm/i915/intel_lpe_audio.c
#	include/drm/intel_lpe_audio.h
diff --cc drivers/gpu/drm/i915/i915_drv.h
index c383dcb3961f,836d823d476b..000000000000
--- a/drivers/gpu/drm/i915/i915_drv.h
+++ b/drivers/gpu/drm/i915/i915_drv.h
@@@ -3388,6 -3396,14 +3388,17 @@@ extern int i915_restore_state(struct dr
  void i915_setup_sysfs(struct drm_i915_private *dev_priv);
  void i915_teardown_sysfs(struct drm_i915_private *dev_priv);
  
++<<<<<<< HEAD
++=======
+ /* intel_lpe_audio.c */
+ int  intel_lpe_audio_init(struct drm_i915_private *dev_priv);
+ void intel_lpe_audio_teardown(struct drm_i915_private *dev_priv);
+ void intel_lpe_audio_irq_handler(struct drm_i915_private *dev_priv);
+ void intel_lpe_audio_notify(struct drm_i915_private *dev_priv,
+ 			    void *eld, int port, int tmds_clk_speed,
+ 			    bool dp_output, int link_rate);
+ 
++>>>>>>> b5f2be9ae5bf (drm/i915: add DP support in LPE audio mode)
  /* intel_i2c.c */
  extern int intel_setup_gmbus(struct drm_device *dev);
  extern void intel_teardown_gmbus(struct drm_device *dev);
diff --cc drivers/gpu/drm/i915/intel_audio.c
index 49f10538d4aa,1645ce42b898..000000000000
--- a/drivers/gpu/drm/i915/intel_audio.c
+++ b/drivers/gpu/drm/i915/intel_audio.c
@@@ -630,6 -631,20 +630,23 @@@ void intel_audio_codec_enable(struct in
  	if (acomp && acomp->audio_ops && acomp->audio_ops->pin_eld_notify)
  		acomp->audio_ops->pin_eld_notify(acomp->audio_ops->audio_ptr,
  						 (int) port, (int) pipe);
++<<<<<<< HEAD
++=======
+ 	switch (intel_encoder->type) {
+ 	case INTEL_OUTPUT_HDMI:
+ 		intel_lpe_audio_notify(dev_priv, connector->eld, port,
+ 				       crtc_state->port_clock,
+ 				       false, 0);
+ 		break;
+ 	case INTEL_OUTPUT_DP:
+ 		intel_lpe_audio_notify(dev_priv, connector->eld, port,
+ 				       adjusted_mode->crtc_clock,
+ 				       true, crtc_state->port_clock);
+ 		break;
+ 	default:
+ 		break;
+ 	}
++>>>>>>> b5f2be9ae5bf (drm/i915: add DP support in LPE audio mode)
  }
  
  /**
@@@ -663,6 -678,8 +680,11 @@@ void intel_audio_codec_disable(struct i
  	if (acomp && acomp->audio_ops && acomp->audio_ops->pin_eld_notify)
  		acomp->audio_ops->pin_eld_notify(acomp->audio_ops->audio_ptr,
  						 (int) port, (int) pipe);
++<<<<<<< HEAD
++=======
+ 
+ 	intel_lpe_audio_notify(dev_priv, NULL, port, 0, false, 0);
++>>>>>>> b5f2be9ae5bf (drm/i915: add DP support in LPE audio mode)
  }
  
  /**
* Unmerged path drivers/gpu/drm/i915/intel_lpe_audio.c
* Unmerged path include/drm/intel_lpe_audio.h
* Unmerged path drivers/gpu/drm/i915/i915_drv.h
* Unmerged path drivers/gpu/drm/i915/intel_audio.c
* Unmerged path drivers/gpu/drm/i915/intel_lpe_audio.c
* Unmerged path include/drm/intel_lpe_audio.h
