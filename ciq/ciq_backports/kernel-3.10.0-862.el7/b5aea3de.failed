ixgbe: Fix cls_u32 offload support for L4 ports

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Sridhar Samudrala <sridhar.samudrala@intel.com>
commit b5aea3de88e526a46839b7ccf049fab4f8ad7a4b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/b5aea3de.failed

Fix support for 16 bit source/dest port matches in ixgbe model.
u32 uses a single 32-bit key value for both source and destination ports
starting at offset 0. So replace the 2 functions with a single function
that takes this key value/mask to program both source and dest ports.

Verified with the following filter:

 #tc qdisc add dev p4p1 ingress
 #tc filter add dev p4p1 parent ffff: protocol ip prio 99 \
	handle 1: u32 divisor 1
 #tc filter add dev p4p1 parent ffff: protocol ip prio 99 \
	handle 800:0:10 u32 ht 800: link 1: \
	offset at 0 mask 0f00 shift 6 plus 0 eat match ip protocol 6 ff
 #tc filter add dev p4p1 parent ffff: protocol ip prio 99 \
	handle 1:0:10 u32 ht 1: \
	match tcp src 1024 ffff match tcp dst 80 ffff action drop
 #tc filter add dev p4p1 parent ffff: protocol ip prio 99 \
	handle 1:0:11 u32 ht 1: \
	match tcp src 1025 ffff action drop
 #tc filter add dev p4p1 parent ffff: protocol ip prio 99 \
	handle 1:0:12 u32 ht 1: \
	match tcp dst 81 ffff action drop

	Signed-off-by: Sridhar Samudrala <sridhar.samudrala@intel.com>
	Acked-by: John Fastabend <john.r.fastabend@intel.com>
	Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
(cherry picked from commit b5aea3de88e526a46839b7ccf049fab4f8ad7a4b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/ixgbe/ixgbe_model.h
diff --cc drivers/net/ethernet/intel/ixgbe/ixgbe_model.h
index ce48872d4782,74c53ad9d268..000000000000
--- a/drivers/net/ethernet/intel/ixgbe/ixgbe_model.h
+++ b/drivers/net/ethernet/intel/ixgbe/ixgbe_model.h
@@@ -84,9 -77,7 +78,13 @@@ static inline int ixgbe_mat_prgm_ports(
  };
  
  static struct ixgbe_mat_field ixgbe_tcp_fields[] = {
++<<<<<<< HEAD
 +	{.off = 0, .mask = 0xffff, .val = ixgbe_mat_prgm_sport,
 +	 .type = IXGBE_ATR_FLOW_TYPE_TCPV4},
 +	{.off = 2, .mask = 0xffff, .val = ixgbe_mat_prgm_dport,
++=======
+ 	{.off = 0, .val = ixgbe_mat_prgm_ports,
++>>>>>>> b5aea3de88e5 (ixgbe: Fix cls_u32 offload support for L4 ports)
  	 .type = IXGBE_ATR_FLOW_TYPE_TCPV4},
  	{ .val = NULL } /* terminal node */
  };
* Unmerged path drivers/net/ethernet/intel/ixgbe/ixgbe_model.h
