i40e: Fix a bug with VMDq RSS queue allocation

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Anjali Singhai Jain <anjali.singhai@intel.com>
commit 5a433199bfde1b5360bf592184a2b89ce4ee2eda
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/5a433199.failed

The X722 pf flag setup should happen before the VMDq RSS queue count is
initialized for VMDq VSI to get the right number of queues for RSS in
case of X722 devices.

	Signed-off-by: Anjali Singhai Jain <anjali.singhai@intel.com>
	Signed-off-by: Alice Michael <alice.michael@intel.com>
	Tested-by: Andrew Bowers <andrewx.bowers@intel.com>
	Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
(cherry picked from commit 5a433199bfde1b5360bf592184a2b89ce4ee2eda)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/i40e/i40e_main.c
diff --cc drivers/net/ethernet/intel/i40e/i40e_main.c
index 32ff0c8dc416,5df25df123d7..000000000000
--- a/drivers/net/ethernet/intel/i40e/i40e_main.c
+++ b/drivers/net/ethernet/intel/i40e/i40e_main.c
@@@ -8927,28 -9064,6 +8950,31 @@@ static int i40e_sw_init(struct i40e_pf 
  					I40E_MAX_VF_COUNT);
  	}
  #endif /* CONFIG_PCI_IOV */
++<<<<<<< HEAD
 +	if (pf->hw.mac.type == I40E_MAC_X722) {
 +		pf->flags |= I40E_FLAG_RSS_AQ_CAPABLE
 +			     | I40E_FLAG_128_QP_RSS_CAPABLE
 +			     | I40E_FLAG_HW_ATR_EVICT_CAPABLE
 +			     | I40E_FLAG_OUTER_UDP_CSUM_CAPABLE
 +			     | I40E_FLAG_WB_ON_ITR_CAPABLE
 +			     | I40E_FLAG_MULTIPLE_TCP_UDP_RSS_PCTYPE
 +			     | I40E_FLAG_NO_PCI_LINK_CHECK
 +			     | I40E_FLAG_USE_SET_LLDP_MIB
 +			     | I40E_FLAG_GENEVE_OFFLOAD_CAPABLE
 +			     | I40E_FLAG_PTP_L4_CAPABLE
 +			     | I40E_FLAG_WOL_MC_MAGIC_PKT_WAKE;
 +	} else if ((pf->hw.aq.api_maj_ver > 1) ||
 +		   ((pf->hw.aq.api_maj_ver == 1) &&
 +		    (pf->hw.aq.api_min_ver > 4))) {
 +		/* Supported in FW API version higher than 1.4 */
 +		pf->flags |= I40E_FLAG_GENEVE_OFFLOAD_CAPABLE;
 +		pf->hw_disabled_flags = I40E_FLAG_HW_ATR_EVICT_CAPABLE;
 +	} else {
 +		pf->hw_disabled_flags = I40E_FLAG_HW_ATR_EVICT_CAPABLE;
 +	}
 +
++=======
++>>>>>>> 5a433199bfde (i40e: Fix a bug with VMDq RSS queue allocation)
  	pf->eeprom_version = 0xDEAD;
  	pf->lan_veb = I40E_NO_VEB;
  	pf->lan_vsi = I40E_NO_VSI;
* Unmerged path drivers/net/ethernet/intel/i40e/i40e_main.c
