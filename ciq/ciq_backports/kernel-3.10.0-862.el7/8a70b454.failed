ASoC: dapm: Add new widget type for constructing DAPM graphs on DSPs.

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [sound] alsa: asoc: dapm: Add new widget type for constructing DAPM graphs on DSPs (Jaroslav Kysela) [1463624]
Rebuild_FUZZ: 95.10%
commit-author Liam Girdwood <liam.r.girdwood@linux.intel.com>
commit 8a70b4544ef4f094cc2c52734e097cc358f56603
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/8a70b454.failed

Add some DAPM widget types to better support the construction of DAPM
graphs within DSPs.

	Signed-off-by: Liam Girdwood <liam.r.girdwood@linux.intel.com>
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit 8a70b4544ef4f094cc2c52734e097cc358f56603)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	Documentation/sound/alsa/soc/dapm.txt
diff --cc Documentation/sound/alsa/soc/dapm.txt
index 6faab4880006,8e44107933ab..000000000000
--- a/Documentation/sound/alsa/soc/dapm.txt
+++ b/Documentation/sound/alsa/soc/dapm.txt
@@@ -50,29 -59,70 +50,96 @@@ widgets hereafter
  
  Audio DAPM widgets fall into a number of types:-
  
++<<<<<<< HEAD:Documentation/sound/alsa/soc/dapm.txt
 + o Mixer      - Mixes several analog signals into a single analog signal.
 + o Mux        - An analog switch that outputs only one of many inputs.
 + o PGA        - A programmable gain amplifier or attenuation widget.
 + o ADC        - Analog to Digital Converter
 + o DAC        - Digital to Analog Converter
 + o Switch     - An analog switch
 + o Input      - A codec input pin
 + o Output     - A codec output pin
 + o Headphone  - Headphone (and optional Jack)
 + o Mic        - Mic (and optional Jack)
 + o Line       - Line Input/Output (and optional Jack)
 + o Speaker    - Speaker
 + o Supply     - Power or clock supply widget used by other widgets.
 + o Regulator  - External regulator that supplies power to audio components.
 + o Clock      -	External clock that supplies clock to audio components.
 + o AIF IN     - Audio Interface Input (with TDM slot mask).
 + o AIF OUT    - Audio Interface Output (with TDM slot mask).
 + o Siggen     - Signal Generator.
 + o DAI IN     - Digital Audio Interface Input.
 + o DAI OUT    - Digital Audio Interface Output.
 + o DAI Link   - DAI Link between two DAI structures */
 + o Pre        - Special PRE widget (exec before all others)
 + o Post       - Special POST widget (exec after all others)
++=======
+ Mixer
+ 	Mixes several analog signals into a single analog signal.
+ Mux
+ 	An analog switch that outputs only one of many inputs.
+ PGA
+ 	A programmable gain amplifier or attenuation widget.
+ ADC
+ 	Analog to Digital Converter
+ DAC
+ 	Digital to Analog Converter
+ Switch
+ 	An analog switch
+ Input
+ 	A codec input pin
+ Output
+ 	A codec output pin
+ Headphone
+ 	Headphone (and optional Jack)
+ Mic
+ 	Mic (and optional Jack)
+ Line
+ 	Line Input/Output (and optional Jack)
+ Speaker
+ 	Speaker
+ Supply
+ 	Power or clock supply widget used by other widgets.
+ Regulator
+ 	External regulator that supplies power to audio components.
+ Clock
+ 	External clock that supplies clock to audio components.
+ AIF IN
+ 	Audio Interface Input (with TDM slot mask).
+ AIF OUT
+ 	Audio Interface Output (with TDM slot mask).
+ Siggen
+ 	Signal Generator.
+ DAI IN
+ 	Digital Audio Interface Input.
+ DAI OUT
+ 	Digital Audio Interface Output.
+ DAI Link
+ 	DAI Link between two DAI structures
+ Pre
+ 	Special PRE widget (exec before all others)
+ Post
+ 	Special POST widget (exec after all others)
+ Buffer
+ 	Inter widget audio data buffer within a DSP.
+ Scheduler
+ 	DSP internal scheduler that schedules component/pipeline processing
+ 	work.
+ Effect
+ 	Widget that performs an audio processing effect.
+ SRC
+ 	Sample Rate Converter within DSP or CODEC
+ ASRC
+ 	Asynchronous Sample Rate Converter within DSP or CODEC
+ Encoder
+ 	Widget that encodes audio data from one format (usually PCM) to another
+ 	usually more compressed format.
+ Decoder
+ 	Widget that decodes audio data from a compressed format to an
+ 	uncompressed format like PCM.
+ 
++>>>>>>> 8a70b4544ef4 (ASoC: dapm: Add new widget type for constructing DAPM graphs on DSPs.):Documentation/sound/soc/dapm.rst
  
  (Widgets are defined in include/sound/soc-dapm.h)
  
* Unmerged path Documentation/sound/alsa/soc/dapm.txt
diff --git a/include/sound/soc-dapm.h b/include/sound/soc-dapm.h
index 8560eb6ece6c..02bd2c43ac74 100644
--- a/include/sound/soc-dapm.h
+++ b/include/sound/soc-dapm.h
@@ -499,6 +499,13 @@ enum snd_soc_dapm_type {
 	snd_soc_dapm_dai_out,
 	snd_soc_dapm_dai_link,		/* link between two DAI structures */
 	snd_soc_dapm_kcontrol,		/* Auto-disabled kcontrol */
+	snd_soc_dapm_buffer,		/* DSP/CODEC internal buffer */
+	snd_soc_dapm_scheduler,		/* DSP/CODEC internal scheduler */
+	snd_soc_dapm_effect,		/* DSP/CODEC effect component */
+	snd_soc_dapm_src,		/* DSP/CODEC SRC component */
+	snd_soc_dapm_asrc,		/* DSP/CODEC ASRC component */
+	snd_soc_dapm_encoder,		/* FW/SW audio encoder component */
+	snd_soc_dapm_decoder,		/* FW/SW audio decoder component */
 };
 
 enum snd_soc_dapm_subclass {
diff --git a/include/uapi/sound/asoc.h b/include/uapi/sound/asoc.h
index 6702533c8bd8..78014ec56357 100644
--- a/include/uapi/sound/asoc.h
+++ b/include/uapi/sound/asoc.h
@@ -73,7 +73,15 @@
 #define SND_SOC_TPLG_DAPM_DAI_IN	13
 #define SND_SOC_TPLG_DAPM_DAI_OUT	14
 #define SND_SOC_TPLG_DAPM_DAI_LINK	15
-#define SND_SOC_TPLG_DAPM_LAST		SND_SOC_TPLG_DAPM_DAI_LINK
+#define SND_SOC_TPLG_DAPM_BUFFER	16
+#define SND_SOC_TPLG_DAPM_SCHEDULER	17
+#define SND_SOC_TPLG_DAPM_EFFECT	18
+#define SND_SOC_TPLG_DAPM_SIGGEN	19
+#define SND_SOC_TPLG_DAPM_SRC		20
+#define SND_SOC_TPLG_DAPM_ASRC		21
+#define SND_SOC_TPLG_DAPM_ENCODER	22
+#define SND_SOC_TPLG_DAPM_DECODER	23
+#define SND_SOC_TPLG_DAPM_LAST		SND_SOC_TPLG_DAPM_DECODER
 
 /* Header magic number and string sizes */
 #define SND_SOC_TPLG_MAGIC		0x41536F43 /* ASoC */
diff --git a/sound/soc/soc-topology.c b/sound/soc/soc-topology.c
index efb47e648ad1..d5a5fd36ba61 100644
--- a/sound/soc/soc-topology.c
+++ b/sound/soc/soc-topology.c
@@ -242,6 +242,14 @@ static const struct soc_tplg_map dapm_map[] = {
 	{SND_SOC_TPLG_DAPM_DAI_IN, snd_soc_dapm_dai_in},
 	{SND_SOC_TPLG_DAPM_DAI_OUT, snd_soc_dapm_dai_out},
 	{SND_SOC_TPLG_DAPM_DAI_LINK, snd_soc_dapm_dai_link},
+	{SND_SOC_TPLG_DAPM_BUFFER, snd_soc_dapm_buffer},
+	{SND_SOC_TPLG_DAPM_SCHEDULER, snd_soc_dapm_scheduler},
+	{SND_SOC_TPLG_DAPM_EFFECT, snd_soc_dapm_effect},
+	{SND_SOC_TPLG_DAPM_SIGGEN, snd_soc_dapm_siggen},
+	{SND_SOC_TPLG_DAPM_SRC, snd_soc_dapm_src},
+	{SND_SOC_TPLG_DAPM_ASRC, snd_soc_dapm_asrc},
+	{SND_SOC_TPLG_DAPM_ENCODER, snd_soc_dapm_encoder},
+	{SND_SOC_TPLG_DAPM_DECODER, snd_soc_dapm_decoder},
 };
 
 static int tplc_chan_get_reg(struct soc_tplg *tplg,
