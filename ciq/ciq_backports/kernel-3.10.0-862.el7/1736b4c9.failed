RDMA/qedr: Parse vlan priority as sl

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Amrani, Ram <Ram.Amrani@cavium.com>
commit 1736b4c99d1c53abec042d41b702aeabeb65d86a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/1736b4c9.failed

Parse the vlan priority from the vlan tag and configure it to the
WC's sl field.

Fixes: abd49676c707 ("qed: Add RoCE ll2 & GSI support")
	Signed-off-by: Ram Amrani <Ram.Amrani@cavium.com>
	Signed-off-by: Michal Kalderon <Michal.Kalderon@cavium.com>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 1736b4c99d1c53abec042d41b702aeabeb65d86a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/qedr/qedr_cm.c
diff --cc drivers/infiniband/hw/qedr/qedr_cm.c
index 54568c16e682,ad8965397cf7..000000000000
--- a/drivers/infiniband/hw/qedr/qedr_cm.c
+++ b/drivers/infiniband/hw/qedr/qedr_cm.c
@@@ -583,9 -713,14 +583,15 @@@ int qedr_gsi_poll_cq(struct ib_cq *ibcq
  		wc[i].wc_flags |= IB_WC_GRH | IB_WC_IP_CSUM_OK;
  		ether_addr_copy(wc[i].smac, qp->rqe_wr_id[qp->rq.cons].smac);
  		wc[i].wc_flags |= IB_WC_WITH_SMAC;
 -
 -		vlan_id = qp->rqe_wr_id[qp->rq.cons].vlan &
 -			  VLAN_VID_MASK;
 -		if (vlan_id) {
 +		if (qp->rqe_wr_id[qp->rq.cons].vlan_id) {
  			wc[i].wc_flags |= IB_WC_WITH_VLAN;
++<<<<<<< HEAD
 +			wc[i].vlan_id = qp->rqe_wr_id[qp->rq.cons].vlan_id;
++=======
+ 			wc[i].vlan_id = vlan_id;
+ 			wc[i].sl = (qp->rqe_wr_id[qp->rq.cons].vlan &
+ 				    VLAN_PRIO_MASK) >> VLAN_PRIO_SHIFT;
++>>>>>>> 1736b4c99d1c (RDMA/qedr: Parse vlan priority as sl)
  		}
  
  		qedr_inc_sw_cons(&qp->rq);
* Unmerged path drivers/infiniband/hw/qedr/qedr_cm.c
