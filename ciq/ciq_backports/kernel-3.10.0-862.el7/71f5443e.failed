x86/dumpstack: Fix show_stack() task pointer regression

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [x86] dumpstack: Fix show_stack() task pointer regression (Josh Poimboeuf) [1430637]
Rebuild_FUZZ: 96.23%
commit-author Josh Poimboeuf <jpoimboe@redhat.com>
commit 71f5443ebb1227c22e8decbcd28a1ea6deaf8257
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/71f5443e.failed

With the following commit:

  e18bcccd1a4e ("x86/dumpstack: Convert show_trace_log_lvl() to use the new unwinder")

The task pointer argument to show_stack_log_lvl() in show_stack() was
inadvertently changed to 'current'.

	Signed-off-by: Josh Poimboeuf <jpoimboe@redhat.com>
	Cc: Andy Lutomirski <luto@kernel.org>
	Cc: Borislav Petkov <bp@alien8.de>
	Cc: Brian Gerst <brgerst@gmail.com>
	Cc: Denys Vlasenko <dvlasenk@redhat.com>
	Cc: H. Peter Anvin <hpa@zytor.com>
	Cc: Linus Torvalds <torvalds@linux-foundation.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Thomas Gleixner <tglx@linutronix.de>
	Cc: byungchul.park@lge.com
	Cc: fweisbec@gmail.com
	Cc: keescook@chromium.org
	Cc: linux-tip-commits@vger.kernel.org
	Cc: luto@amacapital.net
	Cc: nilayvaish@gmail.com
	Cc: rostedt@goodmis.org
	Cc: tip-bot for Josh Poimboeuf <tipbot@zytor.com>
Fixes: e18bcccd1a4e ("x86/dumpstack: Convert show_trace_log_lvl() to use the new unwinder")
Link: http://lkml.kernel.org/r/20160920155340.yhewlx7vmgmov5fb@treble
	Signed-off-by: Ingo Molnar <mingo@kernel.org>
(cherry picked from commit 71f5443ebb1227c22e8decbcd28a1ea6deaf8257)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kernel/dumpstack.c
diff --cc arch/x86/kernel/dumpstack.c
index 08594671b59f,9b7cf5c28f5f..000000000000
--- a/arch/x86/kernel/dumpstack.c
+++ b/arch/x86/kernel/dumpstack.c
@@@ -191,12 -161,15 +191,21 @@@ void show_stack(struct task_struct *tas
  	 * Stack frames below this one aren't interesting.  Don't show them
  	 * if we're printing for %current.
  	 */
 -	if (!sp && task == current)
 -		sp = get_stack_pointer(current, NULL);
 +	if (!sp && (!task || task == current)) {
 +		sp = &stack;
 +		bp = stack_frame(current, NULL);
 +	}
  
++<<<<<<< HEAD
 +	show_stack_log_lvl(task, NULL, sp, bp, "");
++=======
+ 	show_stack_log_lvl(task, NULL, sp, "");
+ }
+ 
+ void show_stack_regs(struct pt_regs *regs)
+ {
+ 	show_stack_log_lvl(current, regs, NULL, "");
++>>>>>>> 71f5443ebb12 (x86/dumpstack: Fix show_stack() task pointer regression)
  }
  
  static arch_spinlock_t die_lock = __ARCH_SPIN_LOCK_UNLOCKED;
* Unmerged path arch/x86/kernel/dumpstack.c
