rbd: introduce rbd_init_layout()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Ilya Dryomov <idryomov@gmail.com>
commit 263423f8adf4acbdc4fd26ed5b35f4a6408bc0ab
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/263423f8.failed

Rather than initializing layout fields with some made up values in
__rbd_dev_create(), move the initialization into rbd_init_layout() and
call it after the header is actually populated.

	Signed-off-by: Ilya Dryomov <idryomov@gmail.com>
	Reviewed-by: Jason Dillaman <dillaman@redhat.com>
(cherry picked from commit 263423f8adf4acbdc4fd26ed5b35f4a6408bc0ab)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/block/rbd.c
diff --cc drivers/block/rbd.c
index 8bf8211233c2,e7131c758118..000000000000
--- a/drivers/block/rbd.c
+++ b/drivers/block/rbd.c
@@@ -4895,11 -4820,6 +4911,14 @@@ static struct rbd_device *__rbd_dev_cre
  	rbd_dev->rbd_client = rbdc;
  	rbd_dev->spec = spec;
  
++<<<<<<< HEAD
 +	rbd_dev->layout.fl_stripe_unit = cpu_to_le32(1 << RBD_MAX_OBJ_ORDER);
 +	rbd_dev->layout.fl_stripe_count = cpu_to_le32(1);
 +	rbd_dev->layout.fl_object_size = cpu_to_le32(1 << RBD_MAX_OBJ_ORDER);
 +	rbd_dev->layout.fl_pg_pool = cpu_to_le32((u32) spec->pool_id);
 +
++=======
++>>>>>>> 263423f8adf4 (rbd: introduce rbd_init_layout())
  	return rbd_dev;
  }
  
* Unmerged path drivers/block/rbd.c
