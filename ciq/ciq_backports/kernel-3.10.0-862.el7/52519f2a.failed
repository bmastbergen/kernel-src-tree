x86/xen: globalize have_vcpu_info_placement

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [x86] xen: globalize have_vcpu_info_placement (Vitaly Kuznetsov) [1482594]
Rebuild_FUZZ: 95.12%
commit-author Vitaly Kuznetsov <vkuznets@redhat.com>
commit 52519f2af020b6b53b4e0cbb8cff71058ed434cd
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/52519f2a.failed

have_vcpu_info_placement applies to both PV and HVM and as we're going
to split the code we need to make it global.

Rename to xen_have_vcpu_info_placement.

	Signed-off-by: Vitaly Kuznetsov <vkuznets@redhat.com>
	Reviewed-by: Juergen Gross <jgross@suse.com>
	Signed-off-by: Juergen Gross <jgross@suse.com>
(cherry picked from commit 52519f2af020b6b53b4e0cbb8cff71058ed434cd)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/xen/enlighten.c
diff --cc arch/x86/xen/enlighten.c
index 5df0cb46e645,7b55408ff0ab..000000000000
--- a/arch/x86/xen/enlighten.c
+++ b/arch/x86/xen/enlighten.c
@@@ -1156,9 -1156,11 +1156,17 @@@ void xen_setup_vcpu_info_placement(void
  		xen_vcpu_setup(cpu);
  	}
  
++<<<<<<< HEAD
 +	/* xen_vcpu_setup managed to place the vcpu_info within the
 +	   percpu area for all cpus, so make use of it */
 +	if (have_vcpu_info_placement) {
++=======
+ 	/*
+ 	 * xen_vcpu_setup managed to place the vcpu_info within the
+ 	 * percpu area for all cpus, so make use of it.
+ 	 */
+ 	if (xen_have_vcpu_info_placement) {
++>>>>>>> 52519f2af020 (x86/xen: globalize have_vcpu_info_placement)
  		pv_irq_ops.save_fl = __PV_IS_CALLEE_SAVE(xen_save_fl_direct);
  		pv_irq_ops.restore_fl = __PV_IS_CALLEE_SAVE(xen_restore_fl_direct);
  		pv_irq_ops.irq_disable = __PV_IS_CALLEE_SAVE(xen_irq_disable_direct);
* Unmerged path arch/x86/xen/enlighten.c
diff --git a/arch/x86/xen/xen-ops.h b/arch/x86/xen/xen-ops.h
index 774e39171c8c..476033589f45 100644
--- a/arch/x86/xen/xen-ops.h
+++ b/arch/x86/xen/xen-ops.h
@@ -59,6 +59,8 @@ irqreturn_t xen_debug_interrupt(int irq, void *dev_id);
 
 bool xen_vcpu_stolen(int vcpu);
 
+extern int xen_have_vcpu_info_placement;
+
 void xen_vcpu_setup(int cpu);
 void xen_setup_vcpu_info_placement(void);
 
