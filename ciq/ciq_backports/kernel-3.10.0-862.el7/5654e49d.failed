RDMA/netlink: Provide port state and physical link state

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Leon Romanovsky <leonro@mellanox.com>
commit 5654e49db0b2d87c12b6e120b6a830abe3d3921b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/5654e49d.failed

Add port state and physical link state to the users of RDMA netlink.

	Signed-off-by: Leon Romanovsky <leonro@mellanox.com>
(cherry picked from commit 5654e49db0b2d87c12b6e120b6a830abe3d3921b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/core/nldev.c
#	include/uapi/rdma/rdma_netlink.h
diff --cc include/uapi/rdma/rdma_netlink.h
index 02fe8390c18f,c488c3cf361b..000000000000
--- a/include/uapi/rdma/rdma_netlink.h
+++ b/include/uapi/rdma/rdma_netlink.h
@@@ -222,4 -222,84 +222,87 @@@ struct rdma_nla_ls_gid 
  	__u8		gid[16];
  };
  
++<<<<<<< HEAD
++=======
+ enum rdma_nldev_command {
+ 	RDMA_NLDEV_CMD_UNSPEC,
+ 
+ 	RDMA_NLDEV_CMD_GET, /* can dump */
+ 	RDMA_NLDEV_CMD_SET,
+ 	RDMA_NLDEV_CMD_NEW,
+ 	RDMA_NLDEV_CMD_DEL,
+ 
+ 	RDMA_NLDEV_CMD_PORT_GET, /* can dump */
+ 	RDMA_NLDEV_CMD_PORT_SET,
+ 	RDMA_NLDEV_CMD_PORT_NEW,
+ 	RDMA_NLDEV_CMD_PORT_DEL,
+ 
+ 	RDMA_NLDEV_NUM_OPS
+ };
+ 
+ enum rdma_nldev_attr {
+ 	/* don't change the order or add anything between, this is ABI! */
+ 	RDMA_NLDEV_ATTR_UNSPEC,
+ 
+ 	/* Identifier for ib_device */
+ 	RDMA_NLDEV_ATTR_DEV_INDEX,		/* u32 */
+ 
+ 	RDMA_NLDEV_ATTR_DEV_NAME,		/* string */
+ 	/*
+ 	 * Device index together with port index are identifiers
+ 	 * for port/link properties.
+ 	 *
+ 	 * For RDMA_NLDEV_CMD_GET commamnd, port index will return number
+ 	 * of available ports in ib_device, while for port specific operations,
+ 	 * it will be real port index as it appears in sysfs. Port index follows
+ 	 * sysfs notation and starts from 1 for the first port.
+ 	 */
+ 	RDMA_NLDEV_ATTR_PORT_INDEX,		/* u32 */
+ 
+ 	/*
+ 	 * Device and port capabilities
+ 	 */
+ 	RDMA_NLDEV_ATTR_CAP_FLAGS,		/* u64 */
+ 
+ 	/*
+ 	 * FW version
+ 	 */
+ 	RDMA_NLDEV_ATTR_FW_VERSION,		/* string */
+ 
+ 	/*
+ 	 * Node GUID (in host byte order) associated with the RDMA device.
+ 	 */
+ 	RDMA_NLDEV_ATTR_NODE_GUID,			/* u64 */
+ 
+ 	/*
+ 	 * System image GUID (in host byte order) associated with
+ 	 * this RDMA device and other devices which are part of a
+ 	 * single system.
+ 	 */
+ 	RDMA_NLDEV_ATTR_SYS_IMAGE_GUID,		/* u64 */
+ 
+ 	/*
+ 	 * Subnet prefix (in host byte order)
+ 	 */
+ 	RDMA_NLDEV_ATTR_SUBNET_PREFIX,		/* u64 */
+ 
+ 	/*
+ 	 * Local Identifier (LID),
+ 	 * According to IB specification, It is 16-bit address assigned
+ 	 * by the Subnet Manager. Extended to be 32-bit for OmniPath users.
+ 	 */
+ 	RDMA_NLDEV_ATTR_LID,			/* u32 */
+ 	RDMA_NLDEV_ATTR_SM_LID,			/* u32 */
+ 
+ 	/*
+ 	 * LID mask control (LMC)
+ 	 */
+ 	RDMA_NLDEV_ATTR_LMC,			/* u8 */
+ 
+ 	RDMA_NLDEV_ATTR_PORT_STATE,		/* u8 */
+ 	RDMA_NLDEV_ATTR_PORT_PHYS_STATE,	/* u8 */
+ 
+ 	RDMA_NLDEV_ATTR_MAX
+ };
++>>>>>>> 5654e49db0b2 (RDMA/netlink: Provide port state and physical link state)
  #endif /* _UAPI_RDMA_NETLINK_H */
* Unmerged path drivers/infiniband/core/nldev.c
* Unmerged path drivers/infiniband/core/nldev.c
* Unmerged path include/uapi/rdma/rdma_netlink.h
