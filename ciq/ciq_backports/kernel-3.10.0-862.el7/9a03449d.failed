i40e: Fix link down message when interface is brought up

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Sudheer Mogilappagari <sudheer.mogilappagari@intel.com>
commit 9a03449d3ea0f6b497ff3a3bf6203a5e72c7e6be
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/9a03449d.failed

i40e_print_link_message() is intended to compare new
link state with current link state and print log message
only if the new state is different from current state.

However in current driver the new state does not get updated
when link is going down because of the if condition. When an
interface is brought down, vsi->state is set to I40E_VSI_DOWN
in i40e_vsi_close() and later i40e_print_link_message() does
not get invoked in i40e_link_event due to if condition. Hence
link down message doesn't appear when link is going down. The
down state is seen  later during i40e_open() and old state
gets printed. The actual link state doesn't get updated in
i40e_close() or i40e_open() but when i40e_handle_link_event is
called inside i40e_clean_adminq_subtask.

This change allows i40e_print_link_message() to be called when
interface is going down and keeps the state information updated.

	Signed-off-by: Sudheer Mogilappagari <sudheer.mogilappagari@intel.com>
	Tested-by: Andrew Bowers <andrewx.bowers@intel.com>
	Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
(cherry picked from commit 9a03449d3ea0f6b497ff3a3bf6203a5e72c7e6be)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/i40e/i40e_main.c
diff --cc drivers/net/ethernet/intel/i40e/i40e_main.c
index 5d03c7e3f2e6,2e8fe6186b38..000000000000
--- a/drivers/net/ethernet/intel/i40e/i40e_main.c
+++ b/drivers/net/ethernet/intel/i40e/i40e_main.c
@@@ -6410,8 -6420,7 +6410,12 @@@ static void i40e_link_event(struct i40e
  	     new_link == netif_carrier_ok(vsi->netdev)))
  		return;
  
++<<<<<<< HEAD
 +	if (!test_bit(__I40E_DOWN, &vsi->state))
 +		i40e_print_link_message(vsi, new_link);
++=======
+ 	i40e_print_link_message(vsi, new_link);
++>>>>>>> 9a03449d3ea0 (i40e: Fix link down message when interface is brought up)
  
  	/* Notify the base of the switch tree connected to
  	 * the link.  Floating VEBs are not notified.
* Unmerged path drivers/net/ethernet/intel/i40e/i40e_main.c
