acpi/bus: Set _OSC for diverse core support

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Srinivas Pandruvada <srinivas.pandruvada@linux.intel.com>
commit 8b533a0eeefc5861cea57163dd3cec2798a77f6c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/8b533a0e.failed

Set the OSC_SB_CPC_DIVERSE_HIGH_SUPPORT (bit 12) to enable diverse
core support.

This is required to enable the BIOS support of the Intel Turbo Boost Max
Technology 3.0 feature.

	Signed-off-by: Srinivas Pandruvada <srinivas.pandruvada@linux.intel.com>
	Signed-off-by: Tim Chen <tim.c.chen@linux.intel.com>
	Cc: linux-pm@vger.kernel.org
	Cc: peterz@infradead.org
	Cc: jolsa@redhat.com
	Cc: rjw@rjwysocki.net
	Cc: linux-acpi@vger.kernel.org
	Cc: bp@suse.de
Link: http://lkml.kernel.org/r/a023623a727e86040a1715797055f6402caefd7e.1479844244.git.tim.c.chen@linux.intel.com
	Signed-off-by: Thomas Gleixner <tglx@linutronix.de>

(cherry picked from commit 8b533a0eeefc5861cea57163dd3cec2798a77f6c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/linux/acpi.h
diff --cc include/linux/acpi.h
index 0ab4b0e3a549,051023756520..000000000000
--- a/include/linux/acpi.h
+++ b/include/linux/acpi.h
@@@ -373,8 -466,13 +373,15 @@@ acpi_status acpi_run_osc(acpi_handle ha
  #define OSC_SB_HOTPLUG_OST_SUPPORT		0x00000008
  #define OSC_SB_APEI_SUPPORT			0x00000010
  #define OSC_SB_CPC_SUPPORT			0x00000020
++<<<<<<< HEAD
++=======
+ #define OSC_SB_CPCV2_SUPPORT			0x00000040
+ #define OSC_SB_PCLPI_SUPPORT			0x00000080
+ #define OSC_SB_OSLPI_SUPPORT			0x00000100
+ #define OSC_SB_CPC_DIVERSE_HIGH_SUPPORT		0x00001000
++>>>>>>> 8b533a0eeefc (acpi/bus: Set _OSC for diverse core support)
  
  extern bool osc_sb_apei_support_acked;
 -extern bool osc_pc_lpi_support_confirmed;
  
  /* PCI Host Bridge _OSC: Capabilities DWORD 2: Support Field */
  #define OSC_PCI_EXT_CONFIG_SUPPORT		0x00000001
diff --git a/drivers/acpi/bus.c b/drivers/acpi/bus.c
index 01b7641ae954..edd7ee60989d 100644
--- a/drivers/acpi/bus.c
+++ b/drivers/acpi/bus.c
@@ -307,6 +307,9 @@ static void acpi_bus_osc_support(void)
 	}
 #endif
 
+	if (IS_ENABLED(CONFIG_SCHED_ITMT))
+		capbuf[OSC_SUPPORT_DWORD] |= OSC_SB_CPC_DIVERSE_HIGH_SUPPORT;
+
 	if (!ghes_disable)
 		capbuf[OSC_SUPPORT_DWORD] |= OSC_SB_APEI_SUPPORT;
 	if (ACPI_FAILURE(acpi_get_handle(NULL, "\\_SB", &handle)))
* Unmerged path include/linux/acpi.h
