NFSv4: Add missing nfs_put_lock_context()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author NeilBrown <neilb@suse.com>
commit 7a0566b38c518e98df2359c8c15c2b3f91a4d67e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/7a0566b3.failed

Otherwise the lock context won't be freed when we're done with it.

From: NeilBrown <neilb@suse.com>
Fixes: 5bd3f817 ("NFSv4: change nfs4_select_rw_stateid to take a lock_context inplace of lock_owner")
	Signed-off-by: Anna Schumaker <Anna.Schumaker@netapp.com>
	Signed-off-by: Trond Myklebust <trond.myklebust@primarydata.com>
(cherry picked from commit 7a0566b38c518e98df2359c8c15c2b3f91a4d67e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/nfs/nfs4proc.c
diff --cc fs/nfs/nfs4proc.c
index b211a49fc834,d3431ff32662..000000000000
--- a/fs/nfs/nfs4proc.c
+++ b/fs/nfs/nfs4proc.c
@@@ -2911,15 -2948,17 +2911,25 @@@ static int _nfs4_do_setattr(struct inod
  
  	if (nfs4_copy_delegation_stateid(inode, fmode, &arg->stateid, &delegation_cred)) {
  		/* Use that stateid */
 -	} else if (truncate && ctx != NULL) {
 -		struct nfs_lock_context *l_ctx;
 -		if (!nfs4_valid_open_stateid(ctx->state))
 +	} else if (truncate && state != NULL) {
 +		struct nfs_lockowner lockowner = {
 +			.l_owner = current->files,
 +			.l_pid = current->tgid,
 +		};
 +		if (!nfs4_valid_open_stateid(state))
  			return -EBADF;
++<<<<<<< HEAD
 +		if (nfs4_select_rw_stateid(state, FMODE_WRITE, &lockowner,
 +				&arg->stateid, &delegation_cred) == -EIO)
++=======
+ 		l_ctx = nfs_get_lock_context(ctx);
+ 		if (IS_ERR(l_ctx))
+ 			return PTR_ERR(l_ctx);
+ 		status = nfs4_select_rw_stateid(ctx->state, FMODE_WRITE, l_ctx,
+ 						&arg->stateid, &delegation_cred);
+ 		nfs_put_lock_context(l_ctx);
+ 		if (status == -EIO)
++>>>>>>> 7a0566b38c51 (NFSv4: Add missing nfs_put_lock_context())
  			return -EBADF;
  	} else
  		nfs4_stateid_copy(&arg->stateid, &zero_stateid);
* Unmerged path fs/nfs/nfs4proc.c
