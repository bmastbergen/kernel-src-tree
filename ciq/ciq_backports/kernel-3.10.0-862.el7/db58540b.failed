IB/core: Change port_attr.sm_lid from 16 to 32 bits

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Dasaratharaman Chandramouli <dasaratharaman.chandramouli@intel.com>
commit db58540b021a17e0ede64f761b740556d77f1679
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/db58540b.failed

sm_lid field in struct ib_port_attr is increased to 32 bits. This
enables core components to use larger LIDs if needed.
The user ABI is unchanged and return 16 bit values when queried.

	Signed-off-by: Dasaratharaman Chandramouli <dasaratharaman.chandramouli@intel.com>
	Reviewed-by: Ira Weiny <ira.weiny@intel.com>
	Signed-off-by: Don Hiatt <don.hiatt@intel.com>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit db58540b021a17e0ede64f761b740556d77f1679)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/core/uverbs_cmd.c
#	include/rdma/ib_verbs.h
diff --cc drivers/infiniband/core/uverbs_cmd.c
index 4761b0709900,01e2ff023980..000000000000
--- a/drivers/infiniband/core/uverbs_cmd.c
+++ b/drivers/infiniband/core/uverbs_cmd.c
@@@ -514,8 -275,13 +514,18 @@@ ssize_t ib_uverbs_query_port(struct ib_
  	resp.bad_pkey_cntr   = attr.bad_pkey_cntr;
  	resp.qkey_viol_cntr  = attr.qkey_viol_cntr;
  	resp.pkey_tbl_len    = attr.pkey_tbl_len;
++<<<<<<< HEAD
 +	resp.lid 	     = attr.lid;
 +	resp.sm_lid 	     = attr.sm_lid;
++=======
+ 	if (rdma_cap_opa_ah(ib_dev, cmd.port_num)) {
+ 		resp.lid  = OPA_TO_IB_UCAST_LID(attr.lid);
+ 		resp.sm_lid  = OPA_TO_IB_UCAST_LID(attr.sm_lid);
+ 	} else {
+ 		resp.lid     = (u16)attr.lid;
+ 		resp.sm_lid  = (u16)attr.sm_lid;
+ 	}
++>>>>>>> db58540b021a (IB/core: Change port_attr.sm_lid from 16 to 32 bits)
  	resp.lmc 	     = attr.lmc;
  	resp.max_vl_num      = attr.max_vl_num;
  	resp.sm_sl 	     = attr.sm_sl;
diff --cc include/rdma/ib_verbs.h
index 9d98b1e7b1da,620535908118..000000000000
--- a/include/rdma/ib_verbs.h
+++ b/include/rdma/ib_verbs.h
@@@ -546,8 -549,8 +546,13 @@@ struct ib_port_attr 
  	u32			bad_pkey_cntr;
  	u32			qkey_viol_cntr;
  	u16			pkey_tbl_len;
++<<<<<<< HEAD
 +	u16			lid;
 +	u16			sm_lid;
++=======
+ 	u32			sm_lid;
+ 	u32			lid;
++>>>>>>> db58540b021a (IB/core: Change port_attr.sm_lid from 16 to 32 bits)
  	u8			lmc;
  	u8			max_vl_num;
  	u8			sm_sl;
* Unmerged path drivers/infiniband/core/uverbs_cmd.c
* Unmerged path include/rdma/ib_verbs.h
