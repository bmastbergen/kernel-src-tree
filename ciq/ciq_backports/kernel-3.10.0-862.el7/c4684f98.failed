s390/crypto: fix aes/paes Kconfig dependeny

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [s390] crypto: fix aes/paes Kconfig dependeny (Hendrik Brueckner) [1538139]
Rebuild_FUZZ: 93.83%
commit-author Harald Freudenberger <freude@linux.vnet.ibm.com>
commit c4684f98d3453dd07cc7ce67e0e795330eeec9c5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/c4684f98.failed

The s390_paes and the s390_aes kernel module used just one
config symbol CONFIG_CRYPTO_AES. As paes has a dependency
to PKEY and this requires ZCRYPT the aes module also had
a dependency to the zcrypt device driver which is not true.
Fixed by introducing a new config symbol CONFIG_CRYPTO_PAES
which has dependencies to PKEY and ZCRYPT. Removed the
dependency for the aes module to ZCRYPT.

	Signed-off-by: Harald Freudenberger <freude@linux.vnet.ibm.com>
	Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
(cherry picked from commit c4684f98d3453dd07cc7ce67e0e795330eeec9c5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/s390/crypto/Makefile
diff --cc arch/s390/crypto/Makefile
index 7f0b7cda6259,ad4bd777768d..000000000000
--- a/arch/s390/crypto/Makefile
+++ b/arch/s390/crypto/Makefile
@@@ -7,5 -7,10 +7,9 @@@ obj-$(CONFIG_CRYPTO_SHA256_S390) += sha
  obj-$(CONFIG_CRYPTO_SHA512_S390) += sha512_s390.o sha_common.o
  obj-$(CONFIG_CRYPTO_DES_S390) += des_s390.o
  obj-$(CONFIG_CRYPTO_AES_S390) += aes_s390.o
++<<<<<<< HEAD
++=======
+ obj-$(CONFIG_CRYPTO_PAES_S390) += paes_s390.o
++>>>>>>> c4684f98d345 (s390/crypto: fix aes/paes Kconfig dependeny)
  obj-$(CONFIG_S390_PRNG) += prng.o
  obj-$(CONFIG_CRYPTO_GHASH_S390) += ghash_s390.o
 -obj-$(CONFIG_CRYPTO_CRC32_S390) += crc32-vx_s390.o
 -obj-$(CONFIG_ARCH_RANDOM) += arch_random.o
 -
 -crc32-vx_s390-y := crc32-vx.o crc32le-vx.o crc32be-vx.o
* Unmerged path arch/s390/crypto/Makefile
diff --git a/drivers/crypto/Kconfig b/drivers/crypto/Kconfig
index f8f2b951026a..69145bcebf04 100644
--- a/drivers/crypto/Kconfig
+++ b/drivers/crypto/Kconfig
@@ -76,6 +76,20 @@ config ZCRYPT
 	  + Crypto Express3 Coprocessor (CEX3C)
 	  + Crypto Express3 Accelerator (CEX3A)
 
+config CRYPTO_PAES_S390
+	tristate "PAES cipher algorithms"
+	depends on S390
+	depends on ZCRYPT
+	depends on PKEY
+	select CRYPTO_ALGAPI
+	select CRYPTO_BLKCIPHER
+	help
+	  This is the s390 hardware accelerated implementation of the
+	  AES cipher algorithms for use with protected key.
+
+	  Select this option if you want to use the paes cipher
+	  for example to use protected key encrypted devices.
+
 config CRYPTO_SHA1_S390
 	tristate "SHA1 digest algorithm"
 	depends on S390
