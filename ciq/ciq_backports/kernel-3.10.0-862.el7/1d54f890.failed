IB/mlx5: Report RX checksum capabilities for IPoIB

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Yishai Hadas <yishaih@mellanox.com>
commit 1d54f89094e2d2067948550ec52aab93e15b4b0c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/1d54f890.failed

Report RX checksum capabilities when 'ipoib_enhanced_offloads'
capabilities are set and support checksum.

	Signed-off-by: Yishai Hadas <yishaih@mellanox.com>
	Reviewed-by: Maor Gottlieb <maorg@mellanox.com>
	Signed-off-by: Leon Romanovsky <leon@kernel.org>
	Signed-off-by: Doug Ledford <dledford@redhat.com>
(cherry picked from commit 1d54f89094e2d2067948550ec52aab93e15b4b0c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/mlx5/main.c
diff --cc drivers/infiniband/hw/mlx5/main.c
index 278c0964f404,2757d445b042..000000000000
--- a/drivers/infiniband/hw/mlx5/main.c
+++ b/drivers/infiniband/hw/mlx5/main.c
@@@ -659,6 -698,14 +659,17 @@@ static int mlx5_ib_query_device(struct 
  		props->device_cap_flags |= IB_DEVICE_UD_TSO;
  	}
  
++<<<<<<< HEAD
++=======
+ 	if (MLX5_CAP_GEN(dev->mdev, rq_delay_drop) &&
+ 	    MLX5_CAP_GEN(dev->mdev, general_notification_event))
+ 		props->raw_packet_caps |= IB_RAW_PACKET_CAP_DELAY_DROP;
+ 
+ 	if (MLX5_CAP_GEN(mdev, ipoib_enhanced_offloads) &&
+ 	    MLX5_CAP_IPOIB_ENHANCED(mdev, csum_cap))
+ 		props->device_cap_flags |= IB_DEVICE_UD_IP_CSUM;
+ 
++>>>>>>> 1d54f89094e2 (IB/mlx5: Report RX checksum capabilities for IPoIB)
  	if (MLX5_CAP_GEN(dev->mdev, eth_net_offloads) &&
  	    MLX5_CAP_ETH(dev->mdev, scatter_fcs)) {
  		/* Legacy bit to support old userspace libraries */
* Unmerged path drivers/infiniband/hw/mlx5/main.c
