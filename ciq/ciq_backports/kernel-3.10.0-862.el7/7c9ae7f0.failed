i40e: Fix for trace found with S4 state

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Carolyn Wyborny <carolyn.wyborny@intel.com>
commit 7c9ae7f053e9e896c24fd23595ba369a5fe322e1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/7c9ae7f0.failed

This patch fixes a problem found in systems when entering
S4 state.  This patch fixes the problem by ensuring that
the misc vector's IRQ is disabled as well.  Without this
patch a stack trace can be seen upon entering S4 state.

	Signed-off-by: Carolyn Wyborny <carolyn.wyborny@intel.com>
	Tested-by: Andrew Bowers <andrewx.bowers@intel.com>
	Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
(cherry picked from commit 7c9ae7f053e9e896c24fd23595ba369a5fe322e1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/i40e/i40e_main.c
diff --cc drivers/net/ethernet/intel/i40e/i40e_main.c
index fd58cc7c4ac4,933b8e357ee4..000000000000
--- a/drivers/net/ethernet/intel/i40e/i40e_main.c
+++ b/drivers/net/ethernet/intel/i40e/i40e_main.c
@@@ -12005,11 -12130,18 +12008,26 @@@ static int i40e_resume(struct pci_dev *
  	pci_wake_from_d3(pdev, false);
  
  	/* handling the reset will rebuild the device state */
++<<<<<<< HEAD
 +	if (test_and_clear_bit(__I40E_SUSPENDED, &pf->state)) {
 +		clear_bit(__I40E_DOWN, &pf->state);
 +		rtnl_lock();
 +		i40e_reset_and_rebuild(pf, false);
 +		rtnl_unlock();
++=======
+ 	if (test_and_clear_bit(__I40E_SUSPENDED, pf->state)) {
+ 		clear_bit(__I40E_DOWN, pf->state);
+ 		if (pf->msix_entries) {
+ 			err = request_irq(pf->msix_entries[0].vector,
+ 					  i40e_intr, 0, pf->int_name, pf);
+ 			if (err) {
+ 				dev_err(&pf->pdev->dev,
+ 					"request_irq for %s failed: %d\n",
+ 					pf->int_name, err);
+ 			}
+ 		}
+ 		i40e_reset_and_rebuild(pf, false, false);
++>>>>>>> 7c9ae7f053e9 (i40e: Fix for trace found with S4 state)
  	}
  
  	return 0;
* Unmerged path drivers/net/ethernet/intel/i40e/i40e_main.c
