ceph: avoid accessing / when mounting a subpath

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Yan, Zheng <zyan@redhat.com>
commit ce2728aaa82bbebae7d20345324af3f0f49eeb20
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/ce2728aa.failed

Accessing / causes failuire if the client has caps that restrict path

	Signed-off-by: Yan, Zheng <zyan@redhat.com>
(cherry picked from commit ce2728aaa82bbebae7d20345324af3f0f49eeb20)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/ceph/super.c
diff --cc fs/ceph/super.c
index f6ce4d2e42ba,a29ffce98187..000000000000
--- a/fs/ceph/super.c
+++ b/fs/ceph/super.c
@@@ -769,15 -790,10 +771,22 @@@ static struct dentry *open_root_dentry(
  		struct inode *inode = req->r_target_inode;
  		req->r_target_inode = NULL;
  		dout("open_root_inode success\n");
++<<<<<<< HEAD
 +		if (ceph_ino(inode) == CEPH_INO_ROOT &&
 +		    fsc->sb->s_root == NULL) {
 +			root = d_make_root(inode);
 +			if (!root) {
 +				root = ERR_PTR(-ENOMEM);
 +				goto out;
 +			}
 +		} else {
 +			root = d_obtain_alias(inode);
++=======
+ 		root = d_make_root(inode);
+ 		if (!root) {
+ 			root = ERR_PTR(-ENOMEM);
+ 			goto out;
++>>>>>>> ce2728aaa82b (ceph: avoid accessing / when mounting a subpath)
  		}
  		ceph_init_dentry(root);
  		dout("open_root_inode success, root dentry is %p\n", root);
* Unmerged path fs/ceph/super.c
