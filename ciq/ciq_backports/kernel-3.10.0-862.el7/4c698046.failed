net: ip6mr: fix static mfc/dev leaks on table destruction

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [net] ip6mr: fix static mfc/dev leaks on table destruction (Matteo Croce) [1445046]
Rebuild_FUZZ: 95.41%
commit-author Nikolay Aleksandrov <nikolay@cumulusnetworks.com>
commit 4c6980462f32b4f282c5d8e5f7ea8070e2937725
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/4c698046.failed

Similar to ipv4, when destroying an mrt table the static mfc entries and
the static devices are kept, which leads to devices that can never be
destroyed (because of refcnt taken) and leaked memory. Make sure that
everything is cleaned up on netns destruction.

Fixes: 8229efdaef1e ("netns: ip6mr: enable namespace support in ipv6 multicast forwarding code")
CC: Benjamin Thery <benjamin.thery@bull.net>
	Signed-off-by: Nikolay Aleksandrov <nikolay@cumulusnetworks.com>
	Reviewed-by: Cong Wang <cwang@twopensource.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 4c6980462f32b4f282c5d8e5f7ea8070e2937725)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv6/ip6mr.c
diff --cc net/ipv6/ip6mr.c
index c99bd79e4c53,7a4a1b81dbb6..000000000000
--- a/net/ipv6/ip6mr.c
+++ b/net/ipv6/ip6mr.c
@@@ -333,8 -333,8 +333,13 @@@ static struct mr6_table *ip6mr_new_tabl
  
  static void ip6mr_free_table(struct mr6_table *mrt)
  {
++<<<<<<< HEAD
 +	del_timer(&mrt->ipmr_expire_timer);
 +	mroute_clean_tables(mrt);
++=======
+ 	del_timer_sync(&mrt->ipmr_expire_timer);
+ 	mroute_clean_tables(mrt, true);
++>>>>>>> 4c6980462f32 (net: ip6mr: fix static mfc/dev leaks on table destruction)
  	kfree(mrt);
  }
  
* Unmerged path net/ipv6/ip6mr.c
