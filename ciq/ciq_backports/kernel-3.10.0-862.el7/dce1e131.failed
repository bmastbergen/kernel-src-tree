drm/amdgpu: bypass lru touch for KIQ ring submission

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Pixel Ding <Pixel.Ding@amd.com>
commit dce1e131dd4dc68099ff1b70aa03cd2d0acf8639
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/dce1e131.failed

KIQ ring submission is used for register accessing on SRIOV
VF that could happen both in irq enabled and irq disabled cases.
Inversion lock could happen on adev->ring_lru_list_lock, while
this operation is useless and just adds overhead in this use
case.

	Signed-off-by: Pixel Ding <Pixel.Ding@amd.com>
	Reviewed-by: Monk Liu <Monk.Liu@amd.com>
	Reviewed-by: Christian KÃ¶nig <christian.koenig@amd.com>
	Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
(cherry picked from commit dce1e131dd4dc68099ff1b70aa03cd2d0acf8639)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/amd/amdgpu/amdgpu_ring.c
diff --cc drivers/gpu/drm/amd/amdgpu/amdgpu_ring.c
index 5ac217b1bd84,a98fbbb4739f..000000000000
--- a/drivers/gpu/drm/amd/amdgpu/amdgpu_ring.c
+++ b/drivers/gpu/drm/amd/amdgpu/amdgpu_ring.c
@@@ -135,6 -135,9 +135,12 @@@ void amdgpu_ring_commit(struct amdgpu_r
  
  	if (ring->funcs->end_use)
  		ring->funcs->end_use(ring);
++<<<<<<< HEAD
++=======
+ 
+ 	if (ring->funcs->type != AMDGPU_RING_TYPE_KIQ)
+ 		amdgpu_ring_lru_touch(ring->adev, ring);
++>>>>>>> dce1e131dd4d (drm/amdgpu: bypass lru touch for KIQ ring submission)
  }
  
  /**
* Unmerged path drivers/gpu/drm/amd/amdgpu/amdgpu_ring.c
