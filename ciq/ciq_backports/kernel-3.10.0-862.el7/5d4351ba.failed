livepatch: x86: make kASLR logic more accurate

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Jiri Kosina <jkosina@suse.cz>
commit 5d4351ba654c2f25eb4f6883db742a16bccbb36b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/5d4351ba.failed

We give up old_addr hint from the coming patch module in cases when kernel load
base has been randomized (as in such case, the coming module has no idea about
the exact randomization offset).

We are currently too pessimistic, and give up immediately as soon as
CONFIG_RANDOMIZE_BASE is set; this doesn't however directly imply that the
load base has actually been randomized. There are config options that
disable kASLR (such as hibernation), user could have disabled kaslr on
kernel command-line, etc.

The loader propagates the information whether kernel has been randomized
through bootparams. This allows us to have the condition more accurate.

On top of that, it seems unnecessary to give up old_addr hints even if
randomization is active. The relocation offset can be computed using
kaslr_ofsset(), and therefore old_addr can be adjusted accordingly.

	Acked-by: Josh Poimboeuf <jpoimboe@redhat.com>
	Signed-off-by: Jiri Kosina <jkosina@suse.cz>
(cherry picked from commit 5d4351ba654c2f25eb4f6883db742a16bccbb36b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/include/asm/livepatch.h
#	kernel/livepatch/core.c
* Unmerged path arch/x86/include/asm/livepatch.h
* Unmerged path kernel/livepatch/core.c
* Unmerged path arch/x86/include/asm/livepatch.h
* Unmerged path kernel/livepatch/core.c
