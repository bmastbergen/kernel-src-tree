drm/amdgpu: Use unsigned ring indices in amdgpu_queue_mgr_map

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Michel Dänzer <michel.daenzer@amd.com>
commit fa7c7939b4bf112cd06ba166b739244077898990
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/fa7c7939.failed

This matches the corresponding UAPI fields. Treating the ring index as
signed could result in accessing random unrelated memory if the MSB was
set.

Fixes: effd924d2f3b ("drm/amdgpu: untie user ring ids from kernel ring
                      ids v6")
	Cc: stable@vger.kernel.org
	Reviewed-by: Alex Deucher <alexander.deucher@amd.com>
	Reviewed-by: Christian König <christian.koenig@amd.com>
	Signed-off-by: Michel Dänzer <michel.daenzer@amd.com>
	Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
(cherry picked from commit fa7c7939b4bf112cd06ba166b739244077898990)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/amd/amdgpu/amdgpu.h
#	drivers/gpu/drm/amd/amdgpu/amdgpu_queue_mgr.c
diff --cc drivers/gpu/drm/amd/amdgpu/amdgpu.h
index 6288d34f9a27,0b14b5373783..000000000000
--- a/drivers/gpu/drm/amd/amdgpu/amdgpu.h
+++ b/drivers/gpu/drm/amd/amdgpu/amdgpu.h
@@@ -648,6 -698,29 +648,32 @@@ int amdgpu_job_submit(struct amdgpu_jo
  		      struct dma_fence **f);
  
  /*
++<<<<<<< HEAD
++=======
+  * Queue manager
+  */
+ struct amdgpu_queue_mapper {
+ 	int 		hw_ip;
+ 	struct mutex	lock;
+ 	/* protected by lock */
+ 	struct amdgpu_ring *queue_map[AMDGPU_MAX_RINGS];
+ };
+ 
+ struct amdgpu_queue_mgr {
+ 	struct amdgpu_queue_mapper mapper[AMDGPU_MAX_IP_NUM];
+ };
+ 
+ int amdgpu_queue_mgr_init(struct amdgpu_device *adev,
+ 			  struct amdgpu_queue_mgr *mgr);
+ int amdgpu_queue_mgr_fini(struct amdgpu_device *adev,
+ 			  struct amdgpu_queue_mgr *mgr);
+ int amdgpu_queue_mgr_map(struct amdgpu_device *adev,
+ 			 struct amdgpu_queue_mgr *mgr,
+ 			 u32 hw_ip, u32 instance, u32 ring,
+ 			 struct amdgpu_ring **out_ring);
+ 
+ /*
++>>>>>>> fa7c7939b4bf (drm/amdgpu: Use unsigned ring indices in amdgpu_queue_mgr_map)
   * context related structures
   */
  
* Unmerged path drivers/gpu/drm/amd/amdgpu/amdgpu_queue_mgr.c
* Unmerged path drivers/gpu/drm/amd/amdgpu/amdgpu.h
* Unmerged path drivers/gpu/drm/amd/amdgpu/amdgpu_queue_mgr.c
