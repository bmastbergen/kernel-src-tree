net: sched: fix NULL pointer dereference when action calls some targets

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [net] sched: fix NULL pointer dereference when action calls some targets (Ivan Vecera) [1445420]
Rebuild_FUZZ: 96.35%
commit-author Xin Long <lucien.xin@gmail.com>
commit 4f8a881acc9d1adaf1e552349a0b1df28933a04c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/4f8a881a.failed

As we know in some target's checkentry it may dereference par.entryinfo
to check entry stuff inside. But when sched action calls xt_check_target,
par.entryinfo is set with NULL. It would cause kernel panic when calling
some targets.

It can be reproduce with:
  # tc qd add dev eth1 ingress handle ffff:
  # tc filter add dev eth1 parent ffff: u32 match u32 0 0 action xt \
    -j ECN --ecn-tcp-remove

It could also crash kernel when using target CLUSTERIP or TPROXY.

By now there's no proper value for par.entryinfo in ipt_init_target,
but it can not be set with NULL. This patch is to void all these
panics by setting it with an ipt_entry obj with all members = 0.

Note that this issue has been there since the very beginning.

	Signed-off-by: Xin Long <lucien.xin@gmail.com>
	Acked-by: Pablo Neira Ayuso <pablo@netfilter.org>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 4f8a881acc9d1adaf1e552349a0b1df28933a04c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sched/act_ipt.c
diff --cc net/sched/act_ipt.c
index 014563af32c0,541707802a23..000000000000
--- a/net/sched/act_ipt.c
+++ b/net/sched/act_ipt.c
@@@ -43,8 -50,10 +44,12 @@@ static int ipt_init_target(struct xt_en
  		return PTR_ERR(target);
  
  	t->u.kernel.target = target;
 -	memset(&par, 0, sizeof(par));
 -	par.net       = net;
  	par.table     = table;
++<<<<<<< HEAD
 +	par.entryinfo = NULL;
++=======
+ 	par.entryinfo = &e;
++>>>>>>> 4f8a881acc9d (net: sched: fix NULL pointer dereference when action calls some targets)
  	par.target    = target;
  	par.targinfo  = t->data;
  	par.hook_mask = hook;
* Unmerged path net/sched/act_ipt.c
