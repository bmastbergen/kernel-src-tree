mlxsw: spectrum: Fix error return code in mlxsw_sp_port_create()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Wei Yongjun <weiyongjun1@huawei.com>
commit d86fd113ebbb37726ef7c7cc6fd6d5ce377455d6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/d86fd113.failed

Fix to return a negative error code from the VID  create error handling
case instead of 0, as done elsewhere in this function.

Fixes: c57529e1d5d8 ("mlxsw: spectrum: Replace vPorts with Port-VLAN")
	Signed-off-by: Wei Yongjun <weiyongjun1@huawei.com>
	Reviewed-by: Ido Schimmel <idosch@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit d86fd113ebbb37726ef7c7cc6fd6d5ce377455d6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlxsw/spectrum.c
diff --cc drivers/net/ethernet/mellanox/mlxsw/spectrum.c
index de9fab4f42e6,b2cd1ebf4e36..000000000000
--- a/drivers/net/ethernet/mellanox/mlxsw/spectrum.c
+++ b/drivers/net/ethernet/mellanox/mlxsw/spectrum.c
@@@ -2948,18 -3032,19 +2948,23 @@@ static int __mlxsw_sp_port_create(struc
  		goto err_port_dcb_init;
  	}
  
 -	err = mlxsw_sp_port_fids_init(mlxsw_sp_port);
 +	err = mlxsw_sp_port_vp_mode_set(mlxsw_sp_port, false);
  	if (err) {
 -		dev_err(mlxsw_sp->bus_info->dev, "Port %d: Failed to initialize FIDs\n",
 +		dev_err(mlxsw_sp->bus_info->dev, "Port %d: Failed to set non-virtual mode\n",
  			mlxsw_sp_port->local_port);
 -		goto err_port_fids_init;
 +		goto err_port_vp_mode_set;
  	}
  
 -	mlxsw_sp_port_vlan = mlxsw_sp_port_vlan_get(mlxsw_sp_port, 1);
 -	if (IS_ERR(mlxsw_sp_port_vlan)) {
 -		dev_err(mlxsw_sp->bus_info->dev, "Port %d: Failed to create VID 1\n",
 +	err = mlxsw_sp_port_pvid_vport_create(mlxsw_sp_port);
 +	if (err) {
 +		dev_err(mlxsw_sp->bus_info->dev, "Port %d: Failed to create PVID vPort\n",
  			mlxsw_sp_port->local_port);
++<<<<<<< HEAD
 +		goto err_port_pvid_vport_create;
++=======
+ 		err = PTR_ERR(mlxsw_sp_port_vlan);
+ 		goto err_port_vlan_get;
++>>>>>>> d86fd113ebbb (mlxsw: spectrum: Fix error return code in mlxsw_sp_port_create())
  	}
  
  	mlxsw_sp_port_switchdev_init(mlxsw_sp_port);
* Unmerged path drivers/net/ethernet/mellanox/mlxsw/spectrum.c
