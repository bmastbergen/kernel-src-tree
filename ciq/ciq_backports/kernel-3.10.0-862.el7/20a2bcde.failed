drm/i915/gvt: Extract mmio_read_from_hw() common function

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Xiong Zhang <xiong.y.zhang@intel.com>
commit 20a2bcdec5071f78bebe48c5eecdb89de6e96acb
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/20a2bcde.failed

The mmio read handler for ring timestmap / instdone register are same
as reading hw value directly.

Extract it as common function to reduce code duplications.

	Signed-off-by: Xiong Zhang <xiong.y.zhang@intel.com>
	Signed-off-by: Zhi Wang <zhi.a.wang@intel.com>
(cherry picked from commit 20a2bcdec5071f78bebe48c5eecdb89de6e96acb)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/i915/gvt/handlers.c
diff --cc drivers/gpu/drm/i915/gvt/handlers.c
index 4a24dc155ace,c24341f174d3..000000000000
--- a/drivers/gpu/drm/i915/gvt/handlers.c
+++ b/drivers/gpu/drm/i915/gvt/handlers.c
@@@ -1394,12 -1429,14 +1394,22 @@@ static int skl_lcpll_write(struct intel
  	return 0;
  }
  
++<<<<<<< HEAD
 +static int ring_timestamp_mmio_read(struct intel_vgpu *vgpu,
++=======
+ static int mmio_read_from_hw(struct intel_vgpu *vgpu,
++>>>>>>> 20a2bcdec507 (drm/i915/gvt: Extract mmio_read_from_hw() common function)
  		unsigned int offset, void *p_data, unsigned int bytes)
  {
  	struct drm_i915_private *dev_priv = vgpu->gvt->dev_priv;
  
++<<<<<<< HEAD
 +	vgpu_vreg(vgpu, offset) = I915_READ(_MMIO(offset));
++=======
+ 	mmio_hw_access_pre(dev_priv);
+ 	vgpu_vreg(vgpu, offset) = I915_READ(_MMIO(offset));
+ 	mmio_hw_access_post(dev_priv);
++>>>>>>> 20a2bcdec507 (drm/i915/gvt: Extract mmio_read_from_hw() common function)
  	return intel_vgpu_default_mmio_read(vgpu, offset, p_data, bytes);
  }
  
@@@ -1586,6 -1625,11 +1596,14 @@@ static int init_generic_mmio_info(struc
  	MMIO_RING_DFH(RING_REG, D_ALL, F_CMD_ACCESS, NULL, NULL);
  #undef RING_REG
  
++<<<<<<< HEAD
++=======
+ #define RING_REG(base) (base + 0x6c)
+ 	MMIO_RING_DFH(RING_REG, D_ALL, 0, mmio_read_from_hw, NULL);
+ #undef RING_REG
+ 	MMIO_DH(GEN7_SC_INSTDONE, D_BDW_PLUS, mmio_read_from_hw, NULL);
+ 
++>>>>>>> 20a2bcdec507 (drm/i915/gvt: Extract mmio_read_from_hw() common function)
  	MMIO_GM_RDR(0x2148, D_ALL, NULL, NULL);
  	MMIO_GM_RDR(CCID, D_ALL, NULL, NULL);
  	MMIO_GM_RDR(0x12198, D_ALL, NULL, NULL);
* Unmerged path drivers/gpu/drm/i915/gvt/handlers.c
