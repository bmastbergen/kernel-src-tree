net/mlx5: FPGA, Move FPGA init/cleanup to init_once

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [netdrv] mlx5: FPGA, Move FPGA init/cleanup to init_once (Kamal Heib) [1456677 1456694]
Rebuild_FUZZ: 95.92%
commit-author Ilan Tayari <ilant@mellanox.com>
commit 9410733c44d768b085af3877ccf63efa298168e9
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/9410733c.failed

The FPGA init and cleanup routines should be called just once per
device.
Move them to the init_once and cleanup_once routines.

	Signed-off-by: Ilan Tayari <ilant@mellanox.com>
	Signed-off-by: Saeed Mahameed <saeedm@mellanox.com>
(cherry picked from commit 9410733c44d768b085af3877ccf63efa298168e9)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/fpga/core.c
#	drivers/net/ethernet/mellanox/mlx5/core/fpga/core.h
#	drivers/net/ethernet/mellanox/mlx5/core/main.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/main.c
index 8f24af5b517a,684612778677..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/main.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/main.c
@@@ -1102,7 -1133,7 +1111,11 @@@ static int mlx5_load_one(struct mlx5_co
  	err = mlx5_start_eqs(dev);
  	if (err) {
  		dev_err(&pdev->dev, "Failed to start pages and async EQs\n");
++<<<<<<< HEAD
 +		goto err_free_uar;
++=======
+ 		goto err_put_uars;
++>>>>>>> 9410733c44d7 (net/mlx5: FPGA, Move FPGA init/cleanup to init_once)
  	}
  
  	err = alloc_comp_eqs(dev);
@@@ -1168,8 -1208,8 +1181,13 @@@ err_affinity_hints
  err_stop_eqs:
  	mlx5_stop_eqs(dev);
  
++<<<<<<< HEAD
 +err_free_uar:
 +	mlx5_free_uuars(dev, &priv->uuari);
++=======
+ err_put_uars:
+ 	mlx5_put_uars_page(dev, priv->uar);
++>>>>>>> 9410733c44d7 (net/mlx5: FPGA, Move FPGA init/cleanup to init_once)
  
  err_disable_msix:
  	mlx5_disable_msix(dev);
@@@ -1235,7 -1277,7 +1253,11 @@@ static int mlx5_unload_one(struct mlx5_
  	mlx5_irq_clear_affinity_hints(dev);
  	free_comp_eqs(dev);
  	mlx5_stop_eqs(dev);
++<<<<<<< HEAD
 +	mlx5_free_uuars(dev, &priv->uuari);
++=======
+ 	mlx5_put_uars_page(dev, priv->uar);
++>>>>>>> 9410733c44d7 (net/mlx5: FPGA, Move FPGA init/cleanup to init_once)
  	mlx5_disable_msix(dev);
  	if (cleanup)
  		mlx5_cleanup_once(dev);
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/fpga/core.c
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/fpga/core.h
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/fpga/core.c
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/fpga/core.h
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/main.c
