dm mpath: remove annoying message of 'blk_get_request() returned -11'

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Ming Lei <ming.lei@redhat.com>
commit 9dc112e2daf87b40607fd8d357e2d7de32290d45
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/9dc112e2.failed

It is very normal to see allocation failure, especially with blk-mq
request_queues, so it's unnecessary to report this error and annoy
people.

In practice this 'blk_get_request() returned -11' error gets logged
quite frequently when a blk-mq DM multipath device sees heavy IO.

This change is marked for stable@ because the annoying message in
question was included in stable@ commit 7083abbbf.

Fixes: 7083abbbf ("dm mpath: avoid that path removal can trigger an infinite loop")
	Cc: stable@vger.kernel.org
	Signed-off-by: Ming Lei <ming.lei@redhat.com>
	Signed-off-by: Mike Snitzer <snitzer@redhat.com>
(cherry picked from commit 9dc112e2daf87b40607fd8d357e2d7de32290d45)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/md/dm-mpath.c
diff --cc drivers/md/dm-mpath.c
index 745e8192f19b,e8094d8fbe0d..000000000000
--- a/drivers/md/dm-mpath.c
+++ b/drivers/md/dm-mpath.c
@@@ -574,33 -494,21 +574,44 @@@ static int __multipath_map(struct dm_ta
  	mpio->nr_bytes = nr_bytes;
  
  	bdev = pgpath->path.dev->bdev;
++<<<<<<< HEAD
 +
 +	if (clone) {
 +		/*
 +		 * Old request-based interface: allocated clone is passed in.
 +		 * Used by: .request_fn stacked on .request_fn path(s).
 +		 */
 +		clone->q = bdev_get_queue(bdev);
 +		clone->rq_disk = bdev->bd_disk;
 +		clone->cmd_flags |= REQ_FAILFAST_TRANSPORT;
 +	} else {
 +		/*
 +		 * blk-mq request-based interface; used by both:
 +		 * .request_fn stacked on blk-mq path(s) and
 +		 * blk-mq stacked on blk-mq path(s).
 +		 */
 +		clone = blk_mq_alloc_request(bdev_get_queue(bdev),
 +					     rq_data_dir(rq), BLK_MQ_REQ_NOWAIT);
 +		if (IS_ERR(clone)) {
 +			/* EBUSY, ENODEV or EWOULDBLOCK: requeue */
 +			clear_request_fn_mpio(m, map_context);
 +			return DM_MAPIO_DELAY_REQUEUE;
++=======
+ 	q = bdev_get_queue(bdev);
+ 	clone = blk_get_request(q, rq->cmd_flags | REQ_NOMERGE, GFP_ATOMIC);
+ 	if (IS_ERR(clone)) {
+ 		/* EBUSY, ENODEV or EWOULDBLOCK: requeue */
+ 		bool queue_dying = blk_queue_dying(q);
+ 		if (queue_dying) {
+ 			atomic_inc(&m->pg_init_in_progress);
+ 			activate_or_offline_path(pgpath);
++>>>>>>> 9dc112e2daf8 (dm mpath: remove annoying message of 'blk_get_request() returned -11')
  		}
 -		return DM_MAPIO_DELAY_REQUEUE;
 +		clone->bio = clone->biotail = NULL;
 +		clone->rq_disk = bdev->bd_disk;
 +		clone->cmd_flags |= REQ_FAILFAST_TRANSPORT;
 +		*__clone = clone;
  	}
 -	clone->bio = clone->biotail = NULL;
 -	clone->rq_disk = bdev->bd_disk;
 -	clone->cmd_flags |= REQ_FAILFAST_TRANSPORT;
 -	*__clone = clone;
  
  	if (pgpath->pg->ps.type->start_io)
  		pgpath->pg->ps.type->start_io(&pgpath->pg->ps,
* Unmerged path drivers/md/dm-mpath.c
