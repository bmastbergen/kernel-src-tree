iommu: Simplify and fix ida handling

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [iommu] Simplify and fix ida handling (Jerry Snitselaar) [1499325]
Rebuild_FUZZ: 89.23%
commit-author Heiner Kallweit <hkallweit1@gmail.com>
commit feccf398db631f3b98c4c6572381517d90b5fd87
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/feccf398.failed

Ida handling can be much simplified by using the ida_simple_.. functions.

This change also fixes the bug that previously checking for errors
returned by ida_get_new() was incomplete.
ida_get_new() can return errors other than EAGAIN, e.g. ENOSPC.
This case wasn't handled.

	Signed-off-by: Heiner Kallweit <hkallweit1@gmail.com>
	Signed-off-by: Joerg Roedel <jroedel@suse.de>
(cherry picked from commit feccf398db631f3b98c4c6572381517d90b5fd87)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/iommu/iommu.c
diff --cc drivers/iommu/iommu.c
index ed280e2e60fd,4d3c4a82af03..000000000000
--- a/drivers/iommu/iommu.c
+++ b/drivers/iommu/iommu.c
@@@ -34,11 -34,10 +34,15 @@@
  #include <trace/events/iommu.h>
  
  static struct kset *iommu_group_kset;
++<<<<<<< HEAD
 +static struct ida iommu_group_ida;
 +static struct mutex iommu_group_mutex;
++=======
+ static DEFINE_IDA(iommu_group_ida);
++>>>>>>> feccf398db63 (iommu: Simplify and fix ida handling)
  
  struct iommu_callback_data {
 -	const struct iommu_ops *ops;
 +	struct iommu_ops *ops;
  };
  
  struct iommu_group {
* Unmerged path drivers/iommu/iommu.c
