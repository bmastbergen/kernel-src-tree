x86/gpu: add CFL to early quirks

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [x86] gpu: add CFL to early quirks (Rob Clark) [1532388]
Rebuild_FUZZ: 93.33%
commit-author Lucas De Marchi <lucas.demarchi@intel.com>
commit 33aa69ed8aacd92dea12671e52eb3ca6ac2d7a49
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/33aa69ed.failed

CFL was missing from intel_early_ids[]. The PCI ID needs to be there to
allow the memory region to be stolen, otherwise we could have RAM being
arbitrarily overwritten if for example we keep using the UEFI framebuffer,
depending on how BIOS has set up the e820 map.

Fixes: b056f8f3d6b9 ("drm/i915/cfl: Add Coffee Lake PCI IDs for S Skus.")
	Signed-off-by: Lucas De Marchi <lucas.demarchi@intel.com>
	Cc: Rodrigo Vivi <rodrigo.vivi@intel.com>
	Cc: Anusha Srivatsa <anusha.srivatsa@intel.com>
	Cc: Jani Nikula <jani.nikula@linux.intel.com>
	Cc: Joonas Lahtinen <joonas.lahtinen@linux.intel.com>
	Cc: David Airlie <airlied@linux.ie>
	Cc: intel-gfx@lists.freedesktop.org
	Cc: dri-devel@lists.freedesktop.org
	Cc: Ingo Molnar <mingo@kernel.org>
	Cc: H. Peter Anvin <hpa@zytor.com>
	Cc: Thomas Gleixner <tglx@linutronix.de>
	Cc: x86@kernel.org
	Cc: <stable@vger.kernel.org> # v4.13+ 0890540e21cf drm/i915: add GT number to intel_device_info
	Cc: <stable@vger.kernel.org> # v4.13+ 41693fd52373 drm/i915/kbl: Change a KBL pci id to GT2 from GT1.5
	Cc: <stable@vger.kernel.org> # v4.13+
	Reviewed-by: Rodrigo Vivi <rodrigo.vivi@intel.com>
	Acked-by: Jani Nikula <jani.nikula@intel.com>
	Acked-by: Ingo Molnar <mingo@kernel.org>
	Signed-off-by: Rodrigo Vivi <rodrigo.vivi@intel.com>
Link: https://patchwork.freedesktop.org/patch/msgid/20171213200425.2954-1-lucas.demarchi@intel.com
(cherry picked from commit 33aa69ed8aacd92dea12671e52eb3ca6ac2d7a49)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/drm/i915_pciids.h
diff --cc include/drm/i915_pciids.h
index 61766a420f6b,c65e4489006d..000000000000
--- a/include/drm/i915_pciids.h
+++ b/include/drm/i915_pciids.h
@@@ -321,4 -370,52 +321,55 @@@
  	INTEL_KBL_GT3_IDS(info), \
  	INTEL_KBL_GT4_IDS(info)
  
++<<<<<<< HEAD
++=======
+ /* CFL S */
+ #define INTEL_CFL_S_GT1_IDS(info) \
+ 	INTEL_VGA_DEVICE(0x3E90, info), /* SRV GT1 */ \
+ 	INTEL_VGA_DEVICE(0x3E93, info)  /* SRV GT1 */
+ 
+ #define INTEL_CFL_S_GT2_IDS(info) \
+ 	INTEL_VGA_DEVICE(0x3E91, info), /* SRV GT2 */ \
+ 	INTEL_VGA_DEVICE(0x3E92, info), /* SRV GT2 */ \
+ 	INTEL_VGA_DEVICE(0x3E96, info)  /* SRV GT2 */
+ 
+ /* CFL H */
+ #define INTEL_CFL_H_GT2_IDS(info) \
+ 	INTEL_VGA_DEVICE(0x3E9B, info), /* Halo GT2 */ \
+ 	INTEL_VGA_DEVICE(0x3E94, info)  /* Halo GT2 */
+ 
+ /* CFL U */
+ #define INTEL_CFL_U_GT3_IDS(info) \
+ 	INTEL_VGA_DEVICE(0x3EA6, info), /* ULT GT3 */ \
+ 	INTEL_VGA_DEVICE(0x3EA7, info), /* ULT GT3 */ \
+ 	INTEL_VGA_DEVICE(0x3EA8, info), /* ULT GT3 */ \
+ 	INTEL_VGA_DEVICE(0x3EA5, info)  /* ULT GT3 */
+ 
+ #define INTEL_CFL_IDS(info) \
+ 	INTEL_CFL_S_GT1_IDS(info), \
+ 	INTEL_CFL_S_GT2_IDS(info), \
+ 	INTEL_CFL_H_GT2_IDS(info), \
+ 	INTEL_CFL_U_GT3_IDS(info)
+ 
+ /* CNL U 2+2 */
+ #define INTEL_CNL_U_GT2_IDS(info) \
+ 	INTEL_VGA_DEVICE(0x5A52, info), \
+ 	INTEL_VGA_DEVICE(0x5A5A, info), \
+ 	INTEL_VGA_DEVICE(0x5A42, info), \
+ 	INTEL_VGA_DEVICE(0x5A4A, info)
+ 
+ /* CNL Y 2+2 */
+ #define INTEL_CNL_Y_GT2_IDS(info) \
+ 	INTEL_VGA_DEVICE(0x5A51, info), \
+ 	INTEL_VGA_DEVICE(0x5A59, info), \
+ 	INTEL_VGA_DEVICE(0x5A41, info), \
+ 	INTEL_VGA_DEVICE(0x5A49, info), \
+ 	INTEL_VGA_DEVICE(0x5A71, info), \
+ 	INTEL_VGA_DEVICE(0x5A79, info)
+ 
+ #define INTEL_CNL_IDS(info) \
+ 	INTEL_CNL_U_GT2_IDS(info), \
+ 	INTEL_CNL_Y_GT2_IDS(info)
+ 
++>>>>>>> 33aa69ed8aac (x86/gpu: add CFL to early quirks)
  #endif /* _I915_PCIIDS_H */
diff --git a/arch/x86/kernel/early-quirks.c b/arch/x86/kernel/early-quirks.c
index e9f54a98b2d9..16fdb4005bf8 100644
--- a/arch/x86/kernel/early-quirks.c
+++ b/arch/x86/kernel/early-quirks.c
@@ -515,6 +515,7 @@ static const struct pci_device_id intel_early_ids[] __initconst = {
 	INTEL_SKL_IDS(&gen9_early_ops),
 	INTEL_BXT_IDS(&gen9_early_ops),
 	INTEL_KBL_IDS(&gen9_early_ops),
+	INTEL_CFL_IDS(&gen9_early_ops),
 	INTEL_GLK_IDS(&gen9_early_ops),
 	INTEL_CNL_IDS(&gen9_early_ops),
 };
* Unmerged path include/drm/i915_pciids.h
