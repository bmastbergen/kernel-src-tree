net: sched: cls_flower: fix ndo_setup_tc type for stats call

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [net] sched: cls_flower: fix ndo_setup_tc type for stats call (Ivan Vecera) [1445420]
Rebuild_FUZZ: 95.65%
commit-author Jiri Pirko <jiri@mellanox.com>
commit d978db8dbebb60a51492da966689dfc0c9216c44
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/d978db8d.failed

I made a stupid mistake using TC_CLSFLOWER_STATS instead of
TC_SETUP_CLSFLOWER. Funny thing is that both are defined as "2" so it
actually did not cause any harm. Anyway, fixing it now.

Fixes: 2572ac53c46f ("net: sched: make type an argument for ndo_setup_tc")
	Signed-off-by: Jiri Pirko <jiri@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit d978db8dbebb60a51492da966689dfc0c9216c44)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/sched/cls_flower.c
diff --cc net/sched/cls_flower.c
index 2d81cc7499da,bd9dab41f8af..000000000000
--- a/net/sched/cls_flower.c
+++ b/net/sched/cls_flower.c
@@@ -287,22 -278,19 +287,27 @@@ static int fl_hw_replace_filter(struct 
  
  static void fl_hw_update_stats(struct tcf_proto *tp, struct cls_fl_filter *f)
  {
 -	struct tc_cls_flower_offload cls_flower = {};
 +	struct tc_cls_flower_offload offload = {0};
  	struct net_device *dev = f->hw_dev;
 +	struct tc_to_netdev *tc = &f->tc;
  
 -	if (!tc_can_offload(dev))
 +	if (!tc_can_offload(dev, tp))
  		return;
  
 -	tc_cls_common_offload_init(&cls_flower.common, tp);
 -	cls_flower.command = TC_CLSFLOWER_STATS;
 -	cls_flower.cookie = (unsigned long) f;
 -	cls_flower.exts = &f->exts;
 +	offload.command = TC_CLSFLOWER_STATS;
 +	offload.prio = tp->prio;
 +	offload.cookie = (unsigned long)f;
 +	offload.exts = &f->exts;
 +
++<<<<<<< HEAD
 +	tc->type = TC_SETUP_CLSFLOWER;
 +	tc->cls_flower = &offload;
  
 +	dev->netdev_ops->ndo_setup_tc(dev, tp->q->handle, tp->protocol, tc);
++=======
+ 	dev->netdev_ops->ndo_setup_tc(dev, TC_SETUP_CLSFLOWER,
+ 				      &cls_flower);
++>>>>>>> d978db8dbebb (net: sched: cls_flower: fix ndo_setup_tc type for stats call)
  }
  
  static void __fl_delete(struct tcf_proto *tp, struct cls_fl_filter *f)
* Unmerged path net/sched/cls_flower.c
