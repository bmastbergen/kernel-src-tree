x86/mm: Centralize PMD flags in sme_encrypt_kernel()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [x86] mm: Centralize PMD flags in sme_encrypt_kernel() (Suravee Suthikulpanit) [1540104]
Rebuild_FUZZ: 96.00%
commit-author Tom Lendacky <thomas.lendacky@amd.com>
commit 2b5d00b6c2cdd94f6d6a494a6f6c0c0fc7b8e711
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/2b5d00b6.failed

In preparation for encrypting more than just the kernel during early
boot processing, centralize the use of the PMD flag settings based
on the type of mapping desired.  When 4KB aligned encryption is added,
this will allow either PTE flags or large page PMD flags to be used
without requiring the caller to adjust.

	Tested-by: Gabriel Craciunescu <nix.or.die@gmail.com>
	Signed-off-by: Tom Lendacky <thomas.lendacky@amd.com>
	Reviewed-by: Borislav Petkov <bp@suse.de>
	Cc: Borislav Petkov <bp@alien8.de>
	Cc: Brijesh Singh <brijesh.singh@amd.com>
	Cc: Linus Torvalds <torvalds@linux-foundation.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Thomas Gleixner <tglx@linutronix.de>
Link: http://lkml.kernel.org/r/20180110192615.6026.14767.stgit@tlendack-t1.amdoffice.net
	Signed-off-by: Ingo Molnar <mingo@kernel.org>
(cherry picked from commit 2b5d00b6c2cdd94f6d6a494a6f6c0c0fc7b8e711)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/mm/mem_encrypt.c
* Unmerged path arch/x86/mm/mem_encrypt.c
* Unmerged path arch/x86/mm/mem_encrypt.c
