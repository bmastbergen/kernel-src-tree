qed: Fix setting of Management bitfields

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Tomer Tayar <Tomer.Tayar@cavium.com>
commit b19601bbf1a1a230beb35ea77acbbfb5bbf542fa
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/b19601bb.failed

The management firmware HSI contains masks which are already
shifted to their right place, so QED_MFW_SET_FIELD() is clearing
incorrect fields by shifting the mask by the offset.

Luckily, today we set the fields in an incrementing order [so we're
not erasing any previously set fields], but this still needs fixing.

	Signed-off-by: Tomer Tayar <Tomer.Tayar@cavium.com>
	Signed-off-by: Yuval Mintz <Yuval.Mintz@cavium.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit b19601bbf1a1a230beb35ea77acbbfb5bbf542fa)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/qlogic/qed/qed.h
diff --cc drivers/net/ethernet/qlogic/qed/qed.h
index 94f6dd236e7f,fd8cf31cce05..000000000000
--- a/drivers/net/ethernet/qlogic/qed/qed.h
+++ b/drivers/net/ethernet/qlogic/qed/qed.h
@@@ -75,6 -87,15 +75,18 @@@ union qed_mcp_protocol_stats
  enum qed_mcp_protocol_type;
  
  /* helpers */
++<<<<<<< HEAD
++=======
+ #define QED_MFW_GET_FIELD(name, field) \
+ 	(((name) & (field ## _MASK)) >> (field ## _SHIFT))
+ 
+ #define QED_MFW_SET_FIELD(name, field, value)				       \
+ 	do {								       \
+ 		(name)	&= ~(field ## _MASK);	       \
+ 		(name)	|= (((value) << (field ## _SHIFT)) & (field ## _MASK));\
+ 	} while (0)
+ 
++>>>>>>> b19601bbf1a1 (qed: Fix setting of Management bitfields)
  static inline u32 qed_db_addr(u32 cid, u32 DEMS)
  {
  	u32 db_addr = FIELD_VALUE(DB_LEGACY_ADDR_DEMS, DEMS) |
* Unmerged path drivers/net/ethernet/qlogic/qed/qed.h
