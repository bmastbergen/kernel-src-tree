scsi: smartpqi: enhance device add and remove messages

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [scsi] smartpqi: enhance device add and remove messages (Don Brace) [1457414]
Rebuild_FUZZ: 94.12%
commit-author Kevin Barnett <kevin.barnett@hpe.com>
commit 6de783f666291763bcc6c3975e146b9b698378b1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/6de783f6.failed

Improved formatting of information displayed when devices
are added/removed from the system.

	Reviewed-by: Scott Benesh <scott.benesh@microsemi.com>
	Signed-off-by: Kevin Barnett <kevin.barnett@microsemi.com>
	Signed-off-by: Don Brace <don.brace@microsemi.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit 6de783f666291763bcc6c3975e146b9b698378b1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/smartpqi/smartpqi_init.c
diff --cc drivers/scsi/smartpqi/smartpqi_init.c
index f2c47dadec6b,4e016dfff972..000000000000
--- a/drivers/scsi/smartpqi/smartpqi_init.c
+++ b/drivers/scsi/smartpqi/smartpqi_init.c
@@@ -1459,22 -1453,61 +1461,80 @@@ static enum pqi_find_result pqi_scsi_fi
  static void pqi_dev_info(struct pqi_ctrl_info *ctrl_info,
  	char *action, struct pqi_scsi_dev *device)
  {
++<<<<<<< HEAD
 +	dev_info(&ctrl_info->pci_dev->dev,
 +		"%s scsi %d:%d:%d:%d: %s %.8s %.16s %-12s SSDSmartPathCap%c En%c Exp%c qd=%d\n",
 +		action,
 +		ctrl_info->scsi_host->host_no,
 +		device->bus,
 +		device->target,
 +		device->lun,
 +		scsi_device_type(device->devtype),
 +		device->vendor,
 +		device->model,
 +		pqi_is_logical_device(device) ?
 +			pqi_raid_level_to_string(device->raid_level) : "",
 +		device->offload_configured ? '+' : '-',
 +		device->offload_enabled_pending ? '+' : '-',
 +		device->expose_device ? '+' : '-',
 +		device->queue_depth);
++=======
+ 	ssize_t count;
+ 	char buffer[PQI_DEV_INFO_BUFFER_LENGTH];
+ 
+ 	count = snprintf(buffer, PQI_DEV_INFO_BUFFER_LENGTH,
+ 		"%d:%d:", ctrl_info->scsi_host->host_no, device->bus);
+ 
+ 	if (device->target_lun_valid)
+ 		count += snprintf(buffer + count,
+ 			PQI_DEV_INFO_BUFFER_LENGTH - count,
+ 			"%d:%d",
+ 			device->target,
+ 			device->lun);
+ 	else
+ 		count += snprintf(buffer + count,
+ 			PQI_DEV_INFO_BUFFER_LENGTH - count,
+ 			"-:-");
+ 
+ 	if (pqi_is_logical_device(device))
+ 		count += snprintf(buffer + count,
+ 			PQI_DEV_INFO_BUFFER_LENGTH - count,
+ 			" %08x%08x",
+ 			*((u32 *)&device->scsi3addr),
+ 			*((u32 *)&device->scsi3addr[4]));
+ 	else
+ 		count += snprintf(buffer + count,
+ 			PQI_DEV_INFO_BUFFER_LENGTH - count,
+ 			" %016llx", device->sas_address);
+ 
+ 	count += snprintf(buffer + count, PQI_DEV_INFO_BUFFER_LENGTH - count,
+ 		" %s %.8s %.16s ",
+ 		scsi_device_type(device->devtype),
+ 		device->vendor,
+ 		device->model);
+ 
+ 	if (pqi_is_logical_device(device)) {
+ 		if (device->devtype == TYPE_DISK)
+ 			count += snprintf(buffer + count,
+ 				PQI_DEV_INFO_BUFFER_LENGTH - count,
+ 				"SSDSmartPathCap%c En%c %-12s",
+ 				device->offload_configured ? '+' : '-',
+ 				(device->offload_enabled ||
+ 				device->offload_enabled_pending) ? '+' : '-',
+ 				pqi_raid_level_to_string(device->raid_level));
+ 	} else {
+ 		count += snprintf(buffer + count,
+ 			PQI_DEV_INFO_BUFFER_LENGTH - count,
+ 			"AIO%c", device->aio_enabled ? '+' : '-');
+ 		if (device->devtype == TYPE_DISK ||
+ 			device->devtype == TYPE_ZBC)
+ 			count += snprintf(buffer + count,
+ 				PQI_DEV_INFO_BUFFER_LENGTH - count,
+ 				" qd=%-6d", device->queue_depth);
+ 	}
+ 
+ 	dev_info(&ctrl_info->pci_dev->dev, "%s %s\n", action, buffer);
++>>>>>>> 6de783f66629 (scsi: smartpqi: enhance device add and remove messages)
  }
  
  /* Assumes the SCSI device list lock is held. */
@@@ -1680,7 -1708,8 +1740,12 @@@ static void pqi_update_device_list(stru
  
  	/* Expose any new devices. */
  	list_for_each_entry_safe(device, next, &add_list, add_list_entry) {
++<<<<<<< HEAD
 +		if (device->expose_device && !device->sdev) {
++=======
+ 		if (!device->sdev) {
+ 			pqi_dev_info(ctrl_info, "added", device);
++>>>>>>> 6de783f66629 (scsi: smartpqi: enhance device add and remove messages)
  			rc = pqi_add_device(ctrl_info, device);
  			if (rc) {
  				dev_warn(&ctrl_info->pci_dev->dev,
* Unmerged path drivers/scsi/smartpqi/smartpqi_init.c
