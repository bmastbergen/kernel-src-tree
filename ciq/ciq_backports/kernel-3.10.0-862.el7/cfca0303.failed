SELinux: renumber the superblock options

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Eric Paris <eparis@redhat.com>
commit cfca0303da0e2c3f570cb5cfc7c373828e6c13a2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/cfca0303.failed

Just to make it clear that we have mount time options and flags,
separate them.  Since I decided to move the non-mount options above
above 0x10, we need a short instead of a char.  (x86 padding says
this takes up no additional space as we have a 3byte whole in the
structure)

	Signed-off-by: Eric Paris <eparis@redhat.com>
(cherry picked from commit cfca0303da0e2c3f570cb5cfc7c373828e6c13a2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	security/selinux/include/security.h
diff --cc security/selinux/include/security.h
index 8fd8e18ea340,9c424d8bd2e0..000000000000
--- a/security/selinux/include/security.h
+++ b/security/selinux/include/security.h
@@@ -49,10 -50,10 +50,16 @@@
  #define FSCONTEXT_MNT	0x02
  #define ROOTCONTEXT_MNT	0x04
  #define DEFCONTEXT_MNT	0x08
+ #define SBLABEL_MNT	0x10
  /* Non-mount related flags */
++<<<<<<< HEAD
 +#define SE_SBINITIALIZED	0x10
 +#define SE_SBPROC		0x20
 +#define SE_SBLABELSUPP	0x40
++=======
+ #define SE_SBINITIALIZED	0x0100
+ #define SE_SBPROC		0x0200
++>>>>>>> cfca0303da0e (SELinux: renumber the superblock options)
  
  #define CONTEXT_STR	"context="
  #define FSCONTEXT_STR	"fscontext="
diff --git a/security/selinux/include/objsec.h b/security/selinux/include/objsec.h
index 446c3d13c83f..06bf2179abd3 100644
--- a/security/selinux/include/objsec.h
+++ b/security/selinux/include/objsec.h
@@ -69,7 +69,7 @@ struct superblock_security_struct {
 	u32 def_sid;			/* default SID for labeling */
 	u32 mntpoint_sid;		/* SECURITY_FS_USE_MNTPOINT context for files */
 	unsigned int behavior;		/* labeling behavior */
-	unsigned char flags;		/* which mount options were specified */
+	unsigned short flags;		/* which mount options were specified */
 	struct mutex lock;
 	struct list_head isec_head;
 	spinlock_t isec_lock;
* Unmerged path security/selinux/include/security.h
