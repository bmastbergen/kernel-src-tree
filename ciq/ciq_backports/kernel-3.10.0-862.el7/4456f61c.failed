devlink: allow to fillup eswitch attrs even if mode_get op does not exist

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Jiri Pirko <jiri@mellanox.com>
commit 4456f61cfd2a589c4368fe0b9080b646b9bd470d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/4456f61c.failed

Even when mode_get op is not present, other eswitch attrs need to be
filled-up.

	Signed-off-by: Jiri Pirko <jiri@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 4456f61cfd2a589c4368fe0b9080b646b9bd470d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/core/devlink.c
diff --cc net/core/devlink.c
index a17fcd87f267,e9c1e6acfb6d..000000000000
--- a/net/core/devlink.c
+++ b/net/core/devlink.c
@@@ -1414,14 -1408,16 +1414,25 @@@ static int devlink_eswitch_fill(struct 
  
  	err = devlink_nl_put_handle(msg, devlink);
  	if (err)
 -		goto nla_put_failure;
 +		goto out;
  
++<<<<<<< HEAD
 +	err = ops->eswitch_mode_get(devlink, &mode);
 +	if (err)
 +		goto out;
 +	err = nla_put_u16(msg, DEVLINK_ATTR_ESWITCH_MODE, mode);
 +	if (err)
 +		goto out;
++=======
+ 	if (ops->eswitch_mode_get) {
+ 		err = ops->eswitch_mode_get(devlink, &mode);
+ 		if (err)
+ 			goto nla_put_failure;
+ 		err = nla_put_u16(msg, DEVLINK_ATTR_ESWITCH_MODE, mode);
+ 		if (err)
+ 			goto nla_put_failure;
+ 	}
++>>>>>>> 4456f61cfd2a (devlink: allow to fillup eswitch attrs even if mode_get op does not exist)
  
  	if (ops->eswitch_inline_mode_get) {
  		err = ops->eswitch_inline_mode_get(devlink, &inline_mode);
* Unmerged path net/core/devlink.c
