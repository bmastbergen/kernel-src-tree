powerpc/book3s: Add a cpu table entry for different POWER9 revs

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [powerpc] book3s: Add a cpu table entry for different POWER9 revs (Mauricio Oliveira) [1494439]
Rebuild_FUZZ: 93.22%
commit-author Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com>
commit 7dccfbc325bb59f94521d544a8ae12148622b4f2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/7dccfbc3.failed

	Signed-off-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com>
	Acked-by: Michael Neuling <mikey@neuling.org>
	Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
(cherry picked from commit 7dccfbc325bb59f94521d544a8ae12148622b4f2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/powerpc/include/asm/cputable.h
#	arch/powerpc/kernel/cputable.c
diff --cc arch/powerpc/include/asm/cputable.h
index 963b6f1f1862,f752e6f7cfbe..000000000000
--- a/arch/powerpc/include/asm/cputable.h
+++ b/arch/powerpc/include/asm/cputable.h
@@@ -196,6 -211,8 +196,11 @@@ enum 
  #define CPU_FTR_DAWR			LONG_ASM_CONST(0x0400000000000000)
  #define CPU_FTR_DABRX			LONG_ASM_CONST(0x0800000000000000)
  #define CPU_FTR_PMAO_BUG		LONG_ASM_CONST(0x1000000000000000)
++<<<<<<< HEAD
++=======
+ #define CPU_FTR_SUBCORE			LONG_ASM_CONST(0x2000000000000000)
+ #define CPU_FTR_POWER9_DD1		LONG_ASM_CONST(0x4000000000000000)
++>>>>>>> 7dccfbc325bb (powerpc/book3s: Add a cpu table entry for different POWER9 revs)
  
  #ifndef __ASSEMBLY__
  
@@@ -448,9 -460,20 +453,23 @@@
  	    CPU_FTR_STCX_CHECKS_ADDRESS | CPU_FTR_POPCNTB | CPU_FTR_POPCNTD | \
  	    CPU_FTR_ICSWX | CPU_FTR_CFAR | CPU_FTR_HVMODE | CPU_FTR_VMX_COPY | \
  	    CPU_FTR_DBELL | CPU_FTR_HAS_PPR | CPU_FTR_DAWR | \
 -	    CPU_FTR_ARCH_207S | CPU_FTR_TM_COMP | CPU_FTR_SUBCORE)
 +	    CPU_FTR_ARCH_207S | CPU_FTR_TM_COMP)
  #define CPU_FTRS_POWER8E (CPU_FTRS_POWER8 | CPU_FTR_PMAO_BUG)
  #define CPU_FTRS_POWER8_DD1 (CPU_FTRS_POWER8 & ~CPU_FTR_DBELL)
++<<<<<<< HEAD
++=======
+ #define CPU_FTRS_POWER9 (CPU_FTR_USE_TB | CPU_FTR_LWSYNC | \
+ 	    CPU_FTR_PPCAS_ARCH_V2 | CPU_FTR_CTRL | CPU_FTR_ARCH_206 |\
+ 	    CPU_FTR_MMCRA | CPU_FTR_SMT | \
+ 	    CPU_FTR_COHERENT_ICACHE | \
+ 	    CPU_FTR_PURR | CPU_FTR_SPURR | CPU_FTR_REAL_LE | \
+ 	    CPU_FTR_DSCR | CPU_FTR_SAO  | \
+ 	    CPU_FTR_STCX_CHECKS_ADDRESS | CPU_FTR_POPCNTB | CPU_FTR_POPCNTD | \
+ 	    CPU_FTR_ICSWX | CPU_FTR_CFAR | CPU_FTR_HVMODE | CPU_FTR_VMX_COPY | \
+ 	    CPU_FTR_DBELL | CPU_FTR_HAS_PPR | CPU_FTR_DAWR | \
+ 	    CPU_FTR_ARCH_207S | CPU_FTR_TM_COMP | CPU_FTR_ARCH_300)
+ #define CPU_FTRS_POWER9_DD1 (CPU_FTRS_POWER9 | CPU_FTR_POWER9_DD1)
++>>>>>>> 7dccfbc325bb (powerpc/book3s: Add a cpu table entry for different POWER9 revs)
  #define CPU_FTRS_CELL	(CPU_FTR_USE_TB | CPU_FTR_LWSYNC | \
  	    CPU_FTR_PPCAS_ARCH_V2 | CPU_FTR_CTRL | \
  	    CPU_FTR_ALTIVEC_COMP | CPU_FTR_MMCRA | CPU_FTR_SMT | \
@@@ -461,19 -484,15 +480,26 @@@
  	    CPU_FTR_PURR | CPU_FTR_REAL_LE | CPU_FTR_DABRX)
  #define CPU_FTRS_COMPATIBLE	(CPU_FTR_USE_TB | CPU_FTR_PPCAS_ARCH_V2)
  
 +#define CPU_FTRS_A2 (CPU_FTR_USE_TB | CPU_FTR_SMT | CPU_FTR_DBELL | \
 +		     CPU_FTR_NOEXECUTE | CPU_FTR_NODSISRALIGN | \
 +		     CPU_FTR_ICSWX | CPU_FTR_DABRX )
 +
  #ifdef __powerpc64__
  #ifdef CONFIG_PPC_BOOK3E
 -#define CPU_FTRS_POSSIBLE	(CPU_FTRS_E6500 | CPU_FTRS_E5500)
 +#define CPU_FTRS_POSSIBLE	(CPU_FTRS_E6500 | CPU_FTRS_E5500 | CPU_FTRS_A2)
  #else
  #define CPU_FTRS_POSSIBLE	\
++<<<<<<< HEAD
 +	    (CPU_FTRS_POWER3 | CPU_FTRS_RS64 | CPU_FTRS_POWER4 |	\
 +	    CPU_FTRS_PPC970 | CPU_FTRS_POWER5 | CPU_FTRS_POWER6 |	\
 +	    CPU_FTRS_POWER7 | CPU_FTRS_POWER8E | CPU_FTRS_POWER8 |	\
 +	    CPU_FTRS_CELL | CPU_FTRS_PA6T | CPU_FTR_VSX)
++=======
+ 	    (CPU_FTRS_POWER4 | CPU_FTRS_PPC970 | CPU_FTRS_POWER5 | \
+ 	     CPU_FTRS_POWER6 | CPU_FTRS_POWER7 | CPU_FTRS_POWER8E | \
+ 	     CPU_FTRS_POWER8 | CPU_FTRS_POWER8_DD1 | CPU_FTRS_CELL | \
+ 	     CPU_FTRS_PA6T | CPU_FTR_VSX | CPU_FTRS_POWER9 | CPU_FTRS_POWER9_DD1)
++>>>>>>> 7dccfbc325bb (powerpc/book3s: Add a cpu table entry for different POWER9 revs)
  #endif
  #else
  enum {
diff --cc arch/powerpc/kernel/cputable.c
index fa8120733e5c,6c4646ac9234..000000000000
--- a/arch/powerpc/kernel/cputable.c
+++ b/arch/powerpc/kernel/cputable.c
@@@ -589,6 -506,44 +589,47 @@@ static struct cpu_spec __initdata cpu_s
  		.machine_check_early	= __machine_check_early_realmode_p8,
  		.platform		= "power8",
  	},
++<<<<<<< HEAD
++=======
+ 	{	/* Power9 DD1*/
+ 		.pvr_mask		= 0xffffff00,
+ 		.pvr_value		= 0x004e0100,
+ 		.cpu_name		= "POWER9 (raw)",
+ 		.cpu_features		= CPU_FTRS_POWER9_DD1,
+ 		.cpu_user_features	= COMMON_USER_POWER9,
+ 		.cpu_user_features2	= COMMON_USER2_POWER9,
+ 		.mmu_features		= MMU_FTRS_POWER9,
+ 		.icache_bsize		= 128,
+ 		.dcache_bsize		= 128,
+ 		.num_pmcs		= 6,
+ 		.pmc_type		= PPC_PMC_IBM,
+ 		.oprofile_cpu_type	= "ppc64/power9",
+ 		.oprofile_type		= PPC_OPROFILE_INVALID,
+ 		.cpu_setup		= __setup_cpu_power9,
+ 		.cpu_restore		= __restore_cpu_power9,
+ 		.flush_tlb		= __flush_tlb_power9,
+ 		.platform		= "power9",
+ 	},
+ 	{	/* Power9 */
+ 		.pvr_mask		= 0xffff0000,
+ 		.pvr_value		= 0x004e0000,
+ 		.cpu_name		= "POWER9 (raw)",
+ 		.cpu_features		= CPU_FTRS_POWER9,
+ 		.cpu_user_features	= COMMON_USER_POWER9,
+ 		.cpu_user_features2	= COMMON_USER2_POWER9,
+ 		.mmu_features		= MMU_FTRS_POWER9,
+ 		.icache_bsize		= 128,
+ 		.dcache_bsize		= 128,
+ 		.num_pmcs		= 6,
+ 		.pmc_type		= PPC_PMC_IBM,
+ 		.oprofile_cpu_type	= "ppc64/power9",
+ 		.oprofile_type		= PPC_OPROFILE_INVALID,
+ 		.cpu_setup		= __setup_cpu_power9,
+ 		.cpu_restore		= __restore_cpu_power9,
+ 		.flush_tlb		= __flush_tlb_power9,
+ 		.platform		= "power9",
+ 	},
++>>>>>>> 7dccfbc325bb (powerpc/book3s: Add a cpu table entry for different POWER9 revs)
  	{	/* Cell Broadband Engine */
  		.pvr_mask		= 0xffff0000,
  		.pvr_value		= 0x00700000,
* Unmerged path arch/powerpc/include/asm/cputable.h
* Unmerged path arch/powerpc/kernel/cputable.c
