scsi: qla2xxx: Allow SNS fabric login to be retried

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [scsi] qla2xxx: Allow SNS fabric login to be retried (Himanshu Madhani) [1460030]
Rebuild_FUZZ: 93.75%
commit-author Joe Carnuccio <joe.carnuccio@cavium.com>
commit a14c771125c99bbe7f9075f1da3b1fcd8e3f4d2c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/a14c7711.failed

If SNS fabric login fails, set loop resync flag to retry via dpc.

	Signed-off-by: Joe Carnuccio <joe.carnuccio@cavium.com>
	Signed-off-by: Himanshu Madhani <himanshu.madhani@cavium.com>
	Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
(cherry picked from commit a14c771125c99bbe7f9075f1da3b1fcd8e3f4d2c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/qla2xxx/qla_init.c
diff --cc drivers/scsi/qla2xxx/qla_init.c
index 998b579c233c,fe2d196833aa..000000000000
--- a/drivers/scsi/qla2xxx/qla_init.c
+++ b/drivers/scsi/qla2xxx/qla_init.c
@@@ -3444,14 -4762,6 +3444,17 @@@ qla2x00_configure_fabric(scsi_qla_host_
  			set_bit(LOOP_RESYNC_NEEDED, &vha->dpc_flags);
  			return rval;
  		}
++<<<<<<< HEAD
 +		if (mb[0] != MBS_COMMAND_COMPLETE) {
 +			ql_dbg(ql_dbg_disc, vha, 0x2042,
 +			    "Failed SNS login: loop_id=%x mb[0]=%x mb[1]=%x mb[2]=%x "
 +			    "mb[6]=%x mb[7]=%x.\n", loop_id, mb[0], mb[1],
 +			    mb[2], mb[6], mb[7]);
 +			return (QLA_SUCCESS);
 +		}
 +
++=======
++>>>>>>> a14c771125c9 (scsi: qla2xxx: Allow SNS fabric login to be retried)
  		if (test_and_clear_bit(REGISTER_FC4_NEEDED, &vha->dpc_flags)) {
  			if (qla2x00_rft_id(vha)) {
  				/* EMPTY */
* Unmerged path drivers/scsi/qla2xxx/qla_init.c
