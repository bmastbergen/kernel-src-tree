target/transport: add flag to indicate CPU Affinity is observed

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Quinn Tran <quinn.tran@qlogic.com>
commit 9095adaab8c1d82707e4e9961b6ad79b62f3361b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/9095adaa.failed

	Signed-off-by: Quinn Tran <quinn.tran@qlogic.com>
	Reviewed-by: Christoph Hellwig <hch@lst.de>
	Reviewed-by: Bart Van Assche <bart.vanassche@sandisk.com>
Fixes: fb3269b ("qla2xxx: Add selective command queuing")
	Signed-off-by: Himanshu Madhani <himanshu.madhani@qlogic.com>
	Signed-off-by: Nicholas Bellinger <nab@linux-iscsi.org>
(cherry picked from commit 9095adaab8c1d82707e4e9961b6ad79b62f3361b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/target/target_core_transport.c
#	include/target/target_core_base.h
diff --cc drivers/target/target_core_transport.c
index 68bc47c2e404,867bc6d0a68a..000000000000
--- a/drivers/target/target_core_transport.c
+++ b/drivers/target/target_core_transport.c
@@@ -755,7 -711,10 +755,14 @@@ void target_complete_cmd(struct se_cmd 
  	cmd->transport_state |= (CMD_T_COMPLETE | CMD_T_ACTIVE);
  	spin_unlock_irqrestore(&cmd->t_state_lock, flags);
  
++<<<<<<< HEAD
 +	queue_work(target_completion_wq, &cmd->work);
++=======
+ 	if (cmd->se_cmd_flags & SCF_USE_CPUID)
+ 		queue_work_on(cmd->cpuid, target_completion_wq, &cmd->work);
+ 	else
+ 		queue_work(target_completion_wq, &cmd->work);
++>>>>>>> 9095adaab8c1 (target/transport: add flag to indicate CPU Affinity is observed)
  }
  EXPORT_SYMBOL(target_complete_cmd);
  
diff --cc include/target/target_core_base.h
index 6a27f0cf6579,e8c8c08bf575..000000000000
--- a/include/target/target_core_base.h
+++ b/include/target/target_core_base.h
@@@ -168,8 -139,9 +168,14 @@@ enum se_cmd_flags_table 
  	SCF_PASSTHROUGH_SG_TO_MEM_NOALLOC = 0x00020000,
  	SCF_COMPARE_AND_WRITE		= 0x00080000,
  	SCF_COMPARE_AND_WRITE_POST	= 0x00100000,
++<<<<<<< HEAD
 +	SCF_CMD_XCOPY_PASSTHROUGH	= 0x00200000,
 +	SCF_PASSTHROUGH_PROT_SG_TO_MEM_NOALLOC = 0x00400000,
++=======
+ 	SCF_PASSTHROUGH_PROT_SG_TO_MEM_NOALLOC = 0x00200000,
+ 	SCF_ACK_KREF			= 0x00400000,
+ 	SCF_USE_CPUID			= 0x00800000,
++>>>>>>> 9095adaab8c1 (target/transport: add flag to indicate CPU Affinity is observed)
  };
  
  /* struct se_dev_entry->lun_flags and struct se_lun->lun_access */
* Unmerged path drivers/target/target_core_transport.c
* Unmerged path include/target/target_core_base.h
