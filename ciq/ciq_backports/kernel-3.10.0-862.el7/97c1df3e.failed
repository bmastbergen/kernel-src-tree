mnt: If fs_fully_visible fails call put_filesystem.

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [fs] mnt: If fs_fully_visible fails call put_filesystem ("Eric W. Biederman") [1487751]
Rebuild_FUZZ: 99.01%
commit-author Eric W. Biederman <ebiederm@xmission.com>
commit 97c1df3e54e811aed484a036a798b4b25d002ecf
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/97c1df3e.failed

Add this trivial missing error handling.

	Cc: stable@vger.kernel.org
Fixes: 1b852bceb0d1 ("mnt: Refactor the logic for mounting sysfs and proc in a user namespace")
	Signed-off-by: "Eric W. Biederman" <ebiederm@xmission.com>
(cherry picked from commit 97c1df3e54e811aed484a036a798b4b25d002ecf)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/namespace.c
diff --cc fs/namespace.c
index edd7c5e218b1,9d45c8a3414f..000000000000
--- a/fs/namespace.c
+++ b/fs/namespace.c
@@@ -2456,6 -2408,12 +2456,15 @@@ static int do_new_mount(struct path *pa
  			flags |= MS_NODEV;
  			mnt_flags |= MNT_NODEV | MNT_LOCK_NODEV;
  		}
++<<<<<<< HEAD
++=======
+ 		if (type->fs_flags & FS_USERNS_VISIBLE) {
+ 			if (!fs_fully_visible(type, &mnt_flags)) {
+ 				put_filesystem(type);
+ 				return -EPERM;
+ 			}
+ 		}
++>>>>>>> 97c1df3e54e8 (mnt: If fs_fully_visible fails call put_filesystem.)
  	}
  
  	mnt = vfs_kern_mount(type, flags, name, data);
* Unmerged path fs/namespace.c
