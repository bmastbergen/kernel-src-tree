ASoC: rt5677: fix SPI dependency

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [sound] alsa: asoc: rt5677: fix SPI dependency (Jaroslav Kysela) [1463624]
Rebuild_FUZZ: 91.43%
commit-author Arnd Bergmann <arnd@arndb.de>
commit 4c121129c9dcb43b33d1cd568c8f2636e72597b0
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/4c121129.failed

The rt5677 codec has gained code that requires SPI to work correctly,
but there is no provision in Kconfig to prevent the driver from
being used when SPI is disabled or a loadable module, resulting
in this build error:

sound/built-in.o: In function `rt5677_spi_write':
:(.text+0xa7ba0): undefined reference to `spi_sync'
sound/built-in.o: In function `rt5677_spi_driver_init':
:(.init.text+0x253c): undefined reference to `spi_register_driver'

ERROR: "spi_sync" [sound/soc/codecs/snd-soc-rt5677-spi.ko] undefined!
ERROR: "spi_register_driver" [sound/soc/codecs/snd-soc-rt5677-spi.ko] undefined!

This makes the SPI portion of the driver depend on the SPI subsystem,
and disables the function that uses SPI for firmware download if SPI
is disabled. The latter may not be the correct solution, but I could
not come up with a better one.

	Signed-off-by: Arnd Bergmann <arnd@arndb.de>
Fixes: af48f1d08a54741 ("ASoC: rt5677: Support DSP function for VAD application")
	Signed-off-by: Mark Brown <broonie@kernel.org>
(cherry picked from commit 4c121129c9dcb43b33d1cd568c8f2636e72597b0)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/soc/codecs/Kconfig
#	sound/soc/codecs/rt5677.c
diff --cc sound/soc/codecs/Kconfig
index bec1671f0a76,ef2c70e77d91..000000000000
--- a/sound/soc/codecs/Kconfig
+++ b/sound/soc/codecs/Kconfig
@@@ -83,6 -518,39 +83,42 @@@ config SND_SOC_RT565
  config SND_SOC_RT5670
  	tristate
  
++<<<<<<< HEAD
++=======
+ config SND_SOC_RT5677
+ 	tristate
+ 	select REGMAP_I2C
+ 	select REGMAP_IRQ
+ 
+ config SND_SOC_RT5677_SPI
+ 	tristate
+ 	default SND_SOC_RT5677 && SPI
+ 
+ #Freescale sgtl5000 codec
+ config SND_SOC_SGTL5000
+ 	tristate "Freescale SGTL5000 CODEC"
+ 	depends on I2C
+ 
+ config SND_SOC_SI476X
+ 	tristate
+ 
+ config SND_SOC_SIGMADSP
+ 	tristate
+ 	select CRC32
+ 
+ config SND_SOC_SIGMADSP_I2C
+ 	tristate
+ 	select SND_SOC_SIGMADSP
+ 
+ config SND_SOC_SIGMADSP_REGMAP
+ 	tristate
+ 	select SND_SOC_SIGMADSP
+ 
+ config SND_SOC_SIRF_AUDIO_CODEC
+ 	tristate "SiRF SoC internal audio codec"
+ 	select REGMAP_MMIO
+ 
++>>>>>>> 4c121129c9dc (ASoC: rt5677: fix SPI dependency)
  config SND_SOC_SN95031
  	tristate
  
* Unmerged path sound/soc/codecs/rt5677.c
* Unmerged path sound/soc/codecs/Kconfig
* Unmerged path sound/soc/codecs/rt5677.c
