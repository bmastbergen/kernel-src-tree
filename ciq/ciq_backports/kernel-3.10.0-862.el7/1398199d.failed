libnvdimm, btt: ensure that flags were also unchanged during a map_read

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Vishal Verma <vishal.l.verma@intel.com>
commit 1398199d849047c59acef0c04e550b47bb9b4be6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/1398199d.failed

In btt_map_read, we read the map twice to make sure that the map entry
didn't change after we added it to the read tracking table. In
anticipation of expanding the use of the error bit, also make sure that
the error and zero flags are constant across the two map reads.

	Signed-off-by: Vishal Verma <vishal.l.verma@intel.com>
	Signed-off-by: Dan Williams <dan.j.williams@intel.com>
(cherry picked from commit 1398199d849047c59acef0c04e550b47bb9b4be6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/nvdimm/btt.c
diff --cc drivers/nvdimm/btt.c
index 1de15c30f250,15d1b071746b..000000000000
--- a/drivers/nvdimm/btt.c
+++ b/drivers/nvdimm/btt.c
@@@ -1001,8 -1051,8 +1002,13 @@@ static int btt_read_pg(struct btt *btt
  			 */
  			barrier();
  
++<<<<<<< HEAD
 +			ret = btt_map_read(arena, premap, &new_map, &t_flag,
 +						&e_flag);
++=======
+ 			ret = btt_map_read(arena, premap, &new_map, &new_t,
+ 						&new_e, NVDIMM_IO_ATOMIC);
++>>>>>>> 1398199d8490 (libnvdimm, btt: ensure that flags were also unchanged during a map_read)
  			if (ret)
  				goto out_rtt;
  
* Unmerged path drivers/nvdimm/btt.c
