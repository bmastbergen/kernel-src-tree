ext4: in ext4_seek_{hole,data}, return -ENXIO for negative offsets

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [fs] ext4: in ext4_seek_{hole, data}, return -ENXIO for negative offsets (Bill O'Donnell) [1494317]
Rebuild_FUZZ: 99.25%
commit-author Darrick J. Wong <darrick.wong@oracle.com>
commit 1bd8d6cd3e413d64e543ec3e69ff43e75a1cf1ea
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/1bd8d6cd.failed

In the ext4 implementations of SEEK_HOLE and SEEK_DATA, make sure we
return -ENXIO for negative offsets instead of banging around inside
the extent code and returning -EFSCORRUPTED.

	Reported-by: Mateusz S <muttdini@gmail.com>
	Signed-off-by: Darrick J. Wong <darrick.wong@oracle.com>
	Signed-off-by: Theodore Ts'o <tytso@mit.edu>
	Cc: stable@vger.kernel.org # 4.6
(cherry picked from commit 1bd8d6cd3e413d64e543ec3e69ff43e75a1cf1ea)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/ext4/file.c
diff --cc fs/ext4/file.c
index b5c54ce20df9,86ea1d92839a..000000000000
--- a/fs/ext4/file.c
+++ b/fs/ext4/file.c
@@@ -519,11 -592,11 +519,16 @@@ static loff_t ext4_seek_data(struct fil
  	int blkbits;
  	int ret;
  
 -	inode_lock(inode);
 +	mutex_lock(&inode->i_mutex);
  
  	isize = i_size_read(inode);
++<<<<<<< HEAD
 +	if (offset >= isize) {
 +		mutex_unlock(&inode->i_mutex);
++=======
+ 	if (offset < 0 || offset >= isize) {
+ 		inode_unlock(inode);
++>>>>>>> 1bd8d6cd3e41 (ext4: in ext4_seek_{hole,data}, return -ENXIO for negative offsets)
  		return -ENXIO;
  	}
  
@@@ -582,11 -655,11 +587,16 @@@ static loff_t ext4_seek_hole(struct fil
  	int blkbits;
  	int ret;
  
 -	inode_lock(inode);
 +	mutex_lock(&inode->i_mutex);
  
  	isize = i_size_read(inode);
++<<<<<<< HEAD
 +	if (offset >= isize) {
 +		mutex_unlock(&inode->i_mutex);
++=======
+ 	if (offset < 0 || offset >= isize) {
+ 		inode_unlock(inode);
++>>>>>>> 1bd8d6cd3e41 (ext4: in ext4_seek_{hole,data}, return -ENXIO for negative offsets)
  		return -ENXIO;
  	}
  
* Unmerged path fs/ext4/file.c
