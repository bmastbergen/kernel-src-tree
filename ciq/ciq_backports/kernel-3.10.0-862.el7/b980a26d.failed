i2c: immediately mark ourselves as registered

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [i2c] immediately mark ourselves as registered (Gopal Tiwari) [1456705]
Rebuild_FUZZ: 94.12%
commit-author Wolfram Sang <wsa@the-dreams.de>
commit b980a26d02d1f54be31346666222304fcd27ea33
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/b980a26d.failed

Mark the i2c bus as registered right after the the bus_register call,
not at the end of init. Otherwise, we can't register our own dummy
driver.

	Reported-by: Thierry Reding <thierry.reding@gmail.com>
	Signed-off-by: Wolfram Sang <wsa@the-dreams.de>
Fixes: 95026658c46ea2 ("i2c: do not use internal data from driver core")
(cherry picked from commit b980a26d02d1f54be31346666222304fcd27ea33)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/i2c/i2c-core.c
diff --cc drivers/i2c/i2c-core.c
index bb2f4e756021,0f2f8484e8ec..000000000000
--- a/drivers/i2c/i2c-core.c
+++ b/drivers/i2c/i2c-core.c
@@@ -1712,6 -2118,10 +1715,13 @@@ static int __init i2c_init(void
  	retval = i2c_add_driver(&dummy_driver);
  	if (retval)
  		goto class_err;
++<<<<<<< HEAD
++=======
+ 
+ 	if (IS_ENABLED(CONFIG_OF_DYNAMIC))
+ 		WARN_ON(of_reconfig_notifier_register(&i2c_of_notifier));
+ 
++>>>>>>> b980a26d02d1 (i2c: immediately mark ourselves as registered)
  	return 0;
  
  class_err:
* Unmerged path drivers/i2c/i2c-core.c
