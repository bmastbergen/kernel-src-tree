ALSA: x86: Call snd_card_register() at the end

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Takashi Iwai <tiwai@suse.de>
commit 36ec0d99bbd7bb392bf64059cbda1818ee2be5a2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/36ec0d99.failed

The card registration should be done at the last stage of the probe
procedure.  Otherwise user-space may access to the device before the
whole initialization is done.

	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit 36ec0d99bbd7bb392bf64059cbda1818ee2be5a2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/x86/intel_hdmi_audio.c
diff --cc sound/x86/intel_hdmi_audio.c
index f2f54691cb43,82f42a6c363c..000000000000
--- a/sound/x86/intel_hdmi_audio.c
+++ b/sound/x86/intel_hdmi_audio.c
@@@ -1613,12 -1586,7 +1613,16 @@@ int hdmi_audio_probe(struct platform_de
  	pr_debug("%s @ %d:DEBUG PLUG/UNPLUG : HAD_DRV_DISCONNECTED\n",
  			__func__, __LINE__);
  
++<<<<<<< HEAD
 +	/* create a card instance with ALSA framework */
 +	retval = snd_card_new(&devptr->dev, hdmi_card_index, hdmi_card_id,
 +				THIS_MODULE, 0, &card);
 +
 +	if (retval)
 +		goto free_hadstream;
++=======
+ 	intelhaddata->dev = &devptr->dev;
++>>>>>>> 36ec0d99bbd7 (ALSA: x86: Call snd_card_register() at the end)
  	intelhaddata->card = card;
  	intelhaddata->card_id = hdmi_card_id;
  	intelhaddata->card_index = card->number;
@@@ -1660,16 -1618,6 +1664,19 @@@
  	if (retval)
  		goto err;
  
++<<<<<<< HEAD
 +	/* internal function call to register device with ALSA */
 +	retval = snd_intelhad_create(intelhaddata, card);
 +	if (retval)
 +		goto err;
 +
 +	card->private_data = &intelhaddata;
 +	retval = snd_card_register(card);
 +	if (retval)
 +		goto err;
 +
++=======
++>>>>>>> 36ec0d99bbd7 (ALSA: x86: Call snd_card_register() at the end)
  	/* IEC958 controls */
  	retval = snd_ctl_add(card, snd_ctl_new1(&had_control_iec958_mask,
  						intelhaddata));
* Unmerged path sound/x86/intel_hdmi_audio.c
