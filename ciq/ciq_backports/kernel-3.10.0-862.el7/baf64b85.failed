perf/x86: Fix incorrect use of do_div() in NMI warning

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Dave Hansen <dave.hansen@linux.intel.com>
commit baf64b85445546a38b44052d71782dfe7531e350
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/baf64b85.failed

I completely botched understanding the calling conventions of
do_div().  I assumed that do_div() returned the result instead
of realizing that it modifies its argument and returns a
remainder.  The side-effect from this would be bogus numbers
for the "msecs" value in the warning messages:

	INFO: NMI handler (perf_event_nmi_handler) took too long to run: 0.114 msecs

Note, there was a second fix posted by Stephane Eranian for
a separate patch which I also botched:

	http://lkml.kernel.org/r/20130704223010.GA30625@quad

	Signed-off-by: Dave Hansen <dave.hansen@linux.intel.com>
	Cc: Dave Hansen <dave@sr71.net>
Link: http://lkml.kernel.org/r/20130708214404.B0B6EA66@viggo.jf.intel.com
	Signed-off-by: Ingo Molnar <mingo@kernel.org>
(cherry picked from commit baf64b85445546a38b44052d71782dfe7531e350)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kernel/nmi.c
diff --cc arch/x86/kernel/nmi.c
index 1a36028022e7,ba77ebc2c353..000000000000
--- a/arch/x86/kernel/nmi.c
+++ b/arch/x86/kernel/nmi.c
@@@ -109,11 -111,13 +109,15 @@@ static int __kprobes nmi_handle(unsigne
  	 */
  	list_for_each_entry_rcu(a, &desc->head, list) {
  		u64 before, delta, whole_msecs;
++<<<<<<< HEAD
 +		int decimal_msecs;
++=======
+ 		int remainder_ns, decimal_msecs, thishandled;
++>>>>>>> baf64b854455 (perf/x86: Fix incorrect use of do_div() in NMI warning)
  
 -		before = local_clock();
 -		thishandled = a->handler(type, regs);
 -		handled += thishandled;
 -		delta = local_clock() - before;
 -		trace_nmi_handler(a->handler, (int)delta, thishandled);
 +		before = sched_clock();
 +		handled += a->handler(type, regs);
 +		delta = sched_clock() - before;
  
  		if (delta < nmi_longest_ns)
  			continue;
* Unmerged path arch/x86/kernel/nmi.c
