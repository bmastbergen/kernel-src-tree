drm/i915/gvt: Refine MMIO_RING_F()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Zhi Wang <zhi.a.wang@intel.com>
commit edee7ecdb4d7311f351feaeb53e269f416bb1b57
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/edee7ecd.failed

Inspect if the host has VCS2 ring by host i915 macro in MMIO_RING_F().
Also this helps on reducing some LOCs.

	Signed-off-by: Zhi Wang <zhi.a.wang@intel.com>
(cherry picked from commit edee7ecdb4d7311f351feaeb53e269f416bb1b57)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/i915/gvt/handlers.c
diff --cc drivers/gpu/drm/i915/gvt/handlers.c
index 4a24dc155ace,812f411d1c7d..000000000000
--- a/drivers/gpu/drm/i915/gvt/handlers.c
+++ b/drivers/gpu/drm/i915/gvt/handlers.c
@@@ -1586,6 -1636,11 +1588,14 @@@ static int init_generic_mmio_info(struc
  	MMIO_RING_DFH(RING_REG, D_ALL, F_CMD_ACCESS, NULL, NULL);
  #undef RING_REG
  
++<<<<<<< HEAD
++=======
+ #define RING_REG(base) (base + 0x6c)
+ 	MMIO_RING_DFH(RING_REG, D_ALL, 0, instdone_mmio_read, NULL);
+ #undef RING_REG
+ 	MMIO_DH(GEN7_SC_INSTDONE, D_BDW_PLUS, instdone_mmio_read, NULL);
+ 
++>>>>>>> edee7ecdb4d7 (drm/i915/gvt: Refine MMIO_RING_F())
  	MMIO_GM_RDR(0x2148, D_ALL, NULL, NULL);
  	MMIO_GM_RDR(CCID, D_ALL, NULL, NULL);
  	MMIO_GM_RDR(0x12198, D_ALL, NULL, NULL);
@@@ -2603,208 -2625,210 +2573,214 @@@ static int init_skl_mmio_info(struct in
  	MMIO_D(GEN9_MEDIA_PG_IDLE_HYSTERESIS, D_SKL_PLUS);
  	MMIO_D(GEN9_RENDER_PG_IDLE_HYSTERESIS, D_SKL_PLUS);
  	MMIO_DFH(GEN9_GAMT_ECO_REG_RW_IA, D_SKL_PLUS, F_CMD_ACCESS, NULL, NULL);
 -	MMIO_DH(0x4ddc, D_SKL_PLUS, NULL, skl_misc_ctl_write);
 -	MMIO_DH(0x42080, D_SKL_PLUS, NULL, skl_misc_ctl_write);
 -	MMIO_D(0x45504, D_SKL_PLUS);
 -	MMIO_D(0x45520, D_SKL_PLUS);
 -	MMIO_D(0x46000, D_SKL_PLUS);
 -	MMIO_DH(0x46010, D_SKL | D_KBL, NULL, skl_lcpll_write);
 -	MMIO_DH(0x46014, D_SKL | D_KBL, NULL, skl_lcpll_write);
 -	MMIO_D(0x6C040, D_SKL | D_KBL);
 -	MMIO_D(0x6C048, D_SKL | D_KBL);
 -	MMIO_D(0x6C050, D_SKL | D_KBL);
 -	MMIO_D(0x6C044, D_SKL | D_KBL);
 -	MMIO_D(0x6C04C, D_SKL | D_KBL);
 -	MMIO_D(0x6C054, D_SKL | D_KBL);
 -	MMIO_D(0x6c058, D_SKL | D_KBL);
 -	MMIO_D(0x6c05c, D_SKL | D_KBL);
 -	MMIO_DH(0X6c060, D_SKL | D_KBL, dpll_status_read, NULL);
 -
 -	MMIO_DH(SKL_PS_WIN_POS(PIPE_A, 0), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_WIN_POS(PIPE_A, 1), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_WIN_POS(PIPE_B, 0), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_WIN_POS(PIPE_B, 1), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_WIN_POS(PIPE_C, 0), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_WIN_POS(PIPE_C, 1), D_SKL_PLUS, NULL, pf_write);
 -
 -	MMIO_DH(SKL_PS_WIN_SZ(PIPE_A, 0), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_WIN_SZ(PIPE_A, 1), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_WIN_SZ(PIPE_B, 0), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_WIN_SZ(PIPE_B, 1), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_WIN_SZ(PIPE_C, 0), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_WIN_SZ(PIPE_C, 1), D_SKL_PLUS, NULL, pf_write);
 -
 -	MMIO_DH(SKL_PS_CTRL(PIPE_A, 0), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_CTRL(PIPE_A, 1), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_CTRL(PIPE_B, 0), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_CTRL(PIPE_B, 1), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_CTRL(PIPE_C, 0), D_SKL_PLUS, NULL, pf_write);
 -	MMIO_DH(SKL_PS_CTRL(PIPE_C, 1), D_SKL_PLUS, NULL, pf_write);
 -
 -	MMIO_DH(PLANE_BUF_CFG(PIPE_A, 0), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_BUF_CFG(PIPE_A, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_BUF_CFG(PIPE_A, 2), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_BUF_CFG(PIPE_A, 3), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(PLANE_BUF_CFG(PIPE_B, 0), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_BUF_CFG(PIPE_B, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_BUF_CFG(PIPE_B, 2), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_BUF_CFG(PIPE_B, 3), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(PLANE_BUF_CFG(PIPE_C, 0), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_BUF_CFG(PIPE_C, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_BUF_CFG(PIPE_C, 2), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_BUF_CFG(PIPE_C, 3), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(CUR_BUF_CFG(PIPE_A), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(CUR_BUF_CFG(PIPE_B), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(CUR_BUF_CFG(PIPE_C), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_F(PLANE_WM(PIPE_A, 0, 0), 4 * 8, 0, 0, 0, D_SKL_PLUS, NULL, NULL);
 -	MMIO_F(PLANE_WM(PIPE_A, 1, 0), 4 * 8, 0, 0, 0, D_SKL_PLUS, NULL, NULL);
 -	MMIO_F(PLANE_WM(PIPE_A, 2, 0), 4 * 8, 0, 0, 0, D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_F(PLANE_WM(PIPE_B, 0, 0), 4 * 8, 0, 0, 0, D_SKL_PLUS, NULL, NULL);
 -	MMIO_F(PLANE_WM(PIPE_B, 1, 0), 4 * 8, 0, 0, 0, D_SKL_PLUS, NULL, NULL);
 -	MMIO_F(PLANE_WM(PIPE_B, 2, 0), 4 * 8, 0, 0, 0, D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_F(PLANE_WM(PIPE_C, 0, 0), 4 * 8, 0, 0, 0, D_SKL_PLUS, NULL, NULL);
 -	MMIO_F(PLANE_WM(PIPE_C, 1, 0), 4 * 8, 0, 0, 0, D_SKL_PLUS, NULL, NULL);
 -	MMIO_F(PLANE_WM(PIPE_C, 2, 0), 4 * 8, 0, 0, 0, D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_F(CUR_WM(PIPE_A, 0), 4 * 8, 0, 0, 0, D_SKL_PLUS, NULL, NULL);
 -	MMIO_F(CUR_WM(PIPE_B, 0), 4 * 8, 0, 0, 0, D_SKL_PLUS, NULL, NULL);
 -	MMIO_F(CUR_WM(PIPE_C, 0), 4 * 8, 0, 0, 0, D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(PLANE_WM_TRANS(PIPE_A, 0), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_WM_TRANS(PIPE_A, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_WM_TRANS(PIPE_A, 2), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(PLANE_WM_TRANS(PIPE_B, 0), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_WM_TRANS(PIPE_B, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_WM_TRANS(PIPE_B, 2), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(PLANE_WM_TRANS(PIPE_C, 0), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_WM_TRANS(PIPE_C, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_WM_TRANS(PIPE_C, 2), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(CUR_WM_TRANS(PIPE_A), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(CUR_WM_TRANS(PIPE_B), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(CUR_WM_TRANS(PIPE_C), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_A, 0), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_A, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_A, 2), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_A, 3), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_B, 0), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_B, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_B, 2), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_B, 3), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_C, 0), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_C, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_C, 2), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_C, 3), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(_REG_701C0(PIPE_A, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C0(PIPE_A, 2), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C0(PIPE_A, 3), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C0(PIPE_A, 4), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(_REG_701C0(PIPE_B, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C0(PIPE_B, 2), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C0(PIPE_B, 3), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C0(PIPE_B, 4), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(_REG_701C0(PIPE_C, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C0(PIPE_C, 2), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C0(PIPE_C, 3), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C0(PIPE_C, 4), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(_REG_701C4(PIPE_A, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C4(PIPE_A, 2), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C4(PIPE_A, 3), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C4(PIPE_A, 4), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(_REG_701C4(PIPE_B, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C4(PIPE_B, 2), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C4(PIPE_B, 3), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C4(PIPE_B, 4), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_DH(_REG_701C4(PIPE_C, 1), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C4(PIPE_C, 2), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C4(PIPE_C, 3), D_SKL_PLUS, NULL, NULL);
 -	MMIO_DH(_REG_701C4(PIPE_C, 4), D_SKL_PLUS, NULL, NULL);
 -
 -	MMIO_D(0x70380, D_SKL_PLUS);
 -	MMIO_D(0x71380, D_SKL_PLUS);
 -	MMIO_D(0x72380, D_SKL_PLUS);
 -	MMIO_D(0x7039c, D_SKL_PLUS);
 -
 -	MMIO_D(0x8f074, D_SKL | D_KBL);
 -	MMIO_D(0x8f004, D_SKL | D_KBL);
 -	MMIO_D(0x8f034, D_SKL | D_KBL);
 -
 -	MMIO_D(0xb11c, D_SKL | D_KBL);
 -
 -	MMIO_D(0x51000, D_SKL | D_KBL);
 -	MMIO_D(0x6c00c, D_SKL_PLUS);
 -
 -	MMIO_F(0xc800, 0x7f8, F_CMD_ACCESS, 0, 0, D_SKL | D_KBL, NULL, NULL);
 -	MMIO_F(0xb020, 0x80, F_CMD_ACCESS, 0, 0, D_SKL | D_KBL, NULL, NULL);
 -
 -	MMIO_D(0xd08, D_SKL_PLUS);
 -	MMIO_DFH(0x20e0, D_SKL_PLUS, F_MODE_MASK, NULL, NULL);
 -	MMIO_DFH(0x20ec, D_SKL_PLUS, F_MODE_MASK | F_CMD_ACCESS, NULL, NULL);
 +	MMIO_DH(0x4ddc, D_SKL, NULL, skl_misc_ctl_write);
 +	MMIO_DH(0x42080, D_SKL, NULL, skl_misc_ctl_write);
 +	MMIO_D(0x45504, D_SKL);
 +	MMIO_D(0x45520, D_SKL);
 +	MMIO_D(0x46000, D_SKL);
 +	MMIO_DH(0x46010, D_SKL, NULL, skl_lcpll_write);
 +	MMIO_DH(0x46014, D_SKL, NULL, skl_lcpll_write);
 +	MMIO_D(0x6C040, D_SKL);
 +	MMIO_D(0x6C048, D_SKL);
 +	MMIO_D(0x6C050, D_SKL);
 +	MMIO_D(0x6C044, D_SKL);
 +	MMIO_D(0x6C04C, D_SKL);
 +	MMIO_D(0x6C054, D_SKL);
 +	MMIO_D(0x6c058, D_SKL);
 +	MMIO_D(0x6c05c, D_SKL);
 +	MMIO_DH(0X6c060, D_SKL, dpll_status_read, NULL);
 +
 +	MMIO_DH(SKL_PS_WIN_POS(PIPE_A, 0), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_WIN_POS(PIPE_A, 1), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_WIN_POS(PIPE_B, 0), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_WIN_POS(PIPE_B, 1), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_WIN_POS(PIPE_C, 0), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_WIN_POS(PIPE_C, 1), D_SKL, NULL, pf_write);
 +
 +	MMIO_DH(SKL_PS_WIN_SZ(PIPE_A, 0), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_WIN_SZ(PIPE_A, 1), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_WIN_SZ(PIPE_B, 0), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_WIN_SZ(PIPE_B, 1), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_WIN_SZ(PIPE_C, 0), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_WIN_SZ(PIPE_C, 1), D_SKL, NULL, pf_write);
 +
 +	MMIO_DH(SKL_PS_CTRL(PIPE_A, 0), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_CTRL(PIPE_A, 1), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_CTRL(PIPE_B, 0), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_CTRL(PIPE_B, 1), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_CTRL(PIPE_C, 0), D_SKL, NULL, pf_write);
 +	MMIO_DH(SKL_PS_CTRL(PIPE_C, 1), D_SKL, NULL, pf_write);
 +
 +	MMIO_DH(PLANE_BUF_CFG(PIPE_A, 0), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_BUF_CFG(PIPE_A, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_BUF_CFG(PIPE_A, 2), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_BUF_CFG(PIPE_A, 3), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(PLANE_BUF_CFG(PIPE_B, 0), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_BUF_CFG(PIPE_B, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_BUF_CFG(PIPE_B, 2), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_BUF_CFG(PIPE_B, 3), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(PLANE_BUF_CFG(PIPE_C, 0), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_BUF_CFG(PIPE_C, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_BUF_CFG(PIPE_C, 2), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_BUF_CFG(PIPE_C, 3), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(CUR_BUF_CFG(PIPE_A), D_SKL, NULL, NULL);
 +	MMIO_DH(CUR_BUF_CFG(PIPE_B), D_SKL, NULL, NULL);
 +	MMIO_DH(CUR_BUF_CFG(PIPE_C), D_SKL, NULL, NULL);
 +
 +	MMIO_F(PLANE_WM(PIPE_A, 0, 0), 4 * 8, 0, 0, 0, D_SKL, NULL, NULL);
 +	MMIO_F(PLANE_WM(PIPE_A, 1, 0), 4 * 8, 0, 0, 0, D_SKL, NULL, NULL);
 +	MMIO_F(PLANE_WM(PIPE_A, 2, 0), 4 * 8, 0, 0, 0, D_SKL, NULL, NULL);
 +
 +	MMIO_F(PLANE_WM(PIPE_B, 0, 0), 4 * 8, 0, 0, 0, D_SKL, NULL, NULL);
 +	MMIO_F(PLANE_WM(PIPE_B, 1, 0), 4 * 8, 0, 0, 0, D_SKL, NULL, NULL);
 +	MMIO_F(PLANE_WM(PIPE_B, 2, 0), 4 * 8, 0, 0, 0, D_SKL, NULL, NULL);
 +
 +	MMIO_F(PLANE_WM(PIPE_C, 0, 0), 4 * 8, 0, 0, 0, D_SKL, NULL, NULL);
 +	MMIO_F(PLANE_WM(PIPE_C, 1, 0), 4 * 8, 0, 0, 0, D_SKL, NULL, NULL);
 +	MMIO_F(PLANE_WM(PIPE_C, 2, 0), 4 * 8, 0, 0, 0, D_SKL, NULL, NULL);
 +
 +	MMIO_F(CUR_WM(PIPE_A, 0), 4 * 8, 0, 0, 0, D_SKL, NULL, NULL);
 +	MMIO_F(CUR_WM(PIPE_B, 0), 4 * 8, 0, 0, 0, D_SKL, NULL, NULL);
 +	MMIO_F(CUR_WM(PIPE_C, 0), 4 * 8, 0, 0, 0, D_SKL, NULL, NULL);
 +
 +	MMIO_DH(PLANE_WM_TRANS(PIPE_A, 0), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_WM_TRANS(PIPE_A, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_WM_TRANS(PIPE_A, 2), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(PLANE_WM_TRANS(PIPE_B, 0), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_WM_TRANS(PIPE_B, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_WM_TRANS(PIPE_B, 2), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(PLANE_WM_TRANS(PIPE_C, 0), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_WM_TRANS(PIPE_C, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_WM_TRANS(PIPE_C, 2), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(CUR_WM_TRANS(PIPE_A), D_SKL, NULL, NULL);
 +	MMIO_DH(CUR_WM_TRANS(PIPE_B), D_SKL, NULL, NULL);
 +	MMIO_DH(CUR_WM_TRANS(PIPE_C), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_A, 0), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_A, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_A, 2), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_A, 3), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_B, 0), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_B, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_B, 2), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_B, 3), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_C, 0), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_C, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_C, 2), D_SKL, NULL, NULL);
 +	MMIO_DH(PLANE_NV12_BUF_CFG(PIPE_C, 3), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(_REG_701C0(PIPE_A, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C0(PIPE_A, 2), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C0(PIPE_A, 3), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C0(PIPE_A, 4), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(_REG_701C0(PIPE_B, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C0(PIPE_B, 2), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C0(PIPE_B, 3), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C0(PIPE_B, 4), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(_REG_701C0(PIPE_C, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C0(PIPE_C, 2), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C0(PIPE_C, 3), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C0(PIPE_C, 4), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(_REG_701C4(PIPE_A, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C4(PIPE_A, 2), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C4(PIPE_A, 3), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C4(PIPE_A, 4), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(_REG_701C4(PIPE_B, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C4(PIPE_B, 2), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C4(PIPE_B, 3), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C4(PIPE_B, 4), D_SKL, NULL, NULL);
 +
 +	MMIO_DH(_REG_701C4(PIPE_C, 1), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C4(PIPE_C, 2), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C4(PIPE_C, 3), D_SKL, NULL, NULL);
 +	MMIO_DH(_REG_701C4(PIPE_C, 4), D_SKL, NULL, NULL);
 +
 +	MMIO_D(0x70380, D_SKL);
 +	MMIO_D(0x71380, D_SKL);
 +	MMIO_D(0x72380, D_SKL);
 +	MMIO_D(0x7039c, D_SKL);
 +
 +	MMIO_F(0x80000, 0x3000, 0, 0, 0, D_SKL, NULL, NULL);
 +	MMIO_D(0x8f074, D_SKL);
 +	MMIO_D(0x8f004, D_SKL);
 +	MMIO_D(0x8f034, D_SKL);
 +
 +	MMIO_D(0xb11c, D_SKL);
 +
 +	MMIO_D(0x51000, D_SKL);
 +	MMIO_D(0x6c00c, D_SKL);
 +
 +	MMIO_F(0xc800, 0x7f8, F_CMD_ACCESS, 0, 0, D_SKL, NULL, NULL);
 +	MMIO_F(0xb020, 0x80, F_CMD_ACCESS, 0, 0, D_SKL, NULL, NULL);
 +
 +	MMIO_D(0xd08, D_SKL);
 +	MMIO_DFH(0x20e0, D_SKL, F_MODE_MASK, NULL, NULL);
 +	MMIO_DFH(0x20ec, D_SKL, F_MODE_MASK | F_CMD_ACCESS, NULL, NULL);
  
  	/* TRTT */
 -	MMIO_DFH(0x4de0, D_SKL | D_KBL, F_CMD_ACCESS, NULL, NULL);
 -	MMIO_DFH(0x4de4, D_SKL | D_KBL, F_CMD_ACCESS, NULL, NULL);
 -	MMIO_DFH(0x4de8, D_SKL | D_KBL, F_CMD_ACCESS, NULL, NULL);
 -	MMIO_DFH(0x4dec, D_SKL | D_KBL, F_CMD_ACCESS, NULL, NULL);
 -	MMIO_DFH(0x4df0, D_SKL | D_KBL, F_CMD_ACCESS, NULL, NULL);
 -	MMIO_DFH(0x4df4, D_SKL | D_KBL, F_CMD_ACCESS, NULL, gen9_trtte_write);
 -	MMIO_DH(0x4dfc, D_SKL | D_KBL, NULL, gen9_trtt_chicken_write);
 +	MMIO_DFH(0x4de0, D_SKL, F_CMD_ACCESS, NULL, NULL);
 +	MMIO_DFH(0x4de4, D_SKL, F_CMD_ACCESS, NULL, NULL);
 +	MMIO_DFH(0x4de8, D_SKL, F_CMD_ACCESS, NULL, NULL);
 +	MMIO_DFH(0x4dec, D_SKL, F_CMD_ACCESS, NULL, NULL);
 +	MMIO_DFH(0x4df0, D_SKL, F_CMD_ACCESS, NULL, NULL);
 +	MMIO_DFH(0x4df4, D_SKL, F_CMD_ACCESS, NULL, gen9_trtte_write);
 +	MMIO_DH(0x4dfc, D_SKL, NULL, gen9_trtt_chicken_write);
  
 -	MMIO_D(0x45008, D_SKL | D_KBL);
 +	MMIO_D(0x45008, D_SKL);
  
 -	MMIO_D(0x46430, D_SKL | D_KBL);
 +	MMIO_D(0x46430, D_SKL);
  
 -	MMIO_D(0x46520, D_SKL | D_KBL);
 +	MMIO_D(0x46520, D_SKL);
  
 -	MMIO_D(0xc403c, D_SKL | D_KBL);
 -	MMIO_D(0xb004, D_SKL_PLUS);
 +	MMIO_D(0xc403c, D_SKL);
 +	MMIO_D(0xb004, D_SKL);
  	MMIO_DH(DMA_CTRL, D_SKL_PLUS, NULL, dma_ctrl_write);
  
 -	MMIO_D(0x65900, D_SKL_PLUS);
 -	MMIO_D(0x1082c0, D_SKL | D_KBL);
 -	MMIO_D(0x4068, D_SKL | D_KBL);
 -	MMIO_D(0x67054, D_SKL | D_KBL);
 -	MMIO_D(0x6e560, D_SKL | D_KBL);
 -	MMIO_D(0x6e554, D_SKL | D_KBL);
 -	MMIO_D(0x2b20, D_SKL | D_KBL);
 -	MMIO_D(0x65f00, D_SKL | D_KBL);
 -	MMIO_D(0x65f08, D_SKL | D_KBL);
 -	MMIO_D(0x320f0, D_SKL | D_KBL);
 -
 +	MMIO_D(0x65900, D_SKL);
 +	MMIO_D(0x1082c0, D_SKL);
 +	MMIO_D(0x4068, D_SKL);
 +	MMIO_D(0x67054, D_SKL);
 +	MMIO_D(0x6e560, D_SKL);
 +	MMIO_D(0x6e554, D_SKL);
 +	MMIO_D(0x2b20, D_SKL);
 +	MMIO_D(0x65f00, D_SKL);
 +	MMIO_D(0x65f08, D_SKL);
 +	MMIO_D(0x320f0, D_SKL);
 +
++<<<<<<< HEAD
 +	MMIO_DFH(_REG_VCS2_EXCC, D_SKL, F_CMD_ACCESS, NULL, NULL);
 +	MMIO_D(0x70034, D_SKL);
 +	MMIO_D(0x71034, D_SKL);
 +	MMIO_D(0x72034, D_SKL);
++=======
+ 	MMIO_D(0x70034, D_SKL_PLUS);
+ 	MMIO_D(0x71034, D_SKL_PLUS);
+ 	MMIO_D(0x72034, D_SKL_PLUS);
++>>>>>>> edee7ecdb4d7 (drm/i915/gvt: Refine MMIO_RING_F())
  
 -	MMIO_D(_PLANE_KEYVAL_1(PIPE_A), D_SKL_PLUS);
 -	MMIO_D(_PLANE_KEYVAL_1(PIPE_B), D_SKL_PLUS);
 -	MMIO_D(_PLANE_KEYVAL_1(PIPE_C), D_SKL_PLUS);
 -	MMIO_D(_PLANE_KEYMSK_1(PIPE_A), D_SKL_PLUS);
 -	MMIO_D(_PLANE_KEYMSK_1(PIPE_B), D_SKL_PLUS);
 -	MMIO_D(_PLANE_KEYMSK_1(PIPE_C), D_SKL_PLUS);
 +	MMIO_D(_PLANE_KEYVAL_1(PIPE_A), D_SKL);
 +	MMIO_D(_PLANE_KEYVAL_1(PIPE_B), D_SKL);
 +	MMIO_D(_PLANE_KEYVAL_1(PIPE_C), D_SKL);
 +	MMIO_D(_PLANE_KEYMSK_1(PIPE_A), D_SKL);
 +	MMIO_D(_PLANE_KEYMSK_1(PIPE_B), D_SKL);
 +	MMIO_D(_PLANE_KEYMSK_1(PIPE_C), D_SKL);
  
 -	MMIO_D(0x44500, D_SKL_PLUS);
 +	MMIO_D(0x44500, D_SKL);
  	MMIO_DFH(GEN9_CSFE_CHICKEN1_RCS, D_SKL_PLUS, F_CMD_ACCESS, NULL, NULL);
 -	MMIO_DFH(GEN8_HDC_CHICKEN1, D_SKL | D_KBL, F_MODE_MASK | F_CMD_ACCESS,
 +	MMIO_DFH(GEN8_HDC_CHICKEN1, D_SKL, F_MODE_MASK | F_CMD_ACCESS,
  		NULL, NULL);
 -
 -	MMIO_D(0x4ab8, D_KBL);
 -	MMIO_D(0x2248, D_SKL_PLUS | D_KBL);
 -
  	return 0;
  }
  
* Unmerged path drivers/gpu/drm/i915/gvt/handlers.c
diff --git a/drivers/gpu/drm/i915/gvt/reg.h b/drivers/gpu/drm/i915/gvt/reg.h
index fbd023a16f18..7d01c77a0f7a 100644
--- a/drivers/gpu/drm/i915/gvt/reg.h
+++ b/drivers/gpu/drm/i915/gvt/reg.h
@@ -54,9 +54,6 @@
 
 #define VGT_SPRSTRIDE(pipe)	_PIPE(pipe, _SPRA_STRIDE, _PLANE_STRIDE_2_B)
 
-#define _REG_VECS_EXCC		0x1A028
-#define _REG_VCS2_EXCC		0x1c028
-
 #define _REG_701C0(pipe, plane) (0x701c0 + pipe * 0x1000 + (plane - 1) * 0x100)
 #define _REG_701C4(pipe, plane) (0x701c4 + pipe * 0x1000 + (plane - 1) * 0x100)
 
