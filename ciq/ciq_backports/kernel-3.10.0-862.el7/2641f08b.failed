x86/retpoline/entry: Convert entry assembler indirect jumps

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [x86] retpoline/entry: Convert entry assembler indirect jumps (Josh Poimboeuf) [1535644]
Rebuild_FUZZ: 96.49%
commit-author David Woodhouse <dwmw@amazon.co.uk>
commit 2641f08bb7fc63a636a2b18173221d7040a3512e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/2641f08b.failed

Convert indirect jumps in core 32/64bit entry assembler code to use
non-speculative sequences when CONFIG_RETPOLINE is enabled.

Don't use CALL_NOSPEC in entry_SYSCALL_64_fastpath because the return
address after the 'call' instruction must be *precisely* at the
.Lentry_SYSCALL_64_after_fastpath label for stub_ptregs_64 to work,
and the use of alternatives will mess that up unless we play horrid
games to prepend with NOPs and make the variants the same length. It's
not worth it; in the case where we ALTERNATIVE out the retpoline, the
first instruction at __x86.indirect_thunk.rax is going to be a bare
jmp *%rax anyway.

	Signed-off-by: David Woodhouse <dwmw@amazon.co.uk>
	Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
	Acked-by: Ingo Molnar <mingo@kernel.org>
	Acked-by: Arjan van de Ven <arjan@linux.intel.com>
	Cc: gnomes@lxorguk.ukuu.org.uk
	Cc: Rik van Riel <riel@redhat.com>
	Cc: Andi Kleen <ak@linux.intel.com>
	Cc: Josh Poimboeuf <jpoimboe@redhat.com>
	Cc: thomas.lendacky@amd.com
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Linus Torvalds <torvalds@linux-foundation.org>
	Cc: Jiri Kosina <jikos@kernel.org>
	Cc: Andy Lutomirski <luto@amacapital.net>
	Cc: Dave Hansen <dave.hansen@intel.com>
	Cc: Kees Cook <keescook@google.com>
	Cc: Tim Chen <tim.c.chen@linux.intel.com>
	Cc: Greg Kroah-Hartman <gregkh@linux-foundation.org>
	Cc: Paul Turner <pjt@google.com>
Link: https://lkml.kernel.org/r/1515707194-20531-7-git-send-email-dwmw@amazon.co.uk

(cherry picked from commit 2641f08bb7fc63a636a2b18173221d7040a3512e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/entry/entry_32.S
#	arch/x86/entry/entry_64.S
* Unmerged path arch/x86/entry/entry_32.S
* Unmerged path arch/x86/entry/entry_64.S
* Unmerged path arch/x86/entry/entry_32.S
* Unmerged path arch/x86/entry/entry_64.S
