netvsc: enable GRO

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author stephen hemminger <stephen@networkplumber.org>
commit 742fe54c7b03c83ce8067822a8739a4091c319ed
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/742fe54c.failed

Use GRO when receiving packets.

	Signed-off-by: Stephen Hemminger <sthemmin@microsoft.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 742fe54c7b03c83ce8067822a8739a4091c319ed)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/hyperv/netvsc_drv.c
diff --cc drivers/net/hyperv/netvsc_drv.c
index 8539eb924b13,1345f34b6baf..000000000000
--- a/drivers/net/hyperv/netvsc_drv.c
+++ b/drivers/net/hyperv/netvsc_drv.c
@@@ -658,6 -641,9 +658,12 @@@ int netvsc_recv_callback(struct net_dev
  			 const struct ndis_pkt_8021q_info *vlan)
  {
  	struct net_device_context *net_device_ctx = netdev_priv(net);
++<<<<<<< HEAD
++=======
+ 	struct netvsc_device *net_device = net_device_ctx->nvdev;
+ 	u16 q_idx = channel->offermsg.offer.sub_channel_index;
+ 	struct netvsc_channel *nvchan = &net_device->chan_table[q_idx];
++>>>>>>> 742fe54c7b03 (netvsc: enable GRO)
  	struct net_device *vf_netdev;
  	struct sk_buff *skb;
  	struct netvsc_stats *rx_stats;
@@@ -694,7 -679,7 +700,11 @@@
  	 * on the synthetic device because modifying the VF device
  	 * statistics will not work correctly.
  	 */
++<<<<<<< HEAD
 +	rx_stats = this_cpu_ptr(net_device_ctx->rx_stats);
++=======
+ 	rx_stats = &nvchan->rx_stats;
++>>>>>>> 742fe54c7b03 (netvsc: enable GRO)
  	u64_stats_update_begin(&rx_stats->syncp);
  	rx_stats->packets++;
  	rx_stats->bytes += len;
@@@ -705,12 -690,7 +715,16 @@@
  		++rx_stats->multicast;
  	u64_stats_update_end(&rx_stats->syncp);
  
++<<<<<<< HEAD
 +	/*
 +	 * Pass the skb back up. Network stack will deallocate the skb when it
 +	 * is done.
 +	 * TODO - use NAPI?
 +	 */
 +	netif_receive_skb(skb);
++=======
+ 	napi_gro_receive(&nvchan->napi, skb);
++>>>>>>> 742fe54c7b03 (netvsc: enable GRO)
  	rcu_read_unlock();
  
  	return 0;
* Unmerged path drivers/net/hyperv/netvsc_drv.c
