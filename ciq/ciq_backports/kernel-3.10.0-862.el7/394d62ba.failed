tcm_qla2xxx: Add NPIV specific enable/disable attribute logic

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Nicholas Bellinger <nab@linux-iscsi.org>
commit 394d62ba4580a74afc90bf0e007e10291bf447cc
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/394d62ba.failed

This patch adds seperate logic for NPIV specific enable/disable
attribute logic, as NPIV vs. non-NPIV enable/disable ends up being
different enough to warrent seperate logic for setting configfs
tpg_group dependencies in the non-NPIV case.

	Cc: Sawan Chandak <sawan.chandak@qlogic.com>
	Cc: Quinn Tran <quinn.tran@qlogic.com>
	Cc: Saurav Kashyap <saurav.kashyap@qlogic.com>
	Cc: Giridhar Malavali <giridhar.malavali@qlogic.com>
	Signed-off-by: Nicholas Bellinger <nab@linux-iscsi.org>
(cherry picked from commit 394d62ba4580a74afc90bf0e007e10291bf447cc)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/qla2xxx/tcm_qla2xxx.c
diff --cc drivers/scsi/qla2xxx/tcm_qla2xxx.c
index e9c7bfd1510c,db43b2893525..000000000000
--- a/drivers/scsi/qla2xxx/tcm_qla2xxx.c
+++ b/drivers/scsi/qla2xxx/tcm_qla2xxx.c
@@@ -1099,9 -1053,7 +1099,13 @@@ static void tcm_qla2xxx_drop_tpg(struc
  	/*
  	 * Clear local TPG=1 pointer for non NPIV mode.
  	 */
++<<<<<<< HEAD
 +	if (lport->qla_npiv_vp == NULL)
 +		lport->tpg_1 = NULL;
 +
++=======
+ 	lport->tpg_1 = NULL;
++>>>>>>> 394d62ba4580 (tcm_qla2xxx: Add NPIV specific enable/disable attribute logic)
  	kfree(tpg);
  }
  
@@@ -1904,15 -1986,16 +1962,28 @@@ static int tcm_qla2xxx_register_configf
  	/*
  	 * Setup default attribute lists for various npiv_fabric->tf_cit_tmpl
  	 */
++<<<<<<< HEAD
 +	TF_CIT_TMPL(npiv_fabric)->tfc_wwn_cit.ct_attrs = tcm_qla2xxx_wwn_attrs;
 +	TF_CIT_TMPL(npiv_fabric)->tfc_tpg_base_cit.ct_attrs = NULL;
 +	TF_CIT_TMPL(npiv_fabric)->tfc_tpg_attrib_cit.ct_attrs = NULL;
 +	TF_CIT_TMPL(npiv_fabric)->tfc_tpg_param_cit.ct_attrs = NULL;
 +	TF_CIT_TMPL(npiv_fabric)->tfc_tpg_np_base_cit.ct_attrs = NULL;
 +	TF_CIT_TMPL(npiv_fabric)->tfc_tpg_nacl_base_cit.ct_attrs = NULL;
 +	TF_CIT_TMPL(npiv_fabric)->tfc_tpg_nacl_attrib_cit.ct_attrs = NULL;
 +	TF_CIT_TMPL(npiv_fabric)->tfc_tpg_nacl_auth_cit.ct_attrs = NULL;
 +	TF_CIT_TMPL(npiv_fabric)->tfc_tpg_nacl_param_cit.ct_attrs = NULL;
++=======
+ 	npiv_fabric->tf_cit_tmpl.tfc_wwn_cit.ct_attrs = tcm_qla2xxx_wwn_attrs;
+ 	npiv_fabric->tf_cit_tmpl.tfc_tpg_base_cit.ct_attrs =
+ 	    tcm_qla2xxx_npiv_tpg_attrs;
+ 	npiv_fabric->tf_cit_tmpl.tfc_tpg_attrib_cit.ct_attrs = NULL;
+ 	npiv_fabric->tf_cit_tmpl.tfc_tpg_param_cit.ct_attrs = NULL;
+ 	npiv_fabric->tf_cit_tmpl.tfc_tpg_np_base_cit.ct_attrs = NULL;
+ 	npiv_fabric->tf_cit_tmpl.tfc_tpg_nacl_base_cit.ct_attrs = NULL;
+ 	npiv_fabric->tf_cit_tmpl.tfc_tpg_nacl_attrib_cit.ct_attrs = NULL;
+ 	npiv_fabric->tf_cit_tmpl.tfc_tpg_nacl_auth_cit.ct_attrs = NULL;
+ 	npiv_fabric->tf_cit_tmpl.tfc_tpg_nacl_param_cit.ct_attrs = NULL;
++>>>>>>> 394d62ba4580 (tcm_qla2xxx: Add NPIV specific enable/disable attribute logic)
  	/*
  	 * Register the npiv_fabric for use within TCM
  	 */
* Unmerged path drivers/scsi/qla2xxx/tcm_qla2xxx.c
