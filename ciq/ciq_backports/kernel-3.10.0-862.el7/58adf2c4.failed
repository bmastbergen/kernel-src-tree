mlxsw: spectrum_router: Don't assume neighbour type

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Ido Schimmel <idosch@mellanox.com>
commit 58adf2c48003d1a7469fe0d0b438300ab6173031
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/58adf2c4.failed

Thankfully, the neighbour subsystem is agnostic to the upper protocol
and used by both IPv4 and IPv6. By removing assumptions regarding the
neighbour type we can thus re-use much of the neighbour-related code for
both IPv4 and IPv6.

For each nexthop, store its gateway IP and for nexthop group store the
neighbour table used by its nexthops.

Use this information throughout the code and remove assumption about the
neighbour type.

	Signed-off-by: Ido Schimmel <idosch@mellanox.com>
	Signed-off-by: Jiri Pirko <jiri@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 58adf2c48003d1a7469fe0d0b438300ab6173031)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
diff --cc drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
index c83798787698,36f2b6843f17..000000000000
--- a/drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
+++ b/drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
@@@ -1133,7 -1437,8 +1133,12 @@@ struct mlxsw_sp_nexthop 
  						*/
  	struct rhash_head ht_node;
  	struct mlxsw_sp_nexthop_key key;
++<<<<<<< HEAD
 +	struct mlxsw_sp_rif *r;
++=======
+ 	unsigned char gw_addr[sizeof(struct in6_addr)];
+ 	struct mlxsw_sp_rif *rif;
++>>>>>>> 58adf2c48003 (mlxsw: spectrum_router: Don't assume neighbour type)
  	u8 should_offload:1, /* set indicates this neigh is connected and
  			      * should be put to KVD linear area of this group.
  			      */
* Unmerged path drivers/net/ethernet/mellanox/mlxsw/spectrum_router.c
