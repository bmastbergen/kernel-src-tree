perf/x86/msr: Add AMD PTSC (Performance Time-Stamp Counter) support

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Huang Rui <ray.huang@amd.com>
commit 8a22426184774d7ced9c1d3aa4d95d34101fb3be
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/8a224261.failed

AMD Carrizo (Family 15h, Model 60h) introduces a time-stamp counter
which is indicated by CPUID.8000_0001H:ECX[27]. It increments at a 100
MHz rate in all P-states, and C states, S0, or S1. The frequency is
about 100MHz. This counter will be used to calculate processor power
and other parts. So add an interface into the MSR PMU to get the PTSC
counter value.

	Signed-off-by: Huang Rui <ray.huang@amd.com>
	Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
	Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com>
	Cc: Andy Lutomirski <luto@amacapital.net>
	Cc: Aravind Gopalakrishnan <Aravind.Gopalakrishnan@amd.com>
	Cc: Arnaldo Carvalho de Melo <acme@kernel.org>
	Cc: Arnaldo Carvalho de Melo <acme@redhat.com>
	Cc: Borislav Petkov <bp@alien8.de>
	Cc: Borislav Petkov <bp@suse.de>
	Cc: Fengguang Wu <fengguang.wu@intel.com>
	Cc: Jacob Shin <jacob.w.shin@gmail.com>
	Cc: Jiri Olsa <jolsa@redhat.com>
	Cc: Kan Liang <kan.liang@intel.com>
	Cc: Linus Torvalds <torvalds@linux-foundation.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Robert Richter <rric@kernel.org>
	Cc: Stephane Eranian <eranian@google.com>
	Cc: Suravee Suthikulpanit <suravee.suthikulpanit@amd.com>
	Cc: Thomas Gleixner <tglx@linutronix.de>
	Cc: Vince Weaver <vincent.weaver@maine.edu>
Link: http://lkml.kernel.org/r/1454056197-5893-2-git-send-email-ray.huang@amd.com
	Signed-off-by: Ingo Molnar <mingo@kernel.org>
(cherry picked from commit 8a22426184774d7ced9c1d3aa4d95d34101fb3be)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/events/msr.c
#	arch/x86/include/asm/cpufeatures.h
#	arch/x86/include/asm/msr-index.h
diff --cc arch/x86/include/asm/msr-index.h
index 4cf87f807cc5,6e6a5ccfb3f5..000000000000
--- a/arch/x86/include/asm/msr-index.h
+++ b/arch/x86/include/asm/msr-index.h
@@@ -322,6 -326,8 +322,11 @@@
  #define MSR_F15H_PERF_CTR		0xc0010201
  #define MSR_F15H_NB_PERF_CTL		0xc0010240
  #define MSR_F15H_NB_PERF_CTR		0xc0010241
++<<<<<<< HEAD
++=======
+ #define MSR_F15H_PTSC			0xc0010280
+ #define MSR_F15H_IC_CFG			0xc0011021
++>>>>>>> 8a2242618477 (perf/x86/msr: Add AMD PTSC (Performance Time-Stamp Counter) support)
  
  /* Fam 10h MSRs */
  #define MSR_FAM10H_MMIO_CONF_BASE	0xc0010058
* Unmerged path arch/x86/events/msr.c
* Unmerged path arch/x86/include/asm/cpufeatures.h
* Unmerged path arch/x86/events/msr.c
* Unmerged path arch/x86/include/asm/cpufeatures.h
* Unmerged path arch/x86/include/asm/msr-index.h
