ibmvnic: Check for driver reset first in ibmvnic_xmit

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Nathan Fontenot <nfont@linux.vnet.ibm.com>
commit 161b8a813877fb7d3deba6b3bd2731d4f4a75c5e
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/161b8a81.failed

Move the check for the driver resetting to the first thing
in ibmvnic_xmit().

	Signed-off-by: Nathan Fontenot <nfont@linux.vnet.ibm.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 161b8a813877fb7d3deba6b3bd2731d4f4a75c5e)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/ibm/ibmvnic.c
diff --cc drivers/net/ethernet/ibm/ibmvnic.c
index 8b65bfc1f714,f1ee37716ad7..000000000000
--- a/drivers/net/ethernet/ibm/ibmvnic.c
+++ b/drivers/net/ethernet/ibm/ibmvnic.c
@@@ -745,13 -985,7 +745,17 @@@ static int ibmvnic_xmit(struct sk_buff 
  	int index = 0;
  	int ret = 0;
  
++<<<<<<< HEAD
 +	tx_pool = &adapter->tx_pool[queue_num];
 +	tx_scrq = adapter->tx_scrq[queue_num];
 +	txq = netdev_get_tx_queue(netdev, skb_get_queue_mapping(skb));
 +	handle_array = (u64 *)((u8 *)(adapter->login_rsp_buf) +
 +				   be32_to_cpu(adapter->login_rsp_buf->
 +					       off_txsubm_subcrqs));
 +	if (adapter->migrated) {
++=======
+ 	if (adapter->resetting) {
++>>>>>>> 161b8a813877 (ibmvnic: Check for driver reset first in ibmvnic_xmit)
  		if (!netif_subqueue_stopped(netdev, skb))
  			netif_stop_subqueue(netdev, queue_num);
  		dev_kfree_skb_any(skb);
* Unmerged path drivers/net/ethernet/ibm/ibmvnic.c
