x86/hyperv: Fix hypercalls with extended CPU ranges for TLB flushing

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
Rebuild_CHGLOG: - [x86] hyperv: Fix hypercalls with extended CPU ranges for TLB flushing (Vitaly Kuznetsov) [1465471]
Rebuild_FUZZ: 96.97%
commit-author Marcelo Henrique Cerri <marcelo.cerri@canonical.com>
commit ab7ff471aa5db670197070760f022622793da7e5
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/ab7ff471.failed

Do not consider the fixed size of hv_vp_set when passing the variable
header size to hv_do_rep_hypercall().

The Hyper-V hypervisor specification states that for a hypercall with a
variable header only the size of the variable portion should be supplied
via the input control.

For HVCALL_FLUSH_VIRTUAL_ADDRESS_SPACE_EX/LIST_EX calls that means the
fixed portion of hv_vp_set should not be considered.

That fixes random failures of some applications that are unexpectedly
killed with SIGBUS or SIGSEGV.

	Signed-off-by: Marcelo Henrique Cerri <marcelo.cerri@canonical.com>
	Cc: Dexuan Cui <decui@microsoft.com>
	Cc: Haiyang Zhang <haiyangz@microsoft.com>
	Cc: Jork Loeser <Jork.Loeser@microsoft.com>
	Cc: Josh Poulson <jopoulso@microsoft.com>
	Cc: K. Y. Srinivasan <kys@microsoft.com>
	Cc: Linus Torvalds <torvalds@linux-foundation.org>
	Cc: Peter Zijlstra <peterz@infradead.org>
	Cc: Simon Xiao <sixiao@microsoft.com>
	Cc: Stephen Hemminger <sthemmin@microsoft.com>
	Cc: Thomas Gleixner <tglx@linutronix.de>
	Cc: Vitaly Kuznetsov <vkuznets@redhat.com>
	Cc: devel@linuxdriverproject.org
Fixes: 628f54cc6451 ("x86/hyper-v: Support extended CPU ranges for TLB flush hypercalls")
Link: http://lkml.kernel.org/r/1507210469-29065-1-git-send-email-marcelo.cerri@canonical.com
	Signed-off-by: Ingo Molnar <mingo@kernel.org>
(cherry picked from commit ab7ff471aa5db670197070760f022622793da7e5)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/hyperv/mmu.c
* Unmerged path arch/x86/hyperv/mmu.c
* Unmerged path arch/x86/hyperv/mmu.c
