mpls: Refactor how the mpls module is built

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-862.el7
commit-author Eric W. Biederman <ebiederm@xmission.com>
commit cec9166ca4e586de389b0f3c43a8103e728d92ec
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-862.el7/cec9166c.failed

This refactoring is needed to allow more than just mpls gso
support to be built into the mpls moddule.

	Reviewed-by: Simon Horman <horms@verge.net.au>
	Signed-off-by: "Eric W. Biederman" <ebiederm@xmission.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit cec9166ca4e586de389b0f3c43a8103e728d92ec)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/Makefile
diff --cc net/Makefile
index d30df7466503,3995613e5510..000000000000
--- a/net/Makefile
+++ b/net/Makefile
@@@ -69,7 -69,8 +69,12 @@@ obj-$(CONFIG_BATMAN_ADV)	+= batman-adv
  obj-$(CONFIG_NFC)		+= nfc/
  obj-$(CONFIG_OPENVSWITCH)	+= openvswitch/
  obj-$(CONFIG_VSOCKETS)	+= vmw_vsock/
++<<<<<<< HEAD
 +obj-$(CONFIG_NET_MPLS_GSO)	+= mpls/
++=======
+ obj-$(CONFIG_MPLS)		+= mpls/
+ obj-$(CONFIG_HSR)		+= hsr/
++>>>>>>> cec9166ca4e5 (mpls: Refactor how the mpls module is built)
  ifneq ($(CONFIG_NET_SWITCHDEV),)
  obj-y				+= switchdev/
  endif
* Unmerged path net/Makefile
diff --git a/net/mpls/Kconfig b/net/mpls/Kconfig
index 37421db88965..a77fbcdd04ee 100644
--- a/net/mpls/Kconfig
+++ b/net/mpls/Kconfig
@@ -1,9 +1,25 @@
 #
 # MPLS configuration
 #
+
+menuconfig MPLS
+	tristate "MultiProtocol Label Switching"
+	default n
+	---help---
+	  MultiProtocol Label Switching routes packets through logical
+	  circuits.  Originally conceved as a way of routing packets at
+	  hardware speeds (before hardware was capable of routing ipv4 packets),
+	  MPLS remains as simple way of making tunnels.
+
+	  If you have not heard of MPLS you probably want to say N here.
+
+if MPLS
+
 config NET_MPLS_GSO
-	tristate "MPLS: GSO support"
+	bool "MPLS: GSO support"
 	help
 	 This is helper module to allow segmentation of non-MPLS GSO packets
 	 that have had MPLS stack entries pushed onto them and thus
 	 become MPLS GSO packets.
+
+endif # MPLS
