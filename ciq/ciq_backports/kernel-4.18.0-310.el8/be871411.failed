selftests/vm: run_vmtests: invoke gup_benchmark with basic FOLL_PIN coverage

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-310.el8
commit-author John Hubbard <jhubbard@nvidia.com>
commit be87141108f0f5ecbd094d921981dbc52f646c33
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-310.el8/be871411.failed

It's good to have basic unit test coverage of the new FOLL_PIN behavior.
Fortunately, the gup_benchmark unit test is extremely fast (a few
milliseconds), so adding it the the run_vmtests suite is going to cause no
noticeable change in running time.

So, add two new invocations to run_vmtests:

1) Run gup_benchmark with normal get_user_pages().

2) Run gup_benchmark with pin_user_pages().  This is much like the
   first call, except that it sets FOLL_PIN.

Running these two in quick succession also provide a visual comparison of
the running times, which is convenient.

The new invocations are fairly early in the run_vmtests script, because
with test suites, it's usually preferable to put the shorter, faster tests
first, all other things being equal.

	Signed-off-by: John Hubbard <jhubbard@nvidia.com>
	Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
	Reviewed-by: Ira Weiny <ira.weiny@intel.com>
	Cc: Jan Kara <jack@suse.cz>
	Cc: Jérôme Glisse <jglisse@redhat.com>
	Cc: Kirill A. Shutemov <kirill.shutemov@linux.intel.com>
	Cc: "Matthew Wilcox (Oracle)" <willy@infradead.org>
	Cc: Al Viro <viro@zeniv.linux.org.uk>
	Cc: Christoph Hellwig <hch@infradead.org>
	Cc: Dan Williams <dan.j.williams@intel.com>
	Cc: Dave Chinner <david@fromorbit.com>
	Cc: Jason Gunthorpe <jgg@ziepe.ca>
	Cc: Jonathan Corbet <corbet@lwn.net>
	Cc: Michal Hocko <mhocko@suse.com>
	Cc: Mike Kravetz <mike.kravetz@oracle.com>
	Cc: Shuah Khan <shuah@kernel.org>
	Cc: Vlastimil Babka <vbabka@suse.cz>
Link: http://lkml.kernel.org/r/20200211001536.1027652-11-jhubbard@nvidia.com
	Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
(cherry picked from commit be87141108f0f5ecbd094d921981dbc52f646c33)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/testing/selftests/vm/run_vmtests
diff --cc tools/testing/selftests/vm/run_vmtests
index 88cbe5575f0c,da0febf31cae..000000000000
--- a/tools/testing/selftests/vm/run_vmtests
+++ b/tools/testing/selftests/vm/run_vmtests
@@@ -104,6 -112,39 +104,42 @@@ echo "NOTE: The above hugetlb tests pro
  echo "      https://github.com/libhugetlbfs/libhugetlbfs.git for"
  echo "      hugetlb regression testing."
  
++<<<<<<< HEAD
++=======
+ echo "---------------------------"
+ echo "running map_fixed_noreplace"
+ echo "---------------------------"
+ ./map_fixed_noreplace
+ if [ $? -ne 0 ]; then
+ 	echo "[FAIL]"
+ 	exitcode=1
+ else
+ 	echo "[PASS]"
+ fi
+ 
+ echo "--------------------------------------------"
+ echo "running 'gup_benchmark -U' (normal/slow gup)"
+ echo "--------------------------------------------"
+ ./gup_benchmark -U
+ if [ $? -ne 0 ]; then
+ 	echo "[FAIL]"
+ 	exitcode=1
+ else
+ 	echo "[PASS]"
+ fi
+ 
+ echo "------------------------------------------"
+ echo "running gup_benchmark -b (pin_user_pages)"
+ echo "------------------------------------------"
+ ./gup_benchmark -b
+ if [ $? -ne 0 ]; then
+ 	echo "[FAIL]"
+ 	exitcode=1
+ else
+ 	echo "[PASS]"
+ fi
+ 
++>>>>>>> be87141108f0 (selftests/vm: run_vmtests: invoke gup_benchmark with basic FOLL_PIN coverage)
  echo "-------------------"
  echo "running userfaultfd"
  echo "-------------------"
* Unmerged path tools/testing/selftests/vm/run_vmtests
