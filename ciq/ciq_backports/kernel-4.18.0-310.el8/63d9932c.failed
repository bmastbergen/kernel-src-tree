block: move bdput() to the callers of __blkdev_get

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-310.el8
commit-author Christoph Hellwig <hch@lst.de>
commit 63d9932caecee8b0a295c608d083280b45885d10
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-310.el8/63d9932c.failed

This will allow for a more symmetric calling convention going forward.

	Signed-off-by: Christoph Hellwig <hch@lst.de>
	Reviewed-by: Jan Kara <jack@suse.cz>
	Reviewed-by: Hannes Reinecke <hare@suse.de>
	Signed-off-by: Jens Axboe <axboe@kernel.dk>
(cherry picked from commit 63d9932caecee8b0a295c608d083280b45885d10)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	fs/block_dev.c
diff --cc fs/block_dev.c
index d19c1a4a405b,a2d5050c97ee..000000000000
--- a/fs/block_dev.c
+++ b/fs/block_dev.c
@@@ -1639,6 -1461,8 +1639,11 @@@ static int __blkdev_get(struct block_de
  			bdev->bd_part = disk_get_part(disk, partno);
  			if (!(disk->flags & GENHD_FL_UP) ||
  			    !bdev->bd_part || !bdev->bd_part->nr_sects) {
++<<<<<<< HEAD
++=======
+ 				__blkdev_put(whole, mode, 1);
+ 				bdput(whole);
++>>>>>>> 63d9932caece (block: move bdput() to the callers of __blkdev_get)
  				ret = -ENXIO;
  				goto out_clear;
  			}
@@@ -1958,6 -1798,8 +1964,11 @@@ void blkdev_put(struct block_device *bd
  	mutex_unlock(&bdev->bd_mutex);
  
  	__blkdev_put(bdev, mode, 0);
++<<<<<<< HEAD
++=======
+ 	bdput(bdev);
+ 	put_disk_and_module(disk);
++>>>>>>> 63d9932caece (block: move bdput() to the callers of __blkdev_get)
  }
  EXPORT_SYMBOL(blkdev_put);
  
* Unmerged path fs/block_dev.c
