nvme-multipath: set nr_zones for zoned namespaces

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-310.el8
commit-author Keith Busch <kbusch@kernel.org>
commit 73a1a2298f3e9df24cea7a9aab412ba9470f6159
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-310.el8/73a1a229.failed

The bio based drivers only require the request_queue's nr_zones is set,
so set this field in the head if the namespace path is zoned.

Fixes: 240e6ee272c07 ("nvme: support for zoned namespaces")
	Reported-by: Minwoo Im <minwoo.im.dev@gmail.com>
	Cc: Damien Le Moal <damien.lemoal@wdc.com>
	Signed-off-by: Keith Busch <kbusch@kernel.org>
	Signed-off-by: Christoph Hellwig <hch@lst.de>
(cherry picked from commit 73a1a2298f3e9df24cea7a9aab412ba9470f6159)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/nvme/host/multipath.c
diff --cc drivers/nvme/host/multipath.c
index 9cfeb87bbef9,0696319adaf6..000000000000
--- a/drivers/nvme/host/multipath.c
+++ b/drivers/nvme/host/multipath.c
@@@ -690,13 -674,13 +690,23 @@@ void nvme_mpath_add_disk(struct nvme_n
  		nvme_mpath_set_live(ns);
  	}
  
++<<<<<<< HEAD
 +	if (bdi_cap_stable_pages_required(ns->queue->backing_dev_info)) {
 +		struct gendisk *disk = ns->head->disk;
 +
 +		if (disk)
 +			disk->queue->backing_dev_info->capabilities |=
 +					BDI_CAP_STABLE_WRITES;
 +	}
++=======
+ 	if (blk_queue_stable_writes(ns->queue) && ns->head->disk)
+ 		blk_queue_flag_set(QUEUE_FLAG_STABLE_WRITES,
+ 				   ns->head->disk->queue);
+ #ifdef CONFIG_BLK_DEV_ZONED
+ 	if (blk_queue_is_zoned(ns->queue) && ns->head->disk)
+ 		ns->head->disk->queue->nr_zones = ns->queue->nr_zones;
+ #endif
++>>>>>>> 73a1a2298f3e (nvme-multipath: set nr_zones for zoned namespaces)
  }
  
  void nvme_mpath_remove_disk(struct nvme_ns_head *head)
* Unmerged path drivers/nvme/host/multipath.c
