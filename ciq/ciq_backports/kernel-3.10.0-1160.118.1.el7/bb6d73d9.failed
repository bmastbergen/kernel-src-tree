RDMA/irdma: Prevent zero-length STAG registration

jira LE-1907
cve CVE-2023-25775
Rebuild_History Non-Buildable kernel-3.10.0-1160.118.1.el7
Rebuild_CHGLOG: - RDMA/i40iw: Prevent zero-length STAG registration (Kamal Heib) [RHEL-6299] {CVE-2023-25775}
Rebuild_FUZZ: 91.84%
commit-author Christopher Bednarz <christopher.n.bednarz@intel.com>
commit bb6d73d9add68ad270888db327514384dfa44958
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-1160.118.1.el7/bb6d73d9.failed

Currently irdma allows zero-length STAGs to be programmed in HW during
the kernel mode fast register flow. Zero-length MR or STAG registration
disable HW memory length checks.

Improve gaps in bounds checking in irdma by preventing zero-length STAG or
MR registrations except if the IB_PD_UNSAFE_GLOBAL_RKEY is set.

This addresses the disclosure CVE-2023-25775.

Fixes: b48c24c2d710 ("RDMA/irdma: Implement device supported verb APIs")
	Signed-off-by: Christopher Bednarz <christopher.n.bednarz@intel.com>
	Signed-off-by: Shiraz Saleem <shiraz.saleem@intel.com>
Link: https://lore.kernel.org/r/20230818144838.1758-1-shiraz.saleem@intel.com
	Signed-off-by: Leon Romanovsky <leon@kernel.org>
(cherry picked from commit bb6d73d9add68ad270888db327514384dfa44958)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/infiniband/hw/irdma/ctrl.c
#	drivers/infiniband/hw/irdma/type.h
#	drivers/infiniband/hw/irdma/verbs.c
* Unmerged path drivers/infiniband/hw/irdma/ctrl.c
* Unmerged path drivers/infiniband/hw/irdma/type.h
* Unmerged path drivers/infiniband/hw/irdma/verbs.c
* Unmerged path drivers/infiniband/hw/irdma/ctrl.c
* Unmerged path drivers/infiniband/hw/irdma/type.h
* Unmerged path drivers/infiniband/hw/irdma/verbs.c
