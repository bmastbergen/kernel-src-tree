md: revert io stats accounting

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-365.el8
commit-author Guoqing Jiang <jgq516@gmail.com>
commit ad3fc798800fb7ca04c1dfc439dba946818048d8
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-365.el8/ad3fc798.failed

The commit 41d2d848e5c0 ("md: improve io stats accounting") could cause
double fault problem per the report [1], and also it is not correct to
change ->bi_end_io if md don't own it, so let's revert it.

And io stats accounting will be replemented in later commits.

[1]. https://lore.kernel.org/linux-raid/3bf04253-3fad-434a-63a7-20214e38cf26@gmail.com/T/#t

Fixes: 41d2d848e5c0 ("md: improve io stats accounting")
	Signed-off-by: Guoqing Jiang <jiangguoqing@kylinos.cn>
	Signed-off-by: Song Liu <song@kernel.org>
(cherry picked from commit ad3fc798800fb7ca04c1dfc439dba946818048d8)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/md/md.c
diff --cc drivers/md/md.c
index 20d98e2f9902,7ba00e4c862d..000000000000
--- a/drivers/md/md.c
+++ b/drivers/md/md.c
@@@ -453,12 -441,10 +453,16 @@@ check_suspended
  }
  EXPORT_SYMBOL(md_handle_request);
  
++<<<<<<< HEAD
 +static blk_qc_t md_make_request(struct request_queue *q, struct bio *bio)
++=======
+ static blk_qc_t md_submit_bio(struct bio *bio)
++>>>>>>> ad3fc798800f (md: revert io stats accounting)
  {
  	const int rw = bio_data_dir(bio);
 -	struct mddev *mddev = bio->bi_bdev->bd_disk->private_data;
 +	const int sgrp = op_stat_group(bio_op(bio));
 +	struct mddev *mddev = bio->bi_disk->private_data;
 +	unsigned int sectors;
  
  	if (mddev == NULL || mddev->pers == NULL) {
  		bio_io_error(bio);
@@@ -479,11 -465,6 +483,14 @@@
  		return BLK_QC_T_NONE;
  	}
  
++<<<<<<< HEAD
 +	/*
 +	 * save the sectors now since our bio can
 +	 * go away inside make_request
 +	 */
 +	sectors = bio_sectors(bio);
++=======
++>>>>>>> ad3fc798800f (md: revert io stats accounting)
  	/* bio could be mergeable after passing to underlayer */
  	bio->bi_opf &= ~REQ_NOMERGE;
  
* Unmerged path drivers/md/md.c
