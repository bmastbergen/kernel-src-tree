swiotlb-xen: drop DEFAULT_NSLABS

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-365.el8
commit-author Jan Beulich <jbeulich@suse.com>
commit d859ed25b24289c87a97889653596f8088367e16
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-365.el8/d859ed25.failed

It was introduced by 4035b43da6da ("xen-swiotlb: remove xen_set_nslabs")
and then not removed by 2d29960af0be ("swiotlb: dynamically allocate
io_tlb_default_mem").

	Signed-off-by: Jan Beulich <jbeulich@suse.com>
	Reviewed-by: Christoph Hellwig <hch@lst.de>

Link: https://lore.kernel.org/r/15259326-209a-1d11-338c-5018dc38abe8@suse.com
	Signed-off-by: Juergen Gross <jgross@suse.com>
(cherry picked from commit d859ed25b24289c87a97889653596f8088367e16)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/xen/swiotlb-xen.c
diff --cc drivers/xen/swiotlb-xen.c
index 8ccd85660984,9c9ba500ef23..000000000000
--- a/drivers/xen/swiotlb-xen.c
+++ b/drivers/xen/swiotlb-xen.c
@@@ -163,22 -152,22 +163,26 @@@ static const char *xen_swiotlb_error(en
  	return "";
  }
  
++<<<<<<< HEAD
 +#define DEFAULT_NSLABS		ALIGN(SZ_64M >> IO_TLB_SHIFT, IO_TLB_SEGSIZE)
 +
 +int __ref xen_swiotlb_init(int verbose, bool early)
++=======
+ int xen_swiotlb_init(void)
++>>>>>>> d859ed25b242 (swiotlb-xen: drop DEFAULT_NSLABS)
  {
 -	enum xen_swiotlb_err m_ret = XEN_SWIOTLB_UNKNOWN;
 -	unsigned long bytes = swiotlb_size_or_default();
 -	unsigned long nslabs = bytes >> IO_TLB_SHIFT;
 -	unsigned int order, repeat = 3;
 +	unsigned long bytes, order;
  	int rc = -ENOMEM;
 +	enum xen_swiotlb_err m_ret = XEN_SWIOTLB_UNKNOWN;
 +	unsigned int repeat = 3;
  	char *start;
 +	unsigned long nslabs;
  
 -	if (io_tlb_default_mem != NULL) {
 -		pr_warn("swiotlb buffer already initialized\n");
 -		return -EEXIST;
 -	}
 -
 +	nslabs = swiotlb_nr_tbl();
  retry:
 -	m_ret = XEN_SWIOTLB_ENOMEM;
 +	if (!nslabs)
 +		nslabs = DEFAULT_NSLABS;
 +	bytes = nslabs << IO_TLB_SHIFT;
  	order = get_order(bytes);
  
  	/*
* Unmerged path drivers/xen/swiotlb-xen.c
