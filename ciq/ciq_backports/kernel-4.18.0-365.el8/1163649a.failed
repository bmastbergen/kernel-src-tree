drm/i915/display/adlp: Optimize PSR2 power-savings in corner cases

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-365.el8
commit-author José Roberto de Souza <jose.souza@intel.com>
commit 1163649a047995c77527023f192d00ae1971965b
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-365.el8/1163649a.failed

The Wa_14014971508 is required to fix scanout when a feature that i915
do not support is enabled and this feature is not planned to be enabled
for adlp.

Keeping this workaround enabled can badly hurt power-savings when
a full frame fetch is required(see psr2_sel_fetch_plane_state_supported()
and psr2_sel_fetch_pipe_state_supported()).

Here a example that could badly hurt power-savings, userspace does
a page flip to a rotated plane, so CONTINUOS_FULL_FRAME set.
But then for a whole 30 seconds nothing in the screen requires updates
but because CONTINUOS_FULL_FRAME is set, it will not go into DC5/DC6.

Reverting Wa_14014971508 fixes that, as only a single frame will be
sent and then display can go to DC5/DC6 for those 30 seconds of
idleness.

BSpec: 54369
	Cc: Gwan-gyeong Mun <gwan-gyeong.mun@intel.com>
	Signed-off-by: José Roberto de Souza <jose.souza@intel.com>
	Reviewed-by: Gwan-gyeong Mun <gwan-gyeong.mun@intel.com>
Link: https://patchwork.freedesktop.org/patch/msgid/20210930001409.254817-6-jose.souza@intel.com
(cherry picked from commit 1163649a047995c77527023f192d00ae1971965b)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/i915/display/intel_psr.c
diff --cc drivers/gpu/drm/i915/display/intel_psr.c
index 2c6c4a4f9477,05b9b103a98f..000000000000
--- a/drivers/gpu/drm/i915/display/intel_psr.c
+++ b/drivers/gpu/drm/i915/display/intel_psr.c
@@@ -1277,7 -1500,13 +1277,15 @@@ static void psr2_man_trk_ctl_calc(struc
  	u32 val = PSR2_MAN_TRK_CTL_ENABLE;
  
  	if (full_update) {
++<<<<<<< HEAD
 +		val |= PSR2_MAN_TRK_CTL_SF_SINGLE_FULL_FRAME;
++=======
+ 		/*
+ 		 * Not applying Wa_14014971508:adlp as we do not support the
+ 		 * feature that requires this workaround.
+ 		 */
+ 		val |= man_trk_ctl_single_full_frame_bit_get(dev_priv);
++>>>>>>> 1163649a0479 (drm/i915/display/adlp: Optimize PSR2 power-savings in corner cases)
  		goto exit;
  	}
  
* Unmerged path drivers/gpu/drm/i915/display/intel_psr.c
