ALSA: hda - Reduce ifdef CONFIG_SND_HDA_I915

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [alsa] hda - Reduce ifdef CONFIG_SND_HDA_I915 (Jaroslav Kysela) [1197064]
Rebuild_FUZZ: 92.68%
commit-author Takashi Iwai <tiwai@suse.de>
commit 31c648e0d304bbfc49a4a22c6139718367f3fd8d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/31c648e0.failed

We're providing dummy functions for CONFIG_SND_HDA_i915=n, thus ifdef
can be reduced.  (But hda_i915_init() has to be fixed to return zero.)

This automatically fixes a compile warning:
  sound/pci/hda/hda_intel.c: In function 'azx_probe_continue':
  sound/pci/hda/hda_intel.c:1966:1: warning: label 'i915_power_fail' defined but not used [-Wunused-label]

	Reported-by: kbuild test robot <fengguang.wu@intel.com>
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit 31c648e0d304bbfc49a4a22c6139718367f3fd8d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/pci/hda/hda_intel.c
diff --cc sound/pci/hda/hda_intel.c
index 1b8eb97f0430,f7cdf4d2e24e..000000000000
--- a/sound/pci/hda/hda_intel.c
+++ b/sound/pci/hda/hda_intel.c
@@@ -1875,19 -1892,28 +1875,25 @@@ static int azx_probe_continue(struct az
  	int dev = chip->dev_index;
  	int err;
  
 -	hda->probe_continued = 1;
 -
 -	/* Request display power well for the HDA controller or codec. For
 -	 * Haswell/Broadwell, both the display HDA controller and codec need
 -	 * this power. For other platforms, like Baytrail/Braswell, only the
 -	 * display codec needs the power and it can be released after probe.
 -	 */
 +	/* Request power well for Haswell HDA controller and codec */
  	if (chip->driver_caps & AZX_DCAPS_I915_POWERWELL) {
++<<<<<<< HEAD
 +#ifdef CONFIG_SND_HDA_I915
++=======
+ 		/* Baytral/Braswell controllers don't need this power */
+ 		if (pci->device != 0x0f04 && pci->device != 0x2284)
+ 			hda->need_i915_power = 1;
+ 
++>>>>>>> 31c648e0d304 (ALSA: hda - Reduce ifdef CONFIG_SND_HDA_I915)
  		err = hda_i915_init(hda);
  		if (err < 0)
 -			goto i915_power_fail;
 -
 +			goto out_free;
  		err = hda_display_power(hda, true);
  		if (err < 0) {
  			dev_err(chip->card->dev,
  				"Cannot turn on display power on i915\n");
 -			goto i915_power_fail;
 +			goto out_free;
  		}
- #endif
  	}
  
  	err = azx_first_init(chip);
* Unmerged path sound/pci/hda/hda_intel.c
diff --git a/sound/pci/hda/hda_intel.h b/sound/pci/hda/hda_intel.h
index 46e5bfd13eec..2bc2c758492c 100644
--- a/sound/pci/hda/hda_intel.h
+++ b/sound/pci/hda/hda_intel.h
@@ -61,7 +61,7 @@ static inline int hda_display_power(struct hda_intel *hda, bool enable)
 static inline void haswell_set_bclk(struct hda_intel *hda) { return; }
 static inline int hda_i915_init(struct hda_intel *hda)
 {
-	return -ENODEV;
+	return 0;
 }
 static inline int hda_i915_exit(struct hda_intel *hda)
 {
