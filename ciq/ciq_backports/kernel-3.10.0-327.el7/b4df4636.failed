ACPI / video: update the skip case for acpi_video_device_in_dod()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [acpi] video: update the skip case for acpi_video_device_in_dod() (Benjamin Tissoires) [1218354]
Rebuild_FUZZ: 94.31%
commit-author Aaron Lu <aaron.lu@intel.com>
commit b4df463678fb9c6dae9548dbb7545993779fd416
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/b4df4636.failed

If the firmware has declared more than 8 video output devices, and the
one that control the internal panel's backlight is listed after the
first 8 output devices, the _DOD will not include it due to the current
i915 operation region implementation. As a result, we will not create a
backlight device for it while we should. Solve this problem by special
case the firmware that has 8+ output devices in that if we see such a
firmware, we do not test if the device is in _DOD list. The creation of
the backlight device will also enable the firmware to emit events on
backlight hotkey press when the acpi_osi= cmdline option is specified on
those affected ASUS laptops.

Link: https://bugzilla.kernel.org/show_bug.cgi?id=70241
Reported-and-tested-by: Oleksij Rempel <linux@rempel-privat.de>
Reported-and-tested-by: Dmitry Tunin <hanipouspilot@gmail.com>
Reported-and-tested-by: Jimbo <jaime.91@hotmail.es>
	Cc: 3.18+ <stable@vger.kernel.org> # 3.18+
	Signed-off-by: Aaron Lu <aaron.lu@intel.com>
	Acked-by: Jani Nikula <jani.nikula@intel.com>
	Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
(cherry picked from commit b4df463678fb9c6dae9548dbb7545993779fd416)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/acpi/video.c
diff --cc drivers/acpi/video.c
index 3fbd8b48e19e,1eaadff2e198..000000000000
--- a/drivers/acpi/video.c
+++ b/drivers/acpi/video.c
@@@ -1265,6 -1155,28 +1266,31 @@@ acpi_video_device_bind(struct acpi_vide
  	}
  }
  
++<<<<<<< HEAD
++=======
+ static bool acpi_video_device_in_dod(struct acpi_video_device *device)
+ {
+ 	struct acpi_video_bus *video = device->video;
+ 	int i;
+ 
+ 	/*
+ 	 * If we have a broken _DOD or we have more than 8 output devices
+ 	 * under the graphics controller node that we can't proper deal with
+ 	 * in the operation region code currently, no need to test.
+ 	 */
+ 	if (!video->attached_count || video->child_count > 8)
+ 		return true;
+ 
+ 	for (i = 0; i < video->attached_count; i++) {
+ 		if ((video->attached_array[i].value.int_val & 0xfff) ==
+ 		    (device->device_id & 0xfff))
+ 			return true;
+ 	}
+ 
+ 	return false;
+ }
+ 
++>>>>>>> b4df463678fb (ACPI / video: update the skip case for acpi_video_device_in_dod())
  /*
   *  Arg:
   *	video	: video bus device
* Unmerged path drivers/acpi/video.c
