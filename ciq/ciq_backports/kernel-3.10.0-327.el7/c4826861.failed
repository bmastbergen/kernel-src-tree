bonding: drop read_lock in bond_compute_features

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author nikolay@redhat.com <nikolay@redhat.com>
commit c48268611a3df84a9250d2fc34ad671cdae43440
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/c4826861.failed

bond_compute_features is always called with RTNL held, so we can safely
drop the read bond->lock.

	Signed-off-by: Nikolay Aleksandrov <nikolay@redhat.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit c48268611a3df84a9250d2fc34ad671cdae43440)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/bonding/bond_main.c
diff --cc drivers/net/bonding/bond_main.c
index 0def7e7abf50,39e5b1c7ffe2..000000000000
--- a/drivers/net/bonding/bond_main.c
+++ b/drivers/net/bonding/bond_main.c
@@@ -1346,16 -1120,14 +1345,21 @@@ static void bond_compute_features(struc
  	netdev_features_t vlan_features = BOND_VLAN_FEATURES;
  	unsigned short max_hard_header_len = ETH_HLEN;
  	unsigned int gso_max_size = GSO_MAX_SIZE;
+ 	struct net_device *bond_dev = bond->dev;
  	u16 gso_max_segs = GSO_MAX_SEGS;
++<<<<<<< HEAD
 +	int i;
 +	unsigned int flags, dst_release_flag = IFF_XMIT_DST_RELEASE;
 +
 +	read_lock(&bond->lock);
++=======
+ 	struct slave *slave;
++>>>>>>> c48268611a3d (bonding: drop read_lock in bond_compute_features)
  
 -	if (list_empty(&bond->slave_list))
 +	if (!bond->first_slave)
  		goto done;
  
 -	bond_for_each_slave(bond, slave) {
 +	bond_for_each_slave(bond, slave, i) {
  		vlan_features = netdev_increment_features(vlan_features,
  			slave->dev->vlan_features, BOND_VLAN_FEATURES);
  
* Unmerged path drivers/net/bonding/bond_main.c
