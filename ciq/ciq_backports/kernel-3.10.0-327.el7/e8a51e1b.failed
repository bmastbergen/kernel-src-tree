device: Add dev_of_node() accessor

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author Benjamin Herrenschmidt <benh@kernel.crashing.org>
commit e8a51e1b51ee5730ad3913f3962e3099a5e19359
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/e8a51e1b.failed

Suggested by Arnd Bergmann, this gives a practical accessor for
the of_node field of struct device while instructing the compiler
that it will be NULL if CONFIG_OF is not set.

	Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
	Acked-by: Rob Herring <robh@kernel.org>
	Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
(cherry picked from commit e8a51e1b51ee5730ad3913f3962e3099a5e19359)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/linux/device.h
diff --cc include/linux/device.h
index 0e7d3b49bbdd,f3f2c7e38060..000000000000
--- a/include/linux/device.h
+++ b/include/linux/device.h
@@@ -916,6 -911,18 +916,21 @@@ static inline void device_unlock(struc
  	mutex_unlock(&dev->mutex);
  }
  
++<<<<<<< HEAD
++=======
+ static inline void device_lock_assert(struct device *dev)
+ {
+ 	lockdep_assert_held(&dev->mutex);
+ }
+ 
+ static inline struct device_node *dev_of_node(struct device *dev)
+ {
+ 	if (!IS_ENABLED(CONFIG_OF))
+ 		return NULL;
+ 	return dev->of_node;
+ }
+ 
++>>>>>>> e8a51e1b51ee (device: Add dev_of_node() accessor)
  void driver_init(void);
  
  /*
* Unmerged path include/linux/device.h
