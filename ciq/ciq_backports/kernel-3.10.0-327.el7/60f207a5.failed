drm/atomic: fix out of bounds read in for_each_*_in_state helpers

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [drm] atomic: fix out of bounds read in for_each_*_in_state helpers (Rob Clark) [1249805]
Rebuild_FUZZ: 96.83%
commit-author Andrey Ryabinin <a.ryabinin@samsung.com>
commit 60f207a5b6d8f23c2e8388b415e8d5c7311cc79d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/60f207a5.failed

for_each_*_in_state validate array index after
access to array elements, thus perform out of bounds read.

Fix this by validating index in the first place and read
array element iff validation was successful.

Fixes: df63b9994eaf ("drm/atomic: Add for_each_{connector,crtc,plane}_in_state helper macros")
	Signed-off-by: Andrey Ryabinin <a.ryabinin@samsung.com>
	Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
(cherry picked from commit 60f207a5b6d8f23c2e8388b415e8d5c7311cc79d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	include/drm/drm_atomic.h
* Unmerged path include/drm/drm_atomic.h
* Unmerged path include/drm/drm_atomic.h
