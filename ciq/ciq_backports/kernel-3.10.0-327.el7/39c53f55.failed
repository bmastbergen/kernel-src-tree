hpsa: propagate the error code in hpsa_kdump_soft_reset

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author Robert Elliott <elliott@hp.com>
commit 39c53f55a950027fe8e94d56541e21f1a921f7ce
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/39c53f55.failed

If hpsa_wait_for_board_state fails, hpsa_kdump_soft_reset
should propagate its return value (e.g., -ENODEV) rather
than just returning -1.

	Reviewed-by: Scott Teel <scott.teel@pmcs.com>
	Reviewed-by: Kevin Barnett <kevin.barnett@pmcs.com>
	Reviewed-by: Hannes Reinecke <hare@Suse.de>
	Signed-off-by: Robert Elliott <elliott@hp.com>
	Signed-off-by: Don Brace <don.brace@pmcs.com>
	Reviewed-by: Christoph Hellwig <hch@lst.de>
	Signed-off-by: James Bottomley <JBottomley@Odin.com>
(cherry picked from commit 39c53f55a950027fe8e94d56541e21f1a921f7ce)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/hpsa.c
diff --cc drivers/scsi/hpsa.c
index 86152e9b07dd,7adbe42581ee..000000000000
--- a/drivers/scsi/hpsa.c
+++ b/drivers/scsi/hpsa.c
@@@ -6468,16 -7438,14 +6468,22 @@@ static int hpsa_request_irqs(struct ctl
  
  static int hpsa_kdump_soft_reset(struct ctlr_info *h)
  {
++<<<<<<< HEAD
 +	if (hpsa_send_host_reset(h, RAID_CTLR_LUNID,
 +		HPSA_RESET_TYPE_CONTROLLER)) {
 +		dev_warn(&h->pdev->dev, "Resetting array controller failed.\n");
 +		return -EIO;
 +	}
++=======
+ 	int rc;
+ 	hpsa_send_host_reset(h, RAID_CTLR_LUNID, HPSA_RESET_TYPE_CONTROLLER);
++>>>>>>> 39c53f55a950 (hpsa: propagate the error code in hpsa_kdump_soft_reset)
  
  	dev_info(&h->pdev->dev, "Waiting for board to soft reset.\n");
- 	if (hpsa_wait_for_board_state(h->pdev, h->vaddr, BOARD_NOT_READY)) {
+ 	rc = hpsa_wait_for_board_state(h->pdev, h->vaddr, BOARD_NOT_READY);
+ 	if (rc) {
  		dev_warn(&h->pdev->dev, "Soft reset had no effect.\n");
- 		return -1;
+ 		return rc;
  	}
  
  	dev_info(&h->pdev->dev, "Board reset, awaiting READY status.\n");
* Unmerged path drivers/scsi/hpsa.c
