vxlan: Fix bug introduced by commit acbf74a76300

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author Andy Zhou <azhou@nicira.com>
commit 3c4d1daecef875d28bdbe93587908c897c29ba71
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/3c4d1dae.failed

Commit acbf74a76300 ("vxlan: Refactor vxlan driver to make use of the common UDP tunnel functions." introduced a bug in vxlan_xmit_one()
function, causing it to transmit Vxlan packets without proper
Vxlan header inserted. The change was not needed in the first
place. Revert it.

	Reported-by: Tom Herbert <therbert@google.com>
	Cc: Eric Dumazet <eric.dumazet@gmail.com>
	Signed-off-by: Andy Zhou <azhou@nicira.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 3c4d1daecef875d28bdbe93587908c897c29ba71)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/vxlan.c
diff --cc drivers/net/vxlan.c
index 82f83662a0c5,34e102ec95c2..000000000000
--- a/drivers/net/vxlan.c
+++ b/drivers/net/vxlan.c
@@@ -1828,10 -1778,11 +1828,18 @@@ static void vxlan_xmit_one(struct sk_bu
  		tos = ip_tunnel_ecn_encap(tos, old_iph, skb);
  		ttl = ttl ? : ip4_dst_hoplimit(&rt->dst);
  
++<<<<<<< HEAD
 +		err = vxlan_xmit_skb(dev_net(dev), vxlan->vn_sock, rt, skb,
 +				     fl4.saddr, dst->sin.sin_addr.s_addr,
 +				     tos, ttl, df, src_port, dst_port,
 +				     htonl(vni << 8));
++=======
+ 		err = vxlan_xmit_skb(vxlan->vn_sock, rt, skb,
+ 				     fl4.saddr, dst->sin.sin_addr.s_addr,
+ 				     tos, ttl, df, src_port, dst_port,
+ 				     htonl(vni << 8),
+ 				     !net_eq(vxlan->net, dev_net(vxlan->dev)));
++>>>>>>> 3c4d1daecef8 (vxlan: Fix bug introduced by commit acbf74a76300)
  
  		if (err < 0)
  			goto rt_tx_error;
* Unmerged path drivers/net/vxlan.c
