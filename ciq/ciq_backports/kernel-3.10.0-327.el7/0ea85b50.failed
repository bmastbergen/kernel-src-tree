qla2xxx: Use dma_zalloc_coherent

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author Joe Perches <joe@perches.com>
commit 0ea85b50f8e25649fa711be560b282263d3e756c
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/0ea85b50.failed

Use the zeroing function instead of dma_alloc_coherent & memset(,0,)

	Signed-off-by: Joe Perches <joe@perches.com>
	Acked-by: Saurav Kashyap <saurav.kashyap@qlogic.com>
	Signed-off-by: Christoph Hellwig <hch@lst.de>
(cherry picked from commit 0ea85b50f8e25649fa711be560b282263d3e756c)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/qla2xxx/qla_init.c
diff --cc drivers/scsi/qla2xxx/qla_init.c
index 151194d68090,46990f4ceb40..000000000000
--- a/drivers/scsi/qla2xxx/qla_init.c
+++ b/drivers/scsi/qla2xxx/qla_init.c
@@@ -1510,11 -1516,18 +1510,22 @@@ qla2x00_alloc_fw_dump(scsi_qla_host_t *
  		if (ha->tgt.atio_ring)
  			mq_size += ha->tgt.atio_q_length * sizeof(request_t);
  		/* Allocate memory for Fibre Channel Event Buffer. */
 -		if (!IS_QLA25XX(ha) && !IS_QLA81XX(ha) && !IS_QLA83XX(ha) &&
 -		    !IS_QLA27XX(ha))
 +		if (!IS_QLA25XX(ha) && !IS_QLA81XX(ha) && !IS_QLA83XX(ha))
  			goto try_eft;
  
++<<<<<<< HEAD
 +		tc = dma_alloc_coherent(&ha->pdev->dev, FCE_SIZE, &tc_dma,
 +		    GFP_KERNEL);
++=======
+ try_fce:
+ 		if (ha->fce)
+ 			dma_free_coherent(&ha->pdev->dev,
+ 			    FCE_SIZE, ha->fce, ha->fce_dma);
+ 
+ 		/* Allocate memory for Fibre Channel Event Buffer. */
+ 		tc = dma_zalloc_coherent(&ha->pdev->dev, FCE_SIZE, &tc_dma,
+ 					 GFP_KERNEL);
++>>>>>>> 0ea85b50f8e2 (qla2xxx: Use dma_zalloc_coherent)
  		if (!tc) {
  			ql_log(ql_log_warn, vha, 0x00be,
  			    "Unable to allocate (%d KB) for FCE.\n",
@@@ -1540,10 -1552,15 +1550,10 @@@
  		ha->flags.fce_enabled = 1;
  		ha->fce_dma = tc_dma;
  		ha->fce = tc;
 -
  try_eft:
 -		if (ha->eft)
 -			dma_free_coherent(&ha->pdev->dev,
 -			    EFT_SIZE, ha->eft, ha->eft_dma);
 -
  		/* Allocate memory for Extended Trace Buffer. */
- 		tc = dma_alloc_coherent(&ha->pdev->dev, EFT_SIZE, &tc_dma,
- 		    GFP_KERNEL);
+ 		tc = dma_zalloc_coherent(&ha->pdev->dev, EFT_SIZE, &tc_dma,
+ 					 GFP_KERNEL);
  		if (!tc) {
  			ql_log(ql_log_warn, vha, 0x00c1,
  			    "Unable to allocate (%d KB) for EFT.\n",
* Unmerged path drivers/scsi/qla2xxx/qla_init.c
