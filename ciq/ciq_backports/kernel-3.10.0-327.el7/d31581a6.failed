crypto: nx - merge nx-compress and nx-compress-crypto

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [crypto] nx - merge nx-compress and nx-compress-crypto (Gustavo Duarte) [1238571 1245132]
Rebuild_FUZZ: 91.84%
commit-author Dan Streetman <ddstreet@ieee.org>
commit d31581a6e31f1c954704f081376e19c2014c45d3
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/d31581a6.failed

Merge the nx-842.c code into nx-842-crypto.c.

This allows later patches to remove the 'platform' driver, and instead
allow each platform driver to directly register with the crypto
compression api.

	Signed-off-by: Dan Streetman <ddstreet@ieee.org>
	Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
(cherry picked from commit d31581a6e31f1c954704f081376e19c2014c45d3)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/crypto/nx/Kconfig
#	drivers/crypto/nx/Makefile
#	drivers/crypto/nx/nx-842-crypto.c
#	drivers/crypto/nx/nx-842.h
diff --cc drivers/crypto/nx/Kconfig
index f82616621ae1,ad7552a6998c..000000000000
--- a/drivers/crypto/nx/Kconfig
+++ b/drivers/crypto/nx/Kconfig
@@@ -18,9 -13,36 +18,43 @@@ config CRYPTO_DEV_NX_ENCRYP
  
  config CRYPTO_DEV_NX_COMPRESS
  	tristate "Compression acceleration support"
 +	depends on PPC64 && IBMVIO
  	default y
+ 	select CRYPTO_ALGAPI
+ 	select 842_DECOMPRESS
  	help
++<<<<<<< HEAD
 +	  Support for Power7+ in-Nest compression acceleration. This
 +	  module supports acceleration for AES and SHA2 algorithms. If you
 +	  choose 'M' here, this module will be called nx_compress.
++=======
+ 	  Support for PowerPC Nest (NX) compression acceleration. This
+ 	  module supports acceleration for compressing memory with the 842
+ 	  algorithm using the cryptographic API.  One of the platform
+ 	  drivers must be selected also.  If you choose 'M' here, this
+ 	  module will be called nx_compress.
+ 
+ if CRYPTO_DEV_NX_COMPRESS
+ 
+ config CRYPTO_DEV_NX_COMPRESS_PSERIES
+ 	tristate "Compression acceleration support on pSeries platform"
+ 	depends on PPC_PSERIES && IBMVIO
+ 	default y
+ 	help
+ 	  Support for PowerPC Nest (NX) compression acceleration. This
+ 	  module supports acceleration for compressing memory with the 842
+ 	  algorithm.  This supports NX hardware on the pSeries platform.
+ 	  If you choose 'M' here, this module will be called nx_compress_pseries.
+ 
+ config CRYPTO_DEV_NX_COMPRESS_POWERNV
+ 	tristate "Compression acceleration support on PowerNV platform"
+ 	depends on PPC_POWERNV
+ 	default y
+ 	help
+ 	  Support for PowerPC Nest (NX) compression acceleration. This
+ 	  module supports acceleration for compressing memory with the 842
+ 	  algorithm.  This supports NX hardware on the PowerNV platform.
+ 	  If you choose 'M' here, this module will be called nx_compress_powernv.
+ 
+ endif
++>>>>>>> d31581a6e31f (crypto: nx - merge nx-compress and nx-compress-crypto)
diff --cc drivers/crypto/nx/Makefile
index 8669ffa8dc5c,e29ee85b2431..000000000000
--- a/drivers/crypto/nx/Makefile
+++ b/drivers/crypto/nx/Makefile
@@@ -10,5 -10,10 +10,15 @@@ nx-crypto-objs := nx.o 
  		  nx-sha256.o \
  		  nx-sha512.o
  
++<<<<<<< HEAD
 +obj-$(CONFIG_CRYPTO_DEV_NX_COMPRESS) += nx-compress.o
 +nx-compress-objs := nx-842-pseries.o
++=======
+ obj-$(CONFIG_CRYPTO_DEV_NX_COMPRESS) += nx-compress.o nx-compress-platform.o
+ obj-$(CONFIG_CRYPTO_DEV_NX_COMPRESS_PSERIES) += nx-compress-pseries.o
+ obj-$(CONFIG_CRYPTO_DEV_NX_COMPRESS_POWERNV) += nx-compress-powernv.o
+ nx-compress-objs := nx-842-crypto.o
+ nx-compress-platform-objs := nx-842-platform.o
+ nx-compress-pseries-objs := nx-842-pseries.o
+ nx-compress-powernv-objs := nx-842-powernv.o
++>>>>>>> d31581a6e31f (crypto: nx - merge nx-compress and nx-compress-crypto)
* Unmerged path drivers/crypto/nx/nx-842-crypto.c
* Unmerged path drivers/crypto/nx/nx-842.h
* Unmerged path drivers/crypto/nx/Kconfig
* Unmerged path drivers/crypto/nx/Makefile
* Unmerged path drivers/crypto/nx/nx-842-crypto.c
* Unmerged path drivers/crypto/nx/nx-842.h
