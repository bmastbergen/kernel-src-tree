bonding: correctly verify for the first slave in bond_enslave

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author Veaceslav Falico <vfalico@redhat.com>
commit 23c147e026bbb41dd26a2bda0404a95ea951072f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/23c147e0.failed

After commit 1f718f0f4f97145f4072d2d72dcf85069ca7226d ("bonding: populate
neighbour's private on enslave"), we've moved the actual 'linking' in the
end of the function - so that, once linked, the slave is ready to be used,
and is not still in the process of enslaving.

However, 802.3ad verified if it's the first slave by looking at the

if (bond_first_slave(bond) == new_slave)

which, because we've moved the linking to the end, became broken - on the
first slave bond_first_slave(bond) returns NULL.

Fix this by verifying if the prev_slave, that equals bond_last_slave(), is
actually populated - if it is - then it's not the first slave, and vice
versa.

CC: Jay Vosburgh <fubar@us.ibm.com>
CC: Andy Gospodarek <andy@greyhouse.net>
	Signed-off-by: Veaceslav Falico <vfalico@redhat.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 23c147e026bbb41dd26a2bda0404a95ea951072f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/bonding/bond_main.c
diff --cc drivers/net/bonding/bond_main.c
index 05a57077bb1c,0367f8095390..000000000000
--- a/drivers/net/bonding/bond_main.c
+++ b/drivers/net/bonding/bond_main.c
@@@ -1789,7 -1557,7 +1789,11 @@@ int bond_enslave(struct net_device *bon
  		 */
  		bond_set_slave_inactive_flags(new_slave);
  		/* if this is the first slave */
++<<<<<<< HEAD
 +		if (bond->slave_cnt == 1) {
++=======
+ 		if (!prev_slave) {
++>>>>>>> 23c147e026bb (bonding: correctly verify for the first slave in bond_enslave)
  			SLAVE_AD_INFO(new_slave).id = 1;
  			/* Initialize AD with the number of times that the AD timer is called in 1 second
  			 * can be called only after the mac address of the bond is set
* Unmerged path drivers/net/bonding/bond_main.c
