i40e: init NVM update state on adminq init

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author Shannon Nelson <shannon.nelson@intel.com>
commit 0f52958b2cbdb45ec9993cb4a40fb9e02dfbd2f1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/0f52958b.failed

The adminq init is run after the EMPR that is triggered by the
NVM update.  The final write command will cause the reset and
will want to wait for the ARQ event that signals the end of the
update, but the reset precludes the event being sent.  The state
is probably already at INIT, but we set it so here anyway, and
clear the release_on_done flag as well.

Change-ID: Ie9d724a39e71f988741abc3d51b4cb198c7e0272
	Signed-off-by: Shannon Nelson <shannon.nelson@intel.com>
	Acked-by: Michal Kosiarz <michal.kosiarz@intel.com>
	Acked-by: Kamil Krawczyk <kamil.krawczyk@intel.com>
	Tested-by: Jim Young <jamesx.m.young@intel.com>
	Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
(cherry picked from commit 0f52958b2cbdb45ec9993cb4a40fb9e02dfbd2f1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/i40e/i40e_adminq.c
diff --cc drivers/net/ethernet/intel/i40e/i40e_adminq.c
index 72f5d25a222f,77f6254a89ac..000000000000
--- a/drivers/net/ethernet/intel/i40e/i40e_adminq.c
+++ b/drivers/net/ethernet/intel/i40e/i40e_adminq.c
@@@ -617,7 -617,8 +617,12 @@@ i40e_status i40e_init_adminq(struct i40
  
  	/* pre-emptive resource lock release */
  	i40e_aq_release_resource(hw, I40E_NVM_RESOURCE_ID, 0, NULL);
++<<<<<<< HEAD
 +	hw->aq.nvm_busy = false;
++=======
+ 	hw->aq.nvm_release_on_done = false;
+ 	hw->nvmupd_state = I40E_NVMUPD_STATE_INIT;
++>>>>>>> 0f52958b2cbd (i40e: init NVM update state on adminq init)
  
  	ret_code = i40e_aq_set_hmc_resource_profile(hw,
  						    I40E_HMC_PROFILE_DEFAULT,
* Unmerged path drivers/net/ethernet/intel/i40e/i40e_adminq.c
