udpv6: Add lockless sendmsg() support

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author Vlad Yasevich <vyasevich@gmail.com>
commit 03485f2adcde0c2d4e9228b659be78e872486bbb
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/03485f2a.failed

This commit adds the same functionaliy to IPv6 that
commit 903ab86d195cca295379699299c5fc10beba31c7
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Tue Mar 1 02:36:48 2011 +0000

    udp: Add lockless transmit path

added to IPv4.

UDP transmit path can now run without a socket lock,
thus allowing multiple threads to send to a single socket
more efficiently.
This is only used when corking/MSG_MORE is not used.

	Signed-off-by: Vladislav Yasevich <vyasevic@redhat.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 03485f2adcde0c2d4e9228b659be78e872486bbb)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ipv6/udp.c
diff --cc net/ipv6/udp.c
index 2e50fde0d0ea,d048d46779fc..000000000000
--- a/net/ipv6/udp.c
+++ b/net/ipv6/udp.c
@@@ -1279,10 -1339,9 +1294,14 @@@ do_append_data
  	if (dontfrag < 0)
  		dontfrag = np->dontfrag;
  	up->len += ulen;
++<<<<<<< HEAD
 +	getfrag  =  is_udplite ?  udplite_getfrag : ip_generic_getfrag;
 +	err = ip6_append_data(sk, getfrag, msg->msg_iov, ulen,
++=======
+ 	err = ip6_append_data(sk, getfrag, msg, ulen,
++>>>>>>> 03485f2adcde (udpv6: Add lockless sendmsg() support)
  		sizeof(struct udphdr), hlimit, tclass, opt, &fl6,
 -		(struct rt6_info *)dst,
 +		(struct rt6_info*)dst,
  		corkreq ? msg->msg_flags|MSG_MORE : msg->msg_flags, dontfrag);
  	if (err)
  		udp_v6_flush_pending_frames(sk);
* Unmerged path net/ipv6/udp.c
