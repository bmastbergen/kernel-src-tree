KVM: nVMX: introduce nested_get_vmcs12_pages

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [kvm] nvmx: introduce nested_get_vmcs12_pages (Bandan Das) [1209995]
Rebuild_FUZZ: 93.98%
commit-author Wanpeng Li <wanpeng.li@linux.intel.com>
commit a2bcba5035bb3d7fb3099e1893026316365f4b5d
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/a2bcba50.failed

Introduce function nested_get_vmcs12_pages() to check the valid
of nested apic access page and virtual apic page earlier.

	Signed-off-by: Wanpeng Li <wanpeng.li@linux.intel.com>
	Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
(cherry picked from commit a2bcba5035bb3d7fb3099e1893026316365f4b5d)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kvm/vmx.c
diff --cc arch/x86/kvm/vmx.c
index ccfe5bb586e5,70516e11f051..000000000000
--- a/arch/x86/kvm/vmx.c
+++ b/arch/x86/kvm/vmx.c
@@@ -8339,8 -8302,7 +8353,12 @@@ static int nested_vmx_run(struct kvm_vc
  		return 1;
  	}
  
++<<<<<<< HEAD
 +	if (nested_cpu_has2(vmcs12, SECONDARY_EXEC_VIRTUALIZE_APIC_ACCESSES) &&
 +			!IS_ALIGNED(vmcs12->apic_access_addr, PAGE_SIZE)) {
++=======
+ 	if (!nested_get_vmcs12_pages(vcpu, vmcs12)) {
++>>>>>>> a2bcba5035bb (KVM: nVMX: introduce nested_get_vmcs12_pages)
  		/*TODO: Also verify bits beyond physical address width are 0*/
  		nested_vmx_failValid(vcpu, VMXERR_ENTRY_INVALID_CONTROL_FIELD);
  		return 1;
* Unmerged path arch/x86/kvm/vmx.c
