ACPI / Fan: Use bus id as the name for non PNP0C0B (Fan) devices

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [acpi] fan: Use bus id as the name for non PNP0C0B (Fan) devices (Prarit Bhargava) [1174059]
Rebuild_FUZZ: 94.21%
commit-author Srinivas Pandruvada <srinivas.pandruvada@linux.intel.com>
commit bbb16fef19122ec9f20fb865c45375e12f85d2a1
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/bbb16fef.failed

The _ART (Active Cooling Relationship Table), specifies relationship
among heat generating sources to a target active cooling device like
fan. The _ART table refers to actual bus id name for specifying relationship.
Naming "Fan" is not enough as name in the _ART table can change on every
platform, to establish relationship for user space thermal controllers.

	Signed-off-by: Srinivas Pandruvada <srinivas.pandruvada@linux.intel.com>
	Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
(cherry picked from commit bbb16fef19122ec9f20fb865c45375e12f85d2a1)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/acpi/fan.c
diff --cc drivers/acpi/fan.c
index 14d2c553a114,7a36f02598a6..000000000000
--- a/drivers/acpi/fan.c
+++ b/drivers/acpi/fan.c
@@@ -136,17 -323,36 +136,28 @@@ static int acpi_fan_add(struct acpi_dev
  {
  	int result = 0;
  	struct thermal_cooling_device *cdev;
++<<<<<<< HEAD
++=======
+ 	struct acpi_fan *fan;
+ 	struct acpi_device *device = ACPI_COMPANION(&pdev->dev);
+ 	char *name;
++>>>>>>> bbb16fef1912 (ACPI / Fan: Use bus id as the name for non PNP0C0B (Fan) devices)
  
 -	fan = devm_kzalloc(&pdev->dev, sizeof(*fan), GFP_KERNEL);
 -	if (!fan) {
 -		dev_err(&device->dev, "No memory for fan\n");
 -		return -ENOMEM;
 -	}
 -	device->driver_data = fan;
 -	platform_set_drvdata(pdev, fan);
 -
 -	if (acpi_fan_is_acpi4(device)) {
 -		if (acpi_fan_get_fif(device) || acpi_fan_get_fps(device))
 -			goto end;
 -		fan->acpi4 = true;
 -	} else {
 -		result = acpi_device_update_power(device, NULL);
 -		if (result) {
 -			dev_err(&device->dev, "Setting initial power state\n");
 -			goto end;
 -		}
 +	strcpy(acpi_device_name(device), "Fan");
 +	strcpy(acpi_device_class(device), ACPI_FAN_CLASS);
 +
 +	result = acpi_device_update_power(device, NULL);
 +	if (result) {
 +		printk(KERN_ERR PREFIX "Setting initial power state\n");
 +		goto end;
  	}
  
- 	cdev = thermal_cooling_device_register("Fan", device,
+ 	if (!strncmp(pdev->name, "PNP0C0B", strlen("PNP0C0B")))
+ 		name = "Fan";
+ 	else
+ 		name = acpi_device_bid(device);
+ 
+ 	cdev = thermal_cooling_device_register(name, device,
  						&fan_cooling_ops);
  	if (IS_ERR(cdev)) {
  		result = PTR_ERR(cdev);
* Unmerged path drivers/acpi/fan.c
