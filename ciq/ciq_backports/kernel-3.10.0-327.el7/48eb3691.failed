crypto: qat - Ensure ipad and opad are zeroed

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [crypto] qat - Ensure ipad and opad are zeroed (Nikolay Aleksandrov) [1173791]
Rebuild_FUZZ: 90.24%
commit-author Herbert Xu <herbert@gondor.apana.org.au>
commit 48eb3691e8beab349e3a700d45f070be8d4b88ba
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/48eb3691.failed

The patch ad511e260a27b8e35d273cc0ecfe5a8ff9543181 (crypto: qat -
Fix incorrect uses of memzero_explicit) broke hashing because the
code was in fact overwriting the qat_auth_state variable.

In fact there is no reason for the variable to exist anyway since
all we are using it for is to store ipad and opad.  So we could
simply create ipad and opad directly and avoid this whole mess.

	Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
(cherry picked from commit 48eb3691e8beab349e3a700d45f070be8d4b88ba)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/crypto/qat/qat_common/qat_algs.c
diff --cc drivers/crypto/qat/qat_common/qat_algs.c
index 5d93760fdd84,e2c4b254ac41..000000000000
--- a/drivers/crypto/qat/qat_common/qat_algs.c
+++ b/drivers/crypto/qat/qat_common/qat_algs.c
@@@ -161,7 -172,8 +160,12 @@@ static int qat_alg_do_precomputes(struc
  	__be64 *hash512_state_out;
  	int i, offset;
  
++<<<<<<< HEAD
 +	memset(auth_state.data, '\0', MAX_AUTH_STATE_SIZE + 64);
++=======
+ 	memset(ipad, 0, block_size);
+ 	memset(opad, 0, block_size);
++>>>>>>> 48eb3691e8be (crypto: qat - Ensure ipad and opad are zeroed)
  	shash->tfm = ctx->hash_tfm;
  	shash->flags = 0x0;
  
@@@ -172,10 -183,7 +175,14 @@@
  		if (ret)
  			return ret;
  
++<<<<<<< HEAD
 +		memcpy(ipad, buff, digest_size);
 +		memcpy(opad, buff, digest_size);
 +		memset(ipad + digest_size, 0, block_size - digest_size);
 +		memset(opad + digest_size, 0, block_size - digest_size);
++=======
+ 		memcpy(opad, ipad, digest_size);
++>>>>>>> 48eb3691e8be (crypto: qat - Ensure ipad and opad are zeroed)
  	} else {
  		memcpy(ipad, auth_key, auth_keylen);
  		memcpy(opad, auth_key, auth_keylen);
* Unmerged path drivers/crypto/qat/qat_common/qat_algs.c
