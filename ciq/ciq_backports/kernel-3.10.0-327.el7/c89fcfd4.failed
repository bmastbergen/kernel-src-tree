virtio_net: flush when in xmit_more mode and under descriptor pressure

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author David S. Miller <davem@davemloft.net>
commit c89fcfd42cbcf839b6737c977f280188eeea92d7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/c89fcfd4.failed

Mirror the changes made to ixgbe in commit 2367a17390138f68b3aa28f2f220b8d7ff8d91f4
("ixgbe: flush when in xmit_more mode and under descriptor pressure")

	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit c89fcfd42cbcf839b6737c977f280188eeea92d7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/virtio_net.c
diff --cc drivers/net/virtio_net.c
index 5b00d5c57f29,9359a13d285a..000000000000
--- a/drivers/net/virtio_net.c
+++ b/drivers/net/virtio_net.c
@@@ -822,6 -953,9 +822,12 @@@ static netdev_tx_t start_xmit(struct sk
  		}
  	}
  
++<<<<<<< HEAD
++=======
+ 	if (__netif_subqueue_stopped(dev, qnum) || !skb->xmit_more)
+ 		virtqueue_kick(sq->vq);
+ 
++>>>>>>> c89fcfd42cbc (virtio_net: flush when in xmit_more mode and under descriptor pressure)
  	return NETDEV_TX_OK;
  }
  
* Unmerged path drivers/net/virtio_net.c
