net/mlx4_en: Fix off-by-four in ethtool

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [netdrv] mlx4_en: Fix off-by-four in ethtool (Amir Vadai) [1164527 1164530 1164531 1164536 1164537]
Rebuild_FUZZ: 94.59%
commit-author Eran Ben Elisha <eranbe@mellanox.com>
commit 9a2abf5a80ebc8b77d6ad4b68ab597ad43d07399
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/9a2abf5a.failed

NUM_ALL_STATS was not updated with the new four entries, instead
NUM_FLOW_STATS was updated, fix it. that caused off-by-four for all
counters below pf_*_*.

Fixes: b42de4d01264 ('net/mlx4_en: Show PF own statistics via ethtool')
	Signed-off-by: Eran Ben Elisha <eranbe@mellanox.com>
	Signed-off-by: Or Gerlitz <ogerlitz@mellanox.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit 9a2abf5a80ebc8b77d6ad4b68ab597ad43d07399)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx4/mlx4_stats.h
diff --cc drivers/net/ethernet/mellanox/mlx4/mlx4_stats.h
index 8a56611cd79a,7fd466c0b929..000000000000
--- a/drivers/net/ethernet/mellanox/mlx4/mlx4_stats.h
+++ b/drivers/net/ethernet/mellanox/mlx4/mlx4_stats.h
@@@ -48,6 -56,60 +48,65 @@@ struct mlx4_en_perf_stats 
  };
  
  #define NUM_MAIN_STATS	21
++<<<<<<< HEAD
 +#define NUM_ALL_STATS	(NUM_MAIN_STATS + NUM_PORT_STATS + NUM_PKT_STATS + \
 +			 NUM_PERF_STATS)
++=======
+ 
+ #define MLX4_NUM_PRIORITIES	8
+ 
+ struct mlx4_en_flow_stats_rx {
+ 	u64 rx_pause;
+ 	u64 rx_pause_duration;
+ 	u64 rx_pause_transition;
+ #define NUM_FLOW_STATS_RX	3
+ #define NUM_FLOW_PRIORITY_STATS_RX	(NUM_FLOW_STATS_RX * \
+ 					 MLX4_NUM_PRIORITIES)
+ };
+ 
+ struct mlx4_en_flow_stats_tx {
+ 	u64 tx_pause;
+ 	u64 tx_pause_duration;
+ 	u64 tx_pause_transition;
+ #define NUM_FLOW_STATS_TX	3
+ #define NUM_FLOW_PRIORITY_STATS_TX	(NUM_FLOW_STATS_TX * \
+ 					 MLX4_NUM_PRIORITIES)
+ };
+ 
+ #define NUM_FLOW_STATS (NUM_FLOW_STATS_RX + NUM_FLOW_STATS_TX + \
+ 			NUM_FLOW_PRIORITY_STATS_TX + \
+ 			NUM_FLOW_PRIORITY_STATS_RX)
+ 
+ struct mlx4_en_stat_out_flow_control_mbox {
+ 	/* Total number of PAUSE frames received from the far-end port */
+ 	__be64 rx_pause;
+ 	/* Total number of microseconds that far-end port requested to pause
+ 	* transmission of packets
+ 	*/
+ 	__be64 rx_pause_duration;
+ 	/* Number of received transmission from XOFF state to XON state */
+ 	__be64 rx_pause_transition;
+ 	/* Total number of PAUSE frames sent from the far-end port */
+ 	__be64 tx_pause;
+ 	/* Total time in microseconds that transmission of packets has been
+ 	* paused
+ 	*/
+ 	__be64 tx_pause_duration;
+ 	/* Number of transmitter transitions from XOFF state to XON state */
+ 	__be64 tx_pause_transition;
+ 	/* Reserverd */
+ 	__be64 reserved[2];
+ };
+ 
+ enum {
+ 	MLX4_DUMP_ETH_STATS_FLOW_CONTROL = 1 << 12
+ };
+ 
+ #define NUM_ALL_STATS	(NUM_MAIN_STATS + NUM_PORT_STATS + NUM_PKT_STATS + \
+ 			 NUM_FLOW_STATS + NUM_PERF_STATS + NUM_PF_STATS)
+ 
+ #define MLX4_FIND_NETDEV_STAT(n) (offsetof(struct net_device_stats, n) / \
+ 				  sizeof(((struct net_device_stats *)0)->n))
+ 
++>>>>>>> 9a2abf5a80eb (net/mlx4_en: Fix off-by-four in ethtool)
  #endif
* Unmerged path drivers/net/ethernet/mellanox/mlx4/mlx4_stats.h
