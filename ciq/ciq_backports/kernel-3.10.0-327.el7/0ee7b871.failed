Fnic: For Standalone C series, "sending VLAN request" message seen even if the link is down

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author Hiral Shah <hishah@cisco.com>
commit 0ee7b8714dca511a68826a300cc4966f2e83a6c3
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/0ee7b871.failed

When physical link between standalone C series and switch is down,
the fip timer is not turned off and timer expiration will keep sending
vlan request.

It can be fixed by stopping the fip_timer and
it will be restarted automatically when Link is up.

- Increment fnic version from 1.6.0.14 to 1.6.0.15

	Signed-off-by: Hiral Shah <hishah@cisco.com>
	Signed-off-by: Sesidhar Baddela <sebaddel@cisco.com>
	Signed-off-by: Anil Chintalapati <achintal@cisco.com>
	Signed-off-by: Christoph Hellwig <hch@lst.de>
(cherry picked from commit 0ee7b8714dca511a68826a300cc4966f2e83a6c3)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/fnic/fnic.h
#	drivers/scsi/fnic/fnic_fcs.c
diff --cc drivers/scsi/fnic/fnic.h
index a547c3fee2f5,977960b03c9f..000000000000
--- a/drivers/scsi/fnic/fnic.h
+++ b/drivers/scsi/fnic/fnic.h
@@@ -39,7 -39,7 +39,11 @@@
  
  #define DRV_NAME		"fnic"
  #define DRV_DESCRIPTION		"Cisco FCoE HBA Driver"
++<<<<<<< HEAD
 +#define DRV_VERSION		"1.5.0.45a"
++=======
+ #define DRV_VERSION		"1.6.0.15"
++>>>>>>> 0ee7b8714dca (Fnic: For Standalone C series, "sending VLAN request" message seen even if the link is down)
  #define PFX			DRV_NAME ": "
  #define DFX                     DRV_NAME "%d: "
  
diff --cc drivers/scsi/fnic/fnic_fcs.c
index e4f005760a36,bf0bbd42efb5..000000000000
--- a/drivers/scsi/fnic/fnic_fcs.c
+++ b/drivers/scsi/fnic/fnic_fcs.c
@@@ -104,6 -131,15 +104,18 @@@ void fnic_handle_link(struct work_struc
  		fnic->lport->host_stats.link_failure_count++;
  		spin_unlock_irqrestore(&fnic->fnic_lock, flags);
  		FNIC_FCS_DBG(KERN_DEBUG, fnic->lport->host, "link down\n");
++<<<<<<< HEAD
++=======
+ 		fnic_fc_trace_set_data(
+ 			fnic->lport->host->host_no, FNIC_FC_LE,
+ 			"Link Status: UP_DOWN",
+ 			strlen("Link Status: UP_DOWN"));
+ 		if (fnic->config.flags & VFCF_FIP_CAPABLE) {
+ 			FNIC_FCS_DBG(KERN_DEBUG, fnic->lport->host,
+ 				"deleting fip-timer during link-down\n");
+ 			del_timer_sync(&fnic->fip_timer);
+ 		}
++>>>>>>> 0ee7b8714dca (Fnic: For Standalone C series, "sending VLAN request" message seen even if the link is down)
  		fcoe_ctlr_link_down(&fnic->ctlr);
  	}
  
* Unmerged path drivers/scsi/fnic/fnic.h
* Unmerged path drivers/scsi/fnic/fnic_fcs.c
