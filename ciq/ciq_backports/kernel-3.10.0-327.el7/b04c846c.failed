usb: make module xhci_hcd removable

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [usb] make module xhci_hcd removable (Don Zickus) [1232920]
Rebuild_FUZZ: 92.31%
commit-author Arthur Demchenkov <spinal.by@gmail.com>
commit b04c846ceaad42f9e37f3626c7e8f457603863f0
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/b04c846c.failed

Fixed regression. After commit 29e409f0f761 ("xhci: Allow xHCI drivers to
be built as separate modules") the module xhci_hcd became non-removable.
That behaviour is not expected and there're no notes about it in commit
message. The module should be removable as it blocks PM suspend/resume
functions (Debian Bug#666406).

	Signed-off-by: Arthur Demchenkov <spinal.by@gmail.com>
	Reviewed-by: Andrew Bresticker <abrestic@chromium.org>
	Cc: <stable@vger.kernel.org> # v3.18+
	Signed-off-by: Mathias Nyman <mathias.nyman@linux.intel.com>
	Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
(cherry picked from commit b04c846ceaad42f9e37f3626c7e8f457603863f0)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/usb/host/xhci.c
diff --cc drivers/usb/host/xhci.c
index 3301eb9b78c0,4299cbf47793..000000000000
--- a/drivers/usb/host/xhci.c
+++ b/drivers/usb/host/xhci.c
@@@ -5027,15 -5010,13 +5027,26 @@@ static int __init xhci_hcd_init(void
  	/* xhci_run_regs has eight fields and embeds 128 xhci_intr_regs */
  	BUILD_BUG_ON(sizeof(struct xhci_run_regs) != (8+8*128)*32/8);
  	return 0;
 +unreg_pci:
 +	xhci_unregister_pci();
 +	return retval;
  }
+ 
+ /*
+  * If an init function is provided, an exit function must also be provided
+  * to allow module unload.
+  */
+ static void __exit xhci_hcd_fini(void) { }
+ 
  module_init(xhci_hcd_init);
++<<<<<<< HEAD
 +
 +static void __exit xhci_hcd_cleanup(void)
 +{
 +	xhci_unregister_pci();
 +	xhci_unregister_plat();
 +}
 +module_exit(xhci_hcd_cleanup);
++=======
+ module_exit(xhci_hcd_fini);
++>>>>>>> b04c846ceaad (usb: make module xhci_hcd removable)
* Unmerged path drivers/usb/host/xhci.c
