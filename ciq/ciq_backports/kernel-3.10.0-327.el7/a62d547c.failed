virtio_mmio: support non-legacy balloon devices

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [virtio] virtio-mmio: support non-legacy balloon devices (Jason Wang) [1227339]
Rebuild_FUZZ: 97.87%
commit-author Michael S. Tsirkin <mst@redhat.com>
commit a62d547c72cd0ed03565b4eb2167536a64bad0f4
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/a62d547c.failed

virtio_device_is_legacy_only is always false now,
drop the test from virtio mmio.

	Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
	Acked-by: Pawel Moll <pawel.moll@arm.com>
	Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
(cherry picked from commit a62d547c72cd0ed03565b4eb2167536a64bad0f4)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/virtio/virtio_mmio.c
diff --cc drivers/virtio/virtio_mmio.c
index 818be4b53b1f,7a5e60dea6c5..000000000000
--- a/drivers/virtio/virtio_mmio.c
+++ b/drivers/virtio/virtio_mmio.c
@@@ -559,9 -572,17 +559,14 @@@ static int virtio_mmio_probe(struct pla
  	}
  
  	vm_dev->vdev.id.device = readl(vm_dev->base + VIRTIO_MMIO_DEVICE_ID);
 -	if (vm_dev->vdev.id.device == 0) {
 -		/*
 -		 * virtio-mmio device with an ID 0 is a (dummy) placeholder
 -		 * with no function. End probing now with no error reported.
 -		 */
 -		return -ENODEV;
 -	}
  	vm_dev->vdev.id.vendor = readl(vm_dev->base + VIRTIO_MMIO_VENDOR_ID);
  
++<<<<<<< HEAD
 +	writel(PAGE_SIZE, vm_dev->base + VIRTIO_MMIO_GUEST_PAGE_SIZE);
++=======
+ 	if (vm_dev->version == 1)
+ 		writel(PAGE_SIZE, vm_dev->base + VIRTIO_MMIO_GUEST_PAGE_SIZE);
++>>>>>>> a62d547c72cd (virtio_mmio: support non-legacy balloon devices)
  
  	platform_set_drvdata(pdev, vm_dev);
  
* Unmerged path drivers/virtio/virtio_mmio.c
