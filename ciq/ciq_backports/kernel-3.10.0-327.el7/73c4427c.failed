perf/x86/intel/uncore: Don't use smp_processor_id() in validate_group()

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [x86] perf/uncore: Don't use smp_processor_id() in validate_group() (Jiri Olsa) [1176340]
Rebuild_FUZZ: 92.42%
commit-author Yan, Zheng <zheng.z.yan@intel.com>
commit 73c4427c6ca3b32fa0441791e9c6eadceff7242f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/73c4427c.failed

uncore_validate_group() can't call smp_processor_id() because it is
in preemptible context. Pass NUMA_NO_NODE to the allocator instead.

	Signed-off-by: Yan, Zheng <zheng.z.yan@intel.com>
	Signed-off-by: Peter Zijlstra <peterz@infradead.org>
Link: http://lkml.kernel.org/r/1379400493-11505-1-git-send-email-zheng.z.yan@intel.com
	Signed-off-by: Ingo Molnar <mingo@kernel.org>
(cherry picked from commit 73c4427c6ca3b32fa0441791e9c6eadceff7242f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/kernel/cpu/perf_event_intel_uncore.c
diff --cc arch/x86/kernel/cpu/perf_event_intel_uncore.c
index cba38b2af1c1,4118f9f68315..000000000000
--- a/arch/x86/kernel/cpu/perf_event_intel_uncore.c
+++ b/arch/x86/kernel/cpu/perf_event_intel_uncore.c
@@@ -2718,7 -2713,7 +2718,11 @@@ static struct intel_uncore_box *uncore_
  
  	size = sizeof(*box) + type->num_shared_regs * sizeof(struct intel_uncore_extra_reg);
  
++<<<<<<< HEAD
 +	box = kmalloc_node(size, GFP_KERNEL | __GFP_ZERO, cpu_to_node(cpu));
++=======
+ 	box = kzalloc_node(size, GFP_KERNEL, node);
++>>>>>>> 73c4427c6ca3 (perf/x86/intel/uncore: Don't use smp_processor_id() in validate_group())
  	if (!box)
  		return NULL;
  
* Unmerged path arch/x86/kernel/cpu/perf_event_intel_uncore.c
