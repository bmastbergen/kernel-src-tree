HID: i2c-hid: Limit reads to wMaxInputLength bytes for input events

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [hid] i2c-hid: Limit reads to wMaxInputLength bytes for input events (Aristeu Rozanski) [1075108 1075114]
Rebuild_FUZZ: 96.12%
commit-author Seth Forshee <seth.forshee@canonical.com>
commit 6d00f37e49d95e640a3937a4a1ae07dbe92a10cb
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/6d00f37e.failed

d1c7e29e8d27 (HID: i2c-hid: prevent buffer overflow in early IRQ)
changed hid_get_input() to read ihid->bufsize bytes, which can be
more than wMaxInputLength. This is the case with the Dell XPS 13
9343, and it is causing events to be missed. In some cases the
missed events are releases, which can cause the cursor to jump or
freeze, among other problems. Limit the number of bytes read to
min(wMaxInputLength, ihid->bufsize) to prevent such problems.

Fixes: d1c7e29e8d27 "HID: i2c-hid: prevent buffer overflow in early IRQ"
	Signed-off-by: Seth Forshee <seth.forshee@canonical.com>
	Reviewed-by: Benjamin Tissoires <benjamin.tissoires@redhat.com>
	Signed-off-by: Jiri Kosina <jkosina@suse.cz>
(cherry picked from commit 6d00f37e49d95e640a3937a4a1ae07dbe92a10cb)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/hid/i2c-hid/i2c-hid.c
diff --cc drivers/hid/i2c-hid/i2c-hid.c
index 564d90521dfd,36053f33d6d9..000000000000
--- a/drivers/hid/i2c-hid/i2c-hid.c
+++ b/drivers/hid/i2c-hid/i2c-hid.c
@@@ -355,6 -371,9 +355,12 @@@ static void i2c_hid_get_input(struct i2
  {
  	int ret, ret_size;
  	int size = le16_to_cpu(ihid->hdesc.wMaxInputLength);
++<<<<<<< HEAD
++=======
+ 
+ 	if (size > ihid->bufsize)
+ 		size = ihid->bufsize;
++>>>>>>> 6d00f37e49d9 (HID: i2c-hid: Limit reads to wMaxInputLength bytes for input events)
  
  	ret = i2c_master_recv(ihid->client, ihid->inbuf, size);
  	if (ret != size) {
* Unmerged path drivers/hid/i2c-hid/i2c-hid.c
