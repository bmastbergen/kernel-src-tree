i40e: Don't register/de-register apps on NIC partitions in MFP mode

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author Neerav Parikh <neerav.parikh@intel.com>
commit c142b1dc898efd4702aeacc787bbef8918c401e7
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/c142b1dc.failed

Do not register or try to de-register DCB applications with the DCBNL
layer in case of NIC partitions when adapter is in MFP mode.

Change-ID: I603d042a61983a6562be471c6a2b181572504118
	Signed-off-by: Neerav Parikh <neerav.parikh@intel.com>
	Tested-by: Jim Young <james.m.young@intel.com>
	Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
(cherry picked from commit c142b1dc898efd4702aeacc787bbef8918c401e7)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/i40e/i40e_dcb_nl.c
diff --cc drivers/net/ethernet/intel/i40e/i40e_dcb_nl.c
index 9ba276f7087e,bd5079d5c1b6..000000000000
--- a/drivers/net/ethernet/intel/i40e/i40e_dcb_nl.c
+++ b/drivers/net/ethernet/intel/i40e/i40e_dcb_nl.c
@@@ -275,16 -280,18 +279,25 @@@ static bool i40e_dcbnl_find_app(struct 
   * DCB configuration
   **/
  void i40e_dcbnl_flush_apps(struct i40e_pf *pf,
 -			   struct i40e_dcbx_config *old_cfg,
  			   struct i40e_dcbx_config *new_cfg)
  {
 -	struct i40e_dcb_app_priority_table app;
 +	struct i40e_ieee_app_priority_table app;
 +	struct i40e_dcbx_config *dcbxcfg;
 +	struct i40e_hw *hw = &pf->hw;
  	int i;
  
++<<<<<<< HEAD
 +	dcbxcfg = &hw->local_dcbx_config;
 +	for (i = 0; i < dcbxcfg->numapps; i++) {
 +		app = dcbxcfg->app[i];
++=======
+ 	/* MFP mode but not an iSCSI PF so return */
+ 	if ((pf->flags & I40E_FLAG_MFP_ENABLED) && !(pf->hw.func_caps.iscsi))
+ 		return;
+ 
+ 	for (i = 0; i < old_cfg->numapps; i++) {
+ 		app = old_cfg->app[i];
++>>>>>>> c142b1dc898e (i40e: Don't register/de-register apps on NIC partitions in MFP mode)
  		/* The APP is not available anymore delete it */
  		if (!i40e_dcbnl_find_app(new_cfg, &app))
  			i40e_dcbnl_del_app(pf, &app);
* Unmerged path drivers/net/ethernet/intel/i40e/i40e_dcb_nl.c
