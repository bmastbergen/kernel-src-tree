s390/mm: limit STACK_RND_MASK for compat tasks

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [s390] mm: limit STACK_RND_MASK for compat tasks (Hendrik Brueckner) [1204860]
Rebuild_FUZZ: 94.25%
commit-author Martin Schwidefsky <schwidefsky@de.ibm.com>
commit e143fa93c28669a7f0851e6850b1da5b1945fd53
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/e143fa93.failed

For compat tasks the mmap randomization does not use the maximum
randomization value from mmap_rnd_mask but the fixed value of 0x7ff.
This needs to be respected in the definition of STACK_RND_MASK as
well.

	Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
(cherry picked from commit e143fa93c28669a7f0851e6850b1da5b1945fd53)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/s390/include/asm/elf.h
diff --cc arch/s390/include/asm/elf.h
index 78f4f8711d58,c9c875d9ed31..000000000000
--- a/arch/s390/include/asm/elf.h
+++ b/arch/s390/include/asm/elf.h
@@@ -208,7 -209,9 +208,13 @@@ do {								
  } while (0)
  #endif /* CONFIG_COMPAT */
  
++<<<<<<< HEAD
 +#define STACK_RND_MASK	0x7ffUL
++=======
+ extern unsigned long mmap_rnd_mask;
+ 
+ #define STACK_RND_MASK	(test_thread_flag(TIF_31BIT) ? 0x7ff : mmap_rnd_mask)
++>>>>>>> e143fa93c286 (s390/mm: limit STACK_RND_MASK for compat tasks)
  
  #define ARCH_DLINFO							    \
  do {									    \
* Unmerged path arch/s390/include/asm/elf.h
