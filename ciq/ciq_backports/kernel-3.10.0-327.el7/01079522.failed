NVMe: Change nvme_enable_ctrl to set EN and manage CC thru ctrl_config.

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [block] nvme: Change nvme_enable_ctrl to set EN and manage CC thru ctrl_config (David Milburn) [1179447]
Rebuild_FUZZ: 99.29%
commit-author Dan McLeran <daniel.mcleran@intel.com>
commit 01079522f94b3a1c87cfa375be3917d2da6e6363
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/01079522.failed

Change the behavior of nvme_enable_ctrl to set EN.
Clear CC.SH for both nvme_enable_ctrl and nvme_disable_ctrl.
Remove reading of the CC register and manage the state in
dev->ctrl_config.

	Signed-off-by: Dan McLeran <daniel.mcleran@intel.com>
[removed an unwanted write to CC]
	Signed-off-by: Matthew Wilcox <matthew.r.wilcox@intel.com>
	Signed-off-by: Jens Axboe <axboe@fb.com>
(cherry picked from commit 01079522f94b3a1c87cfa375be3917d2da6e6363)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/block/nvme-core.c
diff --cc drivers/block/nvme-core.c
index d98709527569,0a98de813a12..000000000000
--- a/drivers/block/nvme-core.c
+++ b/drivers/block/nvme-core.c
@@@ -1561,8 -1502,10 +1566,15 @@@ static int nvme_configure_admin_queue(s
  	aqa = nvmeq->q_depth - 1;
  	aqa |= aqa << 16;
  
++<<<<<<< HEAD
 +	dev->ctrl_config = NVME_CC_ENABLE | NVME_CC_CSS_NVM;
 +	dev->ctrl_config |= (PAGE_SHIFT - 12) << NVME_CC_MPS_SHIFT;
++=======
+ 	dev->page_size = 1 << page_shift;
+ 
+ 	dev->ctrl_config = NVME_CC_CSS_NVM;
+ 	dev->ctrl_config |= (page_shift - 12) << NVME_CC_MPS_SHIFT;
++>>>>>>> 01079522f94b (NVMe: Change nvme_enable_ctrl to set EN and manage CC thru ctrl_config.)
  	dev->ctrl_config |= NVME_CC_ARB_RR | NVME_CC_SHN_NONE;
  	dev->ctrl_config |= NVME_CC_IOSQES | NVME_CC_IOCQES;
  
* Unmerged path drivers/block/nvme-core.c
