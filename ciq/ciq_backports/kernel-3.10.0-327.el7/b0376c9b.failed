powerpc/powernv: Use it_page_shift for TCE invalidation

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [powerpc] powernv: Use it_page_shift for TCE invalidation (David Gibson) [1232550]
Rebuild_FUZZ: 92.16%
commit-author Alexey Kardashevskiy <aik@ozlabs.ru>
commit b0376c9b08d627aac7cc282138a40edebae7b9ae
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/b0376c9b.failed

This fixes IODA1/2 to use it_page_shift as it may be bigger than 4K.

This changes involved constant values to use "ull" modifier.

	Signed-off-by: Alexey Kardashevskiy <aik@ozlabs.ru>
	Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
(cherry picked from commit b0376c9b08d627aac7cc282138a40edebae7b9ae)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/powerpc/platforms/powernv/pci-ioda.c
diff --cc arch/powerpc/platforms/powernv/pci-ioda.c
index 109e90d84e34,40f968e02d35..000000000000
--- a/arch/powerpc/platforms/powernv/pci-ioda.c
+++ b/arch/powerpc/platforms/powernv/pci-ioda.c
@@@ -588,11 -505,15 +588,12 @@@ static void pnv_ioda_setup_bus_dma(stru
  	}
  }
  
 -static void pnv_pci_ioda1_tce_invalidate(struct pnv_ioda_pe *pe,
 -					 struct iommu_table *tbl,
 -					 __be64 *startp, __be64 *endp, bool rm)
 +static void pnv_pci_ioda1_tce_invalidate(struct iommu_table *tbl,
 +					 __be64 *startp, __be64 *endp)
  {
 -	__be64 __iomem *invalidate = rm ?
 -		(__be64 __iomem *)pe->tce_inval_reg_phys :
 -		(__be64 __iomem *)tbl->it_index;
 +	__be64 __iomem *invalidate = (__be64 __iomem *)tbl->it_index;
  	unsigned long start, end, inc;
+ 	const unsigned shift = tbl->it_page_shift;
  
  	start = __pa(startp);
  	end = __pa(endp);
@@@ -630,13 -554,16 +631,20 @@@
  
  static void pnv_pci_ioda2_tce_invalidate(struct pnv_ioda_pe *pe,
  					 struct iommu_table *tbl,
 -					 __be64 *startp, __be64 *endp, bool rm)
 +					 __be64 *startp, __be64 *endp)
  {
  	unsigned long start, end, inc;
++<<<<<<< HEAD
 +	__be64 __iomem *invalidate = (__be64 __iomem *)tbl->it_index;
++=======
+ 	__be64 __iomem *invalidate = rm ?
+ 		(__be64 __iomem *)pe->tce_inval_reg_phys :
+ 		(__be64 __iomem *)tbl->it_index;
+ 	const unsigned shift = tbl->it_page_shift;
++>>>>>>> b0376c9b08d6 (powerpc/powernv: Use it_page_shift for TCE invalidation)
  
  	/* We'll invalidate DMA address in PE scope */
- 	start = 0x2ul << 60;
+ 	start = 0x2ull << 60;
  	start |= (pe->pe_number & 0xFF);
  	end = start;
  
* Unmerged path arch/powerpc/platforms/powernv/pci-ioda.c
