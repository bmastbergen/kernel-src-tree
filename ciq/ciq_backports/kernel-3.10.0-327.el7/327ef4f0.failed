ALSA: hda - Decouple PCM and hwdep devices from codec object

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [alsa] hda - Decouple PCM and hwdep devices from codec object (Jaroslav Kysela) [1197064]
Rebuild_FUZZ: 94.74%
commit-author Takashi Iwai <tiwai@suse.de>
commit 327ef4f02582d01f7eedb291794106823b44a0cf
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/327ef4f0.failed

This is a preliminary patch for the hda_bus implementation, removing
the parent device setup to codec device.  Since the bus and the class
devices can't be crossed over, leave the sound devices to the default
parent device as is.

	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit 327ef4f02582d01f7eedb291794106823b44a0cf)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/pci/hda/hda_controller.c
diff --cc sound/pci/hda/hda_controller.c
index 9286384796c1,4c7a6f9bfcde..000000000000
--- a/sound/pci/hda/hda_controller.c
+++ b/sound/pci/hda/hda_controller.c
@@@ -959,8 -958,6 +959,11 @@@ static int azx_attach_pcm_stream(struc
  	snd_pcm_lib_preallocate_pages_for_all(pcm, SNDRV_DMA_TYPE_DEV_SG,
  					      chip->card->dev,
  					      size, MAX_PREALLOC_SIZE);
++<<<<<<< HEAD
 +	/* link to codec */
 +	pcm->dev = &codec->dev;
++=======
++>>>>>>> 327ef4f02582 (ALSA: hda - Decouple PCM and hwdep devices from codec object)
  	return 0;
  }
  
diff --git a/sound/pci/hda/hda_beep.c b/sound/pci/hda/hda_beep.c
index 1e7de08e77cb..d6be4e852c4d 100644
--- a/sound/pci/hda/hda_beep.c
+++ b/sound/pci/hda/hda_beep.c
@@ -168,7 +168,6 @@ static int snd_hda_do_attach(struct hda_beep *beep)
 	input_dev->evbit[0] = BIT_MASK(EV_SND);
 	input_dev->sndbit[0] = BIT_MASK(SND_BELL) | BIT_MASK(SND_TONE);
 	input_dev->event = snd_hda_beep_event;
-	input_dev->dev.parent = &codec->dev;
 	input_set_drvdata(input_dev, beep);
 
 	beep->dev = input_dev;
* Unmerged path sound/pci/hda/hda_controller.c
diff --git a/sound/pci/hda/hda_hwdep.c b/sound/pci/hda/hda_hwdep.c
index 11b5a42b4ec8..125f3420fa6a 100644
--- a/sound/pci/hda/hda_hwdep.c
+++ b/sound/pci/hda/hda_hwdep.c
@@ -116,9 +116,6 @@ int snd_hda_create_hwdep(struct hda_codec *codec)
 	hwdep->ops.ioctl_compat = hda_hwdep_ioctl_compat;
 #endif
 
-	/* link to codec */
-	hwdep->dev.parent = &codec->dev;
-
 	/* for sysfs */
 	hwdep->dev.groups = snd_hda_dev_attr_groups;
 	dev_set_drvdata(&hwdep->dev, codec);
