lpfc: Fix null ndlp dereference in target_reset_handler

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author James Smart <james.smart@emulex.com>
commit 63e480fd2f598e9ad37f89e79c36834e7dd60ba0
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/63e480fd.failed

	Signed-off-by: Dick Kennedy <dick.kennedy@emulex.com>
	Signed-off-by: James Smart <james.smart@emulex.com>
	Reviewed-by: Hannes Reinecke <hare@suse.de>
	Signed-off-by: James Bottomley <JBottomley@Odin.com>
(cherry picked from commit 63e480fd2f598e9ad37f89e79c36834e7dd60ba0)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/lpfc/lpfc_scsi.c
diff --cc drivers/scsi/lpfc/lpfc_scsi.c
index ea192be6227a,5612ba6bf213..000000000000
--- a/drivers/scsi/lpfc/lpfc_scsi.c
+++ b/drivers/scsi/lpfc/lpfc_scsi.c
@@@ -5337,7 -5202,15 +5337,19 @@@ lpfc_target_reset_handler(struct scsi_c
  	if (status == FAILED) {
  		lpfc_printf_vlog(vport, KERN_ERR, LOG_FCP,
  			"0722 Target Reset rport failure: rdata x%p\n", rdata);
++<<<<<<< HEAD
 +		return FAILED;
++=======
+ 		if (pnode) {
+ 			spin_lock_irq(shost->host_lock);
+ 			pnode->nlp_flag &= ~NLP_NPR_ADISC;
+ 			pnode->nlp_fcp_info &= ~NLP_FCP_2_DEVICE;
+ 			spin_unlock_irq(shost->host_lock);
+ 		}
+ 		lpfc_reset_flush_io_context(vport, tgt_id, lun_id,
+ 					  LPFC_CTX_TGT);
+ 		return FAST_IO_FAIL;
++>>>>>>> 63e480fd2f59 (lpfc: Fix null ndlp dereference in target_reset_handler)
  	}
  
  	scsi_event.event_type = FC_REG_SCSI_EVENT;
* Unmerged path drivers/scsi/lpfc/lpfc_scsi.c
