tick: Fixup more fallout from hrtimer broadcast mode

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author Preeti U Murthy <preeti@linux.vnet.ibm.com>
commit 849401b66d305f3feb75b6db7459b95ad190552a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/849401b6.failed

The hrtimer mode of broadcast is supported only when
GENERIC_CLOCKEVENTS_BROADCAST and TICK_ONESHOT config options
are enabled. Hence compile in the functions for hrtimer mode
of broadcast only when these options are selected.
Also fix max_delta_ticks value for the pseudo clock device.

	Reported-by: Fengguang Wu <fengguang.wu@intel.com>
	Reported-by: Ingo Molnar <mingo@kernel.org>
	Signed-off-by: Preeti U Murthy <preeti@linux.vnet.ibm.com>
Link: http://lkml.kernel.org/r/52F719EE.9010304@linux.vnet.ibm.com
	Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
(cherry picked from commit 849401b66d305f3feb75b6db7459b95ad190552a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	kernel/time/Makefile
#	kernel/time/tick-broadcast-hrtimer.c
diff --cc kernel/time/Makefile
index ff7d9d2ab504,57a413fd0ebf..000000000000
--- a/kernel/time/Makefile
+++ b/kernel/time/Makefile
@@@ -3,7 -3,11 +3,15 @@@ obj-y += timeconv.o posix-clock.o alarm
  
  obj-$(CONFIG_GENERIC_CLOCKEVENTS_BUILD)		+= clockevents.o
  obj-$(CONFIG_GENERIC_CLOCKEVENTS)		+= tick-common.o
++<<<<<<< HEAD
 +obj-$(CONFIG_GENERIC_CLOCKEVENTS_BROADCAST)	+= tick-broadcast.o
++=======
+ ifeq ($(CONFIG_GENERIC_CLOCKEVENTS_BROADCAST),y)
+  obj-y						+= tick-broadcast.o
+  obj-$(CONFIG_TICK_ONESHOT)			+= tick-broadcast-hrtimer.o
+ endif
+ obj-$(CONFIG_GENERIC_SCHED_CLOCK)		+= sched_clock.o
++>>>>>>> 849401b66d30 (tick: Fixup more fallout from hrtimer broadcast mode)
  obj-$(CONFIG_TICK_ONESHOT)			+= tick-oneshot.o
  obj-$(CONFIG_TICK_ONESHOT)			+= tick-sched.o
  obj-$(CONFIG_TIMER_STATS)			+= timer_stats.o
* Unmerged path kernel/time/tick-broadcast-hrtimer.c
diff --git a/include/linux/clockchips.h b/include/linux/clockchips.h
index ae1193bcf074..1e7b4f1c4383 100644
--- a/include/linux/clockchips.h
+++ b/include/linux/clockchips.h
@@ -196,6 +196,7 @@ static inline void clockevents_resume(void) {}
 
 static inline void clockevents_notify(unsigned long reason, void *arg) {}
 static inline int tick_check_broadcast_expired(void) { return 0; }
+static inline void tick_setup_hrtimer_broadcast(void) {};
 
 #endif
 
* Unmerged path kernel/time/Makefile
* Unmerged path kernel/time/tick-broadcast-hrtimer.c
