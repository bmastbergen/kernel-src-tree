ixgbe: add support for interrupts from X550 external PHY

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author Don Skidmore <donald.c.skidmore@intel.com>
commit 597f22d6aa46105d69648a5c042d1fabe182c6f6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/597f22d6.failed

This patch adds support for receiving interrupts from a external copper
PHY for the X550 part.  This includes enabling, detection as well as
re-enablement.

	Signed-off-by: Don Skidmore <donald.c.skidmore@intel.com>
	Tested-by: Krishneil Singh <krishneil.k.singh@intel.com>
	Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
(cherry picked from commit 597f22d6aa46105d69648a5c042d1fabe182c6f6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
diff --cc drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
index 9c071e440192,1c3477a974bc..000000000000
--- a/drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
+++ b/drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
@@@ -2369,7 -2388,9 +2369,13 @@@ static void ixgbe_check_overtemp_subtas
  
  		break;
  	default:
++<<<<<<< HEAD
 +		if (!(eicr & IXGBE_EICR_GPI_SDP0))
++=======
+ 		if (adapter->hw.mac.type >= ixgbe_mac_X540)
+ 			return;
+ 		if (!(eicr & IXGBE_EICR_GPI_SDP0(hw)))
++>>>>>>> 597f22d6aa46 (ixgbe: add support for interrupts from X550 external PHY)
  			return;
  		break;
  	}
diff --git a/drivers/net/ethernet/intel/ixgbe/ixgbe.h b/drivers/net/ethernet/intel/ixgbe/ixgbe.h
index 75b44a45da46..1751762d3427 100644
--- a/drivers/net/ethernet/intel/ixgbe/ixgbe.h
+++ b/drivers/net/ethernet/intel/ixgbe/ixgbe.h
@@ -654,6 +654,7 @@ struct ixgbe_adapter {
 #define IXGBE_FLAG2_RSS_FIELD_IPV4_UDP		(u32)(1 << 8)
 #define IXGBE_FLAG2_RSS_FIELD_IPV6_UDP		(u32)(1 << 9)
 #define IXGBE_FLAG2_PTP_PPS_ENABLED		(u32)(1 << 10)
+#define IXGBE_FLAG2_PHY_INTERRUPT		(u32)(1 << 11)
 
 	/* Tx fast path data */
 	int num_tx_queues;
* Unmerged path drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
