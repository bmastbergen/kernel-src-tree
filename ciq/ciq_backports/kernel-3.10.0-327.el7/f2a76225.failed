ALSA: line6: Drop superfluous spinlock for trigger

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [alsa] line6: Drop superfluous spinlock for trigger (Jaroslav Kysela) [1197064]
Rebuild_FUZZ: 93.62%
commit-author Takashi Iwai <tiwai@suse.de>
commit f2a76225b962f00642002fb109aee2e5b0dc4259
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/f2a76225.failed

The trigger callback is already spinlocked, so we need no more lock
here (even for the linked substreams).  Let's drop it.

	Tested-by: Chris Rorvick <chris@rorvick.com>
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit f2a76225b962f00642002fb109aee2e5b0dc4259)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/staging/line6/pcm.c
diff --cc drivers/staging/line6/pcm.c
index cfc50624f3e2,adbcac46b785..000000000000
--- a/drivers/staging/line6/pcm.c
+++ b/drivers/staging/line6/pcm.c
@@@ -488,23 -415,14 +478,32 @@@ int line6_init_pcm(struct usb_line6 *li
  			usb_maxpacket(line6->usbdev,
  				usb_sndisocpipe(line6->usbdev, ep_write), 1));
  
 +	line6pcm->properties = properties;
 +	line6->line6pcm = line6pcm;
 +
 +	/* PCM device: */
 +	err = snd_device_new(line6->card, SNDRV_DEV_PCM, line6, &pcm_ops);
 +	if (err < 0)
 +		return err;
 +
 +	snd_card_set_dev(line6->card, line6->ifcdev);
 +
 +	err = snd_line6_new_pcm(line6pcm);
 +	if (err < 0)
 +		return err;
 +
  	spin_lock_init(&line6pcm->lock_audio_out);
  	spin_lock_init(&line6pcm->lock_audio_in);
++<<<<<<< HEAD:drivers/staging/line6/pcm.c
 +	spin_lock_init(&line6pcm->lock_trigger);
++=======
+ 	line6pcm->impulse_period = LINE6_IMPULSE_DEFAULT_PERIOD;
+ 
+ 	line6->line6pcm = line6pcm;
+ 
+ 	pcm->private_data = line6pcm;
+ 	pcm->private_free = line6_cleanup_pcm;
++>>>>>>> f2a76225b962 (ALSA: line6: Drop superfluous spinlock for trigger):sound/usb/line6/pcm.c
  
  	err = line6_create_audio_out_urbs(line6pcm);
  	if (err < 0)
* Unmerged path drivers/staging/line6/pcm.c
diff --git a/drivers/staging/line6/pcm.h b/drivers/staging/line6/pcm.h
index 6aa0d46a2890..a4ecc2c56419 100644
--- a/drivers/staging/line6/pcm.h
+++ b/drivers/staging/line6/pcm.h
@@ -331,11 +331,6 @@ struct snd_line6_pcm {
 	*/
 	spinlock_t lock_audio_in;
 
-	/**
-		 Spin lock to protect trigger.
-	*/
-	spinlock_t lock_trigger;
-
 	/**
 		 PCM playback volume (left and right).
 	*/
