qla2xxx: Add pci device id 0x2271.

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [scsi] qla2xxx: Add pci device id 0x2271 (Chad Dupuis) [1187302]
Rebuild_FUZZ: 98.51%
commit-author Joe Carnuccio <joe.carnuccio@qlogic.com>
commit 2c5bbbb25f0dd6b178f9b03c93c87b6d7727cdc4
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/2c5bbbb2.failed

	Signed-off-by: Joe Carnuccio <joe.carnuccio@qlogic.com>
	Signed-off-by: Saurav Kashyap <saurav.kashyap@qlogic.com>
	Signed-off-by: Christoph Hellwig <hch@lst.de>
(cherry picked from commit 2c5bbbb25f0dd6b178f9b03c93c87b6d7727cdc4)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/scsi/qla2xxx/qla_def.h
#	drivers/scsi/qla2xxx/qla_os.c
diff --cc drivers/scsi/qla2xxx/qla_def.h
index 823aec28928b,89bece72ef66..000000000000
--- a/drivers/scsi/qla2xxx/qla_def.h
+++ b/drivers/scsi/qla2xxx/qla_def.h
@@@ -2910,6 -2906,9 +2910,12 @@@ struct qla_hw_data 
  #define PCI_DEVICE_ID_QLOGIC_ISP8001	0x8001
  #define PCI_DEVICE_ID_QLOGIC_ISP8031	0x8031
  #define PCI_DEVICE_ID_QLOGIC_ISP2031	0x2031
++<<<<<<< HEAD
++=======
+ #define PCI_DEVICE_ID_QLOGIC_ISP2071	0x2071
+ #define PCI_DEVICE_ID_QLOGIC_ISP2271	0x2271
+ 
++>>>>>>> 2c5bbbb25f0d (qla2xxx: Add pci device id 0x2271.)
  	uint32_t	device_type;
  #define DT_ISP2100                      BIT_0
  #define DT_ISP2200                      BIT_1
@@@ -2930,7 -2929,9 +2936,13 @@@
  #define DT_ISP8031			BIT_16
  #define DT_ISPFX00			BIT_17
  #define DT_ISP8044			BIT_18
++<<<<<<< HEAD
 +#define DT_ISP_LAST			(DT_ISP8044 << 1)
++=======
+ #define DT_ISP2071			BIT_19
+ #define DT_ISP2271			BIT_20
+ #define DT_ISP_LAST			(DT_ISP2271 << 1)
++>>>>>>> 2c5bbbb25f0d (qla2xxx: Add pci device id 0x2271.)
  
  #define DT_T10_PI                       BIT_25
  #define DT_IIDMA                        BIT_26
@@@ -2960,6 -2961,8 +2972,11 @@@
  #define IS_QLA2031(ha)	(DT_MASK(ha) & DT_ISP2031)
  #define IS_QLA8031(ha)	(DT_MASK(ha) & DT_ISP8031)
  #define IS_QLAFX00(ha)	(DT_MASK(ha) & DT_ISPFX00)
++<<<<<<< HEAD
++=======
+ #define IS_QLA2071(ha)	(DT_MASK(ha) & DT_ISP2071)
+ #define IS_QLA2271(ha)	(DT_MASK(ha) & DT_ISP2271)
++>>>>>>> 2c5bbbb25f0d (qla2xxx: Add pci device id 0x2271.)
  
  #define IS_QLA23XX(ha)  (IS_QLA2300(ha) || IS_QLA2312(ha) || IS_QLA2322(ha) || \
  			IS_QLA6312(ha) || IS_QLA6322(ha))
@@@ -2968,6 -2971,7 +2985,10 @@@
  #define IS_QLA25XX(ha)  (IS_QLA2532(ha))
  #define IS_QLA83XX(ha)	(IS_QLA2031(ha) || IS_QLA8031(ha))
  #define IS_QLA84XX(ha)  (IS_QLA8432(ha))
++<<<<<<< HEAD
++=======
+ #define IS_QLA27XX(ha)  (IS_QLA2071(ha) || IS_QLA2271(ha))
++>>>>>>> 2c5bbbb25f0d (qla2xxx: Add pci device id 0x2271.)
  #define IS_QLA24XX_TYPE(ha)     (IS_QLA24XX(ha) || IS_QLA54XX(ha) || \
  				IS_QLA84XX(ha))
  #define IS_CNA_CAPABLE(ha)	(IS_QLA81XX(ha) || IS_QLA82XX(ha) || \
diff --cc drivers/scsi/qla2xxx/qla_os.c
index 92bba6e6e067,1b1cd75a7aa0..000000000000
--- a/drivers/scsi/qla2xxx/qla_os.c
+++ b/drivers/scsi/qla2xxx/qla_os.c
@@@ -2222,6 -2263,20 +2222,23 @@@ qla2x00_set_isp_flags(struct qla_hw_dat
  	case PCI_DEVICE_ID_QLOGIC_ISPF001:
  		ha->device_type |= DT_ISPFX00;
  		break;
++<<<<<<< HEAD
++=======
+ 	case PCI_DEVICE_ID_QLOGIC_ISP2071:
+ 		ha->device_type |= DT_ISP2071;
+ 		ha->device_type |= DT_ZIO_SUPPORTED;
+ 		ha->device_type |= DT_FWI2;
+ 		ha->device_type |= DT_IIDMA;
+ 		ha->fw_srisc_address = RISC_START_ADDRESS_2400;
+ 		break;
+ 	case PCI_DEVICE_ID_QLOGIC_ISP2271:
+ 		ha->device_type |= DT_ISP2271;
+ 		ha->device_type |= DT_ZIO_SUPPORTED;
+ 		ha->device_type |= DT_FWI2;
+ 		ha->device_type |= DT_IIDMA;
+ 		ha->fw_srisc_address = RISC_START_ADDRESS_2400;
+ 		break;
++>>>>>>> 2c5bbbb25f0d (qla2xxx: Add pci device id 0x2271.)
  	}
  
  	if (IS_QLA82XX(ha))
@@@ -2296,7 -2352,9 +2313,13 @@@ qla2x00_probe_one(struct pci_dev *pdev
  	    pdev->device == PCI_DEVICE_ID_QLOGIC_ISP2031 ||
  	    pdev->device == PCI_DEVICE_ID_QLOGIC_ISP8031 ||
  	    pdev->device == PCI_DEVICE_ID_QLOGIC_ISPF001 ||
++<<<<<<< HEAD
 +	    pdev->device == PCI_DEVICE_ID_QLOGIC_ISP8044) {
++=======
+ 	    pdev->device == PCI_DEVICE_ID_QLOGIC_ISP8044 ||
+ 	    pdev->device == PCI_DEVICE_ID_QLOGIC_ISP2071 ||
+ 	    pdev->device == PCI_DEVICE_ID_QLOGIC_ISP2271) {
++>>>>>>> 2c5bbbb25f0d (qla2xxx: Add pci device id 0x2271.)
  		bars = pci_select_bars(pdev, IORESOURCE_MEM);
  		mem_only = 1;
  		ql_dbg_pci(ql_dbg_init, pdev, 0x0007,
@@@ -5175,6 -5333,7 +5198,10 @@@ qla2x00_timer(scsi_qla_host_t *vha
  #define FW_ISP82XX	7
  #define FW_ISP2031	8
  #define FW_ISP8031	9
++<<<<<<< HEAD
++=======
+ #define FW_ISP27XX	10
++>>>>>>> 2c5bbbb25f0d (qla2xxx: Add pci device id 0x2271.)
  
  #define FW_FILE_ISP21XX	"ql2100_fw.bin"
  #define FW_FILE_ISP22XX	"ql2200_fw.bin"
@@@ -5186,6 -5345,8 +5213,11 @@@
  #define FW_FILE_ISP82XX	"ql8200_fw.bin"
  #define FW_FILE_ISP2031	"ql2600_fw.bin"
  #define FW_FILE_ISP8031	"ql8300_fw.bin"
++<<<<<<< HEAD
++=======
+ #define FW_FILE_ISP27XX	"ql2700_fw.bin"
+ 
++>>>>>>> 2c5bbbb25f0d (qla2xxx: Add pci device id 0x2271.)
  
  static DEFINE_MUTEX(qla_fw_lock);
  
@@@ -5200,6 -5361,7 +5232,10 @@@ static struct fw_blob qla_fw_blobs[FW_B
  	{ .name = FW_FILE_ISP82XX, },
  	{ .name = FW_FILE_ISP2031, },
  	{ .name = FW_FILE_ISP8031, },
++<<<<<<< HEAD
++=======
+ 	{ .name = FW_FILE_ISP27XX, },
++>>>>>>> 2c5bbbb25f0d (qla2xxx: Add pci device id 0x2271.)
  };
  
  struct fw_blob *
@@@ -5228,6 -5390,8 +5264,11 @@@ qla2x00_request_firmware(scsi_qla_host_
  		blob = &qla_fw_blobs[FW_ISP2031];
  	} else if (IS_QLA8031(ha)) {
  		blob = &qla_fw_blobs[FW_ISP8031];
++<<<<<<< HEAD
++=======
+ 	} else if (IS_QLA27XX(ha)) {
+ 		blob = &qla_fw_blobs[FW_ISP27XX];
++>>>>>>> 2c5bbbb25f0d (qla2xxx: Add pci device id 0x2271.)
  	} else {
  		return NULL;
  	}
@@@ -5557,6 -5721,8 +5598,11 @@@ static struct pci_device_id qla2xxx_pci
  	{ PCI_DEVICE(PCI_VENDOR_ID_QLOGIC, PCI_DEVICE_ID_QLOGIC_ISP8031) },
  	{ PCI_DEVICE(PCI_VENDOR_ID_QLOGIC, PCI_DEVICE_ID_QLOGIC_ISPF001) },
  	{ PCI_DEVICE(PCI_VENDOR_ID_QLOGIC, PCI_DEVICE_ID_QLOGIC_ISP8044) },
++<<<<<<< HEAD
++=======
+ 	{ PCI_DEVICE(PCI_VENDOR_ID_QLOGIC, PCI_DEVICE_ID_QLOGIC_ISP2071) },
+ 	{ PCI_DEVICE(PCI_VENDOR_ID_QLOGIC, PCI_DEVICE_ID_QLOGIC_ISP2271) },
++>>>>>>> 2c5bbbb25f0d (qla2xxx: Add pci device id 0x2271.)
  	{ 0 },
  };
  MODULE_DEVICE_TABLE(pci, qla2xxx_pci_tbl);
* Unmerged path drivers/scsi/qla2xxx/qla_def.h
* Unmerged path drivers/scsi/qla2xxx/qla_os.c
