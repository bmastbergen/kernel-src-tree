x86, apic: Remove support for ia32-based Unisys ES7000

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
Rebuild_CHGLOG: - [x86] apic: Remove support for ia32-based Unisys ES7000 (Steve Best) [1231358]
Rebuild_FUZZ: 95.15%
commit-author David Rientjes <rientjes@google.com>
commit 58f5d2d44883739e43d57334704b7f16f902e463
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/58f5d2d4.failed

There should no longer be any ia32-based Unisys ES7000 systems out in
the wild, so remove support for it.

We've done our due diligence in reaching out to any contact information
listed for this system and no indication was given that it should be
kept around.

	Signed-off-by: David Rientjes <rientjes@google.com>
(cherry picked from commit 58f5d2d44883739e43d57334704b7f16f902e463)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	arch/x86/Kconfig
#	arch/x86/kernel/apic/es7000_32.c
diff --cc arch/x86/Kconfig
index 9b26872f4d21,c6a864748c38..000000000000
--- a/arch/x86/Kconfig
+++ b/arch/x86/Kconfig
@@@ -812,10 -808,11 +804,15 @@@ config MAXSM
  config NR_CPUS
  	int "Maximum number of CPUs" if SMP && !MAXSMP
  	range 2 8 if SMP && X86_32 && !X86_BIGSMP
 -	range 2 512 if SMP && !MAXSMP && !CPUMASK_OFFSTACK
 -	range 2 8192 if SMP && !MAXSMP && CPUMASK_OFFSTACK && X86_64
 +	range 2 512 if SMP && !MAXSMP
  	default "1" if !SMP
++<<<<<<< HEAD
 +	default "5120" if MAXSMP
 +	default "32" if SMP && (X86_NUMAQ || X86_SUMMIT || X86_BIGSMP || X86_ES7000)
++=======
+ 	default "8192" if MAXSMP
+ 	default "32" if SMP && (X86_NUMAQ || X86_SUMMIT || X86_BIGSMP)
++>>>>>>> 58f5d2d44883 (x86, apic: Remove support for ia32-based Unisys ES7000)
  	default "8" if SMP
  	---help---
  	  This allows you to specify the maximum number of CPUs which this
* Unmerged path arch/x86/kernel/apic/es7000_32.c
* Unmerged path arch/x86/Kconfig
diff --git a/arch/x86/kernel/acpi/boot.c b/arch/x86/kernel/acpi/boot.c
index 45a51de24266..72cd2a08ebf9 100644
--- a/arch/x86/kernel/acpi/boot.c
+++ b/arch/x86/kernel/acpi/boot.c
@@ -965,10 +965,6 @@ static int __init acpi_parse_madt_lapic_entries(void)
 #ifdef	CONFIG_X86_IO_APIC
 #define MP_ISA_BUS		0
 
-#ifdef CONFIG_X86_ES7000
-extern int es7000_plat;
-#endif
-
 void __init mp_override_legacy_irq(u8 bus_irq, u8 polarity, u8 trigger, u32 gsi)
 {
 	int ioapic;
@@ -1018,14 +1014,6 @@ void __init mp_config_acpi_legacy_irqs(void)
 	set_bit(MP_ISA_BUS, mp_bus_not_pci);
 	pr_debug("Bus #%d is ISA\n", MP_ISA_BUS);
 
-#ifdef CONFIG_X86_ES7000
-	/*
-	 * Older generations of ES7000 have no legacy identity mappings
-	 */
-	if (es7000_plat == 1)
-		return;
-#endif
-
 	/*
 	 * Use the default configuration for the IRQs 0-15.  Unless
 	 * overridden by (MADT) interrupt source override entries.
diff --git a/arch/x86/kernel/apic/Makefile b/arch/x86/kernel/apic/Makefile
index 0ae0323b1f9c..7b600c68ed20 100644
--- a/arch/x86/kernel/apic/Makefile
+++ b/arch/x86/kernel/apic/Makefile
@@ -21,7 +21,6 @@ endif
 obj-$(CONFIG_X86_NUMAQ)		+= numaq_32.o
 obj-$(CONFIG_X86_SUMMIT)	+= summit_32.o
 obj-$(CONFIG_X86_BIGSMP)	+= bigsmp_32.o
-obj-$(CONFIG_X86_ES7000)	+= es7000_32.o
 
 # For 32bit, probe_32 need to be listed last
 obj-$(CONFIG_X86_LOCAL_APIC)	+= probe_$(BITS).o
* Unmerged path arch/x86/kernel/apic/es7000_32.c
