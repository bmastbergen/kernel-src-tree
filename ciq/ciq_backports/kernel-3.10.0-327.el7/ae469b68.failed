cxgb4: Fix to dump devlog, even if FW is crashed

jira LE-1907
Rebuild_History Non-Buildable kernel-3.10.0-327.el7
commit-author Hariprasad Shenai <hariprasad@chelsio.com>
commit ae469b68a557d1bd538c9122eaf99cf09fc242f2
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-3.10.0-327.el7/ae469b68.failed

Add new Common Code routines to retrieve Firmware Device Log
parameters from PCIE_FW_PF[7]. The firmware initializes its Device Log very
early on and stores the parameters for its location/size in that register.
Using the parameters from the register allows us to access the Firmware
Device Log even when the firmware crashes very early on or we're not
attached to the firmware

Based on original work by Casey Leedom <leedom@chelsio.com>

	Signed-off-by: Hariprasad Shenai <hariprasad@chelsio.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit ae469b68a557d1bd538c9122eaf99cf09fc242f2)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/chelsio/cxgb4/cxgb4.h
#	drivers/net/ethernet/chelsio/cxgb4/t4_regs.h
diff --cc drivers/net/ethernet/chelsio/cxgb4/cxgb4.h
index dddf17cba9bf,c6ff4890d171..000000000000
--- a/drivers/net/ethernet/chelsio/cxgb4/cxgb4.h
+++ b/drivers/net/ethernet/chelsio/cxgb4/cxgb4.h
@@@ -1002,6 -1134,10 +1002,13 @@@ int t4_bar2_sge_qregs(struct adapter *a
  		      u64 *pbar2_qoffset,
  		      unsigned int *pbar2_qid);
  
++<<<<<<< HEAD
++=======
+ unsigned int qtimer_val(const struct adapter *adap,
+ 			const struct sge_rspq *q);
+ 
+ int t4_init_devlog_params(struct adapter *adapter);
++>>>>>>> ae469b68a557 (cxgb4: Fix to dump devlog, even if FW is crashed)
  int t4_init_sge_params(struct adapter *adapter);
  int t4_init_tp_params(struct adapter *adap);
  int t4_filter_field_shift(const struct adapter *adap, int filter_sel);
diff --cc drivers/net/ethernet/chelsio/cxgb4/t4_regs.h
index ca17cd6178d0,326674b19983..000000000000
--- a/drivers/net/ethernet/chelsio/cxgb4/t4_regs.h
+++ b/drivers/net/ethernet/chelsio/cxgb4/t4_regs.h
@@@ -63,583 -63,1148 +63,1359 @@@
  #define MC_BIST_STATUS_REG(reg_addr, idx) ((reg_addr) + (idx) * 4)
  #define EDC_BIST_STATUS_REG(reg_addr, idx) ((reg_addr) + (idx) * 4)
  
++<<<<<<< HEAD
 +#define SGE_PF_KDOORBELL 0x0
 +#define  QID_MASK    0xffff8000U
 +#define  QID_SHIFT   15
 +#define  QID(x)      ((x) << QID_SHIFT)
 +#define  DBPRIO(x)   ((x) << 14)
 +#define  DBTYPE(x)   ((x) << 13)
 +#define  PIDX_MASK   0x00003fffU
 +#define  PIDX_SHIFT  0
 +#define  PIDX(x)     ((x) << PIDX_SHIFT)
 +#define  PIDX_SHIFT_T5   0
 +#define  PIDX_T5(x)  ((x) << PIDX_SHIFT_T5)
++=======
+ #define PCIE_FW_REG(reg_addr, idx) ((reg_addr) + (idx) * 4)
+ 
+ #define SGE_PF_KDOORBELL_A 0x0
 -
 -#define QID_S    15
 -#define QID_V(x) ((x) << QID_S)
 -
 -#define DBPRIO_S    14
 -#define DBPRIO_V(x) ((x) << DBPRIO_S)
 -#define DBPRIO_F    DBPRIO_V(1U)
 -
 -#define PIDX_S    0
 -#define PIDX_V(x) ((x) << PIDX_S)
 -
 -#define SGE_VF_KDOORBELL_A 0x0
 -
 -#define DBTYPE_S    13
 -#define DBTYPE_V(x) ((x) << DBTYPE_S)
 -#define DBTYPE_F    DBTYPE_V(1U)
 -
 -#define PIDX_T5_S    0
 -#define PIDX_T5_M    0x1fffU
 -#define PIDX_T5_V(x) ((x) << PIDX_T5_S)
 -#define PIDX_T5_G(x) (((x) >> PIDX_T5_S) & PIDX_T5_M)
 -
 -#define SGE_PF_GTS_A 0x4
 -
 -#define INGRESSQID_S    16
 -#define INGRESSQID_V(x) ((x) << INGRESSQID_S)
 -
 -#define TIMERREG_S    13
 -#define TIMERREG_V(x) ((x) << TIMERREG_S)
 -
 -#define SEINTARM_S    12
 -#define SEINTARM_V(x) ((x) << SEINTARM_S)
 -
 -#define CIDXINC_S    0
 -#define CIDXINC_M    0xfffU
 -#define CIDXINC_V(x) ((x) << CIDXINC_S)
 -
 -#define SGE_CONTROL_A	0x1008
 -#define SGE_CONTROL2_A	0x1124
 -
 -#define RXPKTCPLMODE_S    18
 -#define RXPKTCPLMODE_V(x) ((x) << RXPKTCPLMODE_S)
 -#define RXPKTCPLMODE_F    RXPKTCPLMODE_V(1U)
 -
 -#define EGRSTATUSPAGESIZE_S    17
 -#define EGRSTATUSPAGESIZE_V(x) ((x) << EGRSTATUSPAGESIZE_S)
 -#define EGRSTATUSPAGESIZE_F    EGRSTATUSPAGESIZE_V(1U)
 -
 -#define PKTSHIFT_S    10
 -#define PKTSHIFT_M    0x7U
 -#define PKTSHIFT_V(x) ((x) << PKTSHIFT_S)
 -#define PKTSHIFT_G(x) (((x) >> PKTSHIFT_S) & PKTSHIFT_M)
 -
 -#define INGPCIEBOUNDARY_S    7
 -#define INGPCIEBOUNDARY_V(x) ((x) << INGPCIEBOUNDARY_S)
 -
 -#define INGPADBOUNDARY_S    4
 -#define INGPADBOUNDARY_M    0x7U
 -#define INGPADBOUNDARY_V(x) ((x) << INGPADBOUNDARY_S)
 -#define INGPADBOUNDARY_G(x) (((x) >> INGPADBOUNDARY_S) & INGPADBOUNDARY_M)
 -
 -#define EGRPCIEBOUNDARY_S    1
 -#define EGRPCIEBOUNDARY_V(x) ((x) << EGRPCIEBOUNDARY_S)
++>>>>>>> ae469b68a557 (cxgb4: Fix to dump devlog, even if FW is crashed)
 +
 +
 +#define SGE_TIMERREGS	6
 +#define SGE_PF_GTS 0x4
 +#define  INGRESSQID_MASK   0xffff0000U
 +#define  INGRESSQID_SHIFT  16
 +#define  INGRESSQID(x)     ((x) << INGRESSQID_SHIFT)
 +#define  TIMERREG_MASK     0x0000e000U
 +#define  TIMERREG_SHIFT    13
 +#define  TIMERREG(x)       ((x) << TIMERREG_SHIFT)
 +#define  SEINTARM_MASK     0x00001000U
 +#define  SEINTARM_SHIFT    12
 +#define  SEINTARM(x)       ((x) << SEINTARM_SHIFT)
 +#define  CIDXINC_MASK      0x00000fffU
 +#define  CIDXINC_SHIFT     0
 +#define  CIDXINC(x)        ((x) << CIDXINC_SHIFT)
 +
 +#define X_RXPKTCPLMODE_SPLIT     1
 +#define X_INGPADBOUNDARY_SHIFT 5
 +
 +#define SGE_CONTROL 0x1008
 +#define SGE_CONTROL2_A		0x1124
 +#define  DCASYSTYPE             0x00080000U
 +#define  RXPKTCPLMODE_MASK      0x00040000U
 +#define  RXPKTCPLMODE_SHIFT     18
 +#define  RXPKTCPLMODE(x)        ((x) << RXPKTCPLMODE_SHIFT)
 +#define  EGRSTATUSPAGESIZE_MASK  0x00020000U
 +#define  EGRSTATUSPAGESIZE_SHIFT 17
 +#define  EGRSTATUSPAGESIZE(x)    ((x) << EGRSTATUSPAGESIZE_SHIFT)
 +#define  PKTSHIFT_MASK          0x00001c00U
 +#define  PKTSHIFT_SHIFT         10
 +#define  PKTSHIFT(x)            ((x) << PKTSHIFT_SHIFT)
 +#define  PKTSHIFT_GET(x)	(((x) & PKTSHIFT_MASK) >> PKTSHIFT_SHIFT)
 +#define  INGPCIEBOUNDARY_32B_X	0
 +#define  INGPCIEBOUNDARY_MASK   0x00000380U
 +#define  INGPCIEBOUNDARY_SHIFT  7
 +#define  INGPCIEBOUNDARY(x)     ((x) << INGPCIEBOUNDARY_SHIFT)
 +#define  INGPADBOUNDARY_MASK    0x00000070U
 +#define  INGPADBOUNDARY_SHIFT   4
 +#define  INGPADBOUNDARY(x)      ((x) << INGPADBOUNDARY_SHIFT)
 +#define  INGPADBOUNDARY_GET(x)	(((x) & INGPADBOUNDARY_MASK) \
 +				 >> INGPADBOUNDARY_SHIFT)
 +#define  INGPACKBOUNDARY_16B_X	0
 +#define  INGPACKBOUNDARY_SHIFT_X 5
  
  #define  INGPACKBOUNDARY_S	16
  #define  INGPACKBOUNDARY_M	0x7U
  #define  INGPACKBOUNDARY_V(x)	((x) << INGPACKBOUNDARY_S)
  #define  INGPACKBOUNDARY_G(x)	(((x) >> INGPACKBOUNDARY_S) \
  				 & INGPACKBOUNDARY_M)
 +#define  EGRPCIEBOUNDARY_MASK   0x0000000eU
 +#define  EGRPCIEBOUNDARY_SHIFT  1
 +#define  EGRPCIEBOUNDARY(x)     ((x) << EGRPCIEBOUNDARY_SHIFT)
 +#define  GLOBALENABLE           0x00000001U
  
 -#define GLOBALENABLE_S    0
 -#define GLOBALENABLE_V(x) ((x) << GLOBALENABLE_S)
 -#define GLOBALENABLE_F    GLOBALENABLE_V(1U)
 -
 -#define SGE_HOST_PAGE_SIZE_A 0x100c
 -
 -#define HOSTPAGESIZEPF7_S    28
 -#define HOSTPAGESIZEPF7_M    0xfU
 -#define HOSTPAGESIZEPF7_V(x) ((x) << HOSTPAGESIZEPF7_S)
 -#define HOSTPAGESIZEPF7_G(x) (((x) >> HOSTPAGESIZEPF7_S) & HOSTPAGESIZEPF7_M)
 -
 -#define HOSTPAGESIZEPF6_S    24
 -#define HOSTPAGESIZEPF6_M    0xfU
 -#define HOSTPAGESIZEPF6_V(x) ((x) << HOSTPAGESIZEPF6_S)
 -#define HOSTPAGESIZEPF6_G(x) (((x) >> HOSTPAGESIZEPF6_S) & HOSTPAGESIZEPF6_M)
 -
 -#define HOSTPAGESIZEPF5_S    20
 -#define HOSTPAGESIZEPF5_M    0xfU
 -#define HOSTPAGESIZEPF5_V(x) ((x) << HOSTPAGESIZEPF5_S)
 -#define HOSTPAGESIZEPF5_G(x) (((x) >> HOSTPAGESIZEPF5_S) & HOSTPAGESIZEPF5_M)
 -
 -#define HOSTPAGESIZEPF4_S    16
 -#define HOSTPAGESIZEPF4_M    0xfU
 -#define HOSTPAGESIZEPF4_V(x) ((x) << HOSTPAGESIZEPF4_S)
 -#define HOSTPAGESIZEPF4_G(x) (((x) >> HOSTPAGESIZEPF4_S) & HOSTPAGESIZEPF4_M)
 -
 -#define HOSTPAGESIZEPF3_S    12
 -#define HOSTPAGESIZEPF3_M    0xfU
 -#define HOSTPAGESIZEPF3_V(x) ((x) << HOSTPAGESIZEPF3_S)
 -#define HOSTPAGESIZEPF3_G(x) (((x) >> HOSTPAGESIZEPF3_S) & HOSTPAGESIZEPF3_M)
 -
 -#define HOSTPAGESIZEPF2_S    8
 -#define HOSTPAGESIZEPF2_M    0xfU
 -#define HOSTPAGESIZEPF2_V(x) ((x) << HOSTPAGESIZEPF2_S)
 -#define HOSTPAGESIZEPF2_G(x) (((x) >> HOSTPAGESIZEPF2_S) & HOSTPAGESIZEPF2_M)
 -
 -#define HOSTPAGESIZEPF1_S    4
 -#define HOSTPAGESIZEPF1_M    0xfU
 -#define HOSTPAGESIZEPF1_V(x) ((x) << HOSTPAGESIZEPF1_S)
 -#define HOSTPAGESIZEPF1_G(x) (((x) >> HOSTPAGESIZEPF1_S) & HOSTPAGESIZEPF1_M)
 -
 -#define HOSTPAGESIZEPF0_S    0
 -#define HOSTPAGESIZEPF0_M    0xfU
 -#define HOSTPAGESIZEPF0_V(x) ((x) << HOSTPAGESIZEPF0_S)
 -#define HOSTPAGESIZEPF0_G(x) (((x) >> HOSTPAGESIZEPF0_S) & HOSTPAGESIZEPF0_M)
 -
 -#define SGE_EGRESS_QUEUES_PER_PAGE_PF_A 0x1010
 -#define SGE_EGRESS_QUEUES_PER_PAGE_VF_A 0x1014
 +#define SGE_HOST_PAGE_SIZE 0x100c
  
 -#define QUEUESPERPAGEPF1_S    4
 +#define  HOSTPAGESIZEPF7_MASK   0x0000000fU
 +#define  HOSTPAGESIZEPF7_SHIFT  28
 +#define  HOSTPAGESIZEPF7(x)     ((x) << HOSTPAGESIZEPF7_SHIFT)
  
 -#define QUEUESPERPAGEPF0_S    0
 -#define QUEUESPERPAGEPF0_M    0xfU
 -#define QUEUESPERPAGEPF0_V(x) ((x) << QUEUESPERPAGEPF0_S)
 -#define QUEUESPERPAGEPF0_G(x) (((x) >> QUEUESPERPAGEPF0_S) & QUEUESPERPAGEPF0_M)
 +#define  HOSTPAGESIZEPF6_MASK   0x0000000fU
 +#define  HOSTPAGESIZEPF6_SHIFT  24
 +#define  HOSTPAGESIZEPF6(x)     ((x) << HOSTPAGESIZEPF6_SHIFT)
  
 -#define SGE_INT_CAUSE1_A	0x1024
 -#define SGE_INT_CAUSE2_A	0x1030
 -#define SGE_INT_CAUSE3_A	0x103c
 -
 -#define ERR_FLM_DBP_S    31
 -#define ERR_FLM_DBP_V(x) ((x) << ERR_FLM_DBP_S)
 -#define ERR_FLM_DBP_F    ERR_FLM_DBP_V(1U)
 -
 -#define ERR_FLM_IDMA1_S    30
 -#define ERR_FLM_IDMA1_V(x) ((x) << ERR_FLM_IDMA1_S)
 -#define ERR_FLM_IDMA1_F    ERR_FLM_IDMA1_V(1U)
 -
 -#define ERR_FLM_IDMA0_S    29
 -#define ERR_FLM_IDMA0_V(x) ((x) << ERR_FLM_IDMA0_S)
 -#define ERR_FLM_IDMA0_F    ERR_FLM_IDMA0_V(1U)
 -
 -#define ERR_FLM_HINT_S    28
 -#define ERR_FLM_HINT_V(x) ((x) << ERR_FLM_HINT_S)
 -#define ERR_FLM_HINT_F    ERR_FLM_HINT_V(1U)
 -
 -#define ERR_PCIE_ERROR3_S    27
 -#define ERR_PCIE_ERROR3_V(x) ((x) << ERR_PCIE_ERROR3_S)
 -#define ERR_PCIE_ERROR3_F    ERR_PCIE_ERROR3_V(1U)
 -
 -#define ERR_PCIE_ERROR2_S    26
 -#define ERR_PCIE_ERROR2_V(x) ((x) << ERR_PCIE_ERROR2_S)
 -#define ERR_PCIE_ERROR2_F    ERR_PCIE_ERROR2_V(1U)
 -
 -#define ERR_PCIE_ERROR1_S    25
 -#define ERR_PCIE_ERROR1_V(x) ((x) << ERR_PCIE_ERROR1_S)
 -#define ERR_PCIE_ERROR1_F    ERR_PCIE_ERROR1_V(1U)
 -
 -#define ERR_PCIE_ERROR0_S    24
 -#define ERR_PCIE_ERROR0_V(x) ((x) << ERR_PCIE_ERROR0_S)
 -#define ERR_PCIE_ERROR0_F    ERR_PCIE_ERROR0_V(1U)
 -
 -#define ERR_CPL_EXCEED_IQE_SIZE_S    22
 -#define ERR_CPL_EXCEED_IQE_SIZE_V(x) ((x) << ERR_CPL_EXCEED_IQE_SIZE_S)
 -#define ERR_CPL_EXCEED_IQE_SIZE_F    ERR_CPL_EXCEED_IQE_SIZE_V(1U)
 -
 -#define ERR_INVALID_CIDX_INC_S    21
 -#define ERR_INVALID_CIDX_INC_V(x) ((x) << ERR_INVALID_CIDX_INC_S)
 -#define ERR_INVALID_CIDX_INC_F    ERR_INVALID_CIDX_INC_V(1U)
 -
 -#define ERR_CPL_OPCODE_0_S    19
 -#define ERR_CPL_OPCODE_0_V(x) ((x) << ERR_CPL_OPCODE_0_S)
 -#define ERR_CPL_OPCODE_0_F    ERR_CPL_OPCODE_0_V(1U)
 -
 -#define ERR_DROPPED_DB_S    18
 -#define ERR_DROPPED_DB_V(x) ((x) << ERR_DROPPED_DB_S)
 -#define ERR_DROPPED_DB_F    ERR_DROPPED_DB_V(1U)
 -
 -#define ERR_DATA_CPL_ON_HIGH_QID1_S    17
 -#define ERR_DATA_CPL_ON_HIGH_QID1_V(x) ((x) << ERR_DATA_CPL_ON_HIGH_QID1_S)
 -#define ERR_DATA_CPL_ON_HIGH_QID1_F    ERR_DATA_CPL_ON_HIGH_QID1_V(1U)
 -
 -#define ERR_DATA_CPL_ON_HIGH_QID0_S    16
 -#define ERR_DATA_CPL_ON_HIGH_QID0_V(x) ((x) << ERR_DATA_CPL_ON_HIGH_QID0_S)
 -#define ERR_DATA_CPL_ON_HIGH_QID0_F    ERR_DATA_CPL_ON_HIGH_QID0_V(1U)
 -
 -#define ERR_BAD_DB_PIDX3_S    15
 -#define ERR_BAD_DB_PIDX3_V(x) ((x) << ERR_BAD_DB_PIDX3_S)
 -#define ERR_BAD_DB_PIDX3_F    ERR_BAD_DB_PIDX3_V(1U)
 -
 -#define ERR_BAD_DB_PIDX2_S    14
 -#define ERR_BAD_DB_PIDX2_V(x) ((x) << ERR_BAD_DB_PIDX2_S)
 -#define ERR_BAD_DB_PIDX2_F    ERR_BAD_DB_PIDX2_V(1U)
 -
 -#define ERR_BAD_DB_PIDX1_S    13
 -#define ERR_BAD_DB_PIDX1_V(x) ((x) << ERR_BAD_DB_PIDX1_S)
 -#define ERR_BAD_DB_PIDX1_F    ERR_BAD_DB_PIDX1_V(1U)
 -
 -#define ERR_BAD_DB_PIDX0_S    12
 -#define ERR_BAD_DB_PIDX0_V(x) ((x) << ERR_BAD_DB_PIDX0_S)
 -#define ERR_BAD_DB_PIDX0_F    ERR_BAD_DB_PIDX0_V(1U)
 -
 -#define ERR_ING_CTXT_PRIO_S    10
 -#define ERR_ING_CTXT_PRIO_V(x) ((x) << ERR_ING_CTXT_PRIO_S)
 -#define ERR_ING_CTXT_PRIO_F    ERR_ING_CTXT_PRIO_V(1U)
 -
 -#define ERR_EGR_CTXT_PRIO_S    9
 -#define ERR_EGR_CTXT_PRIO_V(x) ((x) << ERR_EGR_CTXT_PRIO_S)
 -#define ERR_EGR_CTXT_PRIO_F    ERR_EGR_CTXT_PRIO_V(1U)
 -
 -#define DBFIFO_HP_INT_S    8
 -#define DBFIFO_HP_INT_V(x) ((x) << DBFIFO_HP_INT_S)
 -#define DBFIFO_HP_INT_F    DBFIFO_HP_INT_V(1U)
 -
 -#define DBFIFO_LP_INT_S    7
 -#define DBFIFO_LP_INT_V(x) ((x) << DBFIFO_LP_INT_S)
 -#define DBFIFO_LP_INT_F    DBFIFO_LP_INT_V(1U)
 -
 -#define INGRESS_SIZE_ERR_S    5
 -#define INGRESS_SIZE_ERR_V(x) ((x) << INGRESS_SIZE_ERR_S)
 -#define INGRESS_SIZE_ERR_F    INGRESS_SIZE_ERR_V(1U)
 -
 -#define EGRESS_SIZE_ERR_S    4
 -#define EGRESS_SIZE_ERR_V(x) ((x) << EGRESS_SIZE_ERR_S)
 -#define EGRESS_SIZE_ERR_F    EGRESS_SIZE_ERR_V(1U)
 -
 -#define SGE_INT_ENABLE3_A 0x1040
 -#define SGE_FL_BUFFER_SIZE0_A 0x1044
 -#define SGE_FL_BUFFER_SIZE1_A 0x1048
 -#define SGE_FL_BUFFER_SIZE2_A 0x104c
 -#define SGE_FL_BUFFER_SIZE3_A 0x1050
 -#define SGE_FL_BUFFER_SIZE4_A 0x1054
 -#define SGE_FL_BUFFER_SIZE5_A 0x1058
 -#define SGE_FL_BUFFER_SIZE6_A 0x105c
 -#define SGE_FL_BUFFER_SIZE7_A 0x1060
 -#define SGE_FL_BUFFER_SIZE8_A 0x1064
 -
 -#define SGE_INGRESS_RX_THRESHOLD_A 0x10a0
 -
 -#define THRESHOLD_0_S    24
 -#define THRESHOLD_0_M    0x3fU
 -#define THRESHOLD_0_V(x) ((x) << THRESHOLD_0_S)
 -#define THRESHOLD_0_G(x) (((x) >> THRESHOLD_0_S) & THRESHOLD_0_M)
 -
 -#define THRESHOLD_1_S    16
 -#define THRESHOLD_1_M    0x3fU
 -#define THRESHOLD_1_V(x) ((x) << THRESHOLD_1_S)
 -#define THRESHOLD_1_G(x) (((x) >> THRESHOLD_1_S) & THRESHOLD_1_M)
 -
 -#define THRESHOLD_2_S    8
 -#define THRESHOLD_2_M    0x3fU
 -#define THRESHOLD_2_V(x) ((x) << THRESHOLD_2_S)
 -#define THRESHOLD_2_G(x) (((x) >> THRESHOLD_2_S) & THRESHOLD_2_M)
 -
 -#define THRESHOLD_3_S    0
 -#define THRESHOLD_3_M    0x3fU
 -#define THRESHOLD_3_V(x) ((x) << THRESHOLD_3_S)
 -#define THRESHOLD_3_G(x) (((x) >> THRESHOLD_3_S) & THRESHOLD_3_M)
 -
 -#define SGE_CONM_CTRL_A 0x1094
 -
 -#define EGRTHRESHOLD_S    8
 -#define EGRTHRESHOLD_M    0x3fU
 -#define EGRTHRESHOLD_V(x) ((x) << EGRTHRESHOLD_S)
 -#define EGRTHRESHOLD_G(x) (((x) >> EGRTHRESHOLD_S) & EGRTHRESHOLD_M)
 -
 -#define EGRTHRESHOLDPACKING_S    14
 -#define EGRTHRESHOLDPACKING_M    0x3fU
 -#define EGRTHRESHOLDPACKING_V(x) ((x) << EGRTHRESHOLDPACKING_S)
 -#define EGRTHRESHOLDPACKING_G(x) \
 -	(((x) >> EGRTHRESHOLDPACKING_S) & EGRTHRESHOLDPACKING_M)
 -
 -#define SGE_TIMESTAMP_LO_A 0x1098
 -#define SGE_TIMESTAMP_HI_A 0x109c
 -
 -#define TSOP_S    28
 -#define TSOP_M    0x3U
 -#define TSOP_V(x) ((x) << TSOP_S)
 -#define TSOP_G(x) (((x) >> TSOP_S) & TSOP_M)
 -
 -#define TSVAL_S    0
 -#define TSVAL_M    0xfffffffU
 -#define TSVAL_V(x) ((x) << TSVAL_S)
 -#define TSVAL_G(x) (((x) >> TSVAL_S) & TSVAL_M)
 -
 -#define SGE_DBFIFO_STATUS_A 0x10a4
 +#define  HOSTPAGESIZEPF5_MASK   0x0000000fU
 +#define  HOSTPAGESIZEPF5_SHIFT  20
 +#define  HOSTPAGESIZEPF5(x)     ((x) << HOSTPAGESIZEPF5_SHIFT)
  
 -#define HP_INT_THRESH_S    28
 -#define HP_INT_THRESH_M    0xfU
 -#define HP_INT_THRESH_V(x) ((x) << HP_INT_THRESH_S)
 +#define  HOSTPAGESIZEPF4_MASK   0x0000000fU
 +#define  HOSTPAGESIZEPF4_SHIFT  16
 +#define  HOSTPAGESIZEPF4(x)     ((x) << HOSTPAGESIZEPF4_SHIFT)
  
 -#define LP_INT_THRESH_S    12
 -#define LP_INT_THRESH_M    0xfU
 -#define LP_INT_THRESH_V(x) ((x) << LP_INT_THRESH_S)
 +#define  HOSTPAGESIZEPF3_MASK   0x0000000fU
 +#define  HOSTPAGESIZEPF3_SHIFT  12
 +#define  HOSTPAGESIZEPF3(x)     ((x) << HOSTPAGESIZEPF3_SHIFT)
  
 -#define SGE_DOORBELL_CONTROL_A 0x10a8
 +#define  HOSTPAGESIZEPF2_MASK   0x0000000fU
 +#define  HOSTPAGESIZEPF2_SHIFT  8
 +#define  HOSTPAGESIZEPF2(x)     ((x) << HOSTPAGESIZEPF2_SHIFT)
  
 -#define NOCOALESCE_S    26
 -#define NOCOALESCE_V(x) ((x) << NOCOALESCE_S)
 -#define NOCOALESCE_F    NOCOALESCE_V(1U)
 +#define  HOSTPAGESIZEPF1_M	0x0000000fU
 +#define  HOSTPAGESIZEPF1_S	4
 +#define  HOSTPAGESIZEPF1(x)     ((x) << HOSTPAGESIZEPF1_S)
  
 -#define ENABLE_DROP_S    13
 -#define ENABLE_DROP_V(x) ((x) << ENABLE_DROP_S)
 -#define ENABLE_DROP_F    ENABLE_DROP_V(1U)
 +#define  HOSTPAGESIZEPF0_M	0x0000000fU
 +#define  HOSTPAGESIZEPF0_S	0
 +#define  HOSTPAGESIZEPF0(x)     ((x) << HOSTPAGESIZEPF0_S)
  
 -#define SGE_TIMER_VALUE_0_AND_1_A 0x10b8
 -
 -#define TIMERVALUE0_S    16
 -#define TIMERVALUE0_M    0xffffU
 -#define TIMERVALUE0_V(x) ((x) << TIMERVALUE0_S)
 -#define TIMERVALUE0_G(x) (((x) >> TIMERVALUE0_S) & TIMERVALUE0_M)
 -
 -#define TIMERVALUE1_S    0
 -#define TIMERVALUE1_M    0xffffU
 -#define TIMERVALUE1_V(x) ((x) << TIMERVALUE1_S)
 -#define TIMERVALUE1_G(x) (((x) >> TIMERVALUE1_S) & TIMERVALUE1_M)
 -
 -#define SGE_TIMER_VALUE_2_AND_3_A 0x10bc
 -
 -#define TIMERVALUE2_S    16
 -#define TIMERVALUE2_M    0xffffU
 -#define TIMERVALUE2_V(x) ((x) << TIMERVALUE2_S)
 -#define TIMERVALUE2_G(x) (((x) >> TIMERVALUE2_S) & TIMERVALUE2_M)
 -
 -#define TIMERVALUE3_S    0
 -#define TIMERVALUE3_M    0xffffU
 -#define TIMERVALUE3_V(x) ((x) << TIMERVALUE3_S)
 -#define TIMERVALUE3_G(x) (((x) >> TIMERVALUE3_S) & TIMERVALUE3_M)
 -
 -#define SGE_TIMER_VALUE_4_AND_5_A 0x10c0
 -
 -#define TIMERVALUE4_S    16
 -#define TIMERVALUE4_M    0xffffU
 -#define TIMERVALUE4_V(x) ((x) << TIMERVALUE4_S)
 -#define TIMERVALUE4_G(x) (((x) >> TIMERVALUE4_S) & TIMERVALUE4_M)
 +#define SGE_EGRESS_QUEUES_PER_PAGE_PF 0x1010
 +#define SGE_EGRESS_QUEUES_PER_PAGE_VF_A 0x1014
  
 -#define TIMERVALUE5_S    0
 -#define TIMERVALUE5_M    0xffffU
 -#define TIMERVALUE5_V(x) ((x) << TIMERVALUE5_S)
 -#define TIMERVALUE5_G(x) (((x) >> TIMERVALUE5_S) & TIMERVALUE5_M)
 +#define QUEUESPERPAGEPF1_S    4
  
 -#define SGE_DEBUG_INDEX_A 0x10cc
 -#define SGE_DEBUG_DATA_HIGH_A 0x10d0
 -#define SGE_DEBUG_DATA_LOW_A 0x10d4
 +#define QUEUESPERPAGEPF0_S    0
 +#define QUEUESPERPAGEPF0_MASK   0x0000000fU
 +#define QUEUESPERPAGEPF0_GET(x) ((x) & QUEUESPERPAGEPF0_MASK)
  
 -#define SGE_DEBUG_DATA_LOW_INDEX_2_A	0x12c8
 -#define SGE_DEBUG_DATA_LOW_INDEX_3_A	0x12cc
 -#define SGE_DEBUG_DATA_HIGH_INDEX_10_A	0x12a8
 +#define QUEUESPERPAGEPF0    0
 +#define QUEUESPERPAGEPF1    4
  
 -#define SGE_INGRESS_QUEUES_PER_PAGE_PF_A 0x10f4
 +/* T5 and later support a new BAR2-based doorbell mechanism for Egress Queues.
 + * The User Doorbells are each 128 bytes in length with a Simple Doorbell at
 + * offsets 8x and a Write Combining single 64-byte Egress Queue Unit
 + * (X_IDXSIZE_UNIT) Gather Buffer interface at offset 64.  For Ingress Queues,
 + * we have a Going To Sleep register at offsets 8x+4.
 + *
 + * As noted above, we have many instances of the Simple Doorbell and Going To
 + * Sleep registers at offsets 8x and 8x+4, respectively.  We want to use a
 + * non-64-byte aligned offset for the Simple Doorbell in order to attempt to
 + * avoid buffering of the writes to the Simple Doorbell and we want to use a
 + * non-contiguous offset for the Going To Sleep writes in order to avoid
 + * possible combining between them.
 + */
 +#define SGE_UDB_SIZE            128
 +#define SGE_UDB_KDOORBELL       8
 +#define SGE_UDB_GTS             20
 +#define SGE_UDB_WCDOORBELL      64
 +
 +#define SGE_INT_CAUSE1 0x1024
 +#define SGE_INT_CAUSE2 0x1030
 +#define SGE_INT_CAUSE3 0x103c
 +#define  ERR_FLM_DBP               0x80000000U
 +#define  ERR_FLM_IDMA1             0x40000000U
 +#define  ERR_FLM_IDMA0             0x20000000U
 +#define  ERR_FLM_HINT              0x10000000U
 +#define  ERR_PCIE_ERROR3           0x08000000U
 +#define  ERR_PCIE_ERROR2           0x04000000U
 +#define  ERR_PCIE_ERROR1           0x02000000U
 +#define  ERR_PCIE_ERROR0           0x01000000U
 +#define  ERR_TIMER_ABOVE_MAX_QID   0x00800000U
 +#define  ERR_CPL_EXCEED_IQE_SIZE   0x00400000U
 +#define  ERR_INVALID_CIDX_INC      0x00200000U
 +#define  ERR_ITP_TIME_PAUSED       0x00100000U
 +#define  ERR_CPL_OPCODE_0          0x00080000U
 +#define  ERR_DROPPED_DB            0x00040000U
 +#define  ERR_DATA_CPL_ON_HIGH_QID1 0x00020000U
 +#define  ERR_DATA_CPL_ON_HIGH_QID0 0x00010000U
 +#define  ERR_BAD_DB_PIDX3          0x00008000U
 +#define  ERR_BAD_DB_PIDX2          0x00004000U
 +#define  ERR_BAD_DB_PIDX1          0x00002000U
 +#define  ERR_BAD_DB_PIDX0          0x00001000U
 +#define  ERR_ING_PCIE_CHAN         0x00000800U
 +#define  ERR_ING_CTXT_PRIO         0x00000400U
 +#define  ERR_EGR_CTXT_PRIO         0x00000200U
 +#define  DBFIFO_HP_INT             0x00000100U
 +#define  DBFIFO_LP_INT             0x00000080U
 +#define  REG_ADDRESS_ERR           0x00000040U
 +#define  INGRESS_SIZE_ERR          0x00000020U
 +#define  EGRESS_SIZE_ERR           0x00000010U
 +#define  ERR_INV_CTXT3             0x00000008U
 +#define  ERR_INV_CTXT2             0x00000004U
 +#define  ERR_INV_CTXT1             0x00000002U
 +#define  ERR_INV_CTXT0             0x00000001U
 +
 +#define SGE_INT_ENABLE3 0x1040
 +#define SGE_FL_BUFFER_SIZE0 0x1044
 +#define SGE_FL_BUFFER_SIZE1 0x1048
 +#define SGE_FL_BUFFER_SIZE2 0x104c
 +#define SGE_FL_BUFFER_SIZE3 0x1050
 +#define SGE_FL_BUFFER_SIZE4 0x1054
 +#define SGE_FL_BUFFER_SIZE5 0x1058
 +#define SGE_FL_BUFFER_SIZE6 0x105c
 +#define SGE_FL_BUFFER_SIZE7 0x1060
 +#define SGE_FL_BUFFER_SIZE8 0x1064
 +
 +#define SGE_INGRESS_RX_THRESHOLD 0x10a0
 +#define  THRESHOLD_0_MASK   0x3f000000U
 +#define  THRESHOLD_0_SHIFT  24
 +#define  THRESHOLD_0(x)     ((x) << THRESHOLD_0_SHIFT)
 +#define  THRESHOLD_0_GET(x) (((x) & THRESHOLD_0_MASK) >> THRESHOLD_0_SHIFT)
 +#define  THRESHOLD_1_MASK   0x003f0000U
 +#define  THRESHOLD_1_SHIFT  16
 +#define  THRESHOLD_1(x)     ((x) << THRESHOLD_1_SHIFT)
 +#define  THRESHOLD_1_GET(x) (((x) & THRESHOLD_1_MASK) >> THRESHOLD_1_SHIFT)
 +#define  THRESHOLD_2_MASK   0x00003f00U
 +#define  THRESHOLD_2_SHIFT  8
 +#define  THRESHOLD_2(x)     ((x) << THRESHOLD_2_SHIFT)
 +#define  THRESHOLD_2_GET(x) (((x) & THRESHOLD_2_MASK) >> THRESHOLD_2_SHIFT)
 +#define  THRESHOLD_3_MASK   0x0000003fU
 +#define  THRESHOLD_3_SHIFT  0
 +#define  THRESHOLD_3(x)     ((x) << THRESHOLD_3_SHIFT)
 +#define  THRESHOLD_3_GET(x) (((x) & THRESHOLD_3_MASK) >> THRESHOLD_3_SHIFT)
 +
 +#define SGE_CONM_CTRL 0x1094
 +#define  EGRTHRESHOLD_MASK   0x00003f00U
 +#define  EGRTHRESHOLDshift   8
 +#define  EGRTHRESHOLD(x)     ((x) << EGRTHRESHOLDshift)
 +#define  EGRTHRESHOLD_GET(x) (((x) & EGRTHRESHOLD_MASK) >> EGRTHRESHOLDshift)
 +
 +#define EGRTHRESHOLDPACKING_MASK	0x3fU
 +#define EGRTHRESHOLDPACKING_SHIFT	14
 +#define EGRTHRESHOLDPACKING(x)		((x) << EGRTHRESHOLDPACKING_SHIFT)
 +#define EGRTHRESHOLDPACKING_GET(x)	(((x) >> EGRTHRESHOLDPACKING_SHIFT) & \
 +					  EGRTHRESHOLDPACKING_MASK)
 +
 +#define SGE_DBFIFO_STATUS 0x10a4
 +#define  HP_INT_THRESH_SHIFT 28
 +#define  HP_INT_THRESH_MASK  0xfU
 +#define  HP_INT_THRESH(x)    ((x) << HP_INT_THRESH_SHIFT)
 +#define  LP_INT_THRESH_SHIFT 12
 +#define  LP_INT_THRESH_MASK  0xfU
 +#define  LP_INT_THRESH(x)    ((x) << LP_INT_THRESH_SHIFT)
 +
 +#define SGE_DOORBELL_CONTROL 0x10a8
 +#define  ENABLE_DROP        (1 << 13)
 +
 +#define S_NOCOALESCE    26
 +#define V_NOCOALESCE(x) ((x) << S_NOCOALESCE)
 +#define F_NOCOALESCE    V_NOCOALESCE(1U)
 +
 +#define SGE_TIMESTAMP_LO 0x1098
 +#define SGE_TIMESTAMP_HI 0x109c
 +#define S_TSVAL    0
 +#define M_TSVAL    0xfffffffU
 +#define GET_TSVAL(x) (((x) >> S_TSVAL) & M_TSVAL)
 +
 +#define SGE_TIMER_VALUE_0_AND_1 0x10b8
 +#define  TIMERVALUE0_MASK   0xffff0000U
 +#define  TIMERVALUE0_SHIFT  16
 +#define  TIMERVALUE0(x)     ((x) << TIMERVALUE0_SHIFT)
 +#define  TIMERVALUE0_GET(x) (((x) & TIMERVALUE0_MASK) >> TIMERVALUE0_SHIFT)
 +#define  TIMERVALUE1_MASK   0x0000ffffU
 +#define  TIMERVALUE1_SHIFT  0
 +#define  TIMERVALUE1(x)     ((x) << TIMERVALUE1_SHIFT)
 +#define  TIMERVALUE1_GET(x) (((x) & TIMERVALUE1_MASK) >> TIMERVALUE1_SHIFT)
 +
 +#define SGE_TIMER_VALUE_2_AND_3 0x10bc
 +#define  TIMERVALUE2_MASK   0xffff0000U
 +#define  TIMERVALUE2_SHIFT  16
 +#define  TIMERVALUE2(x)     ((x) << TIMERVALUE2_SHIFT)
 +#define  TIMERVALUE2_GET(x) (((x) & TIMERVALUE2_MASK) >> TIMERVALUE2_SHIFT)
 +#define  TIMERVALUE3_MASK   0x0000ffffU
 +#define  TIMERVALUE3_SHIFT  0
 +#define  TIMERVALUE3(x)     ((x) << TIMERVALUE3_SHIFT)
 +#define  TIMERVALUE3_GET(x) (((x) & TIMERVALUE3_MASK) >> TIMERVALUE3_SHIFT)
 +
 +#define SGE_TIMER_VALUE_4_AND_5 0x10c0
 +#define  TIMERVALUE4_MASK   0xffff0000U
 +#define  TIMERVALUE4_SHIFT  16
 +#define  TIMERVALUE4(x)     ((x) << TIMERVALUE4_SHIFT)
 +#define  TIMERVALUE4_GET(x) (((x) & TIMERVALUE4_MASK) >> TIMERVALUE4_SHIFT)
 +#define  TIMERVALUE5_MASK   0x0000ffffU
 +#define  TIMERVALUE5_SHIFT  0
 +#define  TIMERVALUE5(x)     ((x) << TIMERVALUE5_SHIFT)
 +#define  TIMERVALUE5_GET(x) (((x) & TIMERVALUE5_MASK) >> TIMERVALUE5_SHIFT)
 +
 +#define SGE_DEBUG_INDEX 0x10cc
 +#define SGE_DEBUG_DATA_HIGH 0x10d0
 +#define SGE_DEBUG_DATA_LOW 0x10d4
 +#define SGE_DEBUG_DATA_LOW_INDEX_2	0x12c8
 +#define SGE_DEBUG_DATA_LOW_INDEX_3	0x12cc
 +#define SGE_DEBUG_DATA_HIGH_INDEX_10	0x12a8
 +#define SGE_INGRESS_QUEUES_PER_PAGE_PF 0x10f4
  #define SGE_INGRESS_QUEUES_PER_PAGE_VF_A 0x10f8
  
++<<<<<<< HEAD
 +#define S_HP_INT_THRESH    28
 +#define M_HP_INT_THRESH 0xfU
 +#define V_HP_INT_THRESH(x) ((x) << S_HP_INT_THRESH)
 +#define S_LP_INT_THRESH_T5    18
 +#define V_LP_INT_THRESH_T5(x) ((x) << S_LP_INT_THRESH_T5)
 +#define M_LP_COUNT_T5    0x3ffffU
 +#define G_LP_COUNT_T5(x) (((x) >> S_LP_COUNT) & M_LP_COUNT_T5)
 +#define M_HP_COUNT 0x7ffU
 +#define S_HP_COUNT 16
 +#define G_HP_COUNT(x) (((x) >> S_HP_COUNT) & M_HP_COUNT)
 +#define S_LP_INT_THRESH    12
 +#define M_LP_INT_THRESH 0xfU
 +#define M_LP_INT_THRESH_T5    0xfffU
 +#define V_LP_INT_THRESH(x) ((x) << S_LP_INT_THRESH)
 +#define M_LP_COUNT 0x7ffU
 +#define S_LP_COUNT 0
 +#define G_LP_COUNT(x) (((x) >> S_LP_COUNT) & M_LP_COUNT)
 +#define A_SGE_DBFIFO_STATUS 0x10a4
 +
 +#define SGE_STAT_TOTAL 0x10e4
 +#define SGE_STAT_MATCH 0x10e8
 +
 +#define SGE_STAT_CFG   0x10ec
 +#define S_STATSOURCE_T5    9
 +#define STATSOURCE_T5(x) ((x) << S_STATSOURCE_T5)
 +
 +#define SGE_DBFIFO_STATUS2 0x1118
 +#define M_HP_COUNT_T5    0x3ffU
 +#define G_HP_COUNT_T5(x) ((x)  & M_HP_COUNT_T5)
 +#define S_HP_INT_THRESH_T5    10
 +#define M_HP_INT_THRESH_T5    0xfU
 +#define V_HP_INT_THRESH_T5(x) ((x) << S_HP_INT_THRESH_T5)
 +
 +#define S_ENABLE_DROP    13
 +#define V_ENABLE_DROP(x) ((x) << S_ENABLE_DROP)
 +#define F_ENABLE_DROP    V_ENABLE_DROP(1U)
 +#define S_DROPPED_DB 0
 +#define V_DROPPED_DB(x) ((x) << S_DROPPED_DB)
 +#define F_DROPPED_DB V_DROPPED_DB(1U)
 +#define A_SGE_DOORBELL_CONTROL 0x10a8
 +
 +#define A_SGE_CTXT_CMD 0x11fc
 +#define A_SGE_DBQ_CTXT_BADDR 0x1084
 +
 +#define PCIE_PF_CFG 0x40
 +#define  AIVEC(x)	((x) << 4)
 +#define  AIVEC_MASK	0x3ffU
 +
 +#define PCIE_PF_CLI 0x44
 +#define PCIE_INT_CAUSE 0x3004
 +#define  UNXSPLCPLERR  0x20000000U
 +#define  PCIEPINT      0x10000000U
 +#define  PCIESINT      0x08000000U
 +#define  RPLPERR       0x04000000U
 +#define  RXWRPERR      0x02000000U
 +#define  RXCPLPERR     0x01000000U
 +#define  PIOTAGPERR    0x00800000U
 +#define  MATAGPERR     0x00400000U
 +#define  INTXCLRPERR   0x00200000U
 +#define  FIDPERR       0x00100000U
 +#define  CFGSNPPERR    0x00080000U
 +#define  HRSPPERR      0x00040000U
 +#define  HREQPERR      0x00020000U
 +#define  HCNTPERR      0x00010000U
 +#define  DRSPPERR      0x00008000U
 +#define  DREQPERR      0x00004000U
 +#define  DCNTPERR      0x00002000U
 +#define  CRSPPERR      0x00001000U
 +#define  CREQPERR      0x00000800U
 +#define  CCNTPERR      0x00000400U
 +#define  TARTAGPERR    0x00000200U
 +#define  PIOREQPERR    0x00000100U
 +#define  PIOCPLPERR    0x00000080U
 +#define  MSIXDIPERR    0x00000040U
 +#define  MSIXDATAPERR  0x00000020U
 +#define  MSIXADDRHPERR 0x00000010U
 +#define  MSIXADDRLPERR 0x00000008U
 +#define  MSIDATAPERR   0x00000004U
 +#define  MSIADDRHPERR  0x00000002U
 +#define  MSIADDRLPERR  0x00000001U
 +
 +#define  READRSPERR      0x20000000U
 +#define  TRGT1GRPPERR    0x10000000U
 +#define  IPSOTPERR       0x08000000U
 +#define  IPRXDATAGRPPERR 0x02000000U
 +#define  IPRXHDRGRPPERR  0x01000000U
 +#define  MAGRPPERR       0x00400000U
 +#define  VFIDPERR        0x00200000U
 +#define  HREQWRPERR      0x00010000U
 +#define  DREQWRPERR      0x00002000U
 +#define  MSTTAGQPERR     0x00000400U
 +#define  PIOREQGRPPERR   0x00000100U
 +#define  PIOCPLGRPPERR   0x00000080U
 +#define  MSIXSTIPERR     0x00000004U
 +#define  MSTTIMEOUTPERR  0x00000002U
 +#define  MSTGRPPERR      0x00000001U
 +
 +#define PCIE_NONFAT_ERR 0x3010
 +#define PCIE_CFG_SPACE_REQ 0x3060
 +#define PCIE_CFG_SPACE_DATA 0x3064
 +#define PCIE_MEM_ACCESS_BASE_WIN 0x3068
 +#define S_PCIEOFST       10
 +#define M_PCIEOFST       0x3fffffU
 +#define GET_PCIEOFST(x)  (((x) >> S_PCIEOFST) & M_PCIEOFST)
 +#define  PCIEOFST_MASK   0xfffffc00U
 +#define  BIR_MASK        0x00000300U
 +#define  BIR_SHIFT       8
 +#define  BIR(x)          ((x) << BIR_SHIFT)
 +#define  WINDOW_MASK     0x000000ffU
 +#define  WINDOW_SHIFT    0
 +#define  WINDOW(x)       ((x) << WINDOW_SHIFT)
 +#define  GET_WINDOW(x)	 (((x) >> WINDOW_SHIFT) & WINDOW_MASK)
 +#define PCIE_MEM_ACCESS_OFFSET 0x306c
 +#define ENABLE	(1U << 30)
 +#define FUNCTION(x) ((x) << 12)
 +#define F_LOCALCFG    (1U << 28)
 +
 +#define S_PFNUM    0
 +#define V_PFNUM(x) ((x) << S_PFNUM)
 +
 +#define PCIE_FW 0x30b8
 +#define  PCIE_FW_ERR		0x80000000U
 +#define  PCIE_FW_INIT		0x40000000U
 +#define  PCIE_FW_HALT		0x20000000U
 +#define  PCIE_FW_MASTER_VLD	0x00008000U
 +#define  PCIE_FW_MASTER(x)	((x) << 12)
 +#define  PCIE_FW_MASTER_MASK	0x7
 +#define  PCIE_FW_MASTER_GET(x)	(((x) >> 12) & PCIE_FW_MASTER_MASK)
 +
 +#define PCIE_CORE_UTL_SYSTEM_BUS_AGENT_STATUS 0x5908
 +#define  RNPP 0x80000000U
 +#define  RPCP 0x20000000U
 +#define  RCIP 0x08000000U
 +#define  RCCP 0x04000000U
 +#define  RFTP 0x00800000U
 +#define  PTRP 0x00100000U
 +
 +#define PCIE_CORE_UTL_PCI_EXPRESS_PORT_STATUS 0x59a4
 +#define  TPCP 0x40000000U
 +#define  TNPP 0x20000000U
 +#define  TFTP 0x10000000U
 +#define  TCAP 0x08000000U
 +#define  TCIP 0x04000000U
 +#define  RCAP 0x02000000U
 +#define  PLUP 0x00800000U
 +#define  PLDN 0x00400000U
 +#define  OTDD 0x00200000U
 +#define  GTRP 0x00100000U
 +#define  RDPE 0x00040000U
 +#define  TDCE 0x00020000U
 +#define  TDUE 0x00010000U
 +
 +#define MC_INT_CAUSE 0x7518
 +#define MC_P_INT_CAUSE 0x41318
 +#define  ECC_UE_INT_CAUSE 0x00000004U
 +#define  ECC_CE_INT_CAUSE 0x00000002U
 +#define  PERR_INT_CAUSE   0x00000001U
 +
 +#define MC_ECC_STATUS 0x751c
 +#define MC_P_ECC_STATUS 0x4131c
 +#define  ECC_CECNT_MASK   0xffff0000U
 +#define  ECC_CECNT_SHIFT  16
 +#define  ECC_CECNT(x)     ((x) << ECC_CECNT_SHIFT)
 +#define  ECC_CECNT_GET(x) (((x) & ECC_CECNT_MASK) >> ECC_CECNT_SHIFT)
 +#define  ECC_UECNT_MASK   0x0000ffffU
 +#define  ECC_UECNT_SHIFT  0
 +#define  ECC_UECNT(x)     ((x) << ECC_UECNT_SHIFT)
 +#define  ECC_UECNT_GET(x) (((x) & ECC_UECNT_MASK) >> ECC_UECNT_SHIFT)
 +
 +#define MC_BIST_CMD 0x7600
 +#define  START_BIST          0x80000000U
 +#define  BIST_CMD_GAP_MASK   0x0000ff00U
 +#define  BIST_CMD_GAP_SHIFT  8
 +#define  BIST_CMD_GAP(x)     ((x) << BIST_CMD_GAP_SHIFT)
 +#define  BIST_OPCODE_MASK    0x00000003U
 +#define  BIST_OPCODE_SHIFT   0
 +#define  BIST_OPCODE(x)      ((x) << BIST_OPCODE_SHIFT)
 +
 +#define MC_BIST_CMD_ADDR 0x7604
 +#define MC_BIST_CMD_LEN 0x7608
 +#define MC_BIST_DATA_PATTERN 0x760c
 +#define  BIST_DATA_TYPE_MASK   0x0000000fU
 +#define  BIST_DATA_TYPE_SHIFT  0
 +#define  BIST_DATA_TYPE(x)     ((x) << BIST_DATA_TYPE_SHIFT)
 +
 +#define MC_BIST_STATUS_RDATA 0x7688
 +
 +#define MA_EDRAM0_BAR 0x77c0
 +#define MA_EDRAM1_BAR 0x77c4
 +#define EDRAM_SIZE_MASK   0xfffU
 +#define EDRAM_SIZE_GET(x) ((x) & EDRAM_SIZE_MASK)
 +
 +#define MA_EXT_MEMORY_BAR 0x77c8
 +#define  EXT_MEM_SIZE_MASK   0x00000fffU
 +#define  EXT_MEM_SIZE_SHIFT  0
 +#define  EXT_MEM_SIZE_GET(x) (((x) & EXT_MEM_SIZE_MASK) >> EXT_MEM_SIZE_SHIFT)
 +
 +#define MA_TARGET_MEM_ENABLE 0x77d8
 +#define  EXT_MEM1_ENABLE 0x00000010U
 +#define  EXT_MEM_ENABLE 0x00000004U
 +#define  EDRAM1_ENABLE  0x00000002U
 +#define  EDRAM0_ENABLE  0x00000001U
 +
 +#define MA_INT_CAUSE 0x77e0
 +#define  MEM_PERR_INT_CAUSE 0x00000002U
 +#define  MEM_WRAP_INT_CAUSE 0x00000001U
 +
 +#define MA_INT_WRAP_STATUS 0x77e4
 +#define  MEM_WRAP_ADDRESS_MASK   0xfffffff0U
 +#define  MEM_WRAP_ADDRESS_SHIFT  4
 +#define  MEM_WRAP_ADDRESS_GET(x) (((x) & MEM_WRAP_ADDRESS_MASK) >> MEM_WRAP_ADDRESS_SHIFT)
 +#define  MEM_WRAP_CLIENT_NUM_MASK   0x0000000fU
 +#define  MEM_WRAP_CLIENT_NUM_SHIFT  0
 +#define  MEM_WRAP_CLIENT_NUM_GET(x) (((x) & MEM_WRAP_CLIENT_NUM_MASK) >> MEM_WRAP_CLIENT_NUM_SHIFT)
 +#define MA_PCIE_FW 0x30b8
 +#define MA_PARITY_ERROR_STATUS 0x77f4
 +#define MA_PARITY_ERROR_STATUS2 0x7804
 +
 +#define MA_EXT_MEMORY1_BAR 0x7808
 +#define EDC_0_BASE_ADDR 0x7900
 +
 +#define EDC_BIST_CMD 0x7904
 +#define EDC_BIST_CMD_ADDR 0x7908
 +#define EDC_BIST_CMD_LEN 0x790c
 +#define EDC_BIST_DATA_PATTERN 0x7910
 +#define EDC_BIST_STATUS_RDATA 0x7928
 +#define EDC_INT_CAUSE 0x7978
 +#define  ECC_UE_PAR     0x00000020U
 +#define  ECC_CE_PAR     0x00000010U
 +#define  PERR_PAR_CAUSE 0x00000008U
 +
 +#define EDC_ECC_STATUS 0x797c
 +
 +#define EDC_1_BASE_ADDR 0x7980
 +
 +#define CIM_BOOT_CFG 0x7b00
 +#define  BOOTADDR_MASK 0xffffff00U
 +#define  UPCRST        0x1U
 +
 +#define CIM_PF_MAILBOX_DATA 0x240
 +#define CIM_PF_MAILBOX_CTRL 0x280
 +#define  MBMSGVALID     0x00000008U
 +#define  MBINTREQ       0x00000004U
 +#define  MBOWNER_MASK   0x00000003U
 +#define  MBOWNER_SHIFT  0
 +#define  MBOWNER(x)     ((x) << MBOWNER_SHIFT)
 +#define  MBOWNER_GET(x) (((x) & MBOWNER_MASK) >> MBOWNER_SHIFT)
 +
 +#define CIM_PF_HOST_INT_ENABLE 0x288
 +#define  MBMSGRDYINTEN(x) ((x) << 19)
 +
 +#define CIM_PF_HOST_INT_CAUSE 0x28c
 +#define  MBMSGRDYINT 0x00080000U
 +
 +#define CIM_HOST_INT_CAUSE 0x7b2c
 +#define  TIEQOUTPARERRINT  0x00100000U
 +#define  TIEQINPARERRINT   0x00080000U
 +#define  MBHOSTPARERR      0x00040000U
 +#define  MBUPPARERR        0x00020000U
 +#define  IBQPARERR         0x0001f800U
 +#define  IBQTP0PARERR      0x00010000U
 +#define  IBQTP1PARERR      0x00008000U
 +#define  IBQULPPARERR      0x00004000U
 +#define  IBQSGELOPARERR    0x00002000U
 +#define  IBQSGEHIPARERR    0x00001000U
 +#define  IBQNCSIPARERR     0x00000800U
 +#define  OBQPARERR         0x000007e0U
 +#define  OBQULP0PARERR     0x00000400U
 +#define  OBQULP1PARERR     0x00000200U
 +#define  OBQULP2PARERR     0x00000100U
 +#define  OBQULP3PARERR     0x00000080U
 +#define  OBQSGEPARERR      0x00000040U
 +#define  OBQNCSIPARERR     0x00000020U
 +#define  PREFDROPINT       0x00000002U
 +#define  UPACCNONZERO      0x00000001U
 +
 +#define CIM_HOST_UPACC_INT_CAUSE 0x7b34
 +#define  EEPROMWRINT      0x40000000U
 +#define  TIMEOUTMAINT     0x20000000U
 +#define  TIMEOUTINT       0x10000000U
 +#define  RSPOVRLOOKUPINT  0x08000000U
 +#define  REQOVRLOOKUPINT  0x04000000U
 +#define  BLKWRPLINT       0x02000000U
 +#define  BLKRDPLINT       0x01000000U
 +#define  SGLWRPLINT       0x00800000U
 +#define  SGLRDPLINT       0x00400000U
 +#define  BLKWRCTLINT      0x00200000U
 +#define  BLKRDCTLINT      0x00100000U
 +#define  SGLWRCTLINT      0x00080000U
 +#define  SGLRDCTLINT      0x00040000U
 +#define  BLKWREEPROMINT   0x00020000U
 +#define  BLKRDEEPROMINT   0x00010000U
 +#define  SGLWREEPROMINT   0x00008000U
 +#define  SGLRDEEPROMINT   0x00004000U
 +#define  BLKWRFLASHINT    0x00002000U
 +#define  BLKRDFLASHINT    0x00001000U
 +#define  SGLWRFLASHINT    0x00000800U
 +#define  SGLRDFLASHINT    0x00000400U
 +#define  BLKWRBOOTINT     0x00000200U
 +#define  BLKRDBOOTINT     0x00000100U
 +#define  SGLWRBOOTINT     0x00000080U
 +#define  SGLRDBOOTINT     0x00000040U
 +#define  ILLWRBEINT       0x00000020U
 +#define  ILLRDBEINT       0x00000010U
 +#define  ILLRDINT         0x00000008U
 +#define  ILLWRINT         0x00000004U
 +#define  ILLTRANSINT      0x00000002U
 +#define  RSVDSPACEINT     0x00000001U
++=======
+ #define HP_INT_THRESH_S    28
+ #define HP_INT_THRESH_M    0xfU
+ #define HP_INT_THRESH_V(x) ((x) << HP_INT_THRESH_S)
+ 
+ #define HP_COUNT_S    16
+ #define HP_COUNT_M    0x7ffU
+ #define HP_COUNT_G(x) (((x) >> HP_COUNT_S) & HP_COUNT_M)
+ 
+ #define LP_INT_THRESH_S    12
+ #define LP_INT_THRESH_M    0xfU
+ #define LP_INT_THRESH_V(x) ((x) << LP_INT_THRESH_S)
+ 
+ #define LP_COUNT_S    0
+ #define LP_COUNT_M    0x7ffU
+ #define LP_COUNT_G(x) (((x) >> LP_COUNT_S) & LP_COUNT_M)
+ 
+ #define LP_INT_THRESH_T5_S    18
+ #define LP_INT_THRESH_T5_M    0xfffU
+ #define LP_INT_THRESH_T5_V(x) ((x) << LP_INT_THRESH_T5_S)
+ 
+ #define LP_COUNT_T5_S    0
+ #define LP_COUNT_T5_M    0x3ffffU
+ #define LP_COUNT_T5_G(x) (((x) >> LP_COUNT_T5_S) & LP_COUNT_T5_M)
+ 
+ #define SGE_DOORBELL_CONTROL_A 0x10a8
+ 
+ #define SGE_STAT_TOTAL_A	0x10e4
+ #define SGE_STAT_MATCH_A	0x10e8
+ #define SGE_STAT_CFG_A		0x10ec
+ 
+ #define STATSOURCE_T5_S    9
+ #define STATSOURCE_T5_V(x) ((x) << STATSOURCE_T5_S)
+ 
+ #define SGE_DBFIFO_STATUS2_A 0x1118
+ 
+ #define HP_INT_THRESH_T5_S    10
+ #define HP_INT_THRESH_T5_M    0xfU
+ #define HP_INT_THRESH_T5_V(x) ((x) << HP_INT_THRESH_T5_S)
+ 
+ #define HP_COUNT_T5_S    0
+ #define HP_COUNT_T5_M    0x3ffU
+ #define HP_COUNT_T5_G(x) (((x) >> HP_COUNT_T5_S) & HP_COUNT_T5_M)
+ 
+ #define ENABLE_DROP_S    13
+ #define ENABLE_DROP_V(x) ((x) << ENABLE_DROP_S)
+ #define ENABLE_DROP_F    ENABLE_DROP_V(1U)
+ 
+ #define DROPPED_DB_S    0
+ #define DROPPED_DB_V(x) ((x) << DROPPED_DB_S)
+ #define DROPPED_DB_F    DROPPED_DB_V(1U)
+ 
+ #define SGE_CTXT_CMD_A 0x11fc
+ #define SGE_DBQ_CTXT_BADDR_A 0x1084
+ 
+ /* registers for module PCIE */
+ #define PCIE_PF_CFG_A	0x40
+ 
+ #define AIVEC_S    4
+ #define AIVEC_M    0x3ffU
+ #define AIVEC_V(x) ((x) << AIVEC_S)
+ 
+ #define PCIE_PF_CLI_A	0x44
+ #define PCIE_INT_CAUSE_A	0x3004
+ 
+ #define UNXSPLCPLERR_S    29
+ #define UNXSPLCPLERR_V(x) ((x) << UNXSPLCPLERR_S)
+ #define UNXSPLCPLERR_F    UNXSPLCPLERR_V(1U)
+ 
+ #define PCIEPINT_S    28
+ #define PCIEPINT_V(x) ((x) << PCIEPINT_S)
+ #define PCIEPINT_F    PCIEPINT_V(1U)
+ 
+ #define PCIESINT_S    27
+ #define PCIESINT_V(x) ((x) << PCIESINT_S)
+ #define PCIESINT_F    PCIESINT_V(1U)
+ 
+ #define RPLPERR_S    26
+ #define RPLPERR_V(x) ((x) << RPLPERR_S)
+ #define RPLPERR_F    RPLPERR_V(1U)
+ 
+ #define RXWRPERR_S    25
+ #define RXWRPERR_V(x) ((x) << RXWRPERR_S)
+ #define RXWRPERR_F    RXWRPERR_V(1U)
+ 
+ #define RXCPLPERR_S    24
+ #define RXCPLPERR_V(x) ((x) << RXCPLPERR_S)
+ #define RXCPLPERR_F    RXCPLPERR_V(1U)
+ 
+ #define PIOTAGPERR_S    23
+ #define PIOTAGPERR_V(x) ((x) << PIOTAGPERR_S)
+ #define PIOTAGPERR_F    PIOTAGPERR_V(1U)
+ 
+ #define MATAGPERR_S    22
+ #define MATAGPERR_V(x) ((x) << MATAGPERR_S)
+ #define MATAGPERR_F    MATAGPERR_V(1U)
+ 
+ #define INTXCLRPERR_S    21
+ #define INTXCLRPERR_V(x) ((x) << INTXCLRPERR_S)
+ #define INTXCLRPERR_F    INTXCLRPERR_V(1U)
+ 
+ #define FIDPERR_S    20
+ #define FIDPERR_V(x) ((x) << FIDPERR_S)
+ #define FIDPERR_F    FIDPERR_V(1U)
+ 
+ #define CFGSNPPERR_S    19
+ #define CFGSNPPERR_V(x) ((x) << CFGSNPPERR_S)
+ #define CFGSNPPERR_F    CFGSNPPERR_V(1U)
+ 
+ #define HRSPPERR_S    18
+ #define HRSPPERR_V(x) ((x) << HRSPPERR_S)
+ #define HRSPPERR_F    HRSPPERR_V(1U)
+ 
+ #define HREQPERR_S    17
+ #define HREQPERR_V(x) ((x) << HREQPERR_S)
+ #define HREQPERR_F    HREQPERR_V(1U)
+ 
+ #define HCNTPERR_S    16
+ #define HCNTPERR_V(x) ((x) << HCNTPERR_S)
+ #define HCNTPERR_F    HCNTPERR_V(1U)
+ 
+ #define DRSPPERR_S    15
+ #define DRSPPERR_V(x) ((x) << DRSPPERR_S)
+ #define DRSPPERR_F    DRSPPERR_V(1U)
+ 
+ #define DREQPERR_S    14
+ #define DREQPERR_V(x) ((x) << DREQPERR_S)
+ #define DREQPERR_F    DREQPERR_V(1U)
+ 
+ #define DCNTPERR_S    13
+ #define DCNTPERR_V(x) ((x) << DCNTPERR_S)
+ #define DCNTPERR_F    DCNTPERR_V(1U)
+ 
+ #define CRSPPERR_S    12
+ #define CRSPPERR_V(x) ((x) << CRSPPERR_S)
+ #define CRSPPERR_F    CRSPPERR_V(1U)
+ 
+ #define CREQPERR_S    11
+ #define CREQPERR_V(x) ((x) << CREQPERR_S)
+ #define CREQPERR_F    CREQPERR_V(1U)
+ 
+ #define CCNTPERR_S    10
+ #define CCNTPERR_V(x) ((x) << CCNTPERR_S)
+ #define CCNTPERR_F    CCNTPERR_V(1U)
+ 
+ #define TARTAGPERR_S    9
+ #define TARTAGPERR_V(x) ((x) << TARTAGPERR_S)
+ #define TARTAGPERR_F    TARTAGPERR_V(1U)
+ 
+ #define PIOREQPERR_S    8
+ #define PIOREQPERR_V(x) ((x) << PIOREQPERR_S)
+ #define PIOREQPERR_F    PIOREQPERR_V(1U)
+ 
+ #define PIOCPLPERR_S    7
+ #define PIOCPLPERR_V(x) ((x) << PIOCPLPERR_S)
+ #define PIOCPLPERR_F    PIOCPLPERR_V(1U)
+ 
+ #define MSIXDIPERR_S    6
+ #define MSIXDIPERR_V(x) ((x) << MSIXDIPERR_S)
+ #define MSIXDIPERR_F    MSIXDIPERR_V(1U)
+ 
+ #define MSIXDATAPERR_S    5
+ #define MSIXDATAPERR_V(x) ((x) << MSIXDATAPERR_S)
+ #define MSIXDATAPERR_F    MSIXDATAPERR_V(1U)
+ 
+ #define MSIXADDRHPERR_S    4
+ #define MSIXADDRHPERR_V(x) ((x) << MSIXADDRHPERR_S)
+ #define MSIXADDRHPERR_F    MSIXADDRHPERR_V(1U)
+ 
+ #define MSIXADDRLPERR_S    3
+ #define MSIXADDRLPERR_V(x) ((x) << MSIXADDRLPERR_S)
+ #define MSIXADDRLPERR_F    MSIXADDRLPERR_V(1U)
+ 
+ #define MSIDATAPERR_S    2
+ #define MSIDATAPERR_V(x) ((x) << MSIDATAPERR_S)
+ #define MSIDATAPERR_F    MSIDATAPERR_V(1U)
+ 
+ #define MSIADDRHPERR_S    1
+ #define MSIADDRHPERR_V(x) ((x) << MSIADDRHPERR_S)
+ #define MSIADDRHPERR_F    MSIADDRHPERR_V(1U)
+ 
+ #define MSIADDRLPERR_S    0
+ #define MSIADDRLPERR_V(x) ((x) << MSIADDRLPERR_S)
+ #define MSIADDRLPERR_F    MSIADDRLPERR_V(1U)
+ 
+ #define READRSPERR_S    29
+ #define READRSPERR_V(x) ((x) << READRSPERR_S)
+ #define READRSPERR_F    READRSPERR_V(1U)
+ 
+ #define TRGT1GRPPERR_S    28
+ #define TRGT1GRPPERR_V(x) ((x) << TRGT1GRPPERR_S)
+ #define TRGT1GRPPERR_F    TRGT1GRPPERR_V(1U)
+ 
+ #define IPSOTPERR_S    27
+ #define IPSOTPERR_V(x) ((x) << IPSOTPERR_S)
+ #define IPSOTPERR_F    IPSOTPERR_V(1U)
+ 
+ #define IPRETRYPERR_S    26
+ #define IPRETRYPERR_V(x) ((x) << IPRETRYPERR_S)
+ #define IPRETRYPERR_F    IPRETRYPERR_V(1U)
+ 
+ #define IPRXDATAGRPPERR_S    25
+ #define IPRXDATAGRPPERR_V(x) ((x) << IPRXDATAGRPPERR_S)
+ #define IPRXDATAGRPPERR_F    IPRXDATAGRPPERR_V(1U)
+ 
+ #define IPRXHDRGRPPERR_S    24
+ #define IPRXHDRGRPPERR_V(x) ((x) << IPRXHDRGRPPERR_S)
+ #define IPRXHDRGRPPERR_F    IPRXHDRGRPPERR_V(1U)
+ 
+ #define MAGRPPERR_S    22
+ #define MAGRPPERR_V(x) ((x) << MAGRPPERR_S)
+ #define MAGRPPERR_F    MAGRPPERR_V(1U)
+ 
+ #define VFIDPERR_S    21
+ #define VFIDPERR_V(x) ((x) << VFIDPERR_S)
+ #define VFIDPERR_F    VFIDPERR_V(1U)
+ 
+ #define HREQWRPERR_S    16
+ #define HREQWRPERR_V(x) ((x) << HREQWRPERR_S)
+ #define HREQWRPERR_F    HREQWRPERR_V(1U)
+ 
+ #define DREQWRPERR_S    13
+ #define DREQWRPERR_V(x) ((x) << DREQWRPERR_S)
+ #define DREQWRPERR_F    DREQWRPERR_V(1U)
+ 
+ #define CREQRDPERR_S    11
+ #define CREQRDPERR_V(x) ((x) << CREQRDPERR_S)
+ #define CREQRDPERR_F    CREQRDPERR_V(1U)
+ 
+ #define MSTTAGQPERR_S    10
+ #define MSTTAGQPERR_V(x) ((x) << MSTTAGQPERR_S)
+ #define MSTTAGQPERR_F    MSTTAGQPERR_V(1U)
+ 
+ #define PIOREQGRPPERR_S    8
+ #define PIOREQGRPPERR_V(x) ((x) << PIOREQGRPPERR_S)
+ #define PIOREQGRPPERR_F    PIOREQGRPPERR_V(1U)
+ 
+ #define PIOCPLGRPPERR_S    7
+ #define PIOCPLGRPPERR_V(x) ((x) << PIOCPLGRPPERR_S)
+ #define PIOCPLGRPPERR_F    PIOCPLGRPPERR_V(1U)
+ 
+ #define MSIXSTIPERR_S    2
+ #define MSIXSTIPERR_V(x) ((x) << MSIXSTIPERR_S)
+ #define MSIXSTIPERR_F    MSIXSTIPERR_V(1U)
+ 
+ #define MSTTIMEOUTPERR_S    1
+ #define MSTTIMEOUTPERR_V(x) ((x) << MSTTIMEOUTPERR_S)
+ #define MSTTIMEOUTPERR_F    MSTTIMEOUTPERR_V(1U)
+ 
+ #define MSTGRPPERR_S    0
+ #define MSTGRPPERR_V(x) ((x) << MSTGRPPERR_S)
+ #define MSTGRPPERR_F    MSTGRPPERR_V(1U)
+ 
+ #define PCIE_NONFAT_ERR_A	0x3010
+ #define PCIE_CFG_SPACE_REQ_A	0x3060
+ #define PCIE_CFG_SPACE_DATA_A	0x3064
+ #define PCIE_MEM_ACCESS_BASE_WIN_A 0x3068
+ 
+ #define PCIEOFST_S    10
+ #define PCIEOFST_M    0x3fffffU
+ #define PCIEOFST_G(x) (((x) >> PCIEOFST_S) & PCIEOFST_M)
+ 
+ #define BIR_S    8
+ #define BIR_M    0x3U
+ #define BIR_V(x) ((x) << BIR_S)
+ #define BIR_G(x) (((x) >> BIR_S) & BIR_M)
+ 
+ #define WINDOW_S    0
+ #define WINDOW_M    0xffU
+ #define WINDOW_V(x) ((x) << WINDOW_S)
+ #define WINDOW_G(x) (((x) >> WINDOW_S) & WINDOW_M)
+ 
+ #define PCIE_MEM_ACCESS_OFFSET_A 0x306c
+ 
+ #define ENABLE_S    30
+ #define ENABLE_V(x) ((x) << ENABLE_S)
+ #define ENABLE_F    ENABLE_V(1U)
+ 
+ #define LOCALCFG_S    28
+ #define LOCALCFG_V(x) ((x) << LOCALCFG_S)
+ #define LOCALCFG_F    LOCALCFG_V(1U)
+ 
+ #define FUNCTION_S    12
+ #define FUNCTION_V(x) ((x) << FUNCTION_S)
+ 
+ #define REGISTER_S    0
+ #define REGISTER_V(x) ((x) << REGISTER_S)
+ 
+ #define PFNUM_S    0
+ #define PFNUM_V(x) ((x) << PFNUM_S)
+ 
+ #define PCIE_FW_A 0x30b8
+ #define PCIE_FW_PF_A 0x30bc
+ 
+ #define PCIE_CORE_UTL_SYSTEM_BUS_AGENT_STATUS_A 0x5908
+ 
+ #define RNPP_S    31
+ #define RNPP_V(x) ((x) << RNPP_S)
+ #define RNPP_F    RNPP_V(1U)
+ 
+ #define RPCP_S    29
+ #define RPCP_V(x) ((x) << RPCP_S)
+ #define RPCP_F    RPCP_V(1U)
+ 
+ #define RCIP_S    27
+ #define RCIP_V(x) ((x) << RCIP_S)
+ #define RCIP_F    RCIP_V(1U)
+ 
+ #define RCCP_S    26
+ #define RCCP_V(x) ((x) << RCCP_S)
+ #define RCCP_F    RCCP_V(1U)
+ 
+ #define RFTP_S    23
+ #define RFTP_V(x) ((x) << RFTP_S)
+ #define RFTP_F    RFTP_V(1U)
+ 
+ #define PTRP_S    20
+ #define PTRP_V(x) ((x) << PTRP_S)
+ #define PTRP_F    PTRP_V(1U)
+ 
+ #define PCIE_CORE_UTL_PCI_EXPRESS_PORT_STATUS_A 0x59a4
+ 
+ #define TPCP_S    30
+ #define TPCP_V(x) ((x) << TPCP_S)
+ #define TPCP_F    TPCP_V(1U)
+ 
+ #define TNPP_S    29
+ #define TNPP_V(x) ((x) << TNPP_S)
+ #define TNPP_F    TNPP_V(1U)
+ 
+ #define TFTP_S    28
+ #define TFTP_V(x) ((x) << TFTP_S)
+ #define TFTP_F    TFTP_V(1U)
+ 
+ #define TCAP_S    27
+ #define TCAP_V(x) ((x) << TCAP_S)
+ #define TCAP_F    TCAP_V(1U)
+ 
+ #define TCIP_S    26
+ #define TCIP_V(x) ((x) << TCIP_S)
+ #define TCIP_F    TCIP_V(1U)
+ 
+ #define RCAP_S    25
+ #define RCAP_V(x) ((x) << RCAP_S)
+ #define RCAP_F    RCAP_V(1U)
+ 
+ #define PLUP_S    23
+ #define PLUP_V(x) ((x) << PLUP_S)
+ #define PLUP_F    PLUP_V(1U)
+ 
+ #define PLDN_S    22
+ #define PLDN_V(x) ((x) << PLDN_S)
+ #define PLDN_F    PLDN_V(1U)
+ 
+ #define OTDD_S    21
+ #define OTDD_V(x) ((x) << OTDD_S)
+ #define OTDD_F    OTDD_V(1U)
+ 
+ #define GTRP_S    20
+ #define GTRP_V(x) ((x) << GTRP_S)
+ #define GTRP_F    GTRP_V(1U)
+ 
+ #define RDPE_S    18
+ #define RDPE_V(x) ((x) << RDPE_S)
+ #define RDPE_F    RDPE_V(1U)
+ 
+ #define TDCE_S    17
+ #define TDCE_V(x) ((x) << TDCE_S)
+ #define TDCE_F    TDCE_V(1U)
+ 
+ #define TDUE_S    16
+ #define TDUE_V(x) ((x) << TDUE_S)
+ #define TDUE_F    TDUE_V(1U)
+ 
+ /* registers for module MC */
+ #define MC_INT_CAUSE_A		0x7518
+ #define MC_P_INT_CAUSE_A	0x41318
+ 
+ #define ECC_UE_INT_CAUSE_S    2
+ #define ECC_UE_INT_CAUSE_V(x) ((x) << ECC_UE_INT_CAUSE_S)
+ #define ECC_UE_INT_CAUSE_F    ECC_UE_INT_CAUSE_V(1U)
+ 
+ #define ECC_CE_INT_CAUSE_S    1
+ #define ECC_CE_INT_CAUSE_V(x) ((x) << ECC_CE_INT_CAUSE_S)
+ #define ECC_CE_INT_CAUSE_F    ECC_CE_INT_CAUSE_V(1U)
+ 
+ #define PERR_INT_CAUSE_S    0
+ #define PERR_INT_CAUSE_V(x) ((x) << PERR_INT_CAUSE_S)
+ #define PERR_INT_CAUSE_F    PERR_INT_CAUSE_V(1U)
+ 
+ #define MC_ECC_STATUS_A		0x751c
+ #define MC_P_ECC_STATUS_A	0x4131c
+ 
+ #define ECC_CECNT_S    16
+ #define ECC_CECNT_M    0xffffU
+ #define ECC_CECNT_V(x) ((x) << ECC_CECNT_S)
+ #define ECC_CECNT_G(x) (((x) >> ECC_CECNT_S) & ECC_CECNT_M)
+ 
+ #define ECC_UECNT_S    0
+ #define ECC_UECNT_M    0xffffU
+ #define ECC_UECNT_V(x) ((x) << ECC_UECNT_S)
+ #define ECC_UECNT_G(x) (((x) >> ECC_UECNT_S) & ECC_UECNT_M)
+ 
+ #define MC_BIST_CMD_A 0x7600
+ 
+ #define START_BIST_S    31
+ #define START_BIST_V(x) ((x) << START_BIST_S)
+ #define START_BIST_F    START_BIST_V(1U)
+ 
+ #define BIST_CMD_GAP_S    8
+ #define BIST_CMD_GAP_V(x) ((x) << BIST_CMD_GAP_S)
+ 
+ #define BIST_OPCODE_S    0
+ #define BIST_OPCODE_V(x) ((x) << BIST_OPCODE_S)
+ 
+ #define MC_BIST_CMD_ADDR_A 0x7604
+ #define MC_BIST_CMD_LEN_A 0x7608
+ #define MC_BIST_DATA_PATTERN_A 0x760c
+ 
+ #define MC_BIST_STATUS_RDATA_A 0x7688
+ 
+ /* registers for module MA */
+ #define MA_EDRAM0_BAR_A 0x77c0
+ 
+ #define EDRAM0_SIZE_S    0
+ #define EDRAM0_SIZE_M    0xfffU
+ #define EDRAM0_SIZE_V(x) ((x) << EDRAM0_SIZE_S)
+ #define EDRAM0_SIZE_G(x) (((x) >> EDRAM0_SIZE_S) & EDRAM0_SIZE_M)
+ 
+ #define MA_EDRAM1_BAR_A 0x77c4
+ 
+ #define EDRAM1_SIZE_S    0
+ #define EDRAM1_SIZE_M    0xfffU
+ #define EDRAM1_SIZE_V(x) ((x) << EDRAM1_SIZE_S)
+ #define EDRAM1_SIZE_G(x) (((x) >> EDRAM1_SIZE_S) & EDRAM1_SIZE_M)
+ 
+ #define MA_EXT_MEMORY_BAR_A 0x77c8
+ 
+ #define EXT_MEM_SIZE_S    0
+ #define EXT_MEM_SIZE_M    0xfffU
+ #define EXT_MEM_SIZE_V(x) ((x) << EXT_MEM_SIZE_S)
+ #define EXT_MEM_SIZE_G(x) (((x) >> EXT_MEM_SIZE_S) & EXT_MEM_SIZE_M)
+ 
+ #define MA_EXT_MEMORY1_BAR_A 0x7808
+ 
+ #define EXT_MEM1_SIZE_S    0
+ #define EXT_MEM1_SIZE_M    0xfffU
+ #define EXT_MEM1_SIZE_V(x) ((x) << EXT_MEM1_SIZE_S)
+ #define EXT_MEM1_SIZE_G(x) (((x) >> EXT_MEM1_SIZE_S) & EXT_MEM1_SIZE_M)
+ 
+ #define MA_EXT_MEMORY0_BAR_A 0x77c8
+ 
+ #define EXT_MEM0_SIZE_S    0
+ #define EXT_MEM0_SIZE_M    0xfffU
+ #define EXT_MEM0_SIZE_V(x) ((x) << EXT_MEM0_SIZE_S)
+ #define EXT_MEM0_SIZE_G(x) (((x) >> EXT_MEM0_SIZE_S) & EXT_MEM0_SIZE_M)
+ 
+ #define MA_TARGET_MEM_ENABLE_A 0x77d8
+ 
+ #define EXT_MEM_ENABLE_S    2
+ #define EXT_MEM_ENABLE_V(x) ((x) << EXT_MEM_ENABLE_S)
+ #define EXT_MEM_ENABLE_F    EXT_MEM_ENABLE_V(1U)
+ 
+ #define EDRAM1_ENABLE_S    1
+ #define EDRAM1_ENABLE_V(x) ((x) << EDRAM1_ENABLE_S)
+ #define EDRAM1_ENABLE_F    EDRAM1_ENABLE_V(1U)
+ 
+ #define EDRAM0_ENABLE_S    0
+ #define EDRAM0_ENABLE_V(x) ((x) << EDRAM0_ENABLE_S)
+ #define EDRAM0_ENABLE_F    EDRAM0_ENABLE_V(1U)
+ 
+ #define EXT_MEM1_ENABLE_S    4
+ #define EXT_MEM1_ENABLE_V(x) ((x) << EXT_MEM1_ENABLE_S)
+ #define EXT_MEM1_ENABLE_F    EXT_MEM1_ENABLE_V(1U)
+ 
+ #define EXT_MEM0_ENABLE_S    2
+ #define EXT_MEM0_ENABLE_V(x) ((x) << EXT_MEM0_ENABLE_S)
+ #define EXT_MEM0_ENABLE_F    EXT_MEM0_ENABLE_V(1U)
+ 
+ #define MA_INT_CAUSE_A	0x77e0
+ 
+ #define MEM_PERR_INT_CAUSE_S    1
+ #define MEM_PERR_INT_CAUSE_V(x) ((x) << MEM_PERR_INT_CAUSE_S)
+ #define MEM_PERR_INT_CAUSE_F    MEM_PERR_INT_CAUSE_V(1U)
+ 
+ #define MEM_WRAP_INT_CAUSE_S    0
+ #define MEM_WRAP_INT_CAUSE_V(x) ((x) << MEM_WRAP_INT_CAUSE_S)
+ #define MEM_WRAP_INT_CAUSE_F    MEM_WRAP_INT_CAUSE_V(1U)
+ 
+ #define MA_INT_WRAP_STATUS_A	0x77e4
+ 
+ #define MEM_WRAP_ADDRESS_S    4
+ #define MEM_WRAP_ADDRESS_M    0xfffffffU
+ #define MEM_WRAP_ADDRESS_G(x) (((x) >> MEM_WRAP_ADDRESS_S) & MEM_WRAP_ADDRESS_M)
+ 
+ #define MEM_WRAP_CLIENT_NUM_S    0
+ #define MEM_WRAP_CLIENT_NUM_M    0xfU
+ #define MEM_WRAP_CLIENT_NUM_G(x) \
+ 	(((x) >> MEM_WRAP_CLIENT_NUM_S) & MEM_WRAP_CLIENT_NUM_M)
+ 
+ #define MA_PARITY_ERROR_STATUS_A	0x77f4
+ #define MA_PARITY_ERROR_STATUS1_A	0x77f4
+ #define MA_PARITY_ERROR_STATUS2_A	0x7804
+ 
+ /* registers for module EDC_0 */
+ #define EDC_0_BASE_ADDR		0x7900
+ 
+ #define EDC_BIST_CMD_A		0x7904
+ #define EDC_BIST_CMD_ADDR_A	0x7908
+ #define EDC_BIST_CMD_LEN_A	0x790c
+ #define EDC_BIST_DATA_PATTERN_A 0x7910
+ #define EDC_BIST_STATUS_RDATA_A	0x7928
+ #define EDC_INT_CAUSE_A		0x7978
+ 
+ #define ECC_UE_PAR_S    5
+ #define ECC_UE_PAR_V(x) ((x) << ECC_UE_PAR_S)
+ #define ECC_UE_PAR_F    ECC_UE_PAR_V(1U)
+ 
+ #define ECC_CE_PAR_S    4
+ #define ECC_CE_PAR_V(x) ((x) << ECC_CE_PAR_S)
+ #define ECC_CE_PAR_F    ECC_CE_PAR_V(1U)
+ 
+ #define PERR_PAR_CAUSE_S    3
+ #define PERR_PAR_CAUSE_V(x) ((x) << PERR_PAR_CAUSE_S)
+ #define PERR_PAR_CAUSE_F    PERR_PAR_CAUSE_V(1U)
+ 
+ #define EDC_ECC_STATUS_A	0x797c
+ 
+ /* registers for module EDC_1 */
+ #define EDC_1_BASE_ADDR	0x7980
+ 
+ /* registers for module CIM */
+ #define CIM_BOOT_CFG_A 0x7b00
+ #define CIM_PF_MAILBOX_CTRL_SHADOW_COPY_A 0x290
+ 
+ #define  BOOTADDR_M	0xffffff00U
+ 
+ #define UPCRST_S    0
+ #define UPCRST_V(x) ((x) << UPCRST_S)
+ #define UPCRST_F    UPCRST_V(1U)
+ 
+ #define CIM_PF_MAILBOX_DATA_A 0x240
+ #define CIM_PF_MAILBOX_CTRL_A 0x280
+ 
+ #define MBMSGVALID_S    3
+ #define MBMSGVALID_V(x) ((x) << MBMSGVALID_S)
+ #define MBMSGVALID_F    MBMSGVALID_V(1U)
+ 
+ #define MBINTREQ_S    2
+ #define MBINTREQ_V(x) ((x) << MBINTREQ_S)
+ #define MBINTREQ_F    MBINTREQ_V(1U)
+ 
+ #define MBOWNER_S    0
+ #define MBOWNER_M    0x3U
+ #define MBOWNER_V(x) ((x) << MBOWNER_S)
+ #define MBOWNER_G(x) (((x) >> MBOWNER_S) & MBOWNER_M)
+ 
+ #define CIM_PF_HOST_INT_ENABLE_A 0x288
+ 
+ #define MBMSGRDYINTEN_S    19
+ #define MBMSGRDYINTEN_V(x) ((x) << MBMSGRDYINTEN_S)
+ #define MBMSGRDYINTEN_F    MBMSGRDYINTEN_V(1U)
+ 
+ #define CIM_PF_HOST_INT_CAUSE_A 0x28c
+ 
+ #define MBMSGRDYINT_S    19
+ #define MBMSGRDYINT_V(x) ((x) << MBMSGRDYINT_S)
+ #define MBMSGRDYINT_F    MBMSGRDYINT_V(1U)
+ 
+ #define CIM_HOST_INT_CAUSE_A 0x7b2c
+ 
+ #define TIEQOUTPARERRINT_S    20
+ #define TIEQOUTPARERRINT_V(x) ((x) << TIEQOUTPARERRINT_S)
+ #define TIEQOUTPARERRINT_F    TIEQOUTPARERRINT_V(1U)
+ 
+ #define TIEQINPARERRINT_S    19
+ #define TIEQINPARERRINT_V(x) ((x) << TIEQINPARERRINT_S)
+ #define TIEQINPARERRINT_F    TIEQINPARERRINT_V(1U)
+ 
+ #define PREFDROPINT_S    1
+ #define PREFDROPINT_V(x) ((x) << PREFDROPINT_S)
+ #define PREFDROPINT_F    PREFDROPINT_V(1U)
+ 
+ #define UPACCNONZERO_S    0
+ #define UPACCNONZERO_V(x) ((x) << UPACCNONZERO_S)
+ #define UPACCNONZERO_F    UPACCNONZERO_V(1U)
+ 
+ #define MBHOSTPARERR_S    18
+ #define MBHOSTPARERR_V(x) ((x) << MBHOSTPARERR_S)
+ #define MBHOSTPARERR_F    MBHOSTPARERR_V(1U)
+ 
+ #define MBUPPARERR_S    17
+ #define MBUPPARERR_V(x) ((x) << MBUPPARERR_S)
+ #define MBUPPARERR_F    MBUPPARERR_V(1U)
+ 
+ #define IBQTP0PARERR_S    16
+ #define IBQTP0PARERR_V(x) ((x) << IBQTP0PARERR_S)
+ #define IBQTP0PARERR_F    IBQTP0PARERR_V(1U)
+ 
+ #define IBQTP1PARERR_S    15
+ #define IBQTP1PARERR_V(x) ((x) << IBQTP1PARERR_S)
+ #define IBQTP1PARERR_F    IBQTP1PARERR_V(1U)
+ 
+ #define IBQULPPARERR_S    14
+ #define IBQULPPARERR_V(x) ((x) << IBQULPPARERR_S)
+ #define IBQULPPARERR_F    IBQULPPARERR_V(1U)
+ 
+ #define IBQSGELOPARERR_S    13
+ #define IBQSGELOPARERR_V(x) ((x) << IBQSGELOPARERR_S)
+ #define IBQSGELOPARERR_F    IBQSGELOPARERR_V(1U)
+ 
+ #define IBQSGEHIPARERR_S    12
+ #define IBQSGEHIPARERR_V(x) ((x) << IBQSGEHIPARERR_S)
+ #define IBQSGEHIPARERR_F    IBQSGEHIPARERR_V(1U)
+ 
+ #define IBQNCSIPARERR_S    11
+ #define IBQNCSIPARERR_V(x) ((x) << IBQNCSIPARERR_S)
+ #define IBQNCSIPARERR_F    IBQNCSIPARERR_V(1U)
+ 
+ #define OBQULP0PARERR_S    10
+ #define OBQULP0PARERR_V(x) ((x) << OBQULP0PARERR_S)
+ #define OBQULP0PARERR_F    OBQULP0PARERR_V(1U)
+ 
+ #define OBQULP1PARERR_S    9
+ #define OBQULP1PARERR_V(x) ((x) << OBQULP1PARERR_S)
+ #define OBQULP1PARERR_F    OBQULP1PARERR_V(1U)
+ 
+ #define OBQULP2PARERR_S    8
+ #define OBQULP2PARERR_V(x) ((x) << OBQULP2PARERR_S)
+ #define OBQULP2PARERR_F    OBQULP2PARERR_V(1U)
+ 
+ #define OBQULP3PARERR_S    7
+ #define OBQULP3PARERR_V(x) ((x) << OBQULP3PARERR_S)
+ #define OBQULP3PARERR_F    OBQULP3PARERR_V(1U)
+ 
+ #define OBQSGEPARERR_S    6
+ #define OBQSGEPARERR_V(x) ((x) << OBQSGEPARERR_S)
+ #define OBQSGEPARERR_F    OBQSGEPARERR_V(1U)
+ 
+ #define OBQNCSIPARERR_S    5
+ #define OBQNCSIPARERR_V(x) ((x) << OBQNCSIPARERR_S)
+ #define OBQNCSIPARERR_F    OBQNCSIPARERR_V(1U)
+ 
+ #define CIM_HOST_UPACC_INT_CAUSE_A 0x7b34
+ 
+ #define EEPROMWRINT_S    30
+ #define EEPROMWRINT_V(x) ((x) << EEPROMWRINT_S)
+ #define EEPROMWRINT_F    EEPROMWRINT_V(1U)
+ 
+ #define TIMEOUTMAINT_S    29
+ #define TIMEOUTMAINT_V(x) ((x) << TIMEOUTMAINT_S)
+ #define TIMEOUTMAINT_F    TIMEOUTMAINT_V(1U)
+ 
+ #define TIMEOUTINT_S    28
+ #define TIMEOUTINT_V(x) ((x) << TIMEOUTINT_S)
+ #define TIMEOUTINT_F    TIMEOUTINT_V(1U)
+ 
+ #define RSPOVRLOOKUPINT_S    27
+ #define RSPOVRLOOKUPINT_V(x) ((x) << RSPOVRLOOKUPINT_S)
+ #define RSPOVRLOOKUPINT_F    RSPOVRLOOKUPINT_V(1U)
+ 
+ #define REQOVRLOOKUPINT_S    26
+ #define REQOVRLOOKUPINT_V(x) ((x) << REQOVRLOOKUPINT_S)
+ #define REQOVRLOOKUPINT_F    REQOVRLOOKUPINT_V(1U)
+ 
+ #define BLKWRPLINT_S    25
+ #define BLKWRPLINT_V(x) ((x) << BLKWRPLINT_S)
+ #define BLKWRPLINT_F    BLKWRPLINT_V(1U)
+ 
+ #define BLKRDPLINT_S    24
+ #define BLKRDPLINT_V(x) ((x) << BLKRDPLINT_S)
+ #define BLKRDPLINT_F    BLKRDPLINT_V(1U)
+ 
+ #define SGLWRPLINT_S    23
+ #define SGLWRPLINT_V(x) ((x) << SGLWRPLINT_S)
+ #define SGLWRPLINT_F    SGLWRPLINT_V(1U)
+ 
+ #define SGLRDPLINT_S    22
+ #define SGLRDPLINT_V(x) ((x) << SGLRDPLINT_S)
+ #define SGLRDPLINT_F    SGLRDPLINT_V(1U)
+ 
+ #define BLKWRCTLINT_S    21
+ #define BLKWRCTLINT_V(x) ((x) << BLKWRCTLINT_S)
+ #define BLKWRCTLINT_F    BLKWRCTLINT_V(1U)
+ 
+ #define BLKRDCTLINT_S    20
+ #define BLKRDCTLINT_V(x) ((x) << BLKRDCTLINT_S)
+ #define BLKRDCTLINT_F    BLKRDCTLINT_V(1U)
+ 
+ #define SGLWRCTLINT_S    19
+ #define SGLWRCTLINT_V(x) ((x) << SGLWRCTLINT_S)
+ #define SGLWRCTLINT_F    SGLWRCTLINT_V(1U)
+ 
+ #define SGLRDCTLINT_S    18
+ #define SGLRDCTLINT_V(x) ((x) << SGLRDCTLINT_S)
+ #define SGLRDCTLINT_F    SGLRDCTLINT_V(1U)
+ 
+ #define BLKWREEPROMINT_S    17
+ #define BLKWREEPROMINT_V(x) ((x) << BLKWREEPROMINT_S)
+ #define BLKWREEPROMINT_F    BLKWREEPROMINT_V(1U)
+ 
+ #define BLKRDEEPROMINT_S    16
+ #define BLKRDEEPROMINT_V(x) ((x) << BLKRDEEPROMINT_S)
+ #define BLKRDEEPROMINT_F    BLKRDEEPROMINT_V(1U)
+ 
+ #define SGLWREEPROMINT_S    15
+ #define SGLWREEPROMINT_V(x) ((x) << SGLWREEPROMINT_S)
+ #define SGLWREEPROMINT_F    SGLWREEPROMINT_V(1U)
+ 
+ #define SGLRDEEPROMINT_S    14
+ #define SGLRDEEPROMINT_V(x) ((x) << SGLRDEEPROMINT_S)
+ #define SGLRDEEPROMINT_F    SGLRDEEPROMINT_V(1U)
+ 
+ #define BLKWRFLASHINT_S    13
+ #define BLKWRFLASHINT_V(x) ((x) << BLKWRFLASHINT_S)
+ #define BLKWRFLASHINT_F    BLKWRFLASHINT_V(1U)
+ 
+ #define BLKRDFLASHINT_S    12
+ #define BLKRDFLASHINT_V(x) ((x) << BLKRDFLASHINT_S)
+ #define BLKRDFLASHINT_F    BLKRDFLASHINT_V(1U)
+ 
+ #define SGLWRFLASHINT_S    11
+ #define SGLWRFLASHINT_V(x) ((x) << SGLWRFLASHINT_S)
+ #define SGLWRFLASHINT_F    SGLWRFLASHINT_V(1U)
+ 
+ #define SGLRDFLASHINT_S    10
+ #define SGLRDFLASHINT_V(x) ((x) << SGLRDFLASHINT_S)
+ #define SGLRDFLASHINT_F    SGLRDFLASHINT_V(1U)
+ 
+ #define BLKWRBOOTINT_S    9
+ #define BLKWRBOOTINT_V(x) ((x) << BLKWRBOOTINT_S)
+ #define BLKWRBOOTINT_F    BLKWRBOOTINT_V(1U)
+ 
+ #define BLKRDBOOTINT_S    8
+ #define BLKRDBOOTINT_V(x) ((x) << BLKRDBOOTINT_S)
+ #define BLKRDBOOTINT_F    BLKRDBOOTINT_V(1U)
+ 
+ #define SGLWRBOOTINT_S    7
+ #define SGLWRBOOTINT_V(x) ((x) << SGLWRBOOTINT_S)
+ #define SGLWRBOOTINT_F    SGLWRBOOTINT_V(1U)
+ 
+ #define SGLRDBOOTINT_S    6
+ #define SGLRDBOOTINT_V(x) ((x) << SGLRDBOOTINT_S)
+ #define SGLRDBOOTINT_F    SGLRDBOOTINT_V(1U)
+ 
+ #define ILLWRBEINT_S    5
+ #define ILLWRBEINT_V(x) ((x) << ILLWRBEINT_S)
+ #define ILLWRBEINT_F    ILLWRBEINT_V(1U)
+ 
+ #define ILLRDBEINT_S    4
+ #define ILLRDBEINT_V(x) ((x) << ILLRDBEINT_S)
+ #define ILLRDBEINT_F    ILLRDBEINT_V(1U)
+ 
+ #define ILLRDINT_S    3
+ #define ILLRDINT_V(x) ((x) << ILLRDINT_S)
+ #define ILLRDINT_F    ILLRDINT_V(1U)
+ 
+ #define ILLWRINT_S    2
+ #define ILLWRINT_V(x) ((x) << ILLWRINT_S)
+ #define ILLWRINT_F    ILLWRINT_V(1U)
+ 
+ #define ILLTRANSINT_S    1
+ #define ILLTRANSINT_V(x) ((x) << ILLTRANSINT_S)
+ #define ILLTRANSINT_F    ILLTRANSINT_V(1U)
+ 
+ #define RSVDSPACEINT_S    0
+ #define RSVDSPACEINT_V(x) ((x) << RSVDSPACEINT_S)
+ #define RSVDSPACEINT_F    RSVDSPACEINT_V(1U)
++>>>>>>> ae469b68a557 (cxgb4: Fix to dump devlog, even if FW is crashed)
  
  /* registers for module TP */
 -#define DBGLAWHLF_S    23
 -#define DBGLAWHLF_V(x) ((x) << DBGLAWHLF_S)
 -#define DBGLAWHLF_F    DBGLAWHLF_V(1U)
 -
 -#define DBGLAWPTR_S    16
 -#define DBGLAWPTR_M    0x7fU
 -#define DBGLAWPTR_G(x) (((x) >> DBGLAWPTR_S) & DBGLAWPTR_M)
 -
 -#define DBGLAENABLE_S    12
 -#define DBGLAENABLE_V(x) ((x) << DBGLAENABLE_S)
 -#define DBGLAENABLE_F    DBGLAENABLE_V(1U)
 -
 -#define DBGLARPTR_S    0
 -#define DBGLARPTR_M    0x7fU
 -#define DBGLARPTR_V(x) ((x) << DBGLARPTR_S)
 -
 -#define TP_DBG_LA_DATAL_A	0x7ed8
 -#define TP_DBG_LA_CONFIG_A	0x7ed4
  #define TP_OUT_CONFIG_A		0x7d04
  #define TP_GLOBAL_CONFIG_A	0x7d08
  
* Unmerged path drivers/net/ethernet/chelsio/cxgb4/cxgb4.h
diff --git a/drivers/net/ethernet/chelsio/cxgb4/cxgb4_main.c b/drivers/net/ethernet/chelsio/cxgb4/cxgb4_main.c
index 1b2d97e91707..b092f183dfda 100644
--- a/drivers/net/ethernet/chelsio/cxgb4/cxgb4_main.c
+++ b/drivers/net/ethernet/chelsio/cxgb4/cxgb4_main.c
@@ -5537,6 +5537,13 @@ static int adap_init0(struct adapter *adap)
 	struct fw_caps_config_cmd caps_cmd;
 	int reset = 1;
 
+	/* Grab Firmware Device Log parameters as early as possible so we have
+	 * access to it for debugging, etc.
+	 */
+	ret = t4_init_devlog_params(adap);
+	if (ret < 0)
+		return ret;
+
 	/* Contact FW, advertising Master capability */
 	ret = t4_fw_hello(adap, adap->mbox, adap->mbox, MASTER_MAY, &state);
 	if (ret < 0) {
diff --git a/drivers/net/ethernet/chelsio/cxgb4/t4_hw.c b/drivers/net/ethernet/chelsio/cxgb4/t4_hw.c
index 4234b8c917e7..3224af4e3ed9 100644
--- a/drivers/net/ethernet/chelsio/cxgb4/t4_hw.c
+++ b/drivers/net/ethernet/chelsio/cxgb4/t4_hw.c
@@ -4097,6 +4097,59 @@ int t4_bar2_sge_qregs(struct adapter *adapter,
 	return 0;
 }
 
+/**
+ *	t4_init_devlog_params - initialize adapter->params.devlog
+ *	@adap: the adapter
+ *
+ *	Initialize various fields of the adapter's Firmware Device Log
+ *	Parameters structure.
+ */
+int t4_init_devlog_params(struct adapter *adap)
+{
+	struct devlog_params *dparams = &adap->params.devlog;
+	u32 pf_dparams;
+	unsigned int devlog_meminfo;
+	struct fw_devlog_cmd devlog_cmd;
+	int ret;
+
+	/* If we're dealing with newer firmware, the Device Log Paramerters
+	 * are stored in a designated register which allows us to access the
+	 * Device Log even if we can't talk to the firmware.
+	 */
+	pf_dparams =
+		t4_read_reg(adap, PCIE_FW_REG(PCIE_FW_PF_A, PCIE_FW_PF_DEVLOG));
+	if (pf_dparams) {
+		unsigned int nentries, nentries128;
+
+		dparams->memtype = PCIE_FW_PF_DEVLOG_MEMTYPE_G(pf_dparams);
+		dparams->start = PCIE_FW_PF_DEVLOG_ADDR16_G(pf_dparams) << 4;
+
+		nentries128 = PCIE_FW_PF_DEVLOG_NENTRIES128_G(pf_dparams);
+		nentries = (nentries128 + 1) * 128;
+		dparams->size = nentries * sizeof(struct fw_devlog_e);
+
+		return 0;
+	}
+
+	/* Otherwise, ask the firmware for it's Device Log Parameters.
+	 */
+	memset(&devlog_cmd, 0, sizeof(devlog_cmd));
+	devlog_cmd.op_to_write = htonl(FW_CMD_OP_V(FW_DEVLOG_CMD) |
+				       FW_CMD_REQUEST_F | FW_CMD_READ_F);
+	devlog_cmd.retval_len16 = htonl(FW_LEN16(devlog_cmd));
+	ret = t4_wr_mbox(adap, adap->mbox, &devlog_cmd, sizeof(devlog_cmd),
+			 &devlog_cmd);
+	if (ret)
+		return ret;
+
+	devlog_meminfo = ntohl(devlog_cmd.memtype_devlog_memaddr16_devlog);
+	dparams->memtype = FW_DEVLOG_CMD_MEMTYPE_DEVLOG_G(devlog_meminfo);
+	dparams->start = FW_DEVLOG_CMD_MEMADDR16_DEVLOG_G(devlog_meminfo) << 4;
+	dparams->size = ntohl(devlog_cmd.memsize_devlog);
+
+	return 0;
+}
+
 /**
  *	t4_init_sge_params - initialize adap->params.sge
  *	@adapter: the adapter
* Unmerged path drivers/net/ethernet/chelsio/cxgb4/t4_regs.h
