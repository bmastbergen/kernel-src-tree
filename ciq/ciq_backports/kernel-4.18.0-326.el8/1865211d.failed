ALSA: usb-audio: Move snd_usb_autoresume() call out of setup_hw_info()

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-326.el8
commit-author Takashi Iwai <tiwai@suse.de>
commit 1865211d6789e8404c75278754f0fa4735165600
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-326.el8/1865211d.failed

This is a preliminary work for the upcoming hw-constraint change for
the implicit feedback mode.

Currently snd_usb_autoresume() is called at the end of
setup_hwinfo().  It's a bit confusing; because of this implicit
refcount usage, the caller side needs to call snd_usb_autosuspend()
later in the error path although it's not seen inside the function.
Instead, it's clearer to call both snd_usb_autoresume() and suspend()
in the very same function.

It's only refactoring and no functional changes.

	Tested-by: Keith Milner <kamilner@superlative.org>
	Tested-by: Dylan Robinson <dylan_robinson@motu.com>
Link: https://lore.kernel.org/r/20201123085347.19667-10-tiwai@suse.de
	Signed-off-by: Takashi Iwai <tiwai@suse.de>
(cherry picked from commit 1865211d6789e8404c75278754f0fa4735165600)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	sound/usb/pcm.c
diff --cc sound/usb/pcm.c
index 3e25f95c777d,78933b6571d0..000000000000
--- a/sound/usb/pcm.c
+++ b/sound/usb/pcm.c
@@@ -1387,7 -1401,16 +1387,20 @@@ static int snd_usb_pcm_open(struct snd_
  	subs->dsd_dop.channel = 0;
  	subs->dsd_dop.marker = 1;
  
++<<<<<<< HEAD
 +	return setup_hw_info(runtime, subs);
++=======
+ 	ret = setup_hw_info(runtime, subs);
+ 	if (ret < 0)
+ 		return ret;
+ 	ret = snd_usb_autoresume(subs->stream->chip);
+ 	if (ret < 0)
+ 		return ret;
+ 	ret = snd_media_stream_init(subs, as->pcm, direction);
+ 	if (ret < 0)
+ 		snd_usb_autosuspend(subs->stream->chip);
+ 	return ret;
++>>>>>>> 1865211d6789 (ALSA: usb-audio: Move snd_usb_autoresume() call out of setup_hw_info())
  }
  
  static int snd_usb_pcm_close(struct snd_pcm_substream *substream)
* Unmerged path sound/usb/pcm.c
