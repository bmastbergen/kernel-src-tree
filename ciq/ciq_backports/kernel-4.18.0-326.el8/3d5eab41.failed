iommu/io-pgtable: Remove TLBI_ON_MAP quirk

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-326.el8
commit-author Robin Murphy <robin.murphy@arm.com>
commit 3d5eab41451f8e28f3e45eef8f6b372bf56612fb
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-326.el8/3d5eab41.failed

IO_PGTABLE_QUIRK_TLBI_ON_MAP is now fully superseded by the
core API's iotlb_sync_map callback.

	Signed-off-by: Robin Murphy <robin.murphy@arm.com>
Link: https://lore.kernel.org/r/5abb80bba3a7c371d5ffb7e59c05586deddb9a91.1611764372.git.robin.murphy@arm.com
[will: Remove unused 'iop' local variable from arm_v7s_map()]
	Signed-off-by: Will Deacon <will@kernel.org>
(cherry picked from commit 3d5eab41451f8e28f3e45eef8f6b372bf56612fb)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/iommu/io-pgtable-arm-v7s.c
#	include/linux/io-pgtable.h
diff --cc drivers/iommu/io-pgtable-arm-v7s.c
index d9e1d25bdd4b,929cb1518db1..000000000000
--- a/drivers/iommu/io-pgtable-arm-v7s.c
+++ b/drivers/iommu/io-pgtable-arm-v7s.c
@@@ -744,8 -753,7 +738,12 @@@ static struct io_pgtable *arm_v7s_alloc
  
  	if (cfg->quirks & ~(IO_PGTABLE_QUIRK_ARM_NS |
  			    IO_PGTABLE_QUIRK_NO_PERMS |
++<<<<<<< HEAD
 +			    IO_PGTABLE_QUIRK_TLBI_ON_MAP |
 +			    IO_PGTABLE_QUIRK_ARM_MTK_4GB |
++=======
+ 			    IO_PGTABLE_QUIRK_ARM_MTK_EXT |
++>>>>>>> 3d5eab41451f (iommu/io-pgtable: Remove TLBI_ON_MAP quirk)
  			    IO_PGTABLE_QUIRK_NON_STRICT))
  		return NULL;
  
diff --cc include/linux/io-pgtable.h
index 220815f78f1e,06753323a15e..000000000000
--- a/include/linux/io-pgtable.h
+++ b/include/linux/io-pgtable.h
@@@ -72,14 -68,9 +72,20 @@@ struct io_pgtable_cfg 
  	 *	hardware which does not implement the permissions of a given
  	 *	format, and/or requires some format-specific default value.
  	 *
++<<<<<<< HEAD
 +	 * IO_PGTABLE_QUIRK_TLBI_ON_MAP: If the format forbids caching invalid
 +	 *	(unmapped) entries but the hardware might do so anyway, perform
 +	 *	TLB maintenance when mapping as well as when unmapping.
 +	 *
 +	 * IO_PGTABLE_QUIRK_ARM_MTK_4GB: (ARM v7s format) Set bit 9 in all
 +	 *	PTEs, for Mediatek IOMMUs which treat it as a 33rd address bit
 +	 *	when the SoC is in "4GB mode" and they can only access the high
 +	 *	remap of DRAM (0x1_00000000 to 0x1_ffffffff).
++=======
+ 	 * IO_PGTABLE_QUIRK_ARM_MTK_EXT: (ARM v7s format) MediaTek IOMMUs extend
+ 	 *	to support up to 34 bits PA where the bit32 and bit33 are
+ 	 *	encoded in the bit9 and bit4 of the PTE respectively.
++>>>>>>> 3d5eab41451f (iommu/io-pgtable: Remove TLBI_ON_MAP quirk)
  	 *
  	 * IO_PGTABLE_QUIRK_NON_STRICT: Skip issuing synchronous leaf TLBIs
  	 *	on unmap, for DMA domains using the flush queue mechanism for
@@@ -90,10 -81,13 +96,14 @@@
  	 */
  	#define IO_PGTABLE_QUIRK_ARM_NS		BIT(0)
  	#define IO_PGTABLE_QUIRK_NO_PERMS	BIT(1)
++<<<<<<< HEAD
 +	#define IO_PGTABLE_QUIRK_TLBI_ON_MAP	BIT(2)
 +	#define IO_PGTABLE_QUIRK_ARM_MTK_4GB	BIT(3)
++=======
+ 	#define IO_PGTABLE_QUIRK_ARM_MTK_EXT	BIT(3)
++>>>>>>> 3d5eab41451f (iommu/io-pgtable: Remove TLBI_ON_MAP quirk)
  	#define IO_PGTABLE_QUIRK_NON_STRICT	BIT(4)
  	#define IO_PGTABLE_QUIRK_ARM_TTBR1	BIT(5)
 -	#define IO_PGTABLE_QUIRK_ARM_OUTER_WBWA	BIT(6)
  	unsigned long			quirks;
  	unsigned long			pgsize_bitmap;
  	unsigned int			ias;
* Unmerged path drivers/iommu/io-pgtable-arm-v7s.c
* Unmerged path include/linux/io-pgtable.h
