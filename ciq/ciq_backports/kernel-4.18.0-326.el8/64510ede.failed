iommu: arm-smmu-impl: Convert to a generic reset implementation

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-326.el8
commit-author Sai Prakash Ranjan <saiprakash.ranjan@codeaurora.org>
commit 64510ede36845500584485f3ad30dbcbf83091a6
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-326.el8/64510ede.failed

Currently the QCOM specific smmu reset implementation is very
specific to SDM845 SoC and has a wait-for-safe logic which
may not be required for other SoCs. So move the SDM845 specific
logic to its specific reset function. Also add SC7180 SMMU
compatible for calling into QCOM specific implementation.

	Signed-off-by: Sai Prakash Ranjan <saiprakash.ranjan@codeaurora.org>
	Reviewed-by: Bjorn Andersson <bjorn.andersson@linaro.org>
	Reviewed-by: Stephen Boyd <swboyd@chromium.org>
	Reviewed-by: Robin Murphy <robin.murphy@arm.com>
Link: https://lore.kernel.org/r/d24a0278021bc0b2732636c5728efe55e7318a8b.1587407458.git.saiprakash.ranjan@codeaurora.org
	Signed-off-by: Will Deacon <will@kernel.org>
(cherry picked from commit 64510ede36845500584485f3ad30dbcbf83091a6)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/iommu/arm-smmu-impl.c
#	drivers/iommu/arm-smmu-qcom.c
diff --cc drivers/iommu/arm-smmu-impl.c
index 3a1a5d8188d6,c75b9d957b70..000000000000
--- a/drivers/iommu/arm-smmu-impl.c
+++ b/drivers/iommu/arm-smmu-impl.c
@@@ -166,9 -168,12 +168,15 @@@ struct arm_smmu_device *arm_smmu_impl_i
  		break;
  	}
  
- 	if (of_property_read_bool(smmu->dev->of_node,
- 				  "calxeda,smmu-secure-config-access"))
+ 	if (of_property_read_bool(np, "calxeda,smmu-secure-config-access"))
  		smmu->impl = &calxeda_impl;
  
++<<<<<<< HEAD
++=======
+ 	if (of_device_is_compatible(np, "qcom,sdm845-smmu-500") ||
+ 	    of_device_is_compatible(np, "qcom,sc7180-smmu-500"))
+ 		return qcom_smmu_impl_init(smmu);
+ 
++>>>>>>> 64510ede3684 (iommu: arm-smmu-impl: Convert to a generic reset implementation)
  	return smmu;
  }
* Unmerged path drivers/iommu/arm-smmu-qcom.c
* Unmerged path drivers/iommu/arm-smmu-impl.c
* Unmerged path drivers/iommu/arm-smmu-qcom.c
