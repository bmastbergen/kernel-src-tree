drm/i915/adl_s: Add PHYs for Alderlake S

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-326.el8
commit-author Anusha Srivatsa <anusha.srivatsa@intel.com>
commit a84b4bd1172b8394d5540b51b3cf0f76c0dff17a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-326.el8/a84b4bd1.failed

Alderlake-S has 5 combo phys, add reg definitions for
combo phys and update the port to phy helper for ADL-S.

v2:
- Change IS_GEN() >= 12 to IS_TIGERLAKE() in intel_phy_is_tc()
and return false for platforms RKL,DG1 and ADLS.(mdroper)

	Cc: Lucas De Marchi <lucas.demarchi@intel.com>
	Cc: Jani Nikula <jani.nikula@intel.com>
	Cc: Ville Syrjälä <ville.syrjala@linux.intel.com>
	Cc: Imre Deak <imre.deak@intel.com>
	Cc: Matt Roper <matthew.d.roper@intel.com>
	Signed-off-by: Anusha Srivatsa <anusha.srivatsa@intel.com>
	Signed-off-by: Aditya Swarup <aditya.swarup@intel.com>
	Reviewed-by: Matt Roper <matthew.d.roper@intel.com>
	Reviewed-by: Lucas De Marchi <lucas.demarchi@intel.com>
	Signed-off-by: Lucas De Marchi <lucas.demarchi@intel.com>
Link: https://patchwork.freedesktop.org/patch/msgid/20210125140753.347998-5-aditya.swarup@intel.com
(cherry picked from commit a84b4bd1172b8394d5540b51b3cf0f76c0dff17a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/i915/display/intel_display.c
diff --cc drivers/gpu/drm/i915/display/intel_display.c
index 190e3c9e77de,1eae92e0e268..000000000000
--- a/drivers/gpu/drm/i915/display/intel_display.c
+++ b/drivers/gpu/drm/i915/display/intel_display.c
@@@ -7235,9 -6935,11 +7235,15 @@@ bool intel_phy_is_combo(struct drm_i915
  {
  	if (phy == PHY_NONE)
  		return false;
++<<<<<<< HEAD
 +	else if (IS_ROCKETLAKE(dev_priv))
++=======
+ 	else if (IS_ALDERLAKE_S(dev_priv))
+ 		return phy <= PHY_E;
+ 	else if (IS_DG1(dev_priv) || IS_ROCKETLAKE(dev_priv))
++>>>>>>> a84b4bd1172b (drm/i915/adl_s: Add PHYs for Alderlake S)
  		return phy <= PHY_D;
 -	else if (IS_JSL_EHL(dev_priv))
 +	else if (IS_ELKHARTLAKE(dev_priv))
  		return phy <= PHY_C;
  	else if (INTEL_GEN(dev_priv) >= 11)
  		return phy <= PHY_B;
@@@ -7247,11 -6949,9 +7253,17 @@@
  
  bool intel_phy_is_tc(struct drm_i915_private *dev_priv, enum phy phy)
  {
++<<<<<<< HEAD
 +	if (IS_ROCKETLAKE(dev_priv))
 +		return false;
 +	else if (INTEL_GEN(dev_priv) >= 12)
 +		return phy >= PHY_D && phy <= PHY_I;
 +	else if (INTEL_GEN(dev_priv) >= 11 && !IS_ELKHARTLAKE(dev_priv))
++=======
+ 	if (IS_TIGERLAKE(dev_priv))
+ 		return phy >= PHY_D && phy <= PHY_I;
+ 	else if (IS_ICELAKE(dev_priv))
++>>>>>>> a84b4bd1172b (drm/i915/adl_s: Add PHYs for Alderlake S)
  		return phy >= PHY_C && phy <= PHY_F;
  	else
  		return false;
@@@ -7259,12 -6959,14 +7271,20 @@@
  
  enum phy intel_port_to_phy(struct drm_i915_private *i915, enum port port)
  {
++<<<<<<< HEAD
 +	if (IS_ROCKETLAKE(i915) && port >= PORT_D)
 +		return (enum phy)port - 1;
 +	else if (IS_ELKHARTLAKE(i915) && port == PORT_D)
++=======
+ 	if (IS_ALDERLAKE_S(i915) && port >= PORT_TC1)
+ 		return PHY_B + port - PORT_TC1;
+ 	else if ((IS_DG1(i915) || IS_ROCKETLAKE(i915)) && port >= PORT_TC1)
+ 		return PHY_C + port - PORT_TC1;
+ 	else if (IS_JSL_EHL(i915) && port == PORT_D)
++>>>>>>> a84b4bd1172b (drm/i915/adl_s: Add PHYs for Alderlake S)
  		return PHY_A;
  
 -	return PHY_A + port - PORT_A;
 +	return (enum phy)port;
  }
  
  enum tc_port intel_port_to_tc(struct drm_i915_private *dev_priv, enum port port)
* Unmerged path drivers/gpu/drm/i915/display/intel_display.c
diff --git a/drivers/gpu/drm/i915/i915_reg.h b/drivers/gpu/drm/i915/i915_reg.h
index c18fa99718fe..78c8dd0e9482 100644
--- a/drivers/gpu/drm/i915/i915_reg.h
+++ b/drivers/gpu/drm/i915/i915_reg.h
@@ -1870,10 +1870,13 @@ static inline bool i915_mmio_reg_valid(i915_reg_t reg)
 #define _ICL_COMBOPHY_B			0x6C000
 #define _EHL_COMBOPHY_C			0x160000
 #define _RKL_COMBOPHY_D			0x161000
+#define _ADL_COMBOPHY_E			0x16B000
+
 #define _ICL_COMBOPHY(phy)		_PICK(phy, _ICL_COMBOPHY_A, \
 					      _ICL_COMBOPHY_B, \
 					      _EHL_COMBOPHY_C, \
-					      _RKL_COMBOPHY_D)
+					      _RKL_COMBOPHY_D, \
+					      _ADL_COMBOPHY_E)
 
 /* CNL/ICL Port CL_DW registers */
 #define _ICL_PORT_CL_DW(dw, phy)	(_ICL_COMBOPHY(phy) + \
