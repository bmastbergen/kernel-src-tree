drm/i915/adl_s: Add vbt port and aux channel settings for adls

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-326.el8
commit-author Aditya Swarup <aditya.swarup@intel.com>
commit 18c283df5a0ece65ac1cfc6f1e2867fd24636252
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-326.el8/18c283df.failed

- ADL-S driver internal mapping uses PORT D, E, F, G for Combo phy B, C,
  D and E.
- Add ADLS specific port mappings for vbt port dvo settings.
- Select appropriate AUX CH specific to ADLS based on port mapping.

	Cc: Jani Nikula <jani.nikula@intel.com>
	Cc: Ville Syrjälä <ville.syrjala@linux.intel.com>
	Cc: Imre Deak <imre.deak@intel.com>
	Cc: Matt Roper <matthew.d.roper@intel.com>
	Cc: Lucas De Marchi <lucas.demarchi@intel.com>
	Signed-off-by: Aditya Swarup <aditya.swarup@intel.com>
	Reviewed-by: Matt Roper <matthew.d.roper@intel.com>
	Signed-off-by: Lucas De Marchi <lucas.demarchi@intel.com>
Link: https://patchwork.freedesktop.org/patch/msgid/20210125140753.347998-10-aditya.swarup@intel.com
(cherry picked from commit 18c283df5a0ece65ac1cfc6f1e2867fd24636252)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/gpu/drm/i915/display/intel_bios.c
diff --cc drivers/gpu/drm/i915/display/intel_bios.c
index 91ccc327af09,04337ac6f8c4..000000000000
--- a/drivers/gpu/drm/i915/display/intel_bios.c
+++ b/drivers/gpu/drm/i915/display/intel_bios.c
@@@ -1677,11 -1716,29 +1677,33 @@@ static enum port dvo_port_to_port(struc
  		[PORT_A] = { DVO_PORT_HDMIA, DVO_PORT_DPA, -1 },
  		[PORT_B] = { DVO_PORT_HDMIB, DVO_PORT_DPB, -1 },
  		[PORT_C] = { -1 },
 -		[PORT_TC1] = { DVO_PORT_HDMIC, DVO_PORT_DPC, -1 },
 -		[PORT_TC2] = { DVO_PORT_HDMID, DVO_PORT_DPD, -1 },
 +		[PORT_D] = { DVO_PORT_HDMIC, DVO_PORT_DPC, -1 },
 +		[PORT_E] = { DVO_PORT_HDMID, DVO_PORT_DPD, -1 },
  	};
+ 	/*
+ 	 * Alderlake S ports used in the driver are PORT_A, PORT_D, PORT_E,
+ 	 * PORT_F and PORT_G, we need to map that to correct VBT sections.
+ 	 */
+ 	static const int adls_port_mapping[][3] = {
+ 		[PORT_A] = { DVO_PORT_HDMIA, DVO_PORT_DPA, -1 },
+ 		[PORT_B] = { -1 },
+ 		[PORT_C] = { -1 },
+ 		[PORT_TC1] = { DVO_PORT_HDMIB, DVO_PORT_DPB, -1 },
+ 		[PORT_TC2] = { DVO_PORT_HDMIC, DVO_PORT_DPC, -1 },
+ 		[PORT_TC3] = { DVO_PORT_HDMID, DVO_PORT_DPD, -1 },
+ 		[PORT_TC4] = { DVO_PORT_HDMIE, DVO_PORT_DPE, -1 },
+ 	};
  
++<<<<<<< HEAD
 +	if (IS_ROCKETLAKE(dev_priv))
++=======
+ 	if (IS_ALDERLAKE_S(dev_priv))
+ 		return __dvo_port_to_port(ARRAY_SIZE(adls_port_mapping),
+ 					  ARRAY_SIZE(adls_port_mapping[0]),
+ 					  adls_port_mapping,
+ 					  dvo_port);
+ 	else if (IS_DG1(dev_priv) || IS_ROCKETLAKE(dev_priv))
++>>>>>>> 18c283df5a0e (drm/i915/adl_s: Add vbt port and aux channel settings for adls)
  		return __dvo_port_to_port(ARRAY_SIZE(rkl_port_mapping),
  					  ARRAY_SIZE(rkl_port_mapping[0]),
  					  rkl_port_mapping,
@@@ -2643,16 -2702,32 +2672,39 @@@ enum aux_ch intel_bios_port_aux_ch(stru
  		aux_ch = AUX_CH_A;
  		break;
  	case DP_AUX_B:
- 		aux_ch = AUX_CH_B;
+ 		if (IS_ALDERLAKE_S(dev_priv))
+ 			aux_ch = AUX_CH_USBC1;
+ 		else
+ 			aux_ch = AUX_CH_B;
  		break;
  	case DP_AUX_C:
++<<<<<<< HEAD
 +		aux_ch = IS_ROCKETLAKE(dev_priv) ? AUX_CH_D : AUX_CH_C;
 +		break;
 +	case DP_AUX_D:
 +		aux_ch = IS_ROCKETLAKE(dev_priv) ? AUX_CH_E : AUX_CH_D;
++=======
+ 		if (IS_ALDERLAKE_S(dev_priv))
+ 			aux_ch = AUX_CH_USBC2;
+ 		else if (IS_DG1(dev_priv) || IS_ROCKETLAKE(dev_priv))
+ 			aux_ch = AUX_CH_USBC1;
+ 		else
+ 			aux_ch = AUX_CH_C;
+ 		break;
+ 	case DP_AUX_D:
+ 		if (IS_ALDERLAKE_S(dev_priv))
+ 			aux_ch = AUX_CH_USBC3;
+ 		else if (IS_DG1(dev_priv) || IS_ROCKETLAKE(dev_priv))
+ 			aux_ch = AUX_CH_USBC2;
+ 		else
+ 			aux_ch = AUX_CH_D;
++>>>>>>> 18c283df5a0e (drm/i915/adl_s: Add vbt port and aux channel settings for adls)
  		break;
  	case DP_AUX_E:
- 		aux_ch = AUX_CH_E;
+ 		if (IS_ALDERLAKE_S(dev_priv))
+ 			aux_ch = AUX_CH_USBC4;
+ 		else
+ 			aux_ch = AUX_CH_E;
  		break;
  	case DP_AUX_F:
  		aux_ch = AUX_CH_F;
* Unmerged path drivers/gpu/drm/i915/display/intel_bios.c
