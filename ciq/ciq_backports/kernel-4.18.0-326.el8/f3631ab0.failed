net: ethtool: Remove PHYLIB direct dependency

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-326.el8
commit-author Florian Fainelli <f.fainelli@gmail.com>
commit f3631ab08eeb67ad023ba1b37004ecba0158f93f
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-326.el8/f3631ab0.failed

Now that we have introduced ethtool_phy_ops and the PHY library
dynamically registers its operations with that function pointer, we can
remove the direct PHYLIB dependency in favor of using dynamic
operations.

	Signed-off-by: Florian Fainelli <f.fainelli@gmail.com>
	Signed-off-by: David S. Miller <davem@davemloft.net>
(cherry picked from commit f3631ab08eeb67ad023ba1b37004ecba0158f93f)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	net/ethtool/cabletest.c
diff --cc net/ethtool/cabletest.c
index dd4e90ccdb7f,888f6e101f34..000000000000
--- a/net/ethtool/cabletest.c
+++ b/net/ethtool/cabletest.c
@@@ -55,8 -56,9 +55,12 @@@ out
  
  int ethnl_act_cable_test(struct sk_buff *skb, struct genl_info *info)
  {
 -	struct nlattr *tb[ETHTOOL_A_CABLE_TEST_MAX + 1];
  	struct ethnl_req_info req_info = {};
++<<<<<<< HEAD
 +	struct nlattr **tb = info->attrs;
++=======
+ 	const struct ethtool_phy_ops *ops;
++>>>>>>> f3631ab08eeb (net: ethtool: Remove PHYLIB direct dependency)
  	struct net_device *dev;
  	int ret;
  
@@@ -299,8 -313,9 +309,12 @@@ static int ethnl_act_cable_test_tdr_cfg
  
  int ethnl_act_cable_test_tdr(struct sk_buff *skb, struct genl_info *info)
  {
 -	struct nlattr *tb[ETHTOOL_A_CABLE_TEST_TDR_MAX + 1];
  	struct ethnl_req_info req_info = {};
++<<<<<<< HEAD
 +	struct nlattr **tb = info->attrs;
++=======
+ 	const struct ethtool_phy_ops *ops;
++>>>>>>> f3631ab08eeb (net: ethtool: Remove PHYLIB direct dependency)
  	struct phy_tdr_config cfg;
  	struct net_device *dev;
  	int ret;
diff --git a/net/Kconfig b/net/Kconfig
index 1c78d2fcf6b2..1cd44e244e3e 100644
--- a/net/Kconfig
+++ b/net/Kconfig
@@ -455,7 +455,6 @@ config FAILOVER
 config ETHTOOL_NETLINK
 	bool "Netlink interface for ethtool"
 	default y
-	depends on PHYLIB=y || PHYLIB=n
 	help
 	  An alternative userspace interface for ethtool based on generic
 	  netlink. It provides better extensibility and some new features,
* Unmerged path net/ethtool/cabletest.c
