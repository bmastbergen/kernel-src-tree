selftests/bpf: Xsk selftests - Bi-directional Sockets - SKB, DRV

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-326.el8
commit-author Weqaar Janjua <weqaar.janjua@gmail.com>
commit 7d20441eb05ec6d8dc7b16381c53b3c0b3ad6e8a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-326.el8/7d20441e.failed

Adds following tests:

1. AF_XDP SKB mode
   d. Bi-directional Sockets
      Configure sockets as bi-directional tx/rx sockets, sets up fill
      and completion rings on each socket, tx/rx in both directions.
      Only nopoll mode is used

2. AF_XDP DRV/Native mode
   d. Bi-directional Sockets
   * Only copy mode is supported because veth does not currently support
     zero-copy mode

	Signed-off-by: Weqaar Janjua <weqaar.a.janjua@intel.com>
	Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>
	Tested-by: Yonghong Song <yhs@fb.com>
	Acked-by: Björn Töpel <bjorn.topel@intel.com>
Link: https://lore.kernel.org/bpf/20201207215333.11586-6-weqaar.a.janjua@intel.com
(cherry picked from commit 7d20441eb05ec6d8dc7b16381c53b3c0b3ad6e8a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	tools/testing/selftests/bpf/test_xsk.sh
#	tools/testing/selftests/bpf/xdpxceiver.c
#	tools/testing/selftests/bpf/xdpxceiver.h
diff --cc tools/testing/selftests/bpf/test_xsk.sh
index cae4c5574c4c,88a7483eaae4..000000000000
--- a/tools/testing/selftests/bpf/test_xsk.sh
+++ b/tools/testing/selftests/bpf/test_xsk.sh
@@@ -138,6 -149,102 +138,105 @@@ retval=$
  test_status $retval "${TEST_NAME}"
  statusList+=($retval)
  
++<<<<<<< HEAD
++=======
+ ### TEST 2
+ TEST_NAME="SKB NOPOLL"
+ 
+ vethXDPgeneric ${VETH0} ${VETH1} ${NS1}
+ 
+ params=("-S")
+ execxdpxceiver params
+ 
+ retval=$?
+ test_status $retval "${TEST_NAME}"
+ statusList+=($retval)
+ 
+ ### TEST 3
+ TEST_NAME="SKB POLL"
+ 
+ vethXDPgeneric ${VETH0} ${VETH1} ${NS1}
+ 
+ params=("-S" "-p")
+ execxdpxceiver params
+ 
+ retval=$?
+ test_status $retval "${TEST_NAME}"
+ statusList+=($retval)
+ 
+ ### TEST 4
+ TEST_NAME="DRV NOPOLL"
+ 
+ vethXDPnative ${VETH0} ${VETH1} ${NS1}
+ 
+ params=("-N")
+ execxdpxceiver params
+ 
+ retval=$?
+ test_status $retval "${TEST_NAME}"
+ statusList+=($retval)
+ 
+ ### TEST 5
+ TEST_NAME="DRV POLL"
+ 
+ vethXDPnative ${VETH0} ${VETH1} ${NS1}
+ 
+ params=("-N" "-p")
+ execxdpxceiver params
+ 
+ retval=$?
+ test_status $retval "${TEST_NAME}"
+ statusList+=($retval)
+ 
+ ### TEST 6
+ TEST_NAME="SKB SOCKET TEARDOWN"
+ 
+ vethXDPgeneric ${VETH0} ${VETH1} ${NS1}
+ 
+ params=("-S" "-T")
+ execxdpxceiver params
+ 
+ retval=$?
+ test_status $retval "${TEST_NAME}"
+ statusList+=($retval)
+ 
+ ### TEST 7
+ TEST_NAME="DRV SOCKET TEARDOWN"
+ 
+ vethXDPnative ${VETH0} ${VETH1} ${NS1}
+ 
+ params=("-N" "-T")
+ execxdpxceiver params
+ 
+ retval=$?
+ test_status $retval "${TEST_NAME}"
+ statusList+=($retval)
+ 
+ ### TEST 8
+ TEST_NAME="SKB BIDIRECTIONAL SOCKETS"
+ 
+ vethXDPgeneric ${VETH0} ${VETH1} ${NS1}
+ 
+ params=("-S" "-B")
+ execxdpxceiver params
+ 
+ retval=$?
+ test_status $retval "${TEST_NAME}"
+ statusList+=($retval)
+ 
+ ### TEST 9
+ TEST_NAME="DRV BIDIRECTIONAL SOCKETS"
+ 
+ vethXDPnative ${VETH0} ${VETH1} ${NS1}
+ 
+ params=("-N" "-B")
+ execxdpxceiver params
+ 
+ retval=$?
+ test_status $retval "${TEST_NAME}"
+ statusList+=($retval)
+ 
++>>>>>>> 7d20441eb05e (selftests/bpf: Xsk selftests - Bi-directional Sockets - SKB, DRV)
  ## END TESTS
  
  cleanup_exit ${VETH0} ${VETH1} ${NS1}
* Unmerged path tools/testing/selftests/bpf/xdpxceiver.c
* Unmerged path tools/testing/selftests/bpf/xdpxceiver.h
* Unmerged path tools/testing/selftests/bpf/test_xsk.sh
* Unmerged path tools/testing/selftests/bpf/xdpxceiver.c
* Unmerged path tools/testing/selftests/bpf/xdpxceiver.h
