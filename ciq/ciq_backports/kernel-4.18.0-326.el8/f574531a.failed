net/mlx5: Disable VF tunnel TX offload if ignore_flow_level isn't supported

jira LE-1907
Rebuild_History Non-Buildable kernel-4.18.0-326.el8
commit-author Maor Dickman <maord@nvidia.com>
commit f574531a0b77261478408e9c8f70d96dc701a35a
Empty-Commit: Cherry-Pick Conflicts during history rebuild.
Will be included in final tarball splat. Ref for failed cherry-pick at:
ciq/ciq_backports/kernel-4.18.0-326.el8/f574531a.failed

VF tunnel TX traffic offload is adding flow which forward to flow
tables with lower level, which isn't support on all FW versions
and may cause firmware to fail with syndrome.

Fixed by enabling VF tunnel TX offload only if flow table capability
ignore_flow_level is enabled.

Fixes: 10742efc20a4 ("net/mlx5e: VF tunnel TX traffic offloading")
	Signed-off-by: Maor Dickman <maord@nvidia.com>
	Reviewed-by: Vlad Buslov <vladbu@nvidia.com>
	Signed-off-by: Saeed Mahameed <saeedm@nvidia.com>
(cherry picked from commit f574531a0b77261478408e9c8f70d96dc701a35a)
	Signed-off-by: Jonathan Maple <jmaple@ciq.com>

# Conflicts:
#	drivers/net/ethernet/mellanox/mlx5/core/eswitch_offloads.c
diff --cc drivers/net/ethernet/mellanox/mlx5/core/eswitch_offloads.c
index 1aa743021f64,8694b83968b4..000000000000
--- a/drivers/net/ethernet/mellanox/mlx5/core/eswitch_offloads.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/eswitch_offloads.c
@@@ -389,8 -549,14 +389,17 @@@ esw_setup_dests(struct mlx5_flow_destin
  	struct mlx5_fs_chains *chains = esw_chains(esw);
  	int err = 0;
  
++<<<<<<< HEAD
++=======
+ 	if (!mlx5_eswitch_termtbl_required(esw, attr, flow_act, spec) &&
+ 	    MLX5_CAP_GEN(esw_attr->in_mdev, reg_c_preserve) &&
+ 	    mlx5_eswitch_vport_match_metadata_enabled(esw) &&
+ 	    MLX5_CAP_ESW_FLOWTABLE_FDB(esw->dev, ignore_flow_level))
+ 		attr->flags |= MLX5_ESW_ATTR_FLAG_SRC_REWRITE;
+ 
++>>>>>>> f574531a0b77 (net/mlx5: Disable VF tunnel TX offload if ignore_flow_level isn't supported)
  	if (attr->dest_ft) {
 -		esw_setup_ft_dest(dest, flow_act, esw, attr, spec, *i);
 +		esw_setup_ft_dest(dest, flow_act, attr, *i);
  		(*i)++;
  	} else if (attr->flags & MLX5_ESW_ATTR_FLAG_SLOW_PATH) {
  		esw_setup_slow_path_dest(dest, flow_act, chains, *i);
* Unmerged path drivers/net/ethernet/mellanox/mlx5/core/eswitch_offloads.c
